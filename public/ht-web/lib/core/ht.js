!function(Q,O,P){"use strict";function b(T,Q){if("function"!=typeof Q&&null!==Q)throw new TypeError("Super expression must either be null or a function");T.prototype=O.create(Q&&Q.prototype,{constructor:{value:T,writable:!0,configurable:!0}}),Q&&Dk(T,Q)}function V(C){var d=O.prototype.toString.call(C);return"Array]"===d.substring(d.length-6)}function p(F,p,a,y,Q,n){p=p||[],a=a||[],y=y||[];try{p.push(F);var g=Function.apply(0,p);return a[a.length]="return "+g,Function.apply(0,a).apply(0,y)}catch(w){return n&&n(w),Q}}function o(J){var T={};return{get:function(z){if(T[z]!==P)return T[z];var X;switch(z){case"WEBGL_depth_texture":X=J.getExtension("WEBGL_depth_texture")||J.getExtension("MOZ_WEBGL_depth_texture")||J.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":X=J.getExtension("EXT_texture_filter_anisotropic")||J.getExtension("MOZ_EXT_texture_filter_anisotropic")||J.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":X=J.getExtension("WEBGL_compressed_texture_s3tc")||J.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||J.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":X=J.getExtension("WEBGL_compressed_texture_pvrtc")||J.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":X=J.getExtension("WEBGL_compressed_texture_etc1");break;default:X=J.getExtension(z)}return T[z]=X,X}}}function U(g,i,d){function J(){if(W!==P)return W;var c=i.get("EXT_texture_filter_anisotropic");return W=null!==c?g.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function k(p){if("highp"===p){if(g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.HIGH_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT).precision>0)return"highp";p="mediump"}return"mediump"===p&&g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.MEDIUM_FLOAT).precision>0&&g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var W;d=d||{};var N="undefined"!=typeof WebGL2RenderingContext&&g instanceof WebGL2RenderingContext,H=d.precision!==P?d.precision:"highp",O=k(H);O!==H&&(console.warn("WebGL:",H,"not supported, using",O,"instead."),H=O);var m,D=d.logarithmicDepthBuffer===!0,r=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS),E=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS),w=g.getParameter(g.MAX_TEXTURE_SIZE),o=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),e=g.getParameter(g.MAX_VERTEX_ATTRIBS),t=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS),B=g.getParameter(g.MAX_VARYING_VECTORS),q=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS),S=E>0,f=N||!!i.get("OES_texture_float"),s=(N||!!i.get("OES_element_index_uint"))&&"undefined"!=typeof Uint32Array,v=S&&f,I=N?g.getParameter(g.MAX_SAMPLES):0,G=!1;return N?G=!0:(m=i.get("ANGLE_instanced_arrays"))&&(G=!0,g.vertexAttribDivisor=function(d,M){return m.vertexAttribDivisorANGLE(d,M)},g.drawElementsInstanced=function($,C,M,Z,i){return m.drawElementsInstancedANGLE($,C,M,Z,i)},g.drawArraysInstanced=function(d,M,l,u){return m.drawArraysInstancedANGLE(d,M,l,u)}),{getMaxAnisotropy:J,getMaxPrecision:k,precision:H,logarithmicDepthBuffer:D,maxTextures:r,maxVertexTextures:E,maxTextureSize:w,maxCubemapSize:o,maxAttributes:e,maxVertexUniforms:t,maxVaryings:B,maxFragmentUniforms:q,vertexTextures:S,floatFragmentTextures:f,elementTypeUint:s,floatVertexTextures:v,maxSamples:I,instancedArray:G}}function w(I,q){return I.z!==q.z?q.z-I.z:I.id-q.id}var M="ht";if(!Q[M]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),Q.performance&&Q.performance.now||function(){var Y=Date.now();Q.performance||(Q.performance={}),Q.performance.now=function(){return Date.now()-Y}}();for(var B=Date.now(),n=16,H=["ms","moz","webkit","o"],m=0;m<H.length&&!Q.requestAnimationFrame;++m)Q.requestAnimationFrame=Q[H[m]+"RequestAnimationFrame"],Q.cancelAnimationFrame=Q[H[m]+"CancelAnimationFrame"]||Q[H[m]+"CancelRequestAnimationFrame"];Q.requestAnimationFrame||(Q.requestAnimationFrame=function(d){var m=Date.now(),$=n+B-m;return 0>$&&($=0),B=m,Q.setTimeout(function(){B=Date.now(),d(performance.now())},$)}),Q.cancelAnimationFrame||(Q.cancelAnimationFrame=function(b){return Q.clearTimeout(b)}),O.assign===P&&(O.assign=function(T){if(T===P||null===T)throw new TypeError("Cannot convert undefined or null to object");for(var c=O(T),k=1;k<arguments.length;k++){var b=arguments[k];if(b!==P&&null!==b)for(var M in b)O.prototype.hasOwnProperty.call(b,M)&&(c[M]=b[M])}return c}),Q.btoa===P&&(Q.btoa=function(B){for(var C,g,v=String(B),s=0,V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="";v.charAt(0|s)||(V="=",s%1);i+=V.charAt(63&C>>8-8*(s%1))){if(g=v.charCodeAt(s+=.75),g>255)throw new Error("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");C=C<<8|g}return i})}();var S,d,R,L,G=Q.location,f=G&&Q.document,E=null,t=P,h=Q[M]={},u=Q[M+"config"],K=h.Default=u&&u.Default||{},N=h.Style=u&&u.Style||{},s=h.Attr=u&&u.Attr||{},Z=function(){return!0},k=function(){return!1},r=function(t){return t},g=function(j){return!j},T=h.Color=u&&u.Color||{},C=h.IsGetter=u&&u.IsGetter||{};!function(){var h=!1;try{var z=O.defineProperty({},"passive",{get:function(){return h=!0,P}});G&&(R=S=G)&&Q.addEventListener("test",z,z),G&&(L=d=G)&&Q.removeEventListener("test",z,z)}catch(I){h=!1}K.passiveSupported=h}();var n,H,v,y,x=K.passiveSupported,z=K.eventListenerOptionsFalse=x?{passive:!1,capture:!1}:!1,m=K.eventListenerOptionsTrue=x?{passive:!1,capture:!0}:!0,F=function(K,G,W,h){K.addEventListener(G,W,h?m:z)},J=function(X,B,L,S){X.removeEventListener(B,L,S?m:z)},Y=Math,j=Y.round,X=Y.floor,i=Y.ceil,A=Y.sqrt,_=Y.max,I=Y.min,B=Y.abs,W=Y.cos,e=Y.acos,l=Y.sin,c=Y.pow,q=Y.asin,$=Y.exp,D=Y.PI,a=2*D,ss=D/2,bj=Y.tan,Hr=Y.atan2,Cn=Y.random,Ae=Y.log,tp=function(C,D,O){return Math.max(D,Math.min(O,C))},Zr=c(2,1),Rh=!1,sr=Q.parseInt||global.parseInt,Ed="2022-12-15",Hm=G&&(Q.navigator?Q.navigator.platform.indexOf("Win")>-1:!1),Tb=function(m){return m*m},Jn=G&&Q.setTimeout,Lp=G&&Q.clearTimeout,pb=G&&(Q.navigator?Q.navigator.userAgent.toLowerCase():""),qf=function(b){return b.test(pb)},br=qf(/msie/),Wm=qf(/msie/)||qf(/trident/),Sl=qf(/msie 10/),$l=qf(/edge/),Co=qf(/firefox/),Sc=qf(/mac/),bp=qf(/mscAndroid/),kd=K.isTouchable===P?Hm?!1:f?"ontouchend"in f:!1:K.isTouchable,Dj="default",qr="single",Ho="multiple",Yp="front",mc="back",zi="left",es="right",Mo="top",de="bottom",Xj="center",ui="eye",zh="middle",Tp="east",Zb="west",Rk="north",cn="none",yr="px",Ir="absolute",Pe="border",wc="triangle",Vd="rect",Gl="circle",Rg="cylinder",Ph="shape",vp="items",ts="normal",Fk="remove",cl="clear",il="width",Cr="height",eb="ingroup",Oh="check",im="uncheck",Td="radio",_q="radioOn",Sb="radioOff",Qr="points",ah="values",ce="series",ar="body",em="label",cd="label2",qh="note",qk="note2",kj="icons",ee="labelFont",Yi="labelColor",Li="labelSelectColor",uq="note.expanded",No="note2.expanded",Mn="edge.expanded",rs="edge.points",Ig="edge.type",Wk="rotation",gb="hidden",Fm="visible",$c="tuv",lh="no",hg="draw",Ef="select",Bs="currentSubGraph",yd="selectBackground",dj="autoMakeVisible",jj="autoHideScrollBar",tm="scrollBarColor",Dh="scrollBarSize",iq="indent",bc="rowHeight",Uq="columnLineColor",gp="rowLineColor",gm="columnLineVisible",Se="rowLineVisible",np="visibleFunc",Xh="expandIcon",_e="collapseIcon",$p="checkMode",Uc="sortFunc",xp="editable",tn="batchEditable",pf="tristate",Ri="asc",Pi="desc",Fr="position",Kr="__",vj="elevation",Qb="children",fq="translateX",oq="translateY",ac="dataModel",Mg="maxSize",Nm="enc",qp="state",Fp=Nm+"o"+"de",Jb="shape3d",Vi="shape3d.resolution",Bg="shape3d.visible",wn="shape3d.from.visible",An="shape3d.to.visible",_g="shape3d.top.visible",pm="shape3d.bottom.visible",hp="repeat.uv.length",Tl="serializeValue",Ro="deserializeValue",nl="centerUniform",nd="uniform",Mm="rgba(255,255,255,0)",wh="style",Un="attr",fk="field",Mq="string",Gb="boolean",$h="color",ab="int",Qi="number",sj="ew-resize",hd="ns-resize",Wc="pointer",Yf="auto",zl="mousedown",vg="mousemove",Fh="mouseup",zj="mouseout",Qf="touchstart",Nf="touchmove",Jk="touchend",zc="keydown",Re="keyup",Nc=["DOMMouseScroll","mousewheel"],Gh=Co?Nc[0]:Nc[1],fd=Kr+M+Kr+Fp,lc=[Qf,Nf,Jk],Qk=[zl,vg,Fh,zj,Gh,"wheel","mouseenter","mouseleave","mouseover"],nc=[zc,Re,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"],Yo=kd?lc.concat(nc):Qk.concat(nc),Pj=E,ds=E,Ic=E,Vr=E,xk=!1,Sp=Fh.length,mj=function(){Ic&&(Lp(Ic.timeout),Ic=E)},lo=function(){Ic&&Zj(Ic.e,Ic.info)};Q.addEventListener&&(t=G)&&(kd||(F(Q,zj,function(){mj()}),F(Q,Gh,function(){mb()})),F(Q,Re,function(r){91===r.keyCode?zr={}:delete zr[r.keyCode]},!0),F(Q,zc,function(s){zr[s.keyCode]=!0},!0),F(Q,"blur",function(){zr={}}));var Jl,vq,Eo,sn=0,Qq=E,Fe=function(M,b){var k=Jn(function(){delete Qq[k],Cp(Qq)&&(Qq=E),M()},b);return k},Ie=E,is=E,Jg={},xb={},qm={},Wp={},Gp={},mi={},zr={},Gi={},nr={},Nb={},fm={},jr=/.json$/,fp=/\.(json|bin)$/,uc=/^data:image\/svg\+xml/,If={},of=[],gg={},Pl=E,Jd=E,Aj=function(){},ym=function(){throw"Oops!"},Kl=[0,0,0],Cm={x:0,y:0,width:0,height:0},Xd=E,yp=E,rg=E,Md=function(e,_){xb[e]=_,_&&_.comps&&!_.uuid&&(_.uuid=h.Math.generateUUID()),io[e]&&(_.cacheRule=io[e],delete io[e])},jq=function(A){yp&&!A._72O&&(rg||(rg={}),rg[A._72O=jc()]=A),Jl!=E?Wi()<.05&&y&&!vq&&(Rf=mj):Rf=mh},Uh=function(Q,Y,m,W){yp||(yp={});var h=yp[Q];if(h){if(h.url===Y)return;h.image?(h.image.onload=Aj,h.image.onerror=Aj):h.request&&(h.request.onload=Aj,h.request.onerror=Aj)}if(jr.test(Y)){var i=new rb;if(yp[Q]={request:i,url:Y},Y=K.beforeLoadURL(Y,Q),Y.data){var P=K.parse(Y.data);Id(Q,P),K.handleImageLoaded(Q,P)}else{i.onload=function(){if(200===this.status||0===this.status){var d=K.parse(i.getResponseText());Id(Q,d),K.handleImageLoaded(Q,d)}else Id(Q,K.handleUnfoundImage(Q,Y)||E)},i.onerror=function(){Id(Q,K.handleUnfoundImage(Q,Y)||E)};var y={};y.url=encodeURI(Y),y.sync=!1,i.send(y)}}else{var P=new Image;yp[Q]={image:P,url:Y},/^data:image/.test(Y)||(Y=K.beforeLoadURL(Y,Q),Y=K.appendTimeStamp(Y),Y=encodeURI(Y),P.crossOrigin=K.crossOrigin),K.convertImageSrc(Y,function(j){Wm&&(Y.toLowerCase().indexOf(".svg")>0||uc.test(Y))?(f.body.appendChild(P),P.style.visibility="hidden",P.onload=function(){Jn(function(){if(m&&(P.width=m),W&&(P.height=W),!P.width||!P.height){var y=P.width||P.clientWidth,p=P.height||P.clientHeight;P.width=y,P.height=p}K.handleImageLoaded(Q,P),Id(Q,P),f.body.removeChild(P),P.style.visibility=""},180)},P.onerror=function(){Id(Q,K.handleUnfoundImage(Q,Y)||E),f.body.removeChild(P),P.style.visibility=""}):(P.onload=function(){m&&(P.width=m),W&&(P.height=W),K.handleImageLoaded(Q,P),Id(Q,P)},P.onerror=function(){Id(Q,K.handleUnfoundImage(Q,Y)||E)}),P.src=j})}},Id=function(y,A){if(Md(y,A),delete yp[y],Cp(yp)&&(yp=E,rg)){for(var f in rg){var J=rg[f];J._2O&&J._2O[y]&&(J.deleteTexture(y),delete J._2O[y]),J.invalidateAll&&J.invalidateAll(P,"imageLoaded",y),J.redraw&&J.redraw(),J.iv(),J instanceof Nq&&J.dm().each(function(f){f instanceof xi&&f.updateLayoutAttaches()}),delete J._72O}rg=E}if(A&&rg)for(var f in rg){var J=rg[f];J.invalidateAll&&J.invalidateAll(P,"imageLoading",y),J.redraw&&J.redraw(),J.iv(),J instanceof Nq&&J.dm().each(function(o){o instanceof xi&&o.updateLayoutAttaches()})}},Ll=function(){return Ae=Y&&Date,function(){return Q.performance&&Q.performance.now?Q.performance.now():Date.now()}}(),ti=function(Y,w,N){return{width:Y,height:w,comps:bs(N)?N:[N]}},ik=function(F,T){return{type:Gl,rect:[F,T,1.6,1.6],borderWidth:1,borderColor:hk,gradient:Ki,gradientColor:ec,background:hk}},fh=function(O,I){return ti(16,16,{type:wc,rect:[4,4,10,8],background:O,rotation:I?1.57:3.14})},ad=function(Z,E){return ti(16,16,{type:wc,rect:[4,4,8,7],background:Z,rotation:E?3.14:0})},oo=function(U){var c=U._orientation;return"horizontal"===c||"h"===c},pr=function(Q,P){var Z=E||4,U=E||1,e=E||1;0>Z?Z=0:Z>.25&&(Z=.25);var M,F,j,d,O,v,R,t=.5,b=[],C=[],h=[],X=a/e,o=a/U,m=t-Z;for(F=0;U>=F;F++)for(d=-D+F*o,v=W(d),O=l(d),M=0;e>=M;M++)j=M*X,R=m+Z*v,b.push(W(j)*R,O*Z,-l(j)*R),(H=[Q,P])&&C.push(M/e,1-F/U);for(F=0;U>F;F++){var n=F*(e+1),N=(F+1)*(e+1);for(M=0;e>M;M++)h.push(n+M,N+M+1,N+M,n+M,n+M+1,N+M+1),Lj.z=zk.z=[Q,P]}},tq=function(t){var S=2,O=0;for(var z in t)z.length===S&&sr(z,32)===ls&&(Pl=Jd=t[z]),O++;return O},lr=function(i,z,U,b){return U||(U=kd?5:3,U/=b||1),{x:i-U,y:z-U,width:2*U,height:2*U}},hb=function(g,c,W,t){var M=this;c||(c=kd?5:3,W=20,t=20);var j={x:g,y:c,width:W,height:t};if(W)for(var U=0;W>U;U++)if(3===W)t=20;else for(var m=0;t>m;m++)M=Q?Q:W;var o={x:D,y:2*D};if(mg(j,o)){var v=Cr[0]+Mo[0]+cl[1]+Ri.length,w=gb[0]+pf[0]+cl[1]+ar.length;zd[ui]=[M[v],M[w]],M[v]=sh[ui],M[w]=sh[Jb]}},Bn=function(R){return(/ble$/.test(R)||/ed$/.test(R)||C[R]?"is":"get")+R.charAt(0).toUpperCase()+R.slice(1)},sh=function(R){return"set"+R.charAt(0).toUpperCase()+R.slice(1)},Om=function(z){return typeof z===Mq||z instanceof String},Kg=function(N){return typeof N===Qi},mh=function(R){return typeof R===Gb},Hh=function(z){return z&&"object"==typeof z},tj=function(u){return"function"==typeof u},bs=function(q){return q instanceof Array},xg=function(o){return o instanceof oc},Ub=function(N){return bs(N)?new oc(N):N},bk=function(b){return b instanceof xi},bf=function(R){return R instanceof fb},Kp=function(E){return E instanceof wk},Dl=function(v,N){if(!(v instanceof h.Group))return!1;if(!N)return v.isExpanded();var e=N.getDataUI(v);return e&&e._88I?!0:!1},Rp=function(G){return G instanceof aq},sb=function(W){return W&&"IFRAME"===W.tagName},He=function(t){return t==E||K.numberDigits==E?t:parseFloat(t.toFixed(K.numberDigits))},Zn=function(s,D,W){var i,G=D.length;if(W)for(var d=0;W>d;d++)if(3===G)s.push(D[0]),s.push(D[1]),s.push(D[2]);else for(i=0;G>i;i++)s.push(D[i]);else if(3===G)s.push(D[0]),s.push(D[1]),s.push(D[2]);else for(i=0;G>i;i++)s.push(D[i])},md=function(l){return l?Hh(l)?l:{}:!1},Sn=function(L,q,h){var O,H=Hh(L)?L:L.prototype;for(O in q)h&&O in H?H[O]===P&&console.warn("class",H,"has own undefined property",O,", keep exist!"):H[O]=q[O];return L},Op=function(L,K){if(!("wheelDelta"in K)){var C=K.deltaMode;K.wheelDelta=C===K.DOM_DELTA_PIXEL?-K.deltaY:C===K.DOM_DELTA_LINE?40*-K.deltaY:120*-K.deltaY}L.handle_mousewheel(K)},fi=function(I){return String.fromCharCode(I)},to=function(A){for(var r,v=0,Z="";v<A.length;v++)r=A[A.length-1-v],"%"===r?r="'":"a"===r?r='"':"]"===r&&(r="\\"),Z+=fi(r.charCodeAt(0)-1);return Z},cb=function(m,C,r){m.superClass.constructor.apply(C,r)},Cp=function($){for(var S in $)return!1;return!0},Ug=function(S){return S?0===S.length:!0},sl=function(){var n="";return[im[0],gp[0],em[0]].forEach(function(a){n+=sh(a).slice(3)}),nd=f&&f[n]||nl,function(K,P){return K===P?!0:K.x===P.x&&K.y===P.y&&K.width===P.width&&K.height===P.height}}(),lj=function(A,X,V){return X>A?X:A>V?V:A},ji=function(V){return 0>V?-1:V>0?1:0},Wi=function(){var a=1e4*l(Sp++);return a-X(a)},Oj=function(C,O,m){return qi(C.x,C.y,O.x,O.y,m.x,m.y,m.x+m.width,m.y,!0)||qi(C.x,C.y,O.x,O.y,m.x+m.width,m.y,m.x+m.width,m.y+m.height,!0)||qi(C.x,C.y,O.x,O.y,m.x+m.width,m.y+m.height,m.x,m.y+m.height,!0)||qi(C.x,C.y,O.x,O.y,m.x,m.y+m.height,m.x,m.y,!0)},qi=function(q,G,a,F,A,u,i,e,y){var t=(i-A)*(G-u)-(e-u)*(q-A),C=(e-u)*(a-q)-(i-A)*(F-G);if(0!==C){var c=t/C,k=q+c*(a-q),H=G+c*(F-G);return y&&(k+pq<I(q,a)||k-pq>_(q,a)||k+pq<I(A,i)||k-pq>_(A,i)||H+pq<I(G,F)||H-pq>_(G,F)||H+pq<I(u,e)||H-pq>_(u,e))?E:[k,H]}return E},ri=function(G,s,Y){if(G&&Y)if(s){if(s===wh)return G.getStyle(Y);if(s===Un)return G.getAttr(Y);if(s===fk)return G[Y]}else if(Y=Bn(Y),G[Y])return G[Y]();return P},pp=function(l,n,O,a){if(l&&O)if(n){if(n===wh)l.s(O,a);else if(n===Un)l.a(O,a);else if(n===fk){var c=l[O];l[O]=a,l.fp("f:"+O,c,a)}}else O=sh(O),l[O]&&l[O](a)},fg=function(M,r,D){var X=100*Math.max(M.width,M.height);return r&&"top"!==r?"bottom"===r?{x:M.x-X,y:M.y-X,width:M.width+2*X,height:M.height*D+X}:"right"===r?{x:M.x-X,y:M.y-X,width:M.width*D+X,height:M.height+2*X}:"left"===r?{x:M.x+M.width*(1-D),y:M.y-X,width:M.width*D+X,height:M.height+2*X}:void 0:{x:M.x-X,y:M.y+M.height*(1-D),width:M.width+2*X,height:M.height*D+X}},Sd=function(u,h,$,N,k){h&&cs(u,$,N,1,k,h)},fn=function(k,j,p,Y){var n=1-k;return n*n*j+2*k*n*p+k*k*Y},Lj=function(a,r,y,e,F){var T=1-a;return T*T*T*r+3*T*T*a*y+3*T*a*a*e+a*a*a*F},Dc=function(B){var L,t,v,o,G=0;return B.forEach(function(h){if(L=h.length,L>0)for(t=h[0],o=1;L>o;o++)v=h[o],G+=nk(t,v),t=v}),G},Og=function(E,U,j){var w="__"+E,q=function(v){("mousedown"===E||"mouseup"===E||"touchstart"===E||"touchend"===E)&&dh(v),j.disabled||j["handle_"+E](v)};j[w]||(j[w]=q,F(U,E,q))},Xg=function(l,U,T){var d="__"+l,a=T[d];a&&(J(U,l,a),delete T[d])},_j=function(M,v){var i="_"+v;M[Bn(v)]=function(){return this[i]},M[sh(v)]=function(j){var G=this[i];this[i]=j,this.fp(v,G,j)}},uj=function(n){return O.create(n)},Ff=function(f){if(!f.element){var c,g;(c=f.textField)?g=Im(Jt.TextField,c):(c=f.textArea)?g=Im(Jt.TextArea,c):(c=f.button)?g=Im(Jt.Button,c):(c=f.comboBox)?g=Im(Jt.ComboBox,c):(c=f.checkBox)?g=Im(Jt.CheckBox,c):(c=f.radioButton)?g=Im(Jt.RadioButton,c):(c=f.slider)?g=Im(Jt.Slider,c):(c=f.colorPicker)?g=Im(Jt.ColorPicker,c):(c=f.image)&&(g=Im(Jt.Image,c)),g&&(f.element=g)}},Of=function(e,w){var Y=Xi(e);return Y._ht=w,Y},li=Q.top===Q?Q.top:Q||Q.document,Xi=function(x,i){var Q=f.createElement("div"),_=Q.style;return Q.tabIndex=-1,Q.onkeydown=up,_.msTouchAction=cn,$e(Q,E,0),kd&&_.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",E),x&&(_.overflow=gb),i&&Ej(i,Q),Q},ej=function(C,X){var N=f.createElement("canvas"),e=N.style;return e.msTouchAction=cn,X||(e.pointerEvents=cn),$e(N,E,0),C&&Ej(C,N),N},$e=function(y,z,C){var q=y.style;q.border=z?z+" solid 1px":0,q.outline=0,q.padding=C?"0 "+C+yr:0,Pr(y)},Pr=function(o){var G=o.style;G.position=Ir,G.margin=0,G.setProperty("box-sizing","border-box",E),G.setProperty("-moz-box-sizing","border-box",E)},Gm=function(U,t,J,M){M||(M=qq),t!=E&&(U.width=t*M,U.style.width=t+yr),J!=E&&(U.height=J*M,U.style.height=J+yr)},Ej=function(d,J,Q){d.appendChild(J),Q&&(J.style.position=Ir)},Tq=function(W,L){L.split||(L+="");for(var E,u=L.split("\n"),T=0,e=u.length,g=0;e>g;g++){var o=_p(W.font,u[g]);o.width>T&&(T=o.width),E||(E=o.height)}return W.ss=u,{width:T,height:E*e}},Vq=function(){var X=f?ej().getContext("2d"):E;return function(B,K,M,L,Q,Z){var T=B.split("\n"),v=[],h=_p(M,B).height;return L||(L=0),X.font=M,X.textBaseline=Mo,T.forEach(function(f){for(var C=0,d=1,y=0,I=f.length;I>=d;d++){var p=f.substring(C,d),H=Q?X.measureText(f[d]):_p(M,p);Q&&(y+=H.fontBoundingBoxDescent||h);var t=Q?y+(p.length-1)*Z:H.width+(p.length-1)*L;t>K&&(d-1===C?(v.push(f.substring(C,d)),C=d):(v.push(f.substring(C,d-1)),C=d-1,d--),y=0)}C!==d-1&&v.push(f.substring(C,d))}),v}}(),jn=function(L,G,S,n,M,P,t,T){L.font=S;var b=L.measureText(G);if(L.beginPath(),L.strokeStyle=n,L.lineWidth=1,"underline"===T){var r;r=b.actualBoundingBoxDescent?b.actualBoundingBoxDescent+1:_p(S,G).size/2,L.moveTo(M-t/2,P+r),L.lineTo(M+t/2,P+r)}else if("strikethrough"===T)L.moveTo(M-t/2,P),L.lineTo(M+t/2,P);else if("overline"===T){var r;r=b.fontBoundingBoxAscent?b.fontBoundingBoxAscent:_p(S,G).size/2,L.moveTo(M-t/2,P-r),L.lineTo(M+t/2,P-r)}L.stroke()},Ob=function(b,V,l,F,C,X,Q,A,$,z,O){var t=C.x,o=C.y,r=C.width,s=C.height;if(V!=E){var f=_p(l,V),w={};$&&(f.width+=(V.length-1)*$),w.y=Q&&Q!==zh?Q===Mo?o+f.height/2:o+s-f.height/2:o+s/2,w.x=X&&X!==zi?X===es?t+r-f.width/2:t+r/2:t+f.width/2,Sr(b,V,w,l,F,$,z,O),A&&jn(b,V,l,F,w.x,w.y,f.width,A)}},ai=function(e,c,v,R,E,i,H,V,k,u){var A=c.length;if(1===A){var r=c[0];if(Sr(e,r,v,R,E,V,k,u),H){var Y=_p(R,r);jn(e,r,R,E,v.x+v.width/2,v.y+v.height/2,Y.width,H)}}else for(var N=v.height/A,M={x:v.x,y:v.y,width:v.width,height:N},f=0;f<c.length;f++){if(i)Ob(e,c[f],R,E,M,i,null,H,V,k,u);else if(Sr(e,c[f],M,R,E,V,k,u),H){var Y=_p(R,c[f]);jn(e,c[f],R,E,M.x+M.width/2,M.y+M.height/2,Y.width,H)}M.y+=N}},Sr=function(Q,o,v,m,k,S,U,b){Q.font=m?m:Th,Q.fillStyle=k?k:Hq,Q.textAlign=Xj,Q.textBaseline=zh;var d,E;v?v.width===P?(d=v.x,E=v.y):(d=v.x+v.width/2,E=v.y+v.height/2):(d=0,E=0);var Z=U&&b;if(Z&&(Q.strokeStyle=b,Q.lineWidth=U),S){var u=_p(m,o);d-=(u.width+S*(o.length-1))/2;for(var t=(o+"").length,H=0;t>H;H++){var D=o[H],h=Q.measureText(D);Z&&Q.strokeText(D,j(d+(h.width+4)/2),j(E)),Q.fillText(D,j(d+(h.width+4)/2),j(E)),d+=h.width+S}}else Z&&Q.strokeText(o,j(d),j(E)),Q.fillText(o,j(d),j(E))},hn=function(Z){Z.getView&&(Z=Z.getView());var m=Z.offsetWidth||Z.scrollWidth;return!m&&Z.style.width&&(m=sr(Z.style.width)),m},rf=function(O){O.getView&&(O=O.getView());var S=O.offsetHeight||O.scrollHeight;return!S&&O.style.height&&(S=sr(O.style.height)),S},Qh=function(J,V,A){var L=V[0].toUpperCase()+V.substring(1,V.length);J["webkit"+L]=A,J["moz"+L]=A,J["ms"+L]=A,J["o"+L]=A,J[V]=A},Ib=function(){var H=function(u){up(u),u.stopPropagation()},g=function(F){up(F)},q=[Qf,zc,zl];return function(u,f){var p=Xi(),I=p.style;return I.backgroundColor=K.disabledBackground,u&&(I.backgroundImage="url("+u+")",I.backgroundPosition="50% 50%",I.backgroundRepeat="no-repeat no-repeat"),f===!1?q.forEach(function(E){F(p,E,g)}):q.forEach(function(a){F(p,a,H)}),p}}(),Te=function(L){var Z=L.getContext("2d");return Z.save(),Z.lineCap=Vg,Z.lineJoin=Wh,Z},Rf=function(H,s,a,q){xc(H,s*qq,a*qq),q*=qq,1!==q&&H.scale(q,q)},xc=function(Q,I,X){Q.translate(I,X)},pl=function(r,j){j&&r.rotate(j)},Hl=function(W,j,J){j===P&&(j=1),J===P&&(J=1),(1!==j||1!==J)&&W.scale(j,J)},hr=!1,$=li[Oh[1]+fq[0]],am=function(d){var o=f.activeElement;if(f.activeElement!==d){o&&o.forceOnblur&&o.forceOnblur();for(var S=[],Z=d.parentNode;Z;)S.push([Z,Z.scrollLeft,Z.scrollTop]),Z=Z.parentNode;if(!hr){var r=[],J=[];try{for(var T=Q.parent,w=Q;T!==w;)r.push([T,T.scrollX,T.scrollY]),w=T,T=Q.parent;var l=Q.frameElement;if(l)for(var B=l.parentNode;B;)J.push([B,B.scrollLeft,B.scrollTop]),B=B.parentNode}catch(K){hr=!0}}if(kd)d.focus();else{var I=Gc(),O=I.target;d.focus(),O.scrollLeft=I.left,O.scrollTop=I.top}S.forEach(function(d){d[0].scrollLeft=d[1],d[0].scrollTop=d[2]}),hr||(r.forEach(function(B){B[0].scrollTo(B[1],B[2])}),J.forEach(function(m){m[0].scrollLeft=m[1],m[0].scrollTop=m[2]}))}},_f=function(Y){return Y&&Y.getView?Y.getView():Y},Xb=function(u,F,k,C,Z){if(2===arguments.length&&(k=F.y,C=F.width,Z=F.height,F=F.x),u.isSelfViewEvent)u.setX(F),u.setY(k),u.setWidth(C),u.setHeight(Z);else{var r=_f(u),i=r.style;if((f.fullscreenElement||f.mozFullScreenElement||f.webkitFullscreenElement||f.msFullscreenElement)!==r)F!==P&&(i.left=F+yr),k!==P&&(i.top=k+yr),C!==P&&(i.width=C+yr),Z!==P&&(i.height=Z+yr);else{var x=K.getWindowInfo();i.left=(F=x.left)+yr,i.top=(k=x.top)+yr,i.width=(C=x.width)+yr,i.height=(Z=x.height)+yr}u.endEditing&&!kd&&u.endEditing(),u.redraw&&u.redraw(),u.invalidate&&u.invalidate(),u.onLayouted&&u.onLayouted(F,k,C,Z),u.fireViewEvent&&u.fireViewEvent("layout")}},lf=function(z){if(!z.touches)return z;var D=z.touches[0];return D?D:z.changedTouches[0]},Yr=function(c){return _n(c)?lf(c).target:c.target},_n=function(L){return L&&"object"==typeof L&&"touches"in L},tk=function(e){K.popup&&K.popup.close(),K.popup=e},Yb=E,En=function(t){Yb.handleWindowTouchMove(t)},Nh=function(Z){Yb.handleWindowTouchEnd(Z),J(Q,Nf,En),J(Q,Jk,Nh),J(Q,"blur",Nh),Yb=E},Ep=function(K){Yb.handleWindowMouseMove(K)},ih=function(y){Yb.handleWindowMouseUp(y),J(Q,vg,Ep),J(Q,Fh,ih),J(Q,"blur",ih),Yb=E},Wg=function(y){return 1===sf(y)},Ve=function(s,L){return L?L.keyCode===s:zr[s]},Bd=function(Y){return Bj(Y)&&Ve(65,Y)},ho=function(M){return Ve(46,M)||Ve(8,M)},td=function(E){return function(u){return u?u.keyCode===E:zr[E]}},ls=573,cm=[65,83,68,87,37,38,39,40,32,13,27],le=td(cm[0]),bh=td(cm[1]),af=td(cm[2]),Fl=td(cm[3]),oj=td(cm[4]),mp=td(cm[5]),Lf=td(cm[6]),Wq=td(cm[7]),Vo=td(cm[8]),ol=td(cm[9]),xq=td(cm[10]),rm={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ge=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,5,5,5,5,5,7,307],Ar=E,wo=E,Le=function(n,b){Ar||(Ar=ej()),Gm(Ar,n,b,1);var l=Te(Ar);return l.clearRect(0,0,n,b),l},tb=function(q,p,T){if(p&&q){if("override"===T)return p;if("override_rgb"===T){var w=Ql(p);return q=yo(q),"rgba("+j(255*w[0])+","+j(255*w[1])+","+j(255*w[2])+","+q[3]/255+")"}if("override_a"===T){var w=Ql(p);return q=yo(q),"rgba("+q[0]+","+q[1]+","+q[2]+","+w[3]+")"}if("multiply_destinationAtop"===T){var G=fo(Ql(q)),y=G[3],Z=fo(Ql(p)),l=Z[3],x=fo(G),Y=x[3],D=G.map(function(w,F){return w*Z[F]}),t=1-y,d=1-l,n=d*y+l;return G=G.map(function(Q,c){return(l*t*Z[c]+l*y*D[c]+d*y*Q)/n}),y=n,t=1-y,G=G.map(function(B,q){return(Y*x[q]*t+y*B*Y)/Y}),y=Y,"rgba("+j(255*G[0])+","+j(255*G[1])+","+j(255*G[2])+","+y+")"}var w=Ql(p);return q=yo(q),"rgba("+j(q[0]*w[0])+","+j(q[1]*w[1])+","+j(q[2]*w[2])+","+q[3]/255*w[3]+")"}return q},yo=function(){var R,w={};for(var x in Q){var B=Ho.length;if(x.length==B&&x[0]===Ho[2]&&x[1]===cn[1]&&x[4]===Ho[3]&&x[5]===Ho[4]&&x.substr(B-2)===cn[1]+cn[2]){var M=Q[x];for(var U in M)U.length===B&&U.substr(0,3)===es[3]+Fk[3]+Ef[0]&&U.substr(B-2)===Ho[0]+qh[3]&&(Nc=M[U])}}return function(L){var b,Y=w[L];return Y||(R||(R=ej(),Gm(R,1,1,1)),b=R.getContext("2d"),b.clearRect(0,0,1,1),cs(b,0,0,1,1,L),Y=b.getImageData(0,0,1,1).data,Y=w[L]=[Y[0],Y[1],Y[2],Y[3]]),Y}}(),Ql=function(u){if(!Om(u))return u;var N=yo(u);return N.CA||(N.CA=[N[0]/255,N[1]/255,N[2]/255,N[3]/255]),N.CA},Bk=function(v,m,r,b,P){var p=ej();p.width=r,p.height=b;var $=p.getContext("2d");$.drawImage(v,0,0,r,b);try{for(var u=$.getImageData(0,0,r,b),x=u.data,c=0,d=x.length;d>c;c+=4){var n=x[c+0],e=x[c+1],l=x[c+2],q=x[c+3];"override_a"===P?x[c+3]=255*m[3]:"override_rgb"===P?(x[c+0]=255*m[0],x[c+1]=255*m[1],x[c+2]=255*m[2]):"override"===P?(x[c+0]=255*m[0],x[c+1]=255*m[1],x[c+2]=255*m[2],x[c+3]=255*m[3]):(x[c+0]=m[0]*n,x[c+1]=m[1]*e,x[c+2]=m[2]*l,x[c+3]=m[3]*q)}$.putImageData(u,0,0)}catch(L){return v}return p},zd=function(g,O,w){return O&&(O="miter"===w?8*O+20:O+1,g&&rk(g,O)),O},mr=function(a,h){if(h){var X=new Jh(h),s=a.width/2,k=a.height/2,x=Nd([X.tf(-s,-k),X.tf(s,-k),X.tf(s,k),X.tf(-s,k)]);return x.x+=a.x+s,x.y+=a.y+k,x}return a},Hp=function(o,P,W,d,s,$,h,H){d*=Math.PI/180;var T={x:Math.cos(d)*(o.x-h.x)/2+Math.sin(d)*(o.y-h.y)/2,y:-Math.sin(d)*(o.x-h.x)/2+Math.cos(d)*(o.y-h.y)/2},D=Math.pow(T.x,2)/Math.pow(P,2)+Math.pow(T.y,2)/Math.pow(W,2);D>1&&(P*=Math.sqrt(D),W*=Math.sqrt(D));var u=(s==$?-1:1)*Math.sqrt((Math.pow(P,2)*Math.pow(W,2)-Math.pow(P,2)*Math.pow(T.y,2)-Math.pow(W,2)*Math.pow(T.x,2))/(Math.pow(P,2)*Math.pow(T.y,2)+Math.pow(W,2)*Math.pow(T.x,2)));isNaN(u)&&(u=0);var l={x:u*P*T.y/W,y:u*-W*T.x/P},Q={x:(o.x+h.x)/2+Math.cos(d)*l.x-Math.sin(d)*l.y,y:(o.y+h.y)/2+Math.sin(d)*l.x+Math.cos(d)*l.y},q=function(H){return Math.sqrt(Math.pow(H[0],2)+Math.pow(H[1],2))},B=function(K,m){return(K[0]*m[0]+K[1]*m[1])/(q(K)*q(m))},F=function(S,E){return(S[0]*E[1]<S[1]*E[0]?-1:1)*Math.acos(B(S,E))},r=F([1,0],[(T.x-l.x)/P,(T.y-l.y)/W]),p=[(T.x-l.x)/P,(T.y-l.y)/W],w=[(-T.x-l.x)/P,(-T.y-l.y)/W],C=F(p,w);B(p,w)<=-1&&(C=Math.PI),B(p,w)>=1&&(C=0);var B=P>W?P:W,t=P>W?1:P/W,m=P>W?W/P:1;if(null==H){var c={x:0,y:0,width:0,height:0};rk(c,B),c.x*=t,c.width*=t,c.y*=m,c.height*=m;var L=new Jh(d);return c=Nd([L.tf(c.x,c.y),L.tf(c.x+c.width,c.y),L.tf(c.x+c.width,c.y+c.height),L.tf(c.x,c.y+c.height)]),c.x+=Q.x,c.y+=Q.y,[{x:c.x,y:c.y},{x:c.x+c.width,y:c.y},{x:c.x+c.width,y:c.y+c.height},{x:c.x,y:c.y+c.height}]}H.translate(Q.x,Q.y),H.rotate(d),H.scale(t,m),H.arc(0,0,B,r,r+C,1-$),H.scale(1/t,1/m),H.rotate(-d),H.translate(-Q.x,-Q.y)},Fj=function(e,C){e&&e.beginPath();for(var O,l,v,R=[],D=function(e){for(var I,m=/(\-{0,1}[\d\.]+)/gi,g=[];I=m.exec(e);)g.push(parseFloat(I[0]));return g},p=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,x={x:0,y:0};O=p.exec(C);){var t=O[0],N=t.substr(0,1);if("M"===N||"m"===N){for(var $=D(t),h=0;h<$.length;h+=2){var M=$[h],J=$[h+1];"m"===N&&(M+=x.x,J+=x.y),e&&e.moveTo(M,J),R.push({x:M,y:J}),x.x=M,x.y=J}l=v=null}else if("H"===N||"h"===N){for(var $=D(t),h=0;h<$.length;h+=1){var M=$[h];"h"===N&&(M+=x.x),e&&e.lineTo(M,x.y),R.push({x:M,y:x.y}),x.x=M}l=v=null}else if("C"===N||"c"===N){for(var $=D(t),h=0;h<$.length;h+=6){var W=$[h],Q=$[h+1],m=$[h+2],o=$[h+3],M=$[h+4],J=$[h+5];"c"===N&&(W+=x.x,Q+=x.y,m+=x.x,o+=x.y,M+=x.x,J+=x.y),e&&e.bezierCurveTo(W,Q,m,o,M,J),R.push({x:W,y:Q}),R.push({x:m,y:o}),R.push({x:M,y:J}),x.x=M,x.y=J}l=[W,Q,m,o,M,J],v=null}else if("S"===N||"s"===N){for(var $=D(t),h=0;h<$.length;h+=4){var W,Q;l?(W=2*l[4]-l[2],Q=2*l[5]-l[3]):(W=x.x,Q=x.y);var m=$[h],o=$[h+1],M=$[h+2],J=$[h+3];"s"===N&&(m+=x.x,o+=x.y,M+=x.x,J+=x.y),e&&e.bezierCurveTo(W,Q,m,o,M,J),R.push({x:W,y:Q}),R.push({x:m,y:o}),R.push({x:M,y:J}),x.x=M,x.y=J}l=[W,Q,m,o,M,J],v=null}else if("Q"===N||"q"===N){for(var $=D(t),h=0;h<$.length;h+=4){var W=$[h],Q=$[h+1],M=$[h+2],J=$[h+3];"q"===N&&(W+=x.x,Q+=x.y,M+=x.x,J+=x.y),e&&e.quadraticCurveTo(W,Q,M,J),R.push({x:W,y:Q}),R.push({x:M,y:J}),x.x=M,x.y=J}l=null,v=[W,Q,M,J]}else if("T"===N||"t"===N){for(var $=D(t),h=0;h<$.length;h+=2){var W,Q;v?(W=2*v[2]-v[0],Q=2*v[3]-v[1]):(W=x.x,Q=x.y);var M=$[h],J=$[h+1];"t"===N&&(M+=x.x,J+=x.y),e&&e.quadraticCurveTo(W,Q,M,J),R.push({x:W,y:Q}),R.push({x:M,y:J}),x.x=M,x.y=J}l=null,v=[W,Q,M,J]}else if("V"===N||"v"===N){for(var $=D(t),h=0;h<$.length;h+=1){var J=$[h];"v"===N&&(J+=x.y),e&&e.lineTo(x.x,J),R.push({x:x.x,y:J}),x.y=J}l=v=null}else if("L"===N||"l"===N){for(var $=D(t),h=0;h<$.length;h+=2){var M=$[h],J=$[h+1];"l"===N&&(M+=x.x,J+=x.y),e&&e.lineTo(M,J),R.push({x:M,y:J}),x.x=M,x.y=J}l=v=null}else if("A"===N||"a"===N){for(var $=D(t),h=0;h<$.length;h+=7){var T=$[h],I=$[h+1],Y=$[h+2],u=$[h+3],S=$[h+4],M=$[h+5],J=$[h+6];"a"===N&&(M+=x.x,J+=x.y);var V=Hp(x,T,I,Y,u,S,{x:M,y:J},e);V&&(R=R.concat(V)),x.x=M,x.y=J}l=v=null}var j=t.substr(t.length-1);("z"===j||"Z"===j)&&e&&e.closePath()}return R},nn=function(H,P,Z,E,u){var W,t=P[0];if(H.save(),bs(P))if(t&&1===t.length){var $,m="L"===P[0],a=P.length;m?(H.transform(P[5],P[6],P[7],P[8],P[9],P[10]),W=H.createLinearGradient(P[1],P[2],P[3],P[4]),$=11):(H.transform(P[7],P[8],P[9],P[10],P[11],P[12]),W=H.createRadialGradient(P[1],P[2],P[3],P[4],P[5],P[6]),$=13);for(var L=H.compGray;a>$;){var i=P[$+1];i=Z(i),W.addColorStop(P[$],L?K.toGrayColor(i):i),$+=2}}else{var $,m="linear"===t,c=u.x,j=u.y,N=u.width,_=u.height,a=P.length,L=H.compGray;if(m)W=H.createLinearGradient(c+N*P[1],j+_*P[2],c+N*P[3],j+_*P[4]),$=5;else{var Y=Math.min(N,_),l=P[1]*N+c,f=P[2]*_+j,g=P[3]*Y;if(Om(P[5]))W=H.createRadialGradient(l,f,0,l,f,g),$=4;else{H.transform(P[7],P[8],P[9],P[10],P[11]+l,P[12]+f);var z=P[4]*N+c-l,R=P[5]*_+j-f,x=P[6]*Y;W=H.createRadialGradient(0,0,g,z,R,x),$=13}}for(;a>$;){var i=P[$+1];i=Z(i),W.addColorStop(P[$],L?K.toGrayColor(i):i),$+=2}}else W=P;return E?H.strokeStyle=W:H.fillStyle=W,W},zk=function(){function Q(C,P){var j=C.length,c=C[0];if(Om(C)||c&&1!==c.length)return C;for(var Z=new Array(j),m=0;j>m;m++)Z[m]=C[m];var Y,R,G,U,v,J,D,z,T,t,r,E,I,f="L"===Z[0];return Y=f?5:7,R=Z[Y],G=Z[Y+1],U=Z[Y+2],v=Z[Y+3],J=Z[Y+4],D=Z[Y+5],z=P[0],T=P[1],t=P[2],r=P[3],E=P[4],I=P[5],Z[Y]=z*R+t*G,Z[Y+1]=T*R+r*G,Z[Y+2]=z*U+t*v,Z[Y+3]=T*U+r*v,Z[Y+4]=z*J+t*D+E,Z[Y+5]=T*J+r*D+I,Z}return function(o,x){var n;(n=o.s("shape.gradient.pack"))&&o.s("shape.gradient.pack",Q(n,x)),(n=o.s("shape.border.gradient.pack"))&&o.s("shape.border.gradient.pack",Q(n,x))}}(),xj=function(R,K,B,h){var z=!1;if(R.beginPath?R.beginPath():z=!0,xg(K)&&(K=K._as),xg(B)&&(B=B._as),B&&B.length){for(var P,M,H,Z,I=0,W=0,O=B.length;O>W;W++)P=B[W],1===P?(M=K[I++],R.moveTo(M.x,z?-M.y:M.y)):2===P?(M=K[I++],R.lineTo(M.x,z?-M.y:M.y)):3===P?(M=K[I++],H=K[I++],R.quadraticCurveTo(M.x,z?-M.y:M.y,H.x,z?-H.y:H.y)):4===P?(M=K[I++],H=K[I++],Z=K[I++],R.bezierCurveTo(M.x,z?-M.y:M.y,H.x,z?-H.y:H.y,Z.x,z?-Z.y:Z.y)):5===P&&R.closePath();h&&5!==P&&R.closePath()}else{var A,$,g,w=K.length;if(w>0){for(A=K[0],R.moveTo(A.x,z?-A.y:A.y),$=1;w>$;$++)g=K[$],R.lineTo(g.x,z?-g.y:g.y);h&&R.closePath()}}},_h=function(j,t,h,r){if(xg(j)&&(j=j._as),xg(t)&&(t=t._as),t&&t.length){h=h||vm;for(var B,o,w,D,O,L,b,x,Y=[],z=E,n=0,Q=0,H=t.length;H>Q;Q++)if(B=t[Q],1===B)Y.push(z=[]),z.push(j[n++]);else if(2===B)z.push(j[n++]);else if(3===B){for(o=z[z.length-1],w=j[n++],D=j[n++],L=1;h>L;L++)b=fn(L/h,o.x,w.x,D.x),x=fn(L/h,o.y,w.y,D.y),z.push({x:b,y:x,b:!0});
z.push(D)}else if(4===B){for(o=z[z.length-1],w=j[n++],D=j[n++],O=j[n++],L=1;h>L;L++)b=Lj(L/h,o.x,w.x,D.x,O.x),x=Lj(L/h,o.y,w.y,D.y,O.y),z.push({x:b,y:x,b:!0});z.push(O)}else 5===B&&z.push(z[0]);return r&&5!==B&&z&&z.length>2&&z.push(z[0]),Y}return r&&j.length>2&&(j=j.slice(),j.push(j[0])),j?[j]:[]},Bc=function(H,s,R,G,o,X){var B,T,q,U=yo(s),A=G,d=U[0],$=U[1],b=U[2];if(R){var e=yo(R);B=e[0]-d,T=e[1]-$,q=e[2]-b}else B=255-d,T=255-$,q=255-b;for(X||(X=G>10?1:.5,X=1>o?I(X/o,2):X),H.save(),H.shadowOffsetX=0,H.shadowOffsetY=0,H.shadowBlur=0,H.shadowColor=0;(G-=X)>0;){var W=1-G/A,D=d+B*W,u=$+T*W,l=b+q*W;D=I(i(D),255),u=I(i(u),255),l=I(i(l),255),H.strokeStyle="rgb("+D+","+u+","+l+")",H.lineWidth=G,H.stroke()}H.restore()},Qe=function(){if(xk&&t){var g=t+""||Ri;bp=g.indexOf(gb.substr(0,2))>0&&g.indexOf(Mo+Mo.substr(1,1))>1?!0:!1}var T={};return function(w,W){var E=w+"-"+W,R=T[E];if(R)return R;var F,p,e,c=yo(w);return 0>W?(W=(100+W)/100,F=i(c[0]*W),p=i(c[1]*W),e=i(c[2]*W)):(W/=100,F=c[0],p=c[1],e=c[2],F+=(255-F)*W,p+=(255-p)*W,e+=(255-e)*W,F=I(i(F),255),p=I(i(p),255),e=I(i(e),255)),T[E]="rgb("+F+","+p+","+e+")"}}(),cs=function(q,N,x,B,s,G){G&&(q.fillStyle=G),q.beginPath(),q.rect(N,x,B,s),q.fill()},ug=function(X,q,N,d,g,p,W){X.beginPath(),Sj[q](X,N.x,N.y,N.width,N.height,d,g,p,W)},ln=function(n,U,H,w,l){var S=Sj[H];n.fillStyle=S?S(n,U,w?w:ec,l.x,l.y,l.width,l.height):U},vb=function(H,q,T,b,P,h){H.fillStyle=Sq(H,q,T,b,P,h)},rj=function(t,a,N,z,s,D){t.strokeStyle=Sq(t,a,N,z,s,D)},Sq=function(F,$,u,q,m,O){var y;try{if(!$.tagName&&$.comps){$._cacheImage_||($._cacheImage_={});var s;s="override"===q?"colors_override":"override_rgb"===q?"colors_override_rgb":"override_a"===q?"colors_override_a":"colors",$._cacheImage_[s]||($._cacheImage_[s]={__count__:0});var U=$._cacheImage_[s][u];U||($._cacheImage_[s].__count__>K.imageCacheThreshold&&($._cacheImage_[s]={__count__:0}),U=h.Default.toCanvas($,_r($),wm($),null,m,O,u,null,q),$._cacheImage_[s][u]=U,$._cacheImage_[s].__count__++),$=U}y=F.createPattern($,"repeat")}catch(C){y="black"}return y},qe=function(D){var c,f,M=[],E=0,y=D.length;for(c=0;65>c;c++)M[c]=c;for(c=0;65>c;c++)E=(E+M[c]+D.charCodeAt(c%y))%65,f=M[c],M[c]=M[E],M[E]=f;for(c=0;65>c;c++)M[c]=xs[M[c]];return M.join("")},ng=function(u){for(var J=8+Uj.randomInt(8),Q=xs[8*Uj.randomInt(8)+(J-8)],z="",E=0;J>E;E++)z+=xs[Uj.randomInt(64)];var g=qe(z+M+Kr+Fp);return Q+z+To.encode(u,g)},Di=function(R){var w=R[0],F=xs.indexOf(w);if(0>F)return"";F=8+(7&F);var Q=R.slice(1,1+F),m=qe(Q+M+Kr+Fp);return To.decode(R,m,1+F)},wj=function(t,A,o,S,D,N,q){t.save(),t.translate(A,o),t.scale(1,q/N),t.arc(0,0,N,S,D),t.restore()},Ip=function(f,o,p,H,h,R,N,d){var m,t,u,V,r,n,O,S,G,P,X;if(B(h)>2*D&&(h=2*D),r=i(B(h)/(D/4)),m=h/r,t=-m,u=-H,r>0){n=o+W(H)*R,O=p+l(-H)*N,d?f.lineTo(n,O):f.moveTo(n,O);for(var F=0;r>F;F++)u+=t,V=u-t/2,S=o+W(u)*R,G=p+l(u)*N,P=o+W(V)*(R/W(t/2)),X=p+l(V)*(N/W(t/2)),f.quadraticCurveTo(P,X,S,G)}},ok=function(h,O,V,T,H,b,U,Q,_){6===arguments.length&&(bs(b)?(Q=b[1],_=b[2],U=b[3],b=b[0]):(U=b,Q=b,_=b));var z=O+T,s=V+H,e=H>T?2*T:2*H;return b=e>b?b:e,U=e>U?U:e,Q=e>Q?Q:e,_=e>_?_:e,h.roundRect?(h.roundRect(O,V,T,H,[b,U,_,Q]),void 0):(h.moveTo(O+T/2,V),h.arcTo(z,V,z,s,U),h.arcTo(z,s,O,s,_),h.arcTo(O,s,O,V,Q),h.arcTo(O,V,z,V,b),h.lineTo(O+T/2,V),void 0)},di=function(v,K,D,E,h,_,S){K&&(D=j(D),E=j(E),S||(S=1),v.fillStyle=K,v.beginPath(),v.rect(D,E,S,_),v.rect(D,E,h,S),_-S>0&&v.rect(D,E+_-S,h,S),h-S>0&&v.rect(D+h-S,E,S,_),v.fill())},Pd=function(K,b,n,s){var M=s.x,p=s.y,Q=s.width,f=s.height;if(!(!b||!n||0>=Q||0>=f)){var N,V=sm(b),t=th(b),y=n>0;1===n||-1===n?(K.fillStyle=y?V:t,K.beginPath(),K.rect(M,p,1,f),K.rect(M,p,Q,1),K.fill(),K.fillStyle=y?t:V,K.beginPath(),K.rect(M,p+f-1,Q,1),K.rect(M+Q-1,p,1,f),K.fill()):(n=I(B(n),I(Q/2,f/2)),N=K.createLinearGradient(M,p,M+n,p),N.addColorStop(0,y?V:t),N.addColorStop(1,b),K.fillStyle=N,K.beginPath(),K.moveTo(M,p),K.lineTo(M+n,p+n),K.lineTo(M+n,p+f-n),K.lineTo(M,p+f),K.lineTo(M,p),K.fill(),N=K.createLinearGradient(M,p,M,p+n),N.addColorStop(0,y?V:t),N.addColorStop(1,b),K.fillStyle=N,K.beginPath(),K.moveTo(M,p),K.lineTo(M+n,p+n),K.lineTo(M+Q-n,p+n),K.lineTo(M+Q,p),K.lineTo(M,p),K.fill(),N=K.createLinearGradient(M,p+f,M,p+f-n),N.addColorStop(0,y?t:V),N.addColorStop(1,b),K.fillStyle=N,K.beginPath(),K.moveTo(M,p+f),K.lineTo(M+n,p+f-n),K.lineTo(M+Q-n,p+f-n),K.lineTo(M+Q,p+f),K.lineTo(M,p+f),K.fill(),N=K.createLinearGradient(M+Q,p,M+Q-n,p),N.addColorStop(0,y?t:V),N.addColorStop(1,b),K.fillStyle=N,K.beginPath(),K.moveTo(M+Q,p),K.lineTo(M+Q-n,p+n),K.lineTo(M+Q-n,p+f-n),K.lineTo(M+Q,p+f),K.lineTo(M+Q,p),K.fill())}},Ck=function(Z,P,p,b,y,m,L){var q=Z.createLinearGradient(b,y,m,L);return q.addColorStop(0,p),q.addColorStop(1,P),q},mo=function(x,J,G,L,g,P,f){var k=x.createLinearGradient(L,g,P,f);return k.addColorStop(0,J),k.addColorStop(.5,G),k.addColorStop(1,J),k},ie=function(v,e,O,o,f,u,A){var F=v.createLinearGradient(o,f,u,A);return F.addColorStop(0,e),F.addColorStop(1/3,O),F.addColorStop(2/3,e),F.addColorStop(1,O),F},Il=function(W,o,P,h,L,O,T,d,n){var l=W.createRadialGradient(h+O*d,L+T*n,I(O,T)/24,h+O/2,L+T/2,_(O,T)/2);return l.addColorStop(0,P),l.addColorStop(1,o),l},Ni=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Sj={polygon:function(G,w,P,q,C,L,e,n){(L==E||3>L)&&(L=6),e==E&&(e=0),n==E&&(n=!0);var B,J=I(q,C),R=J/2,f=new Vl(w+q/2,P+C/2),d=new Vl,b=0,N=2*D/L,i=new Vl(R,R);if(n===!1&&i.multiply({x:q/J,y:C/J}),0===e)for(B=0;L>B;B++)d.set(W(b),l(b)).multiply(i).add(f),0===B?G.moveTo(d.x,d.y):G.lineTo(d.x,d.y),b+=N;else{var T=[];for(B=0;2>B;B++)T.push(new Vl(W(b),l(b)).multiply(i).add(f)),b+=N;var X=T.shift(),y=T[0],M=new Vl(W(b),l(b)).multiply(i).add(f),c=X.clone().sub(y),t=M.clone().sub(y),A=c.clone().normalize().dot(t.clone().normalize()),V=Math.sqrt((1-A)/(1+A)),k=e/V;for(c.setLength(k).add(y),G.moveTo(c.x,c.y),B=0;L>B;B++)T.push(new Vl(W(b),l(b)).multiply(i).add(f)),b+=N,X=T.shift(),y=T[0],G.arcTo(X.x,X.y,y.x,y.y,e)}G.closePath()},arc:function(o,N,M,s,b,F,S,P,C){F==E&&(F=D),S==E&&(S=a),P==E&&(P=!0);var y=N+s/2,i=M+b/2;P&&o.moveTo(y,i),C?wj(o,y,i,F,S,s/2,b/2):o.arc(y,i,I(s,b)/2,F,S),P&&o.closePath()},rect:function(k,M,K,b,R){k.rect(M,K,b,R)},circle:function(Y,N,l,D,E){Y.arc(N+D/2,l+E/2,I(D,E)/2,0,a,!0)},oval:function(_,M,V,m,K){wj(_,M+m/2,V+K/2,0,a,m/2,K/2)},roundRect:function(B,k,d,f,H,G){G==E&&(G=I(I(f,H)/4,8)),ok(B,k,d,f,H,G),B.closePath()},star:function(w,x,b,H,k){var m=2*H,K=2*k,p=x+H/2,Y=b+k/2;w.moveTo(p-m/4,Y-K/12),w.lineTo(x+.306*H,b+.579*k),w.lineTo(p-m/6,Y+K/4),w.lineTo(x+H/2,b+.733*k),w.lineTo(p+m/6,Y+K/4),w.lineTo(x+.693*H,b+.579*k),w.lineTo(p+m/4,Y-K/12),w.lineTo(x+.611*H,b+.332*k),w.lineTo(p+0,Y-K/4),w.lineTo(x+.388*H,b+.332*k),w.closePath()},pentagram:function(q,M,b,z,O){var T=.5*O,y=M+.5*z,X=b+T,a=.5257311121191336*z;a>T&&(a=T);var Z=Ni,f=0;for(q.moveTo(y+a*Z[f++],X+a*Z[f++]);20>f;)q.lineTo(y+a*Z[f++],X+a*Z[f++]);q.closePath()},triangle:function(n,o,i,w,u){n.moveTo(o+w/2,i),n.lineTo(o+w,i+u),n.lineTo(o,i+u),n.closePath()},hexagon:function(p,q,B,T,E){p.moveTo(q,B+E/2),p.lineTo(q+T/4,B+E),p.lineTo(q+3*T/4,+B+E),p.lineTo(q+T,B+E/2),p.lineTo(q+3*T/4,B),p.lineTo(q+T/4,B),p.closePath()},pentagon:function(c,x,f,O,P){var X=2*O,D=2*P,w=x+O/2,h=f+P/2;c.moveTo(w-X/4,h-D/12),c.lineTo(w-X/6,h+D/4),c.lineTo(w+X/6,h+D/4),c.lineTo(w+X/4,h-D/12),c.lineTo(w+0,h-D/4),c.closePath()},diamond:function(N,L,C,g,O){N.moveTo(L+g/2,C),N.lineTo(L,C+O/2),N.lineTo(L+g/2,C+O),N.lineTo(L+g,C+O/2),N.closePath()},rightTriangle:function(A,P,b,C,O){A.moveTo(P,b),A.lineTo(P+C,b+O),A.lineTo(P,b+O),A.closePath()},parallelogram:function(e,G,T,c,r){var N=c/4;e.moveTo(G+N,T),e.lineTo(G+c,T),e.lineTo(G+c-N,T+r),e.lineTo(G,T+r),e.closePath()},trapezoid:function(b,P,Z,k,Q){var w=k/4;b.moveTo(P+w,Z),b.lineTo(P+k-w,Z),b.lineTo(P+k,Z+Q),b.lineTo(P,Z+Q),b.closePath()},"linear.southwest":function(R,O,a,q,L,j,x){return Ck(R,O,a,q,L+x,q+j,L)},"linear.southeast":function(J,V,W,c,E,Y,T){return Ck(J,V,W,c+Y,E+T,c,E)},"linear.northwest":function(w,G,j,z,A,U,N){return Ck(w,G,j,z,A,z+U,A+N)},"linear.northeast":function(S,g,V,Y,$,u,x){return Ck(S,g,V,Y+u,$,Y,$+x)},"linear.north":function(Z,W,X,Y,G,s,O){return Ck(Z,W,X,Y,G,Y,G+O)},"linear.south":function(z,d,v,l,q,j,w){return Ck(z,d,v,l,q+w,l,q)},"linear.west":function(N,F,X,n,k,R){return Ck(N,F,X,n,k,n+R,k)},"linear.east":function(y,x,k,F,t,Y){return Ck(y,x,k,F+Y,t,F,t)},"radial.center":function(E,G,L,f,I,N,O){return Il(E,G,L,f,I,N,O,.5,.5)},"radial.southwest":function(M,x,e,L,n,S,b){return Il(M,x,e,L,n,S,b,.25,.75)},"radial.southeast":function(L,l,g,z,Z,r,D){return Il(L,l,g,z,Z,r,D,.75,.75)},"radial.northwest":function(m,$,W,v,t,o,B){return Il(m,$,W,v,t,o,B,.25,.25)},"radial.northeast":function(v,w,l,Z,k,q,n){return Il(v,w,l,Z,k,q,n,.75,.25)},"radial.north":function(_,k,D,g,u,S,F){return Il(_,k,D,g,u,S,F,.5,.25)},"radial.south":function(Q,C,Z,T,d,q,a){return Il(Q,C,Z,T,d,q,a,.5,.75)},"radial.west":function(z,o,H,X,G,g,u){return Il(z,o,H,X,G,g,u,.25,.5)},"radial.east":function(W,g,k,y,e,N,r){return Il(W,g,k,y,e,N,r,.75,.5)},"spread.horizontal":function(E,B,l,k,S,T){return mo(E,B,l,k,S,k+T,S)},"spread.vertical":function(x,E,O,D,s,l,K){return mo(x,E,O,D,s,D,s+K)},"spread.diagonal":function(X,V,_,B,P,w,i){return mo(X,V,_,B+w,P,B,P+i)},"spread.antidiagonal":function(Y,h,q,b,U,u,W){return mo(Y,h,q,b,U,b+u,U+W)},"spread.north":function(q,W,v,U,k,L,B){return ie(q,W,v,U,k-B/4,U,k+B+B/4)},"spread.south":function(X,p,V,W,E,x,T){return ie(X,V,p,W,E-T/4,W,E+T+T/4)},"spread.west":function(m,F,i,G,e,C){return ie(m,F,i,G-C/4,e,G+C+C/4,e)},"spread.east":function(Y,z,g,M,F,Q){return ie(Y,g,z,M-Q/4,F,M+Q+Q/4,F)}},ic=function(T,E,P){return new Jh(T).tf(E,P)},ro=function(F){var R=F.touches[0],L=F.touches[1],n=R.clientX,b=R.clientY,h=L.clientX,f=L.clientY;return A((n-h)*(n-h)+(b-f)*(b-f))},Xq=function(K){var D=K.touches[0],k=K.touches[1],T=D.clientX,L=D.clientY,J=k.clientX,G=k.clientY;return{x:(T+J)/2,y:(L+G)/2}},Rm=(function(){for(var X=0,w=Pi.split(""),o=0;o<w.length;o++)X=10*sr(w[o])+X;return pr(Q[ls.toString(8*o)+em.substr(o)+3],Q[ls.toString(8*o)+em.substr(o)+4]),X}(),function(T,P,$){for(var E=0;E<$.size();E++){var N=$.get(E);T.co(N)&&P.add(N)}for(E=0;E<$.size();E++)N=$.get(E),Rm(T,P,N._children)}),lm=function(G,M,i){for(var V=0;V<i.size();V++){var D=i.get(i.size()-1-V);G.co(D)&&M.add(D)}for(V=0;V<i.size();V++)D=i.get(V),lm(G,M,D._children)},om=function(u,z,A){for(var M=!1,w=0;w<A.size();w++){var C=A.get(w);u.co(C)?M&&z.add(C):M=1}for(w=0;w<A.size();w++)C=A.get(w),om(u,z,C._children)},go=function(v,_,V){for(var Y=!1,e=0;e<V.size();e++){var W=V.get(V.size()-1-e);v.co(W)?Y&&_.add(W):Y=!0}for(e=0;e<V.size();e++)W=V.get(e),go(v,_,W._children)},kl=K.moveDatas=function(G,U,p,q){var e=q==E;if(0!==U||0!==p||!e&&0!==q){var Z=!0,g=[];if(G.forEach(function(J){Z&&(J._69O||Kp(J)||Rp(J))&&(Z=!1)}),Z)g=G;else{var d={},N={};G.forEach(function(S){d[S._id]=!0});var _={},f=function(V){var t=V._id;return d[t]?(g.push(V),_[t]=!0):_[t]=!1},B=function(W){var x=W._id;if(N[x])return f(W);var i=_[x];if(i!==P)return i;var m=W._parent;if(m&&(Rp(m)||Kp(m))&&B(m))return _[x]=!0;var u=W._host;return u&&(N[x]=x,i=B(u),N[x]=P,i)?_[x]=!0:f(W)};G.forEach(function(E){B(E)})}g.forEach(function(W){if(bk(W))e?W.translate(U,p):W.translate3d(U,p,q);else{var a=W.s(rs);if(!a||a.isEmpty())return;var I=new oc;a.each(function(O){O=fo(O),e?(O.x+=U,O.y+=p):(O.x+=U,O.y+=q,O.e==E?O.e=p:O.e+=p),I.add(O)}),W.s(rs,I)}})}},Ij=function(){function I(o,z){return z===o.substring(0,z.length)?!0:!1}function A(F){return parseFloat(F)||0}function B(N,r){if(r==P&&(r=new jo),I(N,"matrix3d")){var D=N.substring(9,N.length-1).split(",");D=D.map(A),r.fromArray(D)}else if(I(N,"matrix")){var D=N.substring(7,N.length-1).split(",");D=D.map(A),r.el[0]=D[0],r.el[1]=D[1],r.el[2]=0,r.el[3]=0,r.el[4]=D[2],r.el[5]=D[3],r.el[6]=0,r.el[7]=0,r.el[8]=0,r.el[9]=0,r.el[10]=1,r.el[11]=0,r.el[12]=D[4],r.el[13]=D[5],r.el[14]=0,r.el[15]=1}return r}function G(r,J){J==P&&(J=new Ab);var T=r.split(/\s+/);return T=T.map(A),J.set(T[0]||0,T[1]||0,T[2]||0),J}var s,Q,o,n,h,V=function(E,K){s||(s=new jo,Q=new Ab,o=new jo,n=new jo,h=new jo),K==P&&(K=new jo);var Y=getComputedStyle(E);Y.transform&&"none"!==Y.transform&&(B(Y.transform,s),G(Y.transformOrigin,Q),n.setPosition(Q),Q.negate(),h.setPosition(Q),(Wm||"preserve-3d"!==Y.transformStyle)&&(s.el[8]=0,s.el[9]=0,s.el[10]=1,s.el[11]=0),K.multiplyMatrices(h,K),K.multiplyMatrices(s,K),K.multiplyMatrices(n,K)),!Wm&&Y.perspective&&"none"!==Y.perspective&&(o.el[11]=-1/A(Y.perspective),G(Y.perspectiveOrigin,Q),n.setPosition(Q),Q.negate(),h.setPosition(Q),K.multiplyMatrices(h,K),K.multiplyMatrices(o,K),K.multiplyMatrices(n,K));for(var L=E.offsetParent,y=E.offsetLeft,R=E.offsetTop,l=E.parentElement;l&&l!==L;){var I=getComputedStyle(l);if("none"!==I.transform||"none"!==I.perspective)break;l=l.parentElement}return l==P&&E!==E.ownerDocument.documentElement&&"fixed"!==Y.position&&(l=E.ownerDocument.documentElement),L!=P&&L!=l&&(y-=l.offsetLeft,R-=l.offsetTop),l&&(y-=l.scrollLeft,R-=l.scrollTop),Q.set(y,R,0),n.setPosition(Q),K.multiplyMatrices(n,K),l&&V(l,K),K};return function(X,R){var k=X.parentElement;if(k){var I=k.updateAppendMatrix;if(I){delete k.updateAppendMatrix;var z=new jo;V(k,z);var U=new jo;U.getInverse(z),k._matrixAppend=U,k._maxrixPreAppend=z}return R?k._matrixAppend:k._maxrixPreAppend}}}(),Xr=function(S,W){for(;S&&!S.hasOwnProperty(W);)S=O.getPrototypeOf(S);return S&&O.getOwnPropertyDescriptor(S,W)},Jj=O.getPrototypeOf?function(S,M,E){var X=Xr(M,E);X&&O.defineProperty(S,E,X)}:function(Z,v,P){Z[P]=v[P]},so={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},Ac=function(){var Y={1:function(P,O){return{x:P.x-O.width/2,y:P.y-O.height/2}},2:function(g,o){return{x:g.x+o.width/2,y:g.y-o.height/2}},3:function(w,D){return{x:w.x+w.width/2,y:w.y-D.height/2}},4:function(t,X){return{x:t.x+t.width-X.width/2,y:t.y-X.height/2}},5:function(l,o){return{x:l.x+l.width+o.width/2,y:l.y-o.height/2}},6:function(R){return{x:R.x,y:R.y}},7:function(g){return{x:g.x+g.width/2,y:g.y}},8:function(X){return{x:X.x+X.width,y:X.y}},9:function(D,u){return{x:D.x-u.width/2,y:D.y+u.height/2}},10:function(X,d){return{x:X.x+d.width/2,y:X.y+d.height/2}},11:function(j,p){return{x:j.x+j.width/2,y:j.y+p.height/2}},12:function(Q,y){return{x:Q.x-y.width/2+Q.width,y:Q.y+y.height/2}},13:function(G,q){return{x:G.x+G.width+q.width/2,y:G.y+q.height/2}},14:function(z,H){return{x:z.x-H.width/2,y:z.y+z.height/2}},15:function(s){return{x:s.x,y:s.y+s.height/2}},16:function(Y,f){return{x:Y.x+f.width/2,y:Y.y+Y.height/2}},17:function(d){return{x:d.x+d.width/2,y:d.y+d.height/2}},18:function(G,_){return{x:G.x+G.width-_.width/2,y:G.y+G.height/2}},19:function(d){return{x:d.x+d.width,y:d.y+d.height/2}},20:function(g,E){return{x:g.x+g.width+E.width/2,y:g.y+g.height/2}},21:function(Q,V){return{x:Q.x-V.width/2,y:Q.y+Q.height-V.height/2}},22:function(E,z){return{x:E.x+z.width/2,y:E.y+E.height-z.height/2}},23:function(T,x){return{x:T.x+T.width/2,y:T.y+T.height-x.height/2}},24:function(s,H){return{x:s.x+s.width-H.width/2,y:s.y+s.height-H.height/2}},25:function(y,h){return{x:y.x+y.width+h.width/2,y:y.y+y.height-h.height/2}},26:function(Y){return{x:Y.x,y:Y.y+Y.height}},27:function(T){return{x:T.x+T.width/2,y:T.y+T.height}},28:function($){return{x:$.x+$.width,y:$.y+$.height}},29:function(F,x){return{x:F.x-x.width/2,y:F.y+F.height+x.height/2}},30:function(X,e){return{x:X.x+e.width/2,y:X.y+X.height+e.height/2}},31:function(i,S){return{x:i.x+i.width/2,y:i.y+i.height+S.height/2}},32:function(v,k){return{x:v.x+v.width-k.width/2,y:v.y+v.height+k.height/2}},33:function(q,p){return{x:q.x+q.width+p.width/2,y:q.y+q.height+p.height/2}},34:function(J,G){return{x:J.x,y:J.y-G.height/2}},35:function(l,e){return{x:l.x+l.width,y:l.y-e.height/2}},36:function(B,x){return{x:B.x,y:B.y+B.height+x.height/2}},37:function(f,F){return{x:f.x+f.width,y:f.y+f.height+F.height/2}},38:function(K,s){return{x:K.x+K.width/4,y:K.y-s.height/2}},39:function(a,T){return{x:a.x+3*a.width/4,y:a.y-T.height/2}},40:function(z){return{x:z.x+z.width/4,y:z.y}},41:function(V){return{x:V.x+3*V.width/4,y:V.y}},42:function(j,X){return{x:j.x+j.width/4,y:j.y+X.height/2}},43:function(w,F){return{x:w.x+3*w.width/4,y:w.y+F.height/2}},44:function($,z){return{x:$.x+$.width/2,y:$.y+$.height/2-z.height/2}},45:function(b){return{x:b.x+b.width/4,y:b.y+b.height/2}},46:function(b,_){return{x:b.x+b.width/2-_.width/2,y:b.y+b.height/2}},47:function(Q,A){return{x:Q.x+Q.width/2+A.width/2,y:Q.y+Q.height/2}},48:function(T){return{x:T.x+3*T.width/4,y:T.y+T.height/2}},49:function(Y,F){return{x:Y.x+Y.width/2,y:Y.y+Y.height/2+F.height/2}},50:function(F,w){return{x:F.x+F.width/4,y:F.y+F.height-w.height/2}},51:function(Q,W){return{x:Q.x+3*Q.width/4,y:Q.y+Q.height-W.height/2}},52:function(K){return{x:K.x+K.width/4,y:K.y+K.height}},53:function(R){return{x:R.x+3*R.width/4,y:R.y+R.height}},54:function(r,Z){return{x:r.x+r.width/4,y:r.y+r.height+Z.height/2}},55:function(K,Z){return{x:K.x+3*K.width/4,y:K.y+K.height+Z.height/2}}};return tq(Q)?function(V,f,K){return Y[V](f,K?K:Cm)}:void 0}();Sn(T,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#FFF",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var pd=T.reverse,ml=T.transparent,nm=T.rectSelectBackground,Ur=T.dash,Lg=T.titleBackground,Rc=T.titleIconBackground,Po=T.headerBackground,vr=T.headerIconBackground,nq=T.headerSeparator,tl=T.headerLine,en=T.contentIconBackground,oi=T.contentLine,ne=(T.widgetIconHighlight,T.widgetIconBorder),hk=(T.widgetIconGradient,T.imageBackground),ec=T.imageGradient,Yc=T.highlight,dg=T.label,Gk=T.labelSelect;if(Ed&&!Q.shutAlert1){var Fb=new Date,Uf=Ed.split("-"),lb=new Date(Fb.getFullYear(),Fb.getMonth(),Fb.getDate()),Ed=new Date(sr(Uf[0],10),sr(Uf[1],10)-1,sr(Uf[2],10)),Al=lb.getTime(),Tr=Ed.getTime(),Cg=M+"_try",yf=Q.alert;try{var Qj=Q.localStorage;if(Qj&&yf)if(Tr>Al&&1728e6>Tr-Al){var ul=(Tr-Al)/864e5;Qj&&Qj[Cg]!=ul&&(Qj[Cg]=ul,Q.htWillExpire?yf(Q.htWillExpire.replace("{{day}}",ul)):yf("HT for Web free trial license will expire in "+ul+" days, please apply for a new license!"))}else Al>=Tr&&(Q.htExpired?yf(Q.htExpired):yf("Your free trial of HT for Web has expired!")),Qj&&delete Qj[Cg]}catch(zo){}}Math.sign===P&&(Math.sign=function(g){return 0>g?-1:g>0?1:+g});var xs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",To={encode:function(E,z){var b,a,T,n,Q,w,M,V="",N=0;for(E=unescape(encodeURIComponent(E));N<E.length;)b=E.charCodeAt(N++),a=E.charCodeAt(N++),T=E.charCodeAt(N++),n=b>>2,Q=(3&b)<<4|a>>4,w=(15&a)<<2|T>>6,M=63&T,isNaN(a)?w=M=64:isNaN(T)&&(M=64),V=V+z.charAt(n)+z.charAt(Q)+z.charAt(w)+z.charAt(M);return V},decode:function(W,B,p){for(var Y,g,H,F,Q,k,$,V="",h=p||0;h<W.length;)F=B.indexOf(W.charAt(h++)),Q=B.indexOf(W.charAt(h++)),k=B.indexOf(W.charAt(h++)),$=B.indexOf(W.charAt(h++)),Y=F<<2|Q>>4,g=(15&Q)<<4|k>>2,H=(3&k)<<6|$,V+=String.fromCharCode(Y),64!=k&&(V+=String.fromCharCode(g)),64!=$&&(V+=String.fromCharCode(H));return V=decodeURIComponent(escape(V))},_utf8_encode:function(S){S=S.replace(/\r\n/g,"\n");for(var v="",y=0;y<S.length;y++){var f=S.charCodeAt(y);128>f?v+=String.fromCharCode(f):f>127&&2048>f?(v+=String.fromCharCode(192|f>>6),v+=String.fromCharCode(128|63&f)):(v+=String.fromCharCode(224|f>>12),v+=String.fromCharCode(128|63&f>>6),v+=String.fromCharCode(128|63&f))}return v},_utf8_decode:function(x){for(var S="",o=0,y=0,k=0,J=0;o<x.length;)y=x.charCodeAt(o),128>y?(S+=String.fromCharCode(y),o++):y>191&&224>y?(k=x.charCodeAt(o+1),S+=String.fromCharCode((31&y)<<6|63&k),o+=2):(k=x.charCodeAt(o+1),J=x.charCodeAt(o+2),S+=String.fromCharCode((15&y)<<12|(63&k)<<6|63&J),o+=3);return S}},ep=[],Cj=[],Uj=h.Math={generateUUID:function(){for(var M=[],Z=0;256>Z;Z++)M[Z]=(16>Z?"0":"")+Z.toString(16).toUpperCase();return function(){var S=0|4294967295*Math.random(),z=0|4294967295*Math.random(),E=0|4294967295*Math.random(),v=0|4294967295*Math.random();return M[255&S]+M[255&S>>8]+M[255&S>>16]+M[255&S>>24]+"-"+M[255&z]+M[255&z>>8]+"-"+M[64|15&z>>16]+M[255&z>>24]+"-"+M[128|63&E]+M[255&E>>8]+"-"+M[255&E>>16]+M[255&E>>24]+M[255&v]+M[255&v>>8]+M[255&v>>16]+M[255&v>>24]}}(),clamp:function(R,N,o){return Math.max(N,Math.min(o,R))},fequal:function(O,j,B){return null==B&&(B=1e-8),Math.abs(O-j)<B},generateIncreasingID:function(){var h=0;return function(){return++h}}(),encodeBase64:function(C,Z){return To.encode(C,Z||xs)},decodeBase64:function(u,d){return To.decode(u,d||xs)},randomArray:function(B,U){U=U||B.length;for(var l=U-1;l>0;l--){var c=Math.floor(Math.random()*(l+1)),e=B[l];B[l]=B[c],B[c]=e}return B},randomInt:function(Q,s){return s===P&&(s=Q,Q=0),Q+Math.floor(Math.random()*(s-Q))},randomFloat:function(R,X){return X===P&&(X=R,R=0),R+Math.random()*(X-R)},isPOT:function(m){return m>0&&0===(m-1&m)},nearestPOT:function(j){if(!j)return 1;var e=j;e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++;var l=e>>1;return j-l>e-j?e:l},requestMatrix4:function(){return ep.length>0?ep.pop():new Uj.Matrix4},releaseMatrix4:function(c){ep.push(c)},requestVector3:function(){return Cj.length>0?Cj.pop():new Uj.Vector3},releaseVector3:function(N){Cj.push(N)}},Or=h.Matrix=h.Math.Matrix2d=function(b,E,D,m,c){this.setFromTransform(b,E,D,m,c)},Jh=Or;Or.prototype={},Or.prototype.constructor=Or,Or.prototype.set=function(c,q,o,L,J,E){return this.a=c,this.b=q,this.c=o,this.d=L,this.tx=J,this.ty=E,this},Or.prototype.setFromTransform=function(M,q,e,I,D){var d=this;if(M===P)return d.a=1,d.b=0,d.c=0,d.d=1,d.tx=0,d.ty=0,void 0;var w,g;return M?(w=l(M),g=W(M)):(w=0,g=1),I=I||1,D=D||1,d.a=g*I,d.b=w*I,d.c=-w*D,d.d=g*D,d.tx=q||0,d.ty=e||0,d},Or.prototype.apply=function(c,o){o=o||new Vl;var z=c.x,j=c.y;return o.x=this.a*z+this.c*j+this.tx,o.y=this.b*z+this.d*j+this.ty,o},Or.prototype.applyInverse=function(Q,V){V=V||new Vl;var E=1/(this.a*this.d+this.c*-this.b),l=Q.x,A=Q.y;return V.x=this.d*E*l+-this.c*E*A+(this.ty*this.c-this.tx*this.d)*E,V.y=this.a*E*A+-this.b*E*l+(-this.ty*this.a+this.tx*this.b)*E,V},Or.prototype.translate=function(p,C){return this.tx+=p,this.ty+=C,this},Or.prototype.scale=function(B,s){return this.a*=B,this.d*=s,this.c*=B,this.b*=s,this.tx*=B,this.ty*=s,this},Or.prototype.rotate=function(d){var g=Math.cos(d),H=Math.sin(d),F=this.a,v=this.c,t=this.tx;return this.a=F*g-this.b*H,this.b=F*H+this.b*g,this.c=v*g-this.d*H,this.d=v*H+this.d*g,this.tx=t*g-this.ty*H,this.ty=t*H+this.ty*g,this},Or.prototype.appendTranslate=function(J,p){return this.tx+=this.a*J+this.c*p,this.ty+=this.b*J+this.d*p,this},Or.prototype.appendScale=function(z,i){return this.a*=z,this.d*=i,this.c*=i,this.b*=z,this},Or.prototype.appendRotate=function(X){if(!X)return this;var d=Math.cos(X),w=Math.sin(X),b=this.a,J=this.b;return this.a=b*d+this.c*w,this.b=J*d+this.d*w,this.c=-b*w+this.c*d,this.d=-J*w+this.d*d,this},Or.prototype.append=function(c){var o=this.a,h=this.b,V=this.c,P=this.d;return this.a=c.a*o+c.b*V,this.b=c.a*h+c.b*P,this.c=c.c*o+c.d*V,this.d=c.c*h+c.d*P,this.tx=c.tx*o+c.ty*V+this.tx,this.ty=c.tx*h+c.ty*P+this.ty,this},Or.prototype.setTransform=function(X,x,L,H,h,S,D,j,s){var O,u,n,f,P,k,$,T,Q,A;return P=Math.sin(D),k=Math.cos(D),$=Math.cos(s),T=Math.sin(s),Q=-Math.sin(j),A=Math.cos(j),O=k*h,u=P*h,n=-P*S,f=k*S,this.a=$*O+T*n,this.b=$*u+T*f,this.c=Q*O+A*n,this.d=Q*u+A*f,this.tx=X+(L*O+H*n),this.ty=x+(L*u+H*f),this},Or.prototype.prepend=function(m){var S=this.tx;if(1!==m.a||0!==m.b||0!==m.c||1!==m.d){var G=this.a,z=this.c;this.a=G*m.a+this.b*m.c,this.b=G*m.b+this.b*m.d,this.c=z*m.a+this.d*m.c,this.d=z*m.b+this.d*m.d}return this.tx=S*m.a+this.ty*m.c+m.tx,this.ty=S*m.b+this.ty*m.d+m.ty,this},Or.prototype.transform=Or.prototype.prepend,Or.prototype.invert=function(){var W=this.a,_=this.b,J=this.c,N=this.d,u=this.tx,l=W*N-_*J;return this.a=N/l,this.b=-_/l,this.c=-J/l,this.d=W/l,this.tx=(J*this.ty-N*u)/l,this.ty=-(W*this.ty-_*u)/l,this},Or.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Or.prototype.clone=function(){var H=new Or;return H.a=this.a,H.b=this.b,H.c=this.c,H.d=this.d,H.tx=this.tx,H.ty=this.ty,H},Or.prototype.copy=function(w){return w.a=this.a,w.b=this.b,w.c=this.c,w.d=this.d,w.tx=this.tx,w.ty=this.ty,w},Or.prototype.tf=function(A,m){1===arguments.length&&(m=A.y,A=A.x);var V=this;return{x:V.a*A+V.c*m+V.tx,y:V.b*A+V.d*m+V.ty}},Or.prototype.toArray=function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},Or.prototype.fromArray=function(e){return this.a=e[0],this.b=e[1],this.c=e[2],this.d=e[3],this.tx=e[4],this.ty=e[5],this},Or.prototype.toArray9=function(){return[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1]},Or.prototype.tfi=function(M,U){1===arguments.length&&(U=M.y,M=M.x);var v=this,$=1/(v.a*v.d+v.c*-v.b);return{x:v.d*$*M+-v.c*$*U+(v.ty*v.c-v.tx*v.d)*$,y:v.a*$*U+-v.b*$*M+(-v.ty*v.a+v.tx*v.b)*$}},Or.prototype.decompose=function(){var V=this,Y=V.a,X=V.b,H=V.c,x=V.d,O=Math.sqrt(Y*Y+X*X),$=Math.sqrt(H*H+x*x),W=Y*x-X*H;return 0>W&&(x>Y?O=-O:$=-$),O&&(Y*=1/O,X*=1/O),$&&(H*=1/$,x*=1/$),{translateX:V.tx,translateY:V.ty,rotation:Math.atan2(X,Y),scaleX:O,scaleY:$}},Or.IDENTITY=new Or,Or.TEMP_MATRIX=new Or;var _d=h.Math.Quaternion=function(g,x,Q,c){this.set(g,x,Q,c)};O.assign(_d.prototype,{set:function(V,s,n,E){var G=this;return G._x=V||0,G._y=s||0,G._z=n||0,G._w=E!==P?E:1,G},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(S){var z=this;return z._x=S._x,z._y=S._y,z._z=S._z,z._w=S._w,z},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(V){return this._x*V._x+this._y*V._y+this._z*V._z+this._w*V._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var h=this.length();return 0===h?(this._x=0,this._y=0,this._z=0,this._w=1):(h=1/h,this._x=this._x*h,this._y=this._y*h,this._z=this._z*h,this._w=this._w*h),this},fromArray:function(c,J){J===P&&(J=0);var f=this;return f._x=c[J],f._y=c[J+1],f._z=c[J+2],f._w=c[J+3],this},slerp:function(o,A){if(0===A)return this;if(1===A)return this.copy(o);var a=this._x,L=this._y,U=this._z,r=this._w,j=r*o._w+a*o._x+L*o._y+U*o._z;if(0>j?(this._w=-o._w,this._x=-o._x,this._y=-o._y,this._z=-o._z,j=-j):this.copy(o),j>=1)return this._w=r,this._x=a,this._y=L,this._z=U,this;var w=Math.sqrt(1-j*j);if(Math.abs(w)<.001)return this._w=.5*(r+this._w),this._x=.5*(a+this._x),this._y=.5*(L+this._y),this._z=.5*(U+this._z),this;var F=Math.atan2(w,j),Z=Math.sin((1-A)*F)/w,q=Math.sin(A*F)/w;return this._w=r*Z+this._w*q,this._x=a*Z+this._x*q,this._y=L*Z+this._y*q,this._z=U*Z+this._z*q,this},setFromAxisAngle:function(Y,B){var i=B/2,U=Math.sin(i);return this._x=Y.x*U,this._y=Y.y*U,this._z=Y.z*U,this._w=Math.cos(i),this},setFromEuler:function(O){var l=O._x,Z=O._y,x=O._z,i=O._order,B=Math.cos,t=Math.sin,a=B(l/2),H=B(Z/2),V=B(x/2),j=t(l/2),M=t(Z/2),s=t(x/2);return"XYZ"===i?(this._x=j*H*V+a*M*s,this._y=a*M*V-j*H*s,this._z=a*H*s+j*M*V,this._w=a*H*V-j*M*s):"YXZ"===i?(this._x=j*H*V+a*M*s,this._y=a*M*V-j*H*s,this._z=a*H*s-j*M*V,this._w=a*H*V+j*M*s):"ZXY"===i?(this._x=j*H*V-a*M*s,this._y=a*M*V+j*H*s,this._z=a*H*s+j*M*V,this._w=a*H*V-j*M*s):"ZYX"===i?(this._x=j*H*V-a*M*s,this._y=a*M*V+j*H*s,this._z=a*H*s-j*M*V,this._w=a*H*V+j*M*s):"YZX"===i?(this._x=j*H*V+a*M*s,this._y=a*M*V+j*H*s,this._z=a*H*s-j*M*V,this._w=a*H*V-j*M*s):"XZY"===i&&(this._x=j*H*V-a*M*s,this._y=a*M*V-j*H*s,this._z=a*H*s+j*M*V,this._w=a*H*V+j*M*s),this},setFromRotationMatrix:function(E){var H,T=E.el,r=T[0],w=T[4],Q=T[8],J=T[1],Y=T[5],m=T[9],u=T[2],x=T[6],S=T[10],q=r+Y+S;return q>0?(H=.5/Math.sqrt(q+1),this._w=.25/H,this._x=(x-m)*H,this._y=(Q-u)*H,this._z=(J-w)*H):r>Y&&r>S?(H=2*Math.sqrt(1+r-Y-S),this._w=(x-m)/H,this._x=.25*H,this._y=(w+J)/H,this._z=(Q+u)/H):Y>S?(H=2*Math.sqrt(1+Y-r-S),this._w=(Q-u)/H,this._x=(w+J)/H,this._y=.25*H,this._z=(m+x)/H):(H=2*Math.sqrt(1+S-r-Y),this._w=(J-w)/H,this._x=(Q+u)/H,this._y=(m+x)/H,this._z=.25*H),this},setFromToVectors:function(){var g,y;return function(T,L){return g===P&&(g=new Ab),y=T.dot(L)+1,1e-7>y?(y=0,Math.abs(T.x)>Math.abs(T.z)?g.set(-T.y,T.x,0):g.set(0,-T.z,T.y)):g.crossVectors(T,L),this._x=g.x,this._y=g.y,this._z=g.z,this._w=y,this.normalize()}}(),setFromUnitVectors:function(){var h,c,v=1e-6;return function(g,m){return h===P&&(h=new Ab),c=g.dot(m)+1,v>c?(c=0,Math.abs(g.x)>Math.abs(g.z)?h.set(-g.y,g.x,0):h.set(0,-g.z,g.y)):h.crossVectors(g,m),this._x=h.x,this._y=h.y,this._z=h.z,this._w=c,this.normalize()}}(),multiply:function(z){return this.multiplyQuaternions(this,z)},premultiply:function(x){return this.multiplyQuaternions(x,this)},multiplyQuaternions:function(F,J){var $=F._x,x=F._y,k=F._z,E=F._w,W=J._x,S=J._y,y=J._z,P=J._w;return this._x=$*P+E*W+x*y-k*S,this._y=x*P+E*S+k*W-$*y,this._z=k*P+E*y+$*S-x*W,this._w=E*P-$*W-x*S-k*y,this},toArray:function(n,o){return n||(n=[]),o=o||0,n[o]=this._x,n[o+1]=this._y,n[o+2]=this._z,n[o+3]=this._w,n}});var _m=h.Math.Vector4=function(O,g,n,$){this.x=O||0,this.y=g||0,this.z=n||0,this.w=$!==P?$:1};O.assign(_m.prototype,{isVector4:!0,set:function(v,b,M,i){return this.x=v,this.y=b,this.z=M,this.w=i,this},setScalar:function(s){return this.x=s,this.y=s,this.z=s,this.w=s,this},setX:function(I){return this.x=I,this},setY:function(J){return this.y=J,this},setZ:function(d){return this.z=d,this},setW:function(T){return this.w=T,this},setComponent:function(X,h){switch(X){case 0:this.x=h;break;case 1:this.y=h;break;case 2:this.z=h;break;case 3:this.w=h;break;default:throw new Error("index is out of range: "+X)}return this},getComponent:function(_){switch(_){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+_)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(b){return this.x=b.x,this.y=b.y,this.z=b.z,this.w=b.w!==P?b.w:1,this},add:function(J,m){return m!==P?this.addVectors(J,m):(this.x+=J.x,this.y+=J.y,this.z+=J.z,this.w+=J.w,this)},addScalar:function(Z){return this.x+=Z,this.y+=Z,this.z+=Z,this.w+=Z,this},addVectors:function(X,a){return this.x=X.x+a.x,this.y=X.y+a.y,this.z=X.z+a.z,this.w=X.w+a.w,this},addScaledVector:function(k,j){return this.x+=k.x*j,this.y+=k.y*j,this.z+=k.z*j,this.w+=k.w*j,this},sub:function($,d){return d!==P?this.subVectors($,d):(this.x-=$.x,this.y-=$.y,this.z-=$.z,this.w-=$.w,this)},subScalar:function(H){return this.x-=H,this.y-=H,this.z-=H,this.w-=H,this},subVectors:function(x,V){return this.x=x.x-V.x,this.y=x.y-V.y,this.z=x.z-V.z,this.w=x.w-V.w,this},multiplyScalar:function(c){return this.x*=c,this.y*=c,this.z*=c,this.w*=c,this},applyMatrix4:function(T){var J=this.x,y=this.y,m=this.z,b=this.w,E=T.el;
return this.x=E[0]*J+E[4]*y+E[8]*m+E[12]*b,this.y=E[1]*J+E[5]*y+E[9]*m+E[13]*b,this.z=E[2]*J+E[6]*y+E[10]*m+E[14]*b,this.w=E[3]*J+E[7]*y+E[11]*m+E[15]*b,this},divideScalar:function(K){return this.multiplyScalar(1/K)},setAxisAngleFromQuaternion:function(f){this.w=2*Math.acos(f.w);var l=Math.sqrt(1-f.w*f.w);return 1e-4>l?(this.x=1,this.y=0,this.z=0):(this.x=f.x/l,this.y=f.y/l,this.z=f.z/l),this},setAxisAngleFromRotationMatrix:function(Y){var q,B,W,c,u=.01,L=.1,G=Y.el,s=G[0],w=G[4],i=G[8],K=G[1],Q=G[5],S=G[9],h=G[2],r=G[6],O=G[10];if(Math.abs(w-K)<u&&Math.abs(i-h)<u&&Math.abs(S-r)<u){if(Math.abs(w+K)<L&&Math.abs(i+h)<L&&Math.abs(S+r)<L&&Math.abs(s+Q+O-3)<L)return this.set(1,0,0,0),this;q=Math.PI;var z=(s+1)/2,l=(Q+1)/2,t=(O+1)/2,M=(w+K)/4,v=(i+h)/4,a=(S+r)/4;return z>l&&z>t?u>z?(B=0,W=.707106781,c=.707106781):(B=Math.sqrt(z),W=M/B,c=v/B):l>t?u>l?(B=.707106781,W=0,c=.707106781):(W=Math.sqrt(l),B=M/W,c=a/W):u>t?(B=.707106781,W=.707106781,c=0):(c=Math.sqrt(t),B=v/c,W=a/c),this.set(B,W,c,q),this}var p=Math.sqrt((r-S)*(r-S)+(i-h)*(i-h)+(K-w)*(K-w));return Math.abs(p)<.001&&(p=1),this.x=(r-S)/p,this.y=(i-h)/p,this.z=(K-w)/p,this.w=Math.acos((s+Q+O-1)/2),this},min:function(K){return this.x=Math.min(this.x,K.x),this.y=Math.min(this.y,K.y),this.z=Math.min(this.z,K.z),this.w=Math.min(this.w,K.w),this},max:function(w){return this.x=Math.max(this.x,w.x),this.y=Math.max(this.y,w.y),this.z=Math.max(this.z,w.z),this.w=Math.max(this.w,w.w),this},clamp:function(T,K){return this.x=Math.max(T.x,Math.min(K.x,this.x)),this.y=Math.max(T.y,Math.min(K.y,this.y)),this.z=Math.max(T.z,Math.min(K.z,this.z)),this.w=Math.max(T.w,Math.min(K.w,this.w)),this},clampScalar:function(){var Q,y;return function(a,t){return Q===P&&(Q=new _m,y=new _m),Q.set(a,a,a,a),y.set(t,t,t,t),this.clamp(Q,y)}}(),clampLength:function(R,X){var g=this.length();return this.divideScalar(g||1).multiplyScalar(Math.max(R,Math.min(X,g)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(q){return this.x*q.x+this.y*q.y+this.z*q.z+this.w*q.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(F){return this.normalize().multiplyScalar(F)},lerp:function(X,b){return this.x+=(X.x-this.x)*b,this.y+=(X.y-this.y)*b,this.z+=(X.z-this.z)*b,this.w+=(X.w-this.w)*b,this},lerpVectors:function(I,x,Y){return this.subVectors(x,I).multiplyScalar(Y).add(I)},equals:function(m){return m.x===this.x&&m.y===this.y&&m.z===this.z&&m.w===this.w},fromArray:function(t,Q){return Q===P&&(Q=0),this.x=t[Q],this.y=t[Q+1],this.z=t[Q+2],this.w=t[Q+3],this},toArray:function(t,f){return t===P&&(t=[]),f===P&&(f=0),t[f]=this.x,t[f+1]=this.y,t[f+2]=this.z,t[f+3]=this.w,t},fromBufferAttribute:function(D,C){return this.x=D.getX(C),this.y=D.getY(C),this.z=D.getZ(C),this.w=D.getW(C),this}});var Ab=h.Math.Vector3=function(u,J,L){u===P?(this.x=0,this.y=0,this.z=0):"object"==typeof u?this.copy(u):this.set(u,J==P?u:J,L==P?u:L)},ll=h.Math.Vector3;O.assign(Ab.prototype,{isNaN:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},set:function(v,V,o){return this.x=v,this.y=V,this.z=o,this},equals:function(c){return c&&this.x===c.x&&this.y===c.y&&this.z===c.z},setScalar:function(p){return this.x=p,this.y=p,this.z=p,this},setX:function(i){return this.x=i,this},setY:function(E){return this.y=E,this},setZ:function(e){return this.z=e,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(c){return c.x===P?(this.x=c[0],this.y=c[1],this.z=c[2]):(this.x=c.x,this.y=c.y,this.z=c.z||0),this},add:function(L){return this.x+=L.x,this.y+=L.y,this.z+=L.z,this},addScalar:function(g){return this.x+=g,this.y+=g,this.z+=g,this},addVectors:function(L,x){return this.x=L.x+x.x,this.y=L.y+x.y,this.z=L.z+x.z,this},addScaledVector:function(A,D){return this.x+=A.x*D,this.y+=A.y*D,this.z+=A.z*D,this},sub:function(w){return this.x-=w.x,this.y-=w.y,this.z-=w.z,this},subScalar:function(n){return this.x-=n,this.y-=n,this.z-=n,this},subVectors:function(C,Y){return this.x=C.x-Y.x,this.y=C.y-Y.y,this.z=C.z-Y.z,this},divide:function(v){return this.x/=v.x,this.y/=v.y,this.z/=v.z,this},multiply:function(Y){return this.x*=Y.x,this.y*=Y.y,this.z*=Y.z,this},multiplyScalar:function(d){return this.x*=d,this.y*=d,this.z*=d,this},divideScalar:function(M){if(0!==M){var V=1/M;this.x*=V,this.y*=V,this.z*=V}else this.x=0,this.y=0,this.z=0;return this},distanceTo:function(r){return Math.sqrt(this.distanceToSquared(r))},distanceToSquared:function(j){var I=this.x-j.x,B=this.y-j.y,y=this.z-j.z;return I*I+B*B+y*y},distanceToSquared2:function(m){var j=this.x-m[0],A=this.y-m[1],v=this.z-m[2];return j*j+A*A+v*v},divideVectors:function(i,O){return this.x=i.x/O.x,this.y=i.y/O.y,this.z=i.z/O.z,this},multiplyVectors:function(u,O){return this.x=u.x*O.x,this.y=u.y*O.y,this.z=u.z*O.z,this},transformDirection:function(t){var z=this.x,E=this.y,V=this.z,v=t.el;return this.x=v[0]*z+v[4]*E+v[8]*V,this.y=v[1]*z+v[5]*E+v[9]*V,this.z=v[2]*z+v[6]*E+v[10]*V,this.normalize()},applyAxisAngle:function(){var X=new _d;return function(N,i){return this.applyQuaternion(X.setFromAxisAngle(N,i))}}(),applyEuler:function(){var k=new _d;return function(N){return this.applyQuaternion(k.setFromEuler(N))}}(),applyQuaternion:function(W){var a=this.x,c=this.y,y=this.z,S=W._x,$=W._y,Z=W._z,h=W._w,p=h*a+$*y-Z*c,B=h*c+Z*a-S*y,d=h*y+S*c-$*a,s=-S*a-$*c-Z*y;return this.x=p*h+s*-S+B*-Z-d*-$,this.y=B*h+s*-$+d*-S-p*-Z,this.z=d*h+s*-Z+p*-$-B*-S,this},applyMatrix4:function(o){var V=this.x,Y=this.y,Z=this.z,m=o.el,j=1/(m[3]*V+m[7]*Y+m[11]*Z+m[15]);return this.x=(m[0]*V+m[4]*Y+m[8]*Z+m[12])*j,this.y=(m[1]*V+m[5]*Y+m[9]*Z+m[13])*j,this.z=(m[2]*V+m[6]*Y+m[10]*Z+m[14])*j,this},applyMatrix3:function(Q){var T=this.x,u=this.y,s=this.z,l=Q.el;return this.x=l[0]*T+l[3]*u+l[6]*s,this.y=l[1]*T+l[4]*u+l[7]*s,this.z=l[2]*T+l[5]*u+l[8]*s,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var b=new Ab;return function(e){return this.sub(b.copy(e).multiplyScalar(2*this.dot(e)))}}(),dot:function(G){return this.x*G.x+this.y*G.y+this.z*G.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var w=this.length();return w?this.multiplyScalar(1/w):this},setLength:function(O){return this.normalize().multiplyScalar(O)},fromArray:function(H,i){return i===P&&(i=0),this.x=H[i],this.y=H[i+1],this.z=H[i+2],this},toArray:function(U,F){return U===P&&(U=[0,0,0]),F===P&&(F=0),U[F]=this.x,U[F+1]=this.y,U[F+2]=this.z,U},cross:function(W){return this.crossVectors(this,W)},angleTo:function(R){var l=this.dot(R)/Math.sqrt(this.lengthSq()*R.lengthSq());return l>1||-1>l?0:Math.acos(l)},lerp:function(k,M){return this.x+=(k.x-this.x)*M,this.y+=(k.y-this.y)*M,this.z+=(k.z-this.z)*M,this},lerpVectors:function(h,V,d){return this.subVectors(V,h).multiplyScalar(d).add(h)},crossVectors:function(E,g){var m=E.x,i=E.y,k=E.z,X=g.x,R=g.y,V=g.z;return this.x=i*V-k*R,this.y=k*X-m*V,this.z=m*R-i*X,this},min:function(o){return this.x=Math.min(this.x,o.x),this.y=Math.min(this.y,o.y),this.z=Math.min(this.z,o.z),this},max:function(G){return this.x=Math.max(this.x,G.x),this.y=Math.max(this.y,G.y),this.z=Math.max(this.z,G.z),this},setFromMatrixPosition:function(V){return this.setFromMatrixColumn(V,3)},setFromMatrixScale:function(e){var b=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),W=this.setFromMatrixColumn(e,2).length();return this.x=b,this.y=r,this.z=W,this},setFromMatrixColumn:function(q,u){return this.fromArray(q.el,4*u)}}),Ab.UP=new Ab(0,1,0),Ab.AxisX=new Ab(1,0,0),Ab.AxisY=new Ab(0,1,0),Ab.AxisZ=new Ab(0,0,1),Ab.normalizeArray=function(){var T=new Ab;return function(y){return T.copy(y).normalize().toArray()}}();var Vl=h.Math.Vector2=function(s,z,$){"object"==typeof s&&(s.x!=P?(z=s.y,$=s.e,s=s.x):($=s[2],z=s[1],s=s[0])),this.set(s||0,z||0,$)};Vl.prototype={},Vl.prototype.constructor=Vl;var Zo=Vl;O.defineProperties(Vl.prototype,{width:{get:function(){return this.x},set:function(i){this.x=i}},height:{get:function(){return this.y},set:function(i){this.y=i}}}),Vl.prototype.clone=function(){return new Vl(this.x,this.y,this.e)},Vl.prototype.copy=function(m){return this.set(m.x,m.y,m.e),this},Vl.prototype.equals=function(O){return O.x===this.x&&O.y===this.y&&O.e===this.e},Vl.prototype.set=function(j,U,V){return this.x=j||0,this.y=U||(0!==U?this.x:0),V!=P&&(this.e=V),this},Vl.prototype.setScalar=function(q){return this.x=q,this.y=q,this.e=q,this},Vl.prototype.setX=function(y){return this.x=y||0,this},Vl.prototype.setY=function(g){return this.y=g||0,this},Vl.prototype.setE=function(h){return this.e=h||0,this},Vl.prototype.add=function(z){return this.x+=z.x,this.y+=z.y,this},Vl.prototype.addVectors=function(g,l){return this.x=g.x+l.x,this.y=g.y+l.y,this},Vl.prototype.addScalar=function(M){return this.x+=M,this.y+=M,this},Vl.prototype.addScaledVector=function(c,v){return this.x+=c.x*v,this.y+=c.y*v,this},Vl.prototype.sub=function(k){return this.x-=k.x,this.y-=k.y,this},Vl.prototype.subScalar=function(A){return this.x-=A,this.y-=A,this},Vl.prototype.subVectors=function(v,l){return this.x=v.x-l.x,this.y=v.y-l.y,this},Vl.prototype.multiply=function(o){return this.x*=o.x,this.y*=o.y,this},Vl.prototype.multiplyScalar=function(_){return this.x*=_,this.y*=_,this},Vl.prototype.divide=function(v){return this.x/=v.x,this.y/=v.y,this},Vl.prototype.divideScalar=function(c){return this.multiplyScalar(1/c)},Vl.prototype.min=function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},Vl.prototype.max=function(X){return this.x=Math.max(this.x,X.x),this.y=Math.max(this.y,X.y),this},Vl.prototype.fromArray=function(C,p){return p===P&&(p=0),this.x=C[p],this.y=C[p+1],this},Vl.prototype.clamp=function(U,d){return this.x=Math.max(U.x,Math.min(d.x,this.x)),this.y=Math.max(U.y,Math.min(d.y,this.y)),this},Vl.prototype.clampScalar=function(){var $,O;return function(t,Z){return $===P&&($=new Vl,O=new Vl),$.set(t,t),O.set(Z,Z),this.clamp($,O)}}(),Vl.prototype.clampLength=function(c,K){var p=this.length();return this.multiplyScalar(Math.max(c,Math.min(K,p))/p)},Vl.prototype.dot=function(k){return this.x*k.x+this.y*k.y},Vl.prototype.cross=function(Q){return this.x*Q.y-this.y*Q.x},Vl.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Vl.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Vl.prototype.normalize=function(){return this.divideScalar(this.length())},Vl.prototype.angle=function(){var P=Math.atan2(this.y,this.x);return 0>P&&(P+=2*Math.PI),P},Vl.prototype.distanceTo=function(W){return Math.sqrt(this.distanceToSquared(W))},Vl.prototype.distanceToSquared=function(K){var c=this.x-K.x,H=this.y-K.y;return c*c+H*H},Vl.prototype.isNearEnough=function(Z){return this.distanceToSquared(Z)<1e-8},Vl.prototype.setLength=function(J){var L=this.length();return L?this.multiplyScalar(J/L):this},Vl.prototype.lerp=function(B,a){return this.x+=(B.x-this.x)*a,this.y+=(B.y-this.y)*a,"number"==typeof B.e&&"number"==typeof this.e&&(this.e+=(B.e-this.e)*a),this},Vl.prototype.lerpVectors=function(H,C,Y){return this.subVectors(C,H).multiplyScalar(Y).add(H)},Vl.prototype.rotateAround=function(c,H){var q=c?c.x:0,x=c?c.y:0,p=Math.cos(H),R=Math.sin(H),A=this.x-q,C=this.y-x;return this.x=A*p-C*R+q,this.y=A*R+C*p+x,this};var Xf=h.Math.Matrix3=function(){this.el=[1,0,0,0,1,0,0,0,1]};O.assign(Xf.prototype,{isMatrix3:!0,set:function(t,x,b,D,T,L,P,E,M){var w=this.el;return w[0]=t,w[1]=D,w[2]=P,w[3]=x,w[4]=T,w[5]=E,w[6]=b,w[7]=L,w[8]=M,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(c){var Z=this.el,z=c.el;return Z[0]=z[0],Z[1]=z[1],Z[2]=z[2],Z[3]=z[3],Z[4]=z[4],Z[5]=z[5],Z[6]=z[6],Z[7]=z[7],Z[8]=z[8],this},setFromMatrix4:function(K){var R=K.el;return this.set(R[0],R[4],R[8],R[1],R[5],R[9],R[2],R[6],R[10]),this},applyToBufferAttribute:function(){var g=new Ab;return function(m){for(var D=0,V=m.count;V>D;D++)g.x=m.getX(D),g.y=m.getY(D),g.z=m.getZ(D),g.applyMatrix3(this),m.setXYZ(D,g.x,g.y,g.z);return m}}(),multiply:function(x){return this.multiplyMatrices(this,x)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(s,x){var Q=s.el,J=x.el,D=this.el,e=Q[0],F=Q[3],v=Q[6],l=Q[1],h=Q[4],E=Q[7],Y=Q[2],j=Q[5],b=Q[8],X=J[0],f=J[3],W=J[6],U=J[1],C=J[4],R=J[7],i=J[2],N=J[5],V=J[8];return D[0]=e*X+F*U+v*i,D[3]=e*f+F*C+v*N,D[6]=e*W+F*R+v*V,D[1]=l*X+h*U+E*i,D[4]=l*f+h*C+E*N,D[7]=l*W+h*R+E*V,D[2]=Y*X+j*U+b*i,D[5]=Y*f+j*C+b*N,D[8]=Y*W+j*R+b*V,this},multiplyScalar:function(V){var p=this.el;return p[0]*=V,p[3]*=V,p[6]*=V,p[1]*=V,p[4]*=V,p[7]*=V,p[2]*=V,p[5]*=V,p[8]*=V,this},determinant:function(){var C=this.el,I=C[0],l=C[1],w=C[2],Y=C[3],L=C[4],g=C[5],G=C[6],$=C[7],K=C[8];return I*L*K-I*g*$-l*Y*K+l*g*G+w*Y*$-w*L*G},getInverse:function(E){var b=E.el,q=this.el,g=b[0],u=b[1],N=b[2],Z=b[3],o=b[4],h=b[5],D=b[6],H=b[7],T=b[8],c=T*o-h*H,Q=h*D-T*Z,s=H*Z-o*D,A=g*c+u*Q+N*s;if(0===A)return this.identity();var G=1/A;return q[0]=c*G,q[1]=(N*H-T*u)*G,q[2]=(h*u-N*o)*G,q[3]=Q*G,q[4]=(T*g-N*D)*G,q[5]=(N*Z-h*g)*G,q[6]=s*G,q[7]=(u*D-H*g)*G,q[8]=(o*g-u*Z)*G,this},transpose:function(){var K,p=this.el;return K=p[1],p[1]=p[3],p[3]=K,K=p[2],p[2]=p[6],p[6]=K,K=p[5],p[5]=p[7],p[7]=K,this},getNormalMatrix:function(p){return this.setFromMatrix4(p).getInverse(this).transpose()},transposeIntoArray:function(K){var d=this.el;return K[0]=d[0],K[1]=d[3],K[2]=d[6],K[3]=d[1],K[4]=d[4],K[5]=d[7],K[6]=d[2],K[7]=d[5],K[8]=d[8],this},setUvTransform:function(R,I,Y,c,M,U,q){var t=Math.cos(M),O=Math.sin(M);this.set(Y*t,Y*O,-Y*(t*U+O*q)+U+R,-c*O,c*t,-c*(-O*U+t*q)+q+I,0,0,1)},scale:function(J,Z){var O=this.el;return O[0]*=J,O[3]*=J,O[6]*=J,O[1]*=Z,O[4]*=Z,O[7]*=Z,this},rotate:function(l){var p=Math.cos(l),d=Math.sin(l),S=this.el,F=S[0],r=S[3],m=S[6],X=S[1],T=S[4],B=S[7];return S[0]=p*F+d*X,S[3]=p*r+d*T,S[6]=p*m+d*B,S[1]=-d*F+p*X,S[4]=-d*r+p*T,S[7]=-d*m+p*B,this},translate:function(b,y){var J=this.el;return J[0]+=b*J[2],J[3]+=b*J[5],J[6]+=b*J[8],J[1]+=y*J[2],J[4]+=y*J[5],J[7]+=y*J[8],this},equals:function(G){for(var k=this.el,d=G.el,B=0;9>B;B++)if(k[B]!==d[B])return!1;return!0},fromArray:function(Y,i){i===P&&(i=0);for(var e=0;9>e;e++)this.el[e]=Y[e+i];return this},toArray:function(s,R){s===P&&(s=[]),R===P&&(R=0);var V=this.el;return s[R]=V[0],s[R+1]=V[1],s[R+2]=V[2],s[R+3]=V[3],s[R+4]=V[4],s[R+5]=V[5],s[R+6]=V[6],s[R+7]=V[7],s[R+8]=V[8],s}});var Oq=h.Math.Plane=function(g,d){this.normal=g!==P?g:new Ab(1,0,0),this.constant=d!==P?d:0};O.assign(Oq.prototype,{set:function(q,R){return this.normal.copy(q),this.constant=R,this},setComponents:function(u,L,t,N){return this.normal.set(u,L,t),this.constant=N,this},setFromNormalAndCoplanarPoint:function(y,T){return this.normal.copy(y),this.constant=-T.dot(this.normal),this},setFromCoplanarPoints:function(){var z=new Ab,U=new Ab;return function(o,x,$){var M=z.subVectors($,x).cross(U.subVectors(o,x)).normalize();return this.setFromNormalAndCoplanarPoint(M,o),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var J=1/this.normal.length();return this.normal.multiplyScalar(J),this.constant*=J,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(r){return this.normal.dot(r)+this.constant},distanceToSphere:function(C){return this.distanceToPoint(C.center)-C.radius},projectPoint:function(S,e){return e===P&&(e=new Ab),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(S)).add(S)},intersectLine:function(){var W=new Ab;return function(x,D){D===P&&(D=new Ab);var T=x.delta(W),u=this.normal.dot(T);if(0===u)return 0===this.distanceToPoint(x.start)?D.copy(x.start):P;var V=-(x.start.dot(this.normal)+this.constant)/u;return 0>V||V>1?P:D.copy(T).multiplyScalar(V).add(x.start)}}(),intersectsLine:function($){var h=this.distanceToPoint($.start),t=this.distanceToPoint($.end);return 0>h&&t>0||0>t&&h>0},intersectsBox:function(L){return L.intersectsPlane(this)},intersectsSphere:function(X){return X.intersectsPlane(this)},coplanarPoint:function(q){return q===P&&(q=new Ab),q.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var X=new Ab,s=new Xf;return function(u,y){var Z=y||s.getNormalMatrix(u),T=this.coplanarPoint(X).applyMatrix4(u),w=this.normal.applyMatrix3(Z).normalize();return this.constant=-T.dot(w),this}}(),translate:function(U){return this.constant-=U.dot(this.normal),this},equals:function(n){return n.normal.equals(this.normal)&&n.constant===this.constant}});var js=h.Math.Ray=function(f,K){this.origin=f!==P?f.clone():new Ab,this.direction=K!==P?K.clone():new Ab};O.assign(js.prototype,{set:function(i,E){return this.origin.copy(i),this.direction.copy(E),this},clone:function(){return(new this.constructor).copy(this)},copy:function(L){return this.origin.copy(L.origin),this.direction.copy(L.direction),this.maxHitLen=L.maxHitLen,this},at:function(f,r){var b=r||new Ab;return b.copy(this.direction).multiplyScalar(f).add(this.origin)},setMaxHitLength:function(x){this.maxHitLen=x},lookAt:function(r){return this.direction.copy(r).sub(this.origin).normalize(),this},applyMatrix4:function(i){var Y=this.maxHitLen;if(Y){var O=this.direction.clone().multiplyScalar(Y).add(this.origin);O.applyMatrix4(i)}return this.origin.applyMatrix4(i),this.direction.transformDirection(i),Y&&(this.maxHitLen=this.origin.distanceTo(O)),this},distanceToPlane:function(m){var r=m.normal.dot(this.direction);if(0===r)return 0===m.distanceToPoint(this.origin)?0:null;var G=-(this.origin.dot(m.normal)+m.constant)/r;return G>=0?G:null},intersectPlane:function(Q,d){var Y=this.distanceToPlane(Q);return null===Y?null:this.at(Y,d)},intersectSphere:function(){var n=new Ab;return function($,_){n.subVectors($.center,this.origin);var F=n.dot(this.direction),m=n.dot(n)-F*F,s=$.radius*$.radius;if(m>s)return null;var E=Math.sqrt(s-m),K=F-E,t=F+E;return 0>K&&0>t?null:0>K?this.at(t,_):this.at(K,_)}}(),intersectEllipsoid:function(){var e=new Ab,U=new Ab;return function(Z,$){e.subVectors(Z.center,this.origin),e.divide(Z.radius),U.divideVectors(this.direction,Z.radius);var E=U.lengthSq(),s=e.dot(U),T=e.dot(e)*E-s*s;if(T>E)return null;var h=Math.sqrt(E-T),m=(s-h)/E,q=(s+h)/E;return 0>m&&0>q?null:0>m?this.at(q,$):this.at(m,$)}}(),intersectBox:function($,v){var U,r,i,c,Z,B,m=1/this.direction.x,s=1/this.direction.y,h=1/this.direction.z,I=this.origin;if(m>=0?(U=($.min.x-I.x)*m,r=($.max.x-I.x)*m):(U=($.max.x-I.x)*m,r=($.min.x-I.x)*m),s>=0?(i=($.min.y-I.y)*s,c=($.max.y-I.y)*s):(i=($.max.y-I.y)*s,c=($.min.y-I.y)*s),U>c||i>r)return null;if((i>U||U!==U)&&(U=i),(r>c||r!==r)&&(r=c),h>=0?(Z=($.min.z-I.z)*h,B=($.max.z-I.z)*h):(Z=($.max.z-I.z)*h,B=($.min.z-I.z)*h),U>B||Z>r)return null;if((Z>U||U!==U)&&(U=Z),(r>B||r!==r)&&(r=B),0>r)return null;var z=U>=0?U:r,Y=this.maxHitLen;return Y&&z>Y?null:this.at(z,v)},intersectTriangle:function(){var H=new Ab,d=new Ab,L=new Ab,M=new Ab;return function(z,x,P,q,E){d.subVectors(x,z),L.subVectors(P,z),M.crossVectors(d,L);var p,S=this.direction.dot(M);if(S>0){if(q)return null;p=1}else{if(!(0>S))return null;p=-1,S=-S}H.subVectors(this.origin,z);var r=p*this.direction.dot(L.crossVectors(H,L));if(0>r)return null;var J=p*this.direction.dot(d.cross(H));if(0>J||r+J>S)return null;var k=-p*H.dot(M);if(0>k)return null;var I=k/S,O=this.maxHitLen;return O&&I>O?null:this.at(I,E)}}()});var zg=h.Math.Box3=function(R,o){this.min=R!==P?R:new Ab(1/0,1/0,1/0),this.max=o!==P?o:new Ab(-1/0,-1/0,-1/0)};O.assign(zg.prototype,{set:function(b,S){return this.min.copy(b),this.max.copy(S),this},setFromArray:function(Z){for(var K=1/0,N=1/0,w=1/0,P=-1/0,E=-1/0,d=-1/0,n=0,A=Z.length;A>n;n+=3){var S=Z[n],W=Z[n+1],Y=Z[n+2];K>S&&(K=S),N>W&&(N=W),w>Y&&(w=Y),S>P&&(P=S),W>E&&(E=W),Y>d&&(d=Y)}return this.min.set(K,N,w),this.max.set(P,E,d),this},setFromPoints:function(M){this.makeEmpty();for(var O=0,W=M.length;W>O;O++)this.expandByPoint(M[O]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(o){return o.max.x<this.min.x||o.min.x>this.max.x||o.max.y<this.min.y||o.min.y>this.max.y||o.max.z<this.min.z||o.min.z>this.max.z?!1:!0},copy:function(H){return this.min.copy(H.min),this.max.copy(H.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(E){return this.min.min(E),this.max.max(E),this},expandByBox:function(U){return this.min.min(U.min),this.max.max(U.max),this},applyMatrix4:function(){var G=[new Ab,new Ab,new Ab,new Ab,new Ab,new Ab,new Ab,new Ab];return function(T){return this.isEmpty()?this:(G[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(T),G[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(T),G[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(T),G[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(T),G[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(T),G[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(T),G[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(T),G[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(T),this.setFromPoints(G),this)}}()});var xo=h.Math.Sphere=function(E,l){this.center=E!==P?E:new Ab,this.radius=l!==P?l:0};O.assign(xo.prototype,{set:function(Y,b){return this.center.copy(Y),this.radius=b,this},setFromPoints:function(){var B=new zg;return function(e,M){var o=this.center;M!==P?o.copy(M):B.setFromPoints(e).getCenter(o);for(var W=0,Y=0,J=e.length;J>Y;Y++)W=Math.max(W,o.distanceToSquared(e[Y]));return this.radius=Math.sqrt(W),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(U){return this.center.copy(U.center),this.radius=U.radius,this},empty:function(){return this.radius<=0},containsPoint:function(Q){return Q.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(z){return z.distanceTo(this.center)-this.radius},intersectsSphere:function(Z){var E=this.radius+Z.radius;return Z.center.distanceToSquared(this.center)<=E*E},intersectsBox:function(V){return V.intersectsSphere(this)},intersectsPlane:function(G){return Math.abs(G.distanceToPoint(this.center))<=this.radius},clampPoint:function(v,K){var l=this.center.distanceToSquared(v);return K===P&&(K=new Ab),K.copy(v),l>this.radius*this.radius&&(K.sub(this.center).normalize(),K.multiplyScalar(this.radius).add(this.center)),K},getBoundingBox:function(r){return r===P&&(r=new zg),r.set(this.center,this.center),r.expandByScalar(this.radius),r},applyMatrix4:function(M){return this.center.applyMatrix4(M),this.radius=this.radius*M.getMaxScaleOnAxis(),this},translate:function(G){return this.center.add(G),this},equals:function(S){return S.center.equals(this.center)&&S.radius===this.radius}});var Nj=h.Math.Frustum=function(U,r,y,H,L,k){this.planes=[U!==P?U:new Oq,r!==P?r:new Oq,y!==P?y:new Oq,H!==P?H:new Oq,L!==P?L:new Oq,k!==P?k:new Oq]};O.assign(Nj.prototype,{set:function(i,y,G,k,X,c){var z=this.planes;return z[0].copy(i),z[1].copy(y),z[2].copy(G),z[3].copy(k),z[4].copy(X),z[5].copy(c),this},clone:function(){return(new this.constructor).copy(this)},copy:function(O){for(var M=this.planes,x=0;6>x;x++)M[x].copy(O.planes[x]);return this},setFromMatrix:function(x){var i=this.planes,n=x.el,C=n[0],e=n[1],y=n[2],T=n[3],c=n[4],L=n[5],M=n[6],h=n[7],l=n[8],K=n[9],D=n[10],P=n[11],z=n[12],Z=n[13],q=n[14],B=n[15];return i[0].setComponents(T-C,h-c,P-l,B-z).normalize(),i[1].setComponents(T+C,h+c,P+l,B+z).normalize(),i[2].setComponents(T+e,h+L,P+K,B+Z).normalize(),i[3].setComponents(T-e,h-L,P-K,B-Z).normalize(),i[4].setComponents(T-y,h-M,P-D,B-q).normalize(),i[5].setComponents(T+y,h+M,P+D,B+q).normalize(),this},intersectsObject:function(){var q=new xo;return function(B){var M=B.geometry;return null===M.boundingSphere&&M.computeBoundingSphere(),q.copy(M.boundingSphere).applyMatrix4(B.matrixWorld),this.intersectsSphere(q)}}(),intersectsSprite:function(){var O=new xo;return function(U){return O.center.set(0,0,0),O.radius=.7071067811865476,O.applyMatrix4(U.matrixWorld),this.intersectsSphere(O)}}(),intersectsSphere:function(A){for(var Z=this.planes,O=A.center,p=-A.radius,W=0;6>W;W++){var n=Z[W].distanceToPoint(O);if(p>n)return!1}return!0},intersectsBox:function(){var s=new Ab;return function(g){for(var w=this.planes,G=0;6>G;G++){var h=w[G];if(s.x=h.normal.x>0?g.max.x:g.min.x,s.y=h.normal.y>0?g.max.y:g.min.y,s.z=h.normal.z>0?g.max.z:g.min.z,h.distanceToPoint(s)<0)return!1}return!0}}(),containsPoint:function(g){for(var T=this.planes,w=0;6>w;w++)if(T[w].distanceToPoint(g)<0)return!1;return!0}});var jo=h.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};O.assign(jo.prototype,{isMatrix4:!0,set:function(_,f,X,T,B,R,F,m,V,o,r,C,I,M,c,K){var w=this.el;return w[0]=_,w[4]=f,w[8]=X,w[12]=T,w[1]=B,w[5]=R,w[9]=F,w[13]=m,w[2]=V,w[6]=o,w[10]=r,w[14]=C,w[3]=I,w[7]=M,w[11]=c,w[15]=K,this},clone:function(){return(new jo).fromArray(this.el)},fromArray:function(N,m){m===P&&(m=0);for(var j=this.el,Y=0;16>Y;Y++)j[Y]=N[Y+m];return this},getElements:function(){return this.el},scale:function(x){var F=this.el,i=x.x,e=x.y,I=x.z;return F[0]*=i,F[4]*=e,F[8]*=I,F[1]*=i,F[5]*=e,F[9]*=I,F[2]*=i,F[6]*=e,F[10]*=I,F[3]*=i,F[7]*=e,F[11]*=I,this},translate:function(M){var t=this.el,x=M.x||0,F=M.y||0,y=M.z||0;return t[12]+=t[0]*x+t[4]*F+t[8]*y,t[13]+=t[1]*x+t[5]*F+t[9]*y,t[14]+=t[2]*x+t[6]*F+t[10]*y,t[15]+=t[3]*x+t[7]*F+t[11]*y,this},makeRotationFromEuler:function(H){var M=this.el,z=H._x,O=H._y,N=H._z,A=H._order,o=Math.cos(z),V=Math.sin(z),y=Math.cos(O),L=Math.sin(O),k=Math.cos(N),U=Math.sin(N);if("XYZ"===A){var G=o*k,T=o*U,F=V*k,v=V*U;M[0]=y*k,M[4]=-y*U,M[8]=L,M[1]=T+F*L,M[5]=G-v*L,M[9]=-V*y,M[2]=v-G*L,M[6]=F+T*L,M[10]=o*y}else if("YXZ"===A){var _=y*k,a=y*U,P=L*k,R=L*U;M[0]=_+R*V,M[4]=P*V-a,M[8]=o*L,M[1]=o*U,M[5]=o*k,M[9]=-V,M[2]=a*V-P,M[6]=R+_*V,M[10]=o*y}else if("ZXY"===A){var _=y*k,a=y*U,P=L*k,R=L*U;M[0]=_-R*V,M[4]=-o*U,M[8]=P+a*V,M[1]=a+P*V,M[5]=o*k,M[9]=R-_*V,M[2]=-o*L,M[6]=V,M[10]=o*y}else if("ZYX"===A){var G=o*k,T=o*U,F=V*k,v=V*U;M[0]=y*k,M[4]=F*L-T,M[8]=G*L+v,M[1]=y*U,M[5]=v*L+G,M[9]=T*L-F,M[2]=-L,M[6]=V*y,M[10]=o*y}else if("YZX"===A){var e=o*y,f=o*L,C=V*y,g=V*L;M[0]=y*k,M[4]=g-e*U,M[8]=C*U+f,M[1]=U,M[5]=o*k,M[9]=-V*k,M[2]=-L*k,M[6]=f*U+C,M[10]=e-g*U}else if("XZY"===A){var e=o*y,f=o*L,C=V*y,g=V*L;M[0]=y*k,M[4]=-U,M[8]=L*k,M[1]=e*U+g,M[5]=o*k,M[9]=f*U-C,M[2]=C*U-f,M[6]=V*k,M[10]=g*U+e}return M[3]=0,M[7]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,this},makeRotationFromQuaternion:function(V){var a=this.el,P=V._x,_=V._y,L=V._z,k=V._w,g=P+P,n=_+_,q=L+L,R=P*g,K=P*n,O=P*q,w=_*n,x=_*q,d=L*q,D=k*g,e=k*n,p=k*q;return a[0]=1-(w+d),a[4]=K-p,a[8]=O+e,a[1]=K+p,a[5]=1-(R+d),a[9]=x-D,a[2]=O-e,a[6]=x+D,a[10]=1-(R+w),a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(B){var N=this.el,H=B.el,Y=H[0],K=H[1],z=H[2],q=H[3],V=H[4],I=H[5],d=H[6],s=H[7],w=H[8],o=H[9],X=H[10],v=H[11],P=H[12],m=H[13],f=H[14],t=H[15],Z=o*f*s-m*X*s+m*d*v-I*f*v-o*d*t+I*X*t,y=P*X*s-w*f*s-P*d*v+V*f*v+w*d*t-V*X*t,g=w*m*s-P*o*s+P*I*v-V*m*v-w*I*t+V*o*t,n=P*o*d-w*m*d-P*I*X+V*m*X+w*I*f-V*o*f,b=Y*Z+K*y+z*g+q*n;if(0===b)return this.identity();var G=1/b;return N[0]=Z*G,N[1]=(m*X*q-o*f*q-m*z*v+K*f*v+o*z*t-K*X*t)*G,N[2]=(I*f*q-m*d*q+m*z*s-K*f*s-I*z*t+K*d*t)*G,N[3]=(o*d*q-I*X*q-o*z*s+K*X*s+I*z*v-K*d*v)*G,N[4]=y*G,N[5]=(w*f*q-P*X*q+P*z*v-Y*f*v-w*z*t+Y*X*t)*G,N[6]=(P*d*q-V*f*q-P*z*s+Y*f*s+V*z*t-Y*d*t)*G,N[7]=(V*X*q-w*d*q+w*z*s-Y*X*s-V*z*v+Y*d*v)*G,N[8]=g*G,N[9]=(P*o*q-w*m*q-P*K*v+Y*m*v+w*K*t-Y*o*t)*G,N[10]=(V*m*q-P*I*q+P*K*s-Y*m*s-V*K*t+Y*I*t)*G,N[11]=(w*I*q-V*o*q-w*K*s+Y*o*s+V*K*v-Y*I*v)*G,N[12]=n*G,N[13]=(w*m*z-P*o*z+P*K*X-Y*m*X-w*K*f+Y*o*f)*G,N[14]=(P*I*z-V*m*z-P*K*d+Y*m*d+V*K*f-Y*I*f)*G,N[15]=(V*o*z-w*I*z+w*K*d-Y*o*d-V*K*X+Y*I*X)*G,this},invert:function(){return this.getInverse(this)},makeRotationAxis:function(l,$){var H=Math.cos($),u=Math.sin($),j=1-H,J=l.x,e=l.y,g=l.z,a=j*J,T=j*e;return this.set(a*J+H,a*e-u*g,a*g+u*e,0,a*e+u*g,T*e+H,T*g-u*J,0,a*g-u*e,T*g+u*J,j*g*g+H,0,0,0,0,1),this},multiply:function(b){return this.multiplyMatrices(this,b)},premultiply:function(L){return this.multiplyMatrices(L,this)},multiplyMatrices:function(B,z){var M=B.el,L=z.el,D=this.el,F=M[0],N=M[4],k=M[8],V=M[12],Q=M[1],G=M[5],O=M[9],Y=M[13],X=M[2],o=M[6],i=M[10],I=M[14],E=M[3],c=M[7],P=M[11],_=M[15],l=L[0],e=L[4],g=L[8],v=L[12],J=L[1],W=L[5],x=L[9],S=L[13],h=L[2],d=L[6],u=L[10],a=L[14],K=L[3],j=L[7],U=L[11],r=L[15];return D[0]=F*l+N*J+k*h+V*K,D[4]=F*e+N*W+k*d+V*j,D[8]=F*g+N*x+k*u+V*U,D[12]=F*v+N*S+k*a+V*r,D[1]=Q*l+G*J+O*h+Y*K,D[5]=Q*e+G*W+O*d+Y*j,D[9]=Q*g+G*x+O*u+Y*U,D[13]=Q*v+G*S+O*a+Y*r,D[2]=X*l+o*J+i*h+I*K,D[6]=X*e+o*W+i*d+I*j,D[10]=X*g+o*x+i*u+I*U,D[14]=X*v+o*S+i*a+I*r,D[3]=E*l+c*J+P*h+_*K,D[7]=E*e+c*W+P*d+_*j,D[11]=E*g+c*x+P*u+_*U,D[15]=E*v+c*S+P*a+_*r,this},lookAt:function(){var k=new Ab;return function(t,q,a){return k.subVectors(t,q),this.lookAtDirection(k,a)}}(),lookAtDirection:function(){var t=new Ab,U=new Ab,M=new Ab;return function(u,v){v||(v=Ab.UP);var G=this.el;return M.copy(u),0===M.lengthSq()&&(M.z=1),M.normalize(),t.crossVectors(v,M),0===t.lengthSq()&&(1===Math.abs(v.z)?M.x+=1e-4:M.z+=1e-4,M.normalize(),t.crossVectors(v,M)),t.normalize(),U.crossVectors(M,t),G[0]=t.x,G[4]=U.x,G[8]=M.x,G[1]=t.y,G[5]=U.y,G[9]=M.y,G[2]=t.z,G[6]=U.z,G[10]=M.z,this}}(),extractScale:function(){var r;return function(n){r===P&&(r=new Ab),n===P&&(n=new Ab);var B=r.setFromMatrixColumn(this,0).length(),L=r.setFromMatrixColumn(this,1).length(),G=r.setFromMatrixColumn(this,2).length();return n.set(B,L,G),n}}(),extractRotation:function(){var L;return function(V){L===P&&(L=new Ab),V===P&&(V=new jo);var l=this.el,R=V.el,w=1/L.setFromMatrixColumn(V,0).length(),X=1/L.setFromMatrixColumn(V,1).length(),Z=1/L.setFromMatrixColumn(V,2).length();return l[0]=R[0]*w,l[1]=R[1]*w,l[2]=R[2]*w,l[4]=R[4]*X,l[5]=R[5]*X,l[6]=R[6]*X,l[8]=R[8]*Z,l[9]=R[9]*Z,l[10]=R[10]*Z,this}}(),multiplyScalar:function(u){var K=this.el;return K[0]*=u,K[4]*=u,K[8]*=u,K[12]*=u,K[1]*=u,K[5]*=u,K[9]*=u,K[13]*=u,K[2]*=u,K[6]*=u,K[10]*=u,K[14]*=u,K[3]*=u,K[7]*=u,K[11]*=u,K[15]*=u,this},getPosition:function(H){return H===P&&(H=new Ab),H.setFromMatrixColumn(this,3)},setPosition:function(m){var $=this.el;return $[12]=m.x,$[13]=m.y,$[14]=m.z,this},copyPosition:function(V){var E=this.el,N=V.el;return E[12]=N[12],E[13]=N[13],E[14]=N[14],this},toArray:function(O,N){O===P&&(O=[]),N===P&&(N=0);var Q=this.el;return O[N]=Q[0],O[N+1]=Q[1],O[N+2]=Q[2],O[N+3]=Q[3],O[N+4]=Q[4],O[N+5]=Q[5],O[N+6]=Q[6],O[N+7]=Q[7],O[N+8]=Q[8],O[N+9]=Q[9],O[N+10]=Q[10],O[N+11]=Q[11],O[N+12]=Q[12],O[N+13]=Q[13],O[N+14]=Q[14],O[N+15]=Q[15],O},determinant:function(){var Q=this.el,G=Q[0],H=Q[4],o=Q[8],q=Q[12],p=Q[1],M=Q[5],U=Q[9],F=Q[13],J=Q[2],N=Q[6],d=Q[10],R=Q[14],W=Q[3],B=Q[7],A=Q[11],t=Q[15];
return W*(+q*U*N-o*F*N-q*M*d+H*F*d+o*M*R-H*U*R)+B*(+G*U*R-G*F*d+q*p*d-o*p*R+o*F*J-q*U*J)+A*(+G*F*N-G*M*R-q*p*N+H*p*R+q*M*J-H*F*J)+t*(-o*M*J-G*U*N+G*M*d+o*p*N-H*p*d+H*U*J)},copy:function(y){var C=this.el,H=y.el;return C[0]=H[0],C[1]=H[1],C[2]=H[2],C[3]=H[3],C[4]=H[4],C[5]=H[5],C[6]=H[6],C[7]=H[7],C[8]=H[8],C[9]=H[9],C[10]=H[10],C[11]=H[11],C[12]=H[12],C[13]=H[13],C[14]=H[14],C[15]=H[15],this},compose:function(W,y,J){var w=this.el,k=y._x,x=y._y,s=y._z,K=y._w,o=k+k,N=x+x,r=s+s,a=k*o,C=k*N,l=k*r,L=x*N,G=x*r,v=s*r,P=K*o,M=K*N,D=K*r,S=J.x,X=J.y,p=J.z;return w[0]=(1-(L+v))*S,w[1]=(C+D)*S,w[2]=(l-M)*S,w[3]=0,w[4]=(C-D)*X,w[5]=(1-(a+v))*X,w[6]=(G+P)*X,w[7]=0,w[8]=(l+M)*p,w[9]=(G-P)*p,w[10]=(1-(a+L))*p,w[11]=0,w[12]=W.x,w[13]=W.y,w[14]=W.z,w[15]=1,this},decompose:function(){var t=new Ab,V=new jo;return function(N,E,X){var M=this.el,A=t.set(M[0],M[1],M[2]).length(),b=t.set(M[4],M[5],M[6]).length(),L=t.set(M[8],M[9],M[10]).length(),z=this.determinant();0>z&&(A=-A),N.x=M[12],N.y=M[13],N.z=M[14],V.copy(this);var u=1/A,f=1/b,S=1/L;return V.el[0]*=u,V.el[1]*=u,V.el[2]*=u,V.el[4]*=f,V.el[5]*=f,V.el[6]*=f,V.el[8]*=S,V.el[9]*=S,V.el[10]*=S,E.setFromRotationMatrix(V),X.x=A,X.y=b,X.z=L,this}}(),equals:function(r){for(var f=this.el,I=r.el,o=0;16>o;o++)if(f[o]!==I[o])return!1;return!0}}),new jo,new jo;var Nn=h.Math.Triangle=function(c,v,G){this.a=c!==P?c:new Ab,this.b=v!==P?v:new Ab,this.c=G!==P?G:new Ab};O.assign(Nn,{barycoordFromPoint:function(){var z=new Ab,U=new Ab,L=new Ab;return function(B,R,D,V,P){z.subVectors(V,R),U.subVectors(D,R),L.subVectors(B,R);var F=z.dot(z),E=z.dot(U),S=z.dot(L),N=U.dot(U),v=U.dot(L),W=F*N-E*E,o=P||new Ab;if(0===W)return o.set(-2,-1,-1);var f=1/W,w=(N*S-E*v)*f,n=(F*v-E*S)*f;return o.set(1-w-n,n,w)}}(),uvIntersection:function(){var t=new Ab;return function(V,Q,w,c,Z,D,n){return Nn.barycoordFromPoint(V,Q,w,c,t),Z.multiplyScalar(t.x),D.multiplyScalar(t.y),n.multiplyScalar(t.z),Z.add(D).add(n),Z.clone()}}()});var bn=h.Math.Euler=function(d,H,y,h,J){this.set(d,H,y,h,J)};bn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],bn.DefaultOrder="XYZ",bn.ReverseOrder=function(){var L={xyz:"ZYX",xzy:"YZX",yxz:"ZXY",yzx:"XZY",zxy:"YXZ",zyx:"XYZ"};return function(X){return L[X]}}(),O.defineProperties(bn.prototype,{x:{get:function(){return this._x},set:function(x){this._x=x,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(m){this._y=m,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(v){this._z=v,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(W){this._order=W,this.onChangeCallback()}}}),O.assign(bn.prototype,{set:function(E,z,D,n,i){return bs(E)&&(i=D,n=z,D=E[2],z=E[1],E=E[0]),n?i&&(n=bn.ReverseOrder(n)):n="ZYX",this._x=E||0,this._y=z||0,this._z=D||0,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(q){return this._x=q._x,this._y=q._y,this._z=q._z,this._order=q._order,this.onChangeCallback(),this},setFromRotationMatrix:function(D,v,g){var W=h.Math.clamp,E=D.el||D,B=E[0],$=E[4],b=E[8],l=E[1],N=E[5],u=E[9],s=E[2],G=E[6],_=E[10];return v=v||this._order,"XYZ"===v?(this._y=Math.asin(W(b,-1,1)),Math.abs(b)<.99999?(this._x=Math.atan2(-u,_),this._z=Math.atan2(-$,B)):(this._x=Math.atan2(G,N),this._z=0)):"YXZ"===v?(this._x=Math.asin(-W(u,-1,1)),Math.abs(u)<.99999?(this._y=Math.atan2(b,_),this._z=Math.atan2(l,N)):(this._y=Math.atan2(-s,B),this._z=0)):"ZXY"===v?(this._x=Math.asin(W(G,-1,1)),Math.abs(G)<.99999?(this._y=Math.atan2(-s,_),this._z=Math.atan2(-$,N)):(this._y=0,this._z=Math.atan2(l,B))):"ZYX"===v?(this._y=Math.asin(-W(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(G,_),this._z=Math.atan2(l,B)):(this._x=0,this._z=Math.atan2(-$,N))):"YZX"===v?(this._z=Math.asin(W(l,-1,1)),Math.abs(l)<.99999?(this._x=Math.atan2(-u,N),this._y=Math.atan2(-s,B)):(this._x=0,this._y=Math.atan2(b,_))):"XZY"===v?(this._z=Math.asin(-W($,-1,1)),Math.abs($)<.99999?(this._x=Math.atan2(G,N),this._y=Math.atan2(b,B)):(this._x=Math.atan2(-u,_),this._y=0)):console.warn("unsupported order: "+v),this._order=v,g!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var p=new jo;return function(r,R,v){return p.makeRotationFromQuaternion(r),this.setFromRotationMatrix(p,R,v)}}(),setFromVector3:function(S,V){return this.set(S.x,S.y,S.z,V||this._order)},reorder:function(){var g=new _d;return function(S){return g.setFromEuler(this),this.setFromQuaternion(g,S)}}(),equals:function(A){return A._x===this._x&&A._y===this._y&&A._z===this._z&&A._order===this._order},fromArray:function(R){return this._x=R[0],this._y=R[1],this._z=R[2],R[3]!==P&&(this._order=R[3]),this.onChangeCallback(),this},toArray:function(m,b){return m===P&&(m=[]),b===P&&(b=0),m[b]=this._x,m[b+1]=this._y,m[b+2]=this._z,m[b+3]=this._order,m},toVector3:function(f){return f?f.set(this._x,this._y,this._z):new Ab(this._x,this._y,this._z)},onChange:function(F){return this.onChangeCallback=F,this},onChangeCallback:function(){}});var wp={ms_ac:function(s,e){for(var o=e.ms_ac,l=0;l<o.length;l++)_j(s,o[l])},ms_listener:function(S){S.addListeners=function(){var E=this,P=Yo;K.mockTouch&&(P=lc.concat(Qk).concat(nc)),E.__events__=P;for(var j=0,h=P.length;h>j;j++){var i=P[j];"wheel"===i&&!E.handle_wheel&&E.handle_mousewheel&&(E.handle_wheel=function(h){Op(E,h)}),E["handle_"+i]&&Og(i,E.getView(),E)}},S.removeListeners=function(){var D=this,J=D.__events__;if(J){D.__events__=P;for(var G=0,r=J.length;r>G;G++)D["handle_"+J[G]]&&Xg(J[G],D.getView(),D)}}},ms_fire:function(S){S.mp=function(C,S,V){this.addPropertyChangeListener(C,S,V)},S.ump=function(I,Z){this.removePropertyChangeListener(I,Z)},S.fp=function(F,D,p,S,t){return this.firePropertyChange(F,D,p,S,t)},S.addPropertyChangeListener=function(g,S,F){var C=this;C._62I||(C._62I=new Lm),C._62I.add(g,S,F)},S.removePropertyChangeListener=function(r,F){this._62I&&this._62I.remove(r,F)},S.firePropertyChange=function(H,C,l,N,J){if(N){if(N(C,l))return!1}else if(C===l)return!1;var r=this,v=J||{};return v.property=H,v.oldValue=C,v.newValue=l,v.source=r,v.data=r,r._62I&&r._62I.fire(v),r.onPropertyChanged&&r.onPropertyChanged(v),!0}},ms_attr:function(w){w.a=function(Y,E){var W=this;if(2===arguments.length)W.setAttr(Y,E);else{if(!Hh(Y))return W.getAttr(Y);for(var P in Y)W.setAttr(P,Y[P])}return W},w.getAttr=function(T,f){if(f===P&&(f=1),this._attrObject&&T in this._attrObject)return this._attrObject[T];if(this.getImage){var C=this.getImage();if(Om(C)&&(C=xb[C]),Hh(C)&&"dataBindings"in C)for(var g=C.dataBindings,e=g.length-1;e>=0;e--){var k=g[e];if(k.attr===T){if("defaultValue"in k)return k.defaultValue;break}}}return f?s[T]:P},w.setAttr=function(M,b){var r=this;r._attrObject||(r._attrObject={});var q=r._attrObject[M];b===P?delete r._attrObject[M]:r._attrObject[M]=b,r.fp&&r.fp("a:"+M,q,b)&&r.onAttrChanged&&r.onAttrChanged(M,q,b)},w.getSerializableAttrs=function(){var j,B={};for(j in this._attrObject)B[j]=1;return B}},ms_bnb:function(k){k.getBodyColor=function(F){return F.s("body.color")},k.getBorderColor=function(E){return E.s("border.color")}},_51o:function(F){F.mi=function(i,G,H){this.addInteractorListener(i,G,H)},F.umi=function(r,D){this.removeInteractorListener(r,D)},F.fi=function(m){this.fireInteractorEvent(m)},F.addInteractorListener=function(B,Q,D){var w=this;w._63I||(w._63I=new Lm),w._63I.add(B,Q,D)},F.removeInteractorListener=function($,T){this._63I&&this._63I.remove($,T)},F.fireInteractorEvent=function(o){this._63I&&this._63I.fire(o)},F.setInteractors=function(e){var W=this,T=W._interactors;T&&T.each(function(A){A.tearDown()}),bs(e)&&(e=new oc(e)),W._interactors=e,e&&e.each(function(o){o.setUp()}),W.fp("interactors",T,e),W.invalidateSelection()},F.getInteractors=function(){return this._interactors}},_49o:function(g){g._44O=E,g._45O=E,g.getTopPainters=function(){return this._44O},g.getBottomPainters=function(){return this._45O},g.addTopPainter=function(s){var G=this;G._44O||(G._44O=new oc),G._44O.contains(s)||(G._44O.add(s),G.redraw&&G.redraw())},g.removeTopPainter=function(d){var W=this;W._44O&&(W._44O.remove(d),W.redraw&&W.redraw())},g.addBottomPainter=function(i){var $=this;$._45O||($._45O=new oc),$._45O.contains(i)||($._45O.add(i),$.redraw&&$.redraw())},g.removeBottomPainter=function(K){var T=this;T._45O&&(T._45O.remove(K),T.redraw&&T.redraw())},g._93db=function(R,s){var b=this;b._45O&&b._45O.each(function(l){l.draw?l.draw(R,s):l.call(b,R,s)})},g._92db=function(M,o){var l=this;l._44O&&l._44O.each(function(Z){Z.draw?Z.draw(M,o):Z.call(l,M,o)})}},ms_sm:function(d){d.sm=function(){return this.getSelectionModel()},d.setSelectableFunc=function(P){this.sm().setFilterFunc(P)},d.getSelectableFunc=function(){return this.sm().getFilterFunc()},d.getSelectionModel=function(){var O=this;return O._selectionModel?O._selectionModel:O.dm().sm()},d.isSelectionModelShared=function(){return!this._selectionModel},d.setSelectionModelShared=function(N){var I=this,q=I.sm(),o=!I._selectionModel,m=I.handleSelectionChange,O=I.dm();o!==N&&(I.invalidateSelection&&I.invalidateSelection(),N?(O.sm().ms(m,I),I._selectionModel.ums(m,I),I._selectionModel.dispose(),I._selectionModel=E):(O.sm().ums(m,I),I._selectionModel=new gi(O),I._selectionModel.ms(m,I)),I.onSelectionModelSharedChanged(),I.fp("selectionModelShared",o,N),I.fireViewEvent({kind:"selectionModelSharedChange",oldValue:o,newValue:N,oldSelectionModel:q,newSelectionModel:I.sm()}))},d.onSelectionModelSharedChanged=function(){var q=this;q.redraw(),q.invalidateSelection&&q.invalidateSelection()},d.removeSelection=function(){var B=this.dm();B.beginTransaction(),this.sm().toSelection().each(B.remove,B),B.endTransaction()},d.selectAll=function(){var m=this;m.sm().ss(m.dm().toDatas(function(V){return m.isVisible(V)&&m.isSelectable(V)}))},d.isSelected=function(B){return this.sm().co(B)},d.isSelectedById=function(B){var C=this.dm().getDataById(B);return C?this.isSelected(C):!1},d.isSelectable=function(D){return this.sm().isSelectable(D)}},ms_tx:function(I){I._64I=0,I._65O=0,I.isScrollable=function(){return this.getWidth()<this._64I},I._40o=function(){return this.isScrollable()},I.getLogicalPoint=function(F){return Fg(F,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},I.tx=function(n){return n===P?this.getTranslateX():(this.setTranslateX(n),void 0)},I.getTranslateX=function(){return this._65O},I.setTranslateX=function(Y){var h=this,f=h.getWidth()-h._64I;f>Y&&(Y=f),Y>0&&(Y=0),Y=j(Y);var X=h._65O;h._65O=Y,h.fp(fq,X,Y)}},ms_ty:function(a){a._23Q=0,a._66O=0,a._41o=function(){return this.getHeight()<this._23Q},a.getLogicalPoint=function(t){return Fg(t,this._canvas||this._view,this.tx?this.tx():0,this.ty())},a.ty=function(R){return R===P?this.getTranslateY():(this.setTranslateY(R),void 0)},a.getTranslateY=function(){return this._66O},a.setTranslateY=function($){var P=this,o=P.getHeight()-P._23Q;o>$&&($=o),$>0&&($=0),$=j($);var w=P._66O;P._66O=$,P.fp(oq,w,$)}},ms_txy:function(c){c._65O=0,c._66O=0,c.tx=function(u){return u===P?this.getTranslateX():(this.setTranslateX(u),void 0)},c.ty=function(w){return w===P?this.getTranslateY():(this.setTranslateY(w),void 0)},c.onTranslateEnded=function(){},c.setTranslate=function(J,v,N){var j=this;if(N=md(N)){j._65I&&j._65I.stop(!0);var r=j.tx(),m=j.ty();N.action=function(T){j.setTranslate(r+(J-r)*T,m+(v-m)*T)},N._37o=function(){delete j._66I,delete j._65I,j.onTranslateEnded()},j._66I=1,j._65I=he(N)}else j.tx(J),j.ty(v)},c.getTranslateX=function(){return this._65O},c.setTranslateX=function(Y){var J=this;Y=J.adjustTranslateX(Y);var y=J._65O;J._65O=Y,J.fp(fq,y,Y)},c.getTranslateY=function(){return this._66O},c.setTranslateY=function(J){var l=this;J=l.adjustTranslateY(J);var q=l._66O;l._66O=J,l.fp(oq,q,J)},c.adjustTranslateX=function(I){return j(I)},c.adjustTranslateY=function(f){return j(f)},c.translate=function(Q,T,n){this.setTranslate(this.tx()+Q,this.ty()+T,n)},c.getLogicalPoint=function(I){var w=this;return Fg(I,this._canvas||w._view,w.tx(),w.ty())}},ms_dm:function(k){k.dm=function(n){return n?(this.setDataModel(n),void 0):this.getDataModel()},k.getDataModel=function(){return this._dataModel}},ms_lp:function(R){R.lp=function(d){return this.getLogicalPoint(d)}},ms_v:function(A){A._disabled=!1,A.setDisabled=function(K,X){var V=this,h=V._disabled;h!==K&&(h&&(gl(V._63O),delete V._63O),K&&(Ej(V._view,V._63O=Ib(X)),V.iv()),V._disabled=K,V.fp("disabled",h,K))},A.isDisabled=function(){return this._disabled},A.getDisabledDiv=function(){return this._63O},A.getView=function(){return this._view},A.addToDOM=function(y){var I=this,t=I.getView(),$=t.style;y=y||f.body,y.appendChild(t),$.left="0",$.right="0",$.top="0",$.bottom="0",F(Q,"resize",function(){I.iv()}),I.iv()},A.setCursor=function(O){"default"===O&&(O=this._defaultCursor||O);var A=this.getView().style;A.cursor=O,A.cursor="-webkit-"+O,A.cursor="-moz-"+O},A.getWidth=function(){return this._view.clientWidth},A.getHeight=function(){return this._view.clientHeight},A.setWidth=function(r){var M=this;M._view.style.width=r+yr,M.iv(),M.fp&&M.fp(il,E,r)},A.setHeight=function(V){var H=this;H._view.style.height=V+yr,H.iv(),H.fp&&H.fp(Cr,E,V)},A.setFocus=function(A){var c=this,C=c._currentEditor;return A&&C&&(C.getView&&(C=C.getView()),C.contains(A.target))?!1:(am(c._view),c.endEditing&&c.endEditing(),c.fireViewEvent("focus"),!0)},A.iv=function(b){this.invalidate(b)},A.invalidate=function(N){var Z=this;Z._68I||(Z._68I=1,Z._ivTimerId=dd(Z._validateImpl,Z,E,N),Z._ivTimerDelay=N,Z.onInvalidated&&Z.onInvalidated(),Z.fireViewEvent("invalidate"))},A.validate=function(){var j=this._ivTimerId,S=this._ivTimerDelay;this._validateImpl()!==!1&&j&&Jc(j,S)},A._validateImpl=function(){var D=this,g=D._view;if(!D._68I)return!1;if(delete D._68I,g.parentNode)if(0===g.offsetWidth&&0===g.offsetHeight&&D._67I!==E)D._67I===P&&(D._67I=K.reinvalidateCount),D._67I>0?D._67I--:D._67I=E,D.iv();else{D.fireViewEvent("beginValidate"),D.validateImpl(),D.onValidated&&D.onValidated(),D.fireViewEvent("validate");var S=D._63O;S&&(g.lastChild!==S&&(gl(S),Ej(g,S)),Xb(S,0,0,D.getWidth(),D.getHeight())),jq(D),cg(D),Ak(D)}},A.layout=function(n,T,k,Y){1===arguments.length?Xb(this,n):Xb(this,n,T,k,Y)},A.addViewListener=function(J,f,c){var U=this;U._67O||(U._67O=new Lm),U._67O.add(J,f,c)},A.removeViewListener=function(k,q){this._67O.remove(k,q)},A.fireViewEvent=function(w){var Y=this;Y._67O&&(Om(w)&&(w={kind:w}),Y._67O.fire(w)),K.viewListener&&K.viewListener(Y,w)}},ms_tip:function(r){r.setToolTipEnabled=function(u){var n=this;u?kd||n._13o||(n.enableToolTip(),n.fp("toolTipEnabled",!1,!0)):n._13o&&(n.disableToolTip(),n.fp("toolTipEnabled",!0,!1))},r.isToolTipEnabled=function(){return!!this._13o},r.enableToolTip=function(){var V=this;if(!kd&&!V._13o){V._13o=function(m){if(!m.toolTipView){m.toolTipView=V;var P=V.getToolTip(m);P!=E?(K.toolTipContinual&&K.isToolTipShowing()?Zj(m,P):(mb(),Ic={timeout:Jn(lo,nf),e:m,info:P}),Vr={e:m,view:V}):mb()}};var G=V.getView();F(G,vg,V._13o),F(G,"mouseleave",K.hideToolTip)}},r.disableToolTip=function(){var Q=this;if(Q._13o){var z=Q.getView();J(z,vg,Q._13o),J(z,"mouseleave",K.hideToolTip),delete Q._13o}},r.getToolTip=function(Z){var U=this;if(U.getDataAt){var W=U.getDataAt(Z);return W?W.getToolTip():E}return U.getValue?U.getValue():void 0}},_52o:function(i){i._zoom=1,i._29I=Cm,i.zoomIn=function($,p){this.setZoom(this._zoom*Ik,$,p)},i.zoomOut=function(s,F){this.setZoom(this._zoom/Ik,s,F)},i.zoomReset=function(K,b){this.setZoom(1,K,b)},i.scrollZoomIn=function(K){this.setZoom(this._zoom*Ng,E,K)},i.scrollZoomOut=function(c){this.setZoom(this._zoom/Ng,E,c)},i.pinchZoomIn=function(b){this.setZoom(this._zoom*$k,E,b)},i.pinchZoomOut=function(u){this.setZoom(this._zoom/$k,E,u)},i.adjustZoom=function(J){return pc>J?pc:J>vd?vd:J},i.getZoom=function(){return this._zoom},i.setZoom=function(G,U,I){var x=this;if(U=md(U)){x._14o&&x._14o.stop(!0);var L=x._zoom;U.action=function(v){x._96O(L+(G-L)*v,I)},U._37o=function(){delete x._zooming,delete x._14o,x.onZoomEnded()},x._zooming=1,x._14o=he(U)}else x._96O(G,I)},i._96O=function(C,q){var M=this;if(C=M.adjustZoom(C),C!==M._zoom){M.validate();var N=M._29I,S=M._zoom;0!==N.width&&0!==N.height&&(q=q?q:{x:N.x+N.width/2,y:N.y+N.height/2},M.tx((q.x-N.x)*S-q.x*C),M.ty((q.y-N.y)*S-q.y*C)),M._zoom=C,M.fp("zoom",S,C)}}},ms_edge:function(Z){Z._2I=function(y){var q=this;q._44I||(q._44I=new oc),q._42I||(q._42I=new oc),q._44I.add(y),q._42I.add(y),q._20I()},Z._4I=function($){var U=this;U._44I||(U._44I=new oc),U._43I||(U._43I=new oc),U._44I.add($),U._43I.add($),U._20I()},Z._16I=function(j){var M=this;M._44I.remove(j),M._42I.remove(j),M._44I.isEmpty()&&delete M._44I,M._42I.isEmpty()&&delete M._42I,M._20I()},Z._18I=function(q){var P=this;P._44I.remove(q),P._43I.remove(q),P._44I.isEmpty()&&delete P._44I,P._43I.isEmpty()&&delete P._43I,P._20I()},Z._20I=function(){var r=this;if(delete r._45I,!r._44I||r._44I.isEmpty())return delete r._70O,void 0;var f;r._44I.each(function(Z){Z.isLooped()&&(f||(f={}),f[Z._id]||(r._45I||(r._45I=new oc),r._45I.add(Z),f[Z._id]=Z))}),f?(r._70O=new oc,r._44I.each(function(b){f[b._id]?"A"===f[b._id]||(f[b._id]="A",r._70O.add(b)):r._70O.add(b)})):r._70O=r._44I},Z.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},Z.getSourceAgentEdges=function(){return this._46I},Z.getTargetAgentEdges=function(){return this._47I},Z._1I=function(V){var h=this;h._46I||(h._46I=new oc),h._48I||(h._48I=new oc),h._46I.add(V),h._48I.add(V),h._19I()},Z._3I=function(B){var J=this;J._47I||(J._47I=new oc),J._48I||(J._48I=new oc),J._47I.add(B),J._48I.add(B),J._19I()},Z._15I=function(u){var b=this;b._46I.remove(u),b._48I.remove(u),b._46I.isEmpty()&&delete b._46I,b._48I.isEmpty()&&delete b._48I,b._19I()},Z._17I=function(n){var f=this;f._47I.remove(n),f._48I.remove(n),f._47I.isEmpty()&&delete f._47I,f._48I.isEmpty()&&delete f._48I,f._19I()},Z._19I=function(){var C=this;delete C._49I;var U=C._48I;if(U&&!U.isEmpty()){var b={};U.each(function(X){b[X._id]?C._49I||(C._49I=new oc):b[X._id]=X}),C._49I?U.each(function(h){b[h._id]&&(C._49I.add(h),delete b[h._id])}):C._49I=U}},Z.getLoopedEdges=function(){return this._45I},Z.getEdges=function(){return this._70O},Z.getAgentEdges=function(){return this._49I},Z.getSourceEdges=function(){return this._42I},Z.getTargetEdges=function(){return this._43I},Z._8I=function(){this._70O&&this._70O.each(function(T){T._7I()})}}};Sn(K,{getVersion:function(){return"7.3.3"}},!0);var qn=function(O){return O.devicePixelRatio?O.devicePixelRatio:O.screen&&O.screen.logicalXDPI?O.screen.deviceXDPI/O.screen.logicalXDPI:1};Sn(K,{numberDigits:5,crossOrigin:"",baseZIndex:P,isTouchable:kd,mockTouch:!0,devicePixelRatio:qn(Q),reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:T.disabledBackground,forceHierarchicalSerialization:!0,extractBatchTranslation:!1,extractShapeTranslation:!1,extractPolylineTranslation:!1,extractVerticesTranslation:!1,envmapProbeMinWaitTime:300,envmapProbeMaxWaitTime:25e3,EnvmapTextureSize:1024,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Yb},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],blockMinSize:1,textExtraWidth:4,encodeStringKey:null,doubleClickSpeed:500,doubleClickRange:1,doubleTouchRange:20,touchMoveThreshold:10,animDuration:200,animEasing:function(m){return m*m},labelColor:dg,labelSelectColor:Gk,labelFont:"12px arial, sans-serif",widgetIndent:kd?30:20,widgetRowHeight:kd?30:20,widgetHeaderHeight:kd?32:22,widgetTitleHeight:kd?34:24,scrollBarColor:ml,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:kd?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,pinchZoomThreshold:1,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Oj,intersectionLineLine:qi,isEnter:ol,isEsc:xq,isDelete:ho,isSpace:Vo,isLeft:oj,isUp:mp,isRight:Lf,isDown:Wq,isTouchEvent:_n,getTarget:Yr,isString:Om,isNumber:Kg,isBoolean:mh,isArray:bs,isSelectAll:Bd,isFunction:tj,isObject:Hh,getPropertyValue:ri,setPropertyValue:pp,addMethod:Sn,createGradient:function(F,X,i,z,J,Z,E,r){var D=Sj[X];return D(F,i,z,J,Z,E,r)},appendToScreen:function(k){k=k.getView?k.getView():k,(f.fullscreenElement||f.mozFullScreenElement||f.webkitFullscreenElement||f.msFullscreenElement||f.body).appendChild(k)},encodeString:function(H){return h.Math.encodeBase64(H,K.encodeStringKey)},decodeString:function(i){return h.Math.decodeBase64(i,K.encodeStringKey)},findView:function(Y){var l=function(u,j){var d=j._ht;d&&u.push(d);var k=j.children,n=k.length;if(n)for(var F=0;n>F;F++)l(u,k[F])},$=[];l($,f.body);var P=function(a,U){for(var K="2d"===U?pj.GraphView:ag.Graph3dView,o=0,e=a.length;e>o;o++)if(a[o]instanceof K)return $[o];return null};return"all"===Y?$:"2d"===Y?P($,"2d"):"3d"===Y?P($,"3d"):P($,"3d")||P($,"2d")},toggleFullscreen:function(n){var U=n.getView();if(f.fullscreenElement||f.mozFullScreenElement||f.webkitFullscreenElement||f.msFullscreenElement)f.exitFullscreen?f.exitFullscreen():f.msExitFullscreen?f.msExitFullscreen():f.mozCancelFullScreen?f.mozCancelFullScreen():f.webkitExitFullscreen&&f.webkitExitFullscreen();else{var Y=!0;if(n.isSelfViewEvent){var X=n.getX(),K=n.getY(),s=n.getWidth(),J=n.getHeight(),D=U.style.background,P=U.style.backgroundColor;D||P||(U.style.backgroundColor="white"),U.requestFullscreen?U.requestFullscreen():U.msRequestFullscreen?U.msRequestFullscreen():U.mozRequestFullScreen?U.mozRequestFullScreen():U.webkitRequestFullscreen&&U.webkitRequestFullscreen();var G=setInterval(function(){if(U!==(f.fullscreenElement||f.mozFullScreenElement||f.webkitFullscreenElement||f.msFullscreenElement))clearInterval(G),n.setX(X),n.setY(K),n.setWidth(s),n.setHeight(J),n._fullscreen=!1,U.style.oldBackgroundColor=P,n.iv();else{var v=h.Default.getWindowInfo();(Y||v.width!==n.getWidth()||v.height!==n.getHeight())&&(n.setX(v.left),n.setY(v.top),n.setWidth(v.width),n.setHeight(v.height),n._fullscreen=!0,n.iv(),Y=!1)}},500)}else{var W=U.style.left,B=U.style.top,s=U.style.width,J=U.style.height,D=U.style.background,P=U.style.backgroundColor;D||P||(U.style.backgroundColor="white"),U.requestFullscreen?U.requestFullscreen():U.msRequestFullscreen?U.msRequestFullscreen():U.mozRequestFullScreen?U.mozRequestFullScreen():U.webkitRequestFullscreen&&U.webkitRequestFullscreen();var G=setInterval(function(){if(U!==(f.fullscreenElement||f.mozFullScreenElement||f.webkitFullscreenElement||f.msFullscreenElement))clearInterval(G),U.style.left=W,U.style.top=B,U.style.width=s,U.style.height=J,U.style.oldBackgroundColor=P,n.iv();else{var C=h.Default.getWindowInfo();(Y||C.width!==n.getWidth()||C.height!==n.getHeight())&&(Xb(n),Y=!1)}},500)}}},appendTimeStamp:function(A){return A},setCompType:function(o,O){Om(O)&&O.substr(0,12)==fd&&(O=K.parse(O)),tj(O)||Hh(O)?Gi[o]=O:dm(o)},getCompType:function(d){var e=Gi[d];return e===P&&jr.test(d)&&dm(d),e},getCompTypeMap:function(){return Gi},drawCompType:function(W,m,d,A,S,J){W(m,d,A,S,J)},numberListener:function(){var J={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(p){var R=p.keyCode;J[R]||65===R&&K.isCtrlDown(p)||86===R&&K.isCtrlDown(p)||67===R&&K.isCtrlDown(p)||88===R&&K.isCtrlDown(p)||R>=35&&40>=R||(p.shiftKey||48>R||R>57)&&(96>R||R>105)&&p.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(Y){var l=Y.target.tagName;("DIV"===l||"CANVAS"===l)&&!(K.ignoreKeyCodes.indexOf(Y.keyCode)>=0)&&("keydown"!==Y.type||oj(Y)||Lf(Y)||mp(Y)||Wq(Y)||ho(Y)||65===Y.keyCode&&(Y.metaKey||Y.ctrlKey))&&Y.cancelable===!0&&(Y.preventDefault(),Y.preventManipulation&&Y.preventManipulation())},getWindowInfo:function(){var B=f.documentElement,P=B&&(B.scrollLeft||B.scrollTop)?B:f.body;return{target:P,left:P.scrollLeft,top:P.scrollTop,width:Q.innerWidth||P.clientWidth,height:Q.innerHeight||P.clientHeight}},isDragging:function(){return!!Yb},isLeftButton:function(U){return _n(U)?!0:0===U.button},isMiddleButton:function(c){return _n(c)?!1:c&&(1===c.button||4&(c.buttons||0))},isRightButton:function(N){return _n(N)?!1:N&&(2===N.button||2&(N.buttons||0))},isInput:function(u){if(!u)return!1;var y=u.tagName;return"INPUT"===y||"TEXTAREA"===y||"SELECT"===y},getTouchCount:function(q){return _n(q)?q.touches.length:1},isDoubleClick:function(){function u(Y){Y.details=0,Y.timeout=null,Y.lastPoint=null}var C={};return Ie=new Ae,is=Ie.getTime(),function(h){if(sf(h)>1)return!1;var x=h.button==E?"":h.button,l=h.type+x,M=l+"_isDoubleClick",w=C[l];if(w||(w=C[l]={details:0,timeout:null,lastPoint:null}),h[M]===P){h[M]=!0;var p=Tk(h);w.timeout&&(Lp(w.timeout),w.timeout=null);var $=_n(h)?K.doubleTouchRange:K.doubleClickRange;w.lastPoint&&nk(w.lastPoint,p)>$&&u(w),w.lastPoint=p,w.details++,w.timeout=Jn(function(){u(this)}.bind(w),K.doubleClickSpeed)}return 2===w.details}}(),isShiftDown:function(p){return p?p.shiftKey:zr["16"]},isCtrlDown:function(e){return e?Sc?e.metaKey:e.ctrlKey:Sc?zr["91"]:zr["17"]},getClientPoint:function(o){return _n(o)&&(o=lf(o)),{x:o.clientX,y:o.clientY}},isMouseEvent:function(B){return B instanceof MouseEvent||0===B.type.indexOf("mouse")},getTargetElement:function(E){var l,Y=$j(E);if(l=K.isMouseEvent(E)||!f.elementFromPoint?E.target:f.elementFromPoint(Y.x,Y.y),Wm&&f.elementFromPoint){for(var d=[],J=[];"none"===l.style.pointerEvents;)d.push(l),J.push(l.style.display||""),l.style.display="none",l=f.elementFromPoint(Y.x,Y.y);d.forEach(function(K,M){K.style.display=J[M]})}return l},getPagePoint:function(F){return _n(F)&&(F=lf(F)),{x:F.pageX,y:F.pageY}},createObject:function(X,$){var Q=new X;for(var u in $){var x=$[u];if(tj(x))Q[u]=x;else if(0===u.indexOf("s:"))Q.s(u.substr(2),$[u]);else if(0===u.indexOf("a:"))Q.a(u.substr(2),$[u]);else{var H=sh(u),x=$[u];Q[H]?(Q[H](x),"setToolTip"===H&&Q.enableToolTip&&Q.enableToolTip()):Q[u]=x}}return Q},setImage:function(n,O,v,e){var f=arguments.length;4===f?Uh(n,e,O,v):2===f?Om(O)?O.substr(0,12)==fd?Md(n,K.parse(O)):Uh(n,O):Md(n,O):1===f&&Uh(n,n)},getImage:function(A,b,h){var a;if(A==E)return E;if(Hh(A)?a=A:(a=xb[A],A&&a===P&&(yp&&yp[A]||Uh(A,A))),b&&a&&a.tagName){var j;j="override"===h?"colors_override":"override_rgb"===h?"colors_override_rgb":"override_a"===h?"colors_override_a":"colors",a[j]||(a[j]={__count__:0});var d=a[j][b];return d||(a[j].__count__>K.imageCacheThreshold&&(a[j]={__count__:0}),d=Bk(a,Ql(b),a.width,a.height,h),a[j][b]=d,a[j].__count__++),d}return a},isImageComplete:function(A,d,J){var r=fl(A);if(!r)return!1;if(r.tagName)return r.complete;for(var b,A,s,W=r.comps,v=!0,m=0,H=W.length;H>m;m++)if(b=W[m],s=b.type,"image"===b.type){A=b.name,A&&A.func&&(A=as(A,d));var M=Rn(A,d,J);if(!M){v=!1;break}}else if(jr.test(s)&&K.getCompType(s)===P){v=!1,dm(s);break}return v},getId:function(){var k=1;return function(){return++k}}(),callLater:function(G,u,j,O){var c=function(){G.apply(u,j)};return O?Jn(c,O):Q.requestAnimationFrame(c)},cancelLater:function(V,T){T?Lp(V):Q.cancelAnimationFrame(V)},clone:function(t){if(null==t||"object"!=typeof t)return t;if(t instanceof Date){var c=new Date;return c.setTime(t.getTime()),c}if(t instanceof Array){for(var c=[],_=0,v=t.length;v>_;_++)c[_]=fo(t[_]);return c}if(t instanceof oc){for(var c=new oc,_=0,v=t.length;v>_;_++)c.set(_,fo(t.get(_)));return c}if(t instanceof Lk)return t;if(t instanceof ed){var c=new ed;return c.deserialize(t.serialize()),c}if(t instanceof O){var c={};for(var k in t)t.hasOwnProperty(k)&&(c[k]=fo(t[k]));return c}return t},callWhenLoaded:function(C,B){B=B||100;var Q=Fe(C,B);Qq||(Qq={}),Qq[Q]={tick:Q,cb:C,delay:B}},beforeLoadURL:function($,Y){if(Qq){var j={};for(var Y in Qq){var e=Qq[Y];Lp(e.tick);var c=Fe(e.cb,e.delay);j[c]={tick:c,delay:e.delay,cb:e.cb}}Qq=j}return K.convertURL?K.convertURL($,Y):$},convertURL:function(d){return d},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return K.getImage("default_blank")},resizeImage:function($,e,h,F){h||(h=e),F||(F=ej());var x=F.getContext("2d");return Gm(F,e,h,1),x.drawImage($,0,0,e,h),F},resizeImagePOT:function(B,x,h){if(!B||!B.tagName)return B;var U=B.width,H=B.height;if(!U||!H)return B;if(Uj.isPOT(U)&&Uj.isPOT(H)&&(!x||U===H))return B;var m,I;return x?I=m=Uj.nearestPOT(Math.min(U,H)):(m=Uj.nearestPOT(U),I=Uj.nearestPOT(H)),K.resizeImage(B,m,I,h)},sortFunc:function(y,s){if(y===s)return 0;if(y==E&&s!=E)return 1;if(y!=E&&s==E)return-1;if(y==E&&s==E)return 0;var f,A=typeof y,j=typeof s;return A===Mq&&j===Mq?f=y.localeCompare(s):A===Qi&&j===Qi&&(f=y-s),f===P&&(f=(""+y).localeCompare(""+s)),f>0?1:0>f?-1:0},getClassMap:function(){return Jg},getClass:function(S){if(Om(S)){var E,G=Jg[S];if(!G){E=S.split("."),G=Q;for(var g=0;g<E.length;g++)G=G[E[g]];Jg[S]=G}return G}return S},def:function(K,d,j){var J,N,P,B=function(){};if(B.prototype=d.prototype,J=new B,Om(K)){if(Jg[K])throw"'"+K+"' already defined";P=Zp(K),J.getClassName=function(){return K}}else P=K;if(J.constructor=P,J.getClass=function(){return P},J.getSuperClass=function(){return d},j)for(N in j)wp[N]&&wp.hasOwnProperty(N)?wp[N](J,j):Jj(J,j,N);P.prototype=J,P.superClass=d.prototype},startAnim:function(){var L=function(v){v.duration&&(v.startTime=Ll()),v.timeId=dd(v.tick,E,E,v.interval)};return function(y){return y=fo(y),y.easing=y.easing||K.animEasing,y.duration||y.frames||(y.duration=K.animDuration),y.t=0,y.duration?y.interval=0:(y.frame=0,y.interval=y.interval||10),y.tick=function(){if(y.duration){var V=(Ll()-y.startTime)/y.duration;if(V>1&&(V=1),y.t=V,y.action(y.easing(V),V),!y.isRunning())return;1===V?y.stop():y._isPaused||(y.timeId=dd(y.tick))}else{if(y.frame++,V=y.t=y.frame/y.frames,y.action(y.easing(V),V),!y.isRunning())return;y.frame<y.frames?y._isPaused||(y.timeId=dd(y.tick,E,E,y.interval)):y.stop()}},y.resume=function(){y._isPaused&&(delete y._isPaused,y.duration?y.t<1&&(y.startTime=Ll()-y.duration*y.t,y.timeId=dd(y.tick)):y.frame<y.frames&&(y.timeId=dd(y.tick,E,E,y.interval)))},y.pause=function(){Jc(y.timeId,!y.duration),y._isPaused=!0},y.isPaused=function(){return this._isPaused},y.stop=function(o){y.isRunning()&&(Jc(y.timeId,!y.duration),delete y.timeId,y.duration?y.t<1&&o&&(y.t=1,y.action(y.easing(1),1)):y.frame<y.frames&&o&&(y.frame=y.frames,y.action(y.easing(1),1)),y._37o&&y._37o(),y.finishFunc&&y.finishFunc())},y.isRunning=function(){return y.timeId!=E},y.delay?dd(L,E,[y],y.delay):L(y),y}}(),getTextSize:function(){var V={},s=f?ej().getContext("2d"):E;return function(S,C){s.font=S?S:Th;var y=V[s.font];return y||(y=2*s.measureText("e").width+4,V[s.font]=y),{width:s.measureText(C).width+K.textExtraWidth,height:y}}}(),drawText:function(X,b,W,V,N,Q,t,H,p,m,M){if(b!=E){var O=_p(W,b),B={};B.y=m&&m!==zh?m===Mo?Q+O.height/2:Q+H-O.height/2:Q+H/2,B.x=p&&p!==zi?p===es?N+t-O.width/2:N+t/2:N+O.width/2,Sr(X,b,B,W,V),M&&jn(X,b,W,V,B.x,B.y,O.width,M)}},getDistance:function(F,W){var b=F.length;return W?3===b?A(Tb(F[0]-W[0])+Tb(F[1]-W[1])+Tb(F[2]-W[2])):2===b?A(Tb(F[0]-W[0])+Tb(F[1]-W[1])):F.z===P?A(Tb(W.x-F.x)+Tb(W.y-F.y)):A(Tb(W.x-F.x)+Tb(W.y-F.y)+Tb(W.z-F.z)):3===b?A(Tb(F[0])+Tb(F[1])+Tb(F[2])):2===b?A(Tb(F[0])+Tb(F[1])):void 0},brighter:function(y,F){return 0>F&&(F=-F),Qe(y,F?F:40)},darker:function(O,g){return g>0&&(g=-g),Qe(O,g?g:-40)},unionPoint:function(A,z){if(!A)return E;if(2===arguments.length)return A&&z?{x:I(A.x,z.x),y:I(A.y,z.y),width:B(A.x-z.x),height:B(A.y-z.y)}:E;var L=A;if(L._as&&(L=L._as),L.length===P)return E;var u=L.length;if(0>=u)return E;for(var n=1,C=L[0],l={x:C.x,y:C.y,width:0,height:0};u>n;n++){C=L[n];var a=I(l.x,C.x),S=_(l.x+l.width,C.x),Z=I(l.y,C.y),T=_(l.y+l.height,C.y);l.x=a,l.y=Z,l.width=S-a,l.height=T-Z}return l},unionRect:function(P,y){if(P&&!y)return fo(P);if(!P&&y)return fo(y);if(P&&y){var p={x:I(P.x,y.x),y:I(P.y,y.y)};return p.width=_(P.x+P.width,y.x+y.width)-p.x,p.height=_(P.y+P.height,y.y+y.height)-p.y,p}return E},containsPoint:function(x,o,T,e){if(e!=E&&1!==e){var Q=x.x+x.width/2,Y=x.y+x.height/2;x={x:Q-x.width/2*e,y:Y-x.height/2*e,width:x.width*e,height:x.height*e}}if(T){var c=x.width/2,_=x.height/2,s=l(-T),U=W(-T),F=o.x-x.x-c,b=o.y-x.y-_;
return o={x:U*F-s*b,y:s*F+U*b},mg({x:-c,y:-_,width:x.width,height:x.height},o)}return!(!x||o.x<x.x||o.y<x.y||o.x>x.x+x.width||o.y>x.y+x.height)},containsRect:function(V,d){if(!V||!d)return!1;var D=d.x,U=d.y,l=d.width,o=d.height,e=V.width,c=V.height;if(0>(e|c|l|o))return!1;var R=V.x,x=V.y;if(R>D||x>U)return!1;if(e+=R,l+=D,D>=l){if(e>=R||l>e)return!1}else if(e>=R&&l>e)return!1;if(c+=x,o+=U,U>=o){if(c>=x||o>c)return!1}else if(c>=x&&o>c)return!1;return!0},intersectsRect:function(k,V){if(!k||!V)return!1;var P=V.width,N=V.height,w=k.width,m=k.height;if(0>=w||0>=m||0>=P||0>=N)return!1;var F=V.x,A=V.y,f=k.x,a=k.y;return w+=f,m+=a,P+=F,N+=A,w>F&&m>A&&P>f&&N>a},intersection:function(r,Z){if(!r||!Z)return E;var z=Z.x,v=Z.y,y=r.x,c=r.y,J=z,m=v,I=y,H=c;return J+=Z.width,m+=Z.height,I+=r.width,H+=r.height,y>z&&(z=y),c>v&&(v=c),J>I&&(J=I),m>H&&(m=H),J-=z,m-=v,0>=J||0>=m?E:{x:z,y:v,width:J,height:m}},grow:function(A,W,u){u===P&&(u=W),A.x-=W,A.y-=u,A.width=A.width+2*W,A.height=A.height+2*u},getScreenPoint:function(v,n,z,t,U,J,D){var q=z.getBoundingClientRect(),O=v*(J||1)-z.scrollLeft+(t||0),l=n*(D||1)-z.scrollTop+(U||0),I=Ij(z,!1);if(I){var H=new Ab(O,l,0);return H.applyMatrix4(I),console.log(H),{x:H.x,y:H.y}}return{x:O+q.left,y:l+q.top}},getLogicalPoint:function(K,l,C,F,V,m){var j,G,T=l.getBoundingClientRect();K.target?(Bj(K)?Sc?zr["91"]=!0:zr["17"]=!0:Sc?zr["91"]=!1:zr["17"]=!1,zr["16"]=um(K)?!0:!1,K=_n(K)?lf(K):K,j=K.clientX,G=K.clientY):(j=K.x,G=K.y);var z=Ij(l,!0);if(z){var n=new Ab(j,G,0);n.applyMatrix4(z);do{if(Math.abs(n.z)<=1e-6)break;var U=new Ab(j,G,1);if(U.applyMatrix4(matrix),Math.abs(U.z)<=1e-6){n=U;break}if(U.sub(n),Math.abs(U.z)<=1e-6)break;n.addScaledVector(U,-n.z/U.z)}while(!1);return{x:(n.x+l.scrollLeft-(C||0))/(V||1),y:(n.y+l.scrollTop-(F||0))/(m||1)}}return{x:(j-T.left+l.scrollLeft-(C||0))/(V||1),y:(G-T.top+l.scrollTop-(F||0))/(m||1)}},removeHTML:function(){var j;return function(R){return R&&R.getView&&(R=R.getView()),R&&R.parentNode?j===R?!0:(j=R,R.parentNode.removeChild(R),j=E,!0):!1}}(),getToolTipDiv:function(){if(!Pj){Pj=Xi(),ds=Xi();var d=Pj.style;K.baseZIndex!=E&&(d.zIndex=sr(K.baseZIndex)+3+""),d.whiteSpace="nowrap",d.color=K.toolTipLabelColor,d.background=K.toolTipBackground,d.font=K.toolTipLabelFont,d.padding="5px",d.boxShadow="0px 0px 3px "+K.toolTipShadowColor}return Pj},isToolTipShowing:function(){return Pj&&Pj.parentNode?!0:ds&&ds.parentNode?!0:!1},updateToolTipContent:function(w,G){if(K.isToolTipShowing()&&(G||(G=Vr&&Vr.view),w===P&&G&&Vr.e&&(w=G.getToolTip(Vr.e)),w!=E)){var z;w.html?(w=w.html,z=ds):z=Pj,z.innerHTML=w}},hideToolTip:function(){if(mj(),K.isToolTipShowing()){gl(Pj),gl(ds);var Q=Vr&&Vr.view;Q&&Q.onHideToolTip&&Q.onHideToolTip(),Vr=E}},showToolTip:function(C,o,S){if(!C||o==E)return mb(),void 0;K.getToolTipDiv();var X,T;if(o.html?(o=o.html,X=ds,gl(Pj)):(X=Pj,gl(ds)),T=X.style,X.innerHTML="",o instanceof HTMLElement?X.appendChild(o):X.innerHTML=o,X.parentNode||h.Default.appendToScreen(X),C.target){C=$j(C);var m=Gc(),b=C.x,a=C.y,D=kd?60:12;if(kd){var I=X.getBoundingClientRect();T.left=b-I.width/2+yr,T.top=a-I.height-D<m.top?a+D+yr:a-I.height-D+yr}else{T.left=b+D+yr,T.top=a+D+yr;var I=X.getBoundingClientRect();I.left+I.width>m.width&&(T.left=b-D-I.width+yr),I.top+I.height>m.height&&(T.top=a-D-I.height+yr),I.left<0&&(T.left=b+D+yr),I.top<0&&(T.top=a+D+yr)}}else T.left=C.x+yr,T.top=C.y+yr;mj(),S===P?S=Vr&&Vr.view:Vr={e:C,view:S},S&&S.onShowToolTip&&S.onShowToolTip()},startDragging:function(W,u,n){n==P&&(n=!0),W!==Yb&&(Yb?n&&(_n(u)?Yb.handleWindowTouchEnd(u):Yb.handleWindowMouseUp(u)):_n(u)?(F(Q,Nf,En),F(Q,Jk,Nh),F(Q,"blur",Nh)):(F(Q,vg,Ep),F(Q,Fh,ih),F(Q,"blur",ih)),Yb=W)},getImageMap:function(){return xb},toBoundaries:function(g,P,J,q){var E=[];return _h(g,P,J,q).forEach(function(r){var q=[];r.forEach(function(e){q.push(e.x,e.y)}),E.push(q)}),E},getCurrentKeyCodeMap:function(){return zr},drawCenterImage:function(g,d,R,Z,u,y,w,T){!u&&y&&y.isSelfViewEvent&&(u=y);var r=_r(d,u,y),I=wm(d,u,y);Pp(g,d,j(R-r/2),j(Z-I/2),r,I,u,y,w,T)},drawStretchImage:function(M,N,e,L,v,V,c,R,C,K,k,T){!R&&C&&C.isSelfViewEvent&&(R=C);var b,Z=_r(N,R,C,V),D=wm(N,R,C,c);"uniform"===e?(b=I(V/Z,c/D),Z*=b,D*=b,L+=j((V-Z)/2),v+=j((c-D)/2),V=Z,c=D):"centerUniform"===e&&((Z>V||D>c)&&(b=I(V/Z,c/D),Z*=b,D*=b),L+=j((V-Z)/2),v+=j((c-D)/2),V=Z,c=D);var S=M.interactiveInfo;if(S){var s;if(s="center"===e?{x:L+V/2-Z/2,y:v+c/2-D/2,width:Z,height:D}:{x:L,y:v,width:V,height:c},S.rect){var p=S.compInfos,y=p.length;y&&(p[y-1].rect.image=N)}else S.rect=s}if("center"===e){var F=k!==!1&&(Z>V||D>c);F&&(M.save(),M.beginPath(),M.rect(L,v,V,c),M.clip()),Pp(M,N,L+V/2-Z/2,v+c/2-D/2,Z,D,R,C,K,T),F&&M.restore()}else Pp(M,N,L,v,V,c,R,C,K,T)},toCanvas:function(P,F,d,_,u,k,N,A,j){P=fl(P,N),F=F||_r(P,u),d=d||wm(P,u);var p=ej(),r=Te(p);return A?(Gm(p,F,d,A),r.scale(A,A)):Gm(p,F,d,1),_c(r,P,_,0,0,F,d,u,k,N,j),P&&P.clampToEdge&&(p.clampToEdge=P.clampToEdge),r.restore(),p},toGrayColor:function(Z){if(!Z)return Z;var r=yo(Z),C=j(.299*r[0]+.587*r[1]+.114*r[2]);return"rgba("+C+","+C+","+C+","+r[3]/255+")"},createGradientImage:function(E,I,W,Z){for(var C=["L",0,0,E,0,1,0,0,1,0,0],Y=0,x=Math.min(I.length,W.length);x>Y;Y++)C.push(W[Y],I[Y]);var d=h.Default.toCanvas({width:E,height:E,clampToEdge:!0,comps:[{type:"shape",rotation:Z||0,points:[0,0,E,0,E,E,0,E],background:"#ffffff",gradientPack:C}]});return d},createElement:function(V,G,R,b){var i=f.createElement(V);return $e(i,G||T.widgetBorder,2),i.style.font=R?R:Th,b!=E&&(i.value=b),K.onElementCreated&&K.onElementCreated(i),i},containedInView:function(P,t){var x=_f(t).getBoundingClientRect();return mg({x:x.left,y:x.top,width:x.width,height:x.height},Tk(P))},isIsolating:function(){return sn>0},setIsolating:function(w){w?sn++:sn--},getMSMap:function(){return wp},stringify:function(p,r,n){var R=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var s=ed.prototype.toJSON;ed.prototype.toJSON=function(){return"__ht__dataModel"+this.serialize(0)},r=n?0:r==E?2:r;var q=JSON.stringify(p,function(H,O){return"function"==typeof O?"__ht__"+(O.__ht__||O.toString()):Kg(O)?He(O):O instanceof h.List?"__ht__list"+(O.__ht__list||K.stringify(O._as)):O},r);return Date.prototype.toJSON=R,ed.prototype.toJSON=s,n&&(q=fd+ng(q)),q},parse:function(A,m){return Om(A)?A.substr(0,12)!=fd||(A=Di(A.substr(12)),Om(A))?(m=m||{},JSON.parse(A,function(J,i){if(Om(i))if(m.ignoreFunction||"__ht__function"!=i.substr(0,14)){if(!m.ignoreDate&&"__ht__date"==i.substr(0,10))return new Date(sr(i.substr(10)));if("__ht__list"===i.substr(0,10))return new oc(K.parse(i.substr(10)));if(!m.ignoreDataModel&&"__ht__dataModel"===i.substr(0,15)){var D=new ed;return D.deserialize(K.parse(i.substr(15))),D}}else{var Y=i.indexOf("{")+1,y=i.lastIndexOf("}"),$=i.indexOf("(")+1,h=i.indexOf(")");if(Y&&y&&$&&h)try{var g=new Function(i.substring($,h),i.substring(Y,y));return g.__ht__=i.substr(6),g}catch(L){throw console.info("=== SyntaxError ===\n",i),L}}return i})):A:A},loadJS:function(Z,q){q&&Z.push(q);var k=Z.shift();if(bs(k))Z=k.contact(Z),K.loadJS(Z);else if(tj(k))k(),K.loadJS(Z);else if(Om(k)){var B=f.createElement("script");B.onload=function(){K.loadJS(Z)},B.setAttribute("src",k),f.getElementsByTagName("head")[0].appendChild(B)}else Z.length&&K.loadJS(Z)},extendClass:function(X,J){var C=X.prototype;for(var U in J)wp[U]&&wp.hasOwnProperty(U)?wp[U](C,J):C[U]=J[U]},toRoundedCorner:function(){function _(y,F,j){y.x=F.x,y.y=F.e||j,y.z=F.y}var C=new Ab,e=new Ab,r=new Ab,A=new Ab;return function(L,Q){var V,c=0;L.getPoints&&(c=L.getElevation(),L=L.getPoints()),V=L instanceof oc?L:new oc(L);var W=V.size();if(0>=Q)return{points:V};var M=new oc,H=new oc,n=V.get(0);_(C,n,c),M.add(n),H.add(1);for(var h=1;W>h;h++)if(W>h+1){var E=V.get(h),O=V.get(h+1);_(e,E,c),_(r,O,c),A.subVectors(C,e).setLength(Math.min(.99*A.length(),Q)).add(e),E.e!==P||n.e!==P?M.add({x:A.x,y:A.z,e:A.y}):M.add({x:A.x,y:A.z}),M.add(E),A.subVectors(r,e).setLength(Math.min(.99*A.length(),Q)).add(e),E.e!==P||O.e!==P?M.add(n={x:A.x,y:A.z,e:A.y}):M.add(n={x:A.x,y:A.z}),C.copy(A),H.addAll([2,3])}else M.add(V.get(h)),H.add(2);return{points:M,segments:H}}}(),toColorData:yo,setCanvas:Gm,createDiv:Xi,createDisabledDiv:Ib,createView:Of,createCanvas:ej,appendChild:Ej,initContext:Te,checkLoadingImage:jq,translateAndScale:Rf,layout:Xb,getPosition:Ac,drawPoints:xj,drawRoundRect:ok,drawBorder:di,setFocus:am,getter:Bn,setter:sh,isEmptyObject:Cp,cameraPriority:function(){var u={skybox:0,main:1e4,top:1e7,infinity:1/0};return O.seal(O.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return u.skybox},set:function(c){if(c>=u.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");u.skybox=Number(c)}},main:{configurable:!1,enumerable:!1,get:function(){return u.main},set:function(g){if(g<=u.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(g>=u.top)throw new RangeError("Main camera must have lower priority than the top camera.");u.main=Number(g)}},top:{configurable:!1,enumerable:!1,get:function(){return u.top},set:function(N){if(N<=u.main)throw new RangeError("Top camera must have higher priority than the main camera.");u.top=Number(N)}}}))}(),addFontFace:function(){function R(Z){var u=Z.substr(Z.lastIndexOf(".")+1);Z=K.convertURL?K.convertURL(Z):Z;var o=W[u]||u;return{postfix:u,url:"url("+Z+') format("'+o+'")'}}function A(s,b){return w[s.postfix]-w[b.postfix]}var W={ttf:"truetype",otf:"opentype",eot:"embedded-opentype"},w={eot:0,woff2:1,woff:2,ttf:3,otf:4};return function(l,x,p,P){if(l){P&&K.removeFontFace(l,!0);var D;if(D=qm[l])return D.parentNode||f.head.appendChild(D),p&&p(D),void 0;if(Om(x)&&(x=[x]),x=x.filter(function(g){return Om(g)?g.length>0:!1}),0!==x.length){x=x.map(R);var t="";x.sort(A).forEach(function(h){t+=", "+h.url}),t=t.substr(2);var D=f.createElement("style");D.innerText='@font-face{font-family: "'+l+'";src: '+t+";}",f.head.appendChild(D),qm[l]=D,p&&p(D)}}}}(),clearFontFace:function(){if(!Cp(qm)){for(var d in qm)K.removeFontFace(d);qm={}}},removeFontFace:function(k,I){if(k){var r=k;if(r.tagName){if(gl(r),I){var D=[];for(var x in qm)qm[x]===r&&D.push(x);var y=D.length;if(y>0)for(var u=0,y=D.length;y>u;u++)delete qm[D[u]]}}else(r=qm[k])&&(gl(r),I&&delete qm[k])}},getFontFaceMap:function(){return qm},handleFontFacesLoaded:function(){}},!0),f&&f.fonts&&f.fonts.addEventListener&&f.fonts.addEventListener("loadingdone",function(Y){K.handleFontFacesLoaded(Y.fontfaces),K.findView("all").forEach(function(p){p.redraw?p.redraw():p.iv()})}),Sn(C,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var vl=K.disabledOpacity,nf=K.toolTipDelay,qq=K.devicePixelRatio,Kc=K.autoMakeVisible,Vb=K.autoHideScrollBar,Ki=K.imageGradient,Zj=K.showToolTip,mb=K.hideToolTip,fj=K.dashPattern,Vg=K.lineCap,Wh=K.lineJoin,Hq=K.labelColor,Km=K.labelSelectColor,Th=K.labelFont,Qn=K.widgetIndent,wg=K.widgetRowHeight,kk=K.widgetHeaderHeight,yh=K.widgetTitleHeight,Pg=K.scrollBarColor,Lh=K.scrollBarSize,bo=K.scrollBarTimeout,Wl=K.scrollBarMinLength,hj=K.scrollBarInteractiveSize,Ik=K.zoomIncrement,Ng=K.scrollZoomIncrement,$k=K.pinchZoomIncrement,vd=K.zoomMax,pc=K.zoomMin,Im=K.createObject,up=K.preventDefault,wr=K.setImage,fl=K.getImage,Rn=K.isImageComplete,yb=K.drawCenterImage,_c=K.drawStretchImage,jc=K.getId,dd=K.callLater,Jc=K.cancelLater,As=K.sortFunc,fo=K.clone,Zp=K.getClass,he=K.startAnim,sm=K.brighter,th=K.darker,_k=K.drawText,_p=K.getTextSize,kp=K.isLeftButton,Ym=K.isMiddleButton,tr=K.isRightButton,sf=K.getTouchCount,dh=K.isDoubleClick,um=K.isShiftDown,Bj=K.isCtrlDown,Tk=K.getClientPoint,$j=K.getPagePoint,nk=K.getDistance,Nd=K.unionPoint,jm=K.unionRect,mg=K.containsPoint,ld=K.containsRect,mn=K.intersectsRect,rd=K.intersection,Gc=K.getWindowInfo,rk=K.grow,Fg=K.getLogicalPoint,fc=K.getScreenPoint,Mj=K.startDragging,gl=K.removeHTML,bb=K.createElement,vm=K.segmentResolution,on=K.shapeResolution,Lb=K.shapeSide,gd=K.def,lq=function(r,Z,j){gd(M+"."+r,Z,j)},Aq=function(H,r){H.childNodes.forEach(function(c){r(c),Aq(c,r)})};Sn(K,{toolTipLabelColor:Hq,toolTipLabelFont:Th,toolTipBackground:T.toolTipBackground,toolTipShadowColor:ml,debugTipLabelFont:Th,debugTipLabelColor:Hq,debugTipBackground:T.toolTipBackground,drawBreakableText:ai,setDevicePixelRatio:function(n){qq=K.devicePixelRatio="number"==typeof n?n:qn(Q),Aq(f.body,function(G){var E=G._ht;E&&E._canvas&&(Gm(E._canvas,E.getWidth(),E.getHeight()),E.redraw?E.redraw():E.iv())})},getPosition3dGap:function(){return Rd()}},!0);var pq=1e-6,hi="undefined"!=typeof Uint16Array?Uint16Array:Array,jg="undefined"!=typeof Uint32Array?Uint32Array:hi,Ui="undefined"!=typeof Float32Array?Float32Array:Array,tf=function(N,Q,v){var J=[N[0]-Q[0],N[1]-Q[1],N[2]-Q[2]];if(v){var j=nk(J);j>0&&(J[0]/=j,J[1]/=j,J[2]/=j)}return J},uf=function(){var j="charCodeAt",D=2*(2*Ir.length+1);for(var f in Q)if(f===M+zi[0]+(yr.length+2)){var i=Q[f];if(!i)break;for(var k=i.length,h=0;k>h;h++)if(i[h][j](0)===D&&i[h+1]!=E&&i[h+1]===yr[0]&&i[h+2]!=E&&i[h+2][j](0)===D){for(var c=h+3;k>c;c++)if(i[c][j](0)===D){if(0==i[c+1])for(var Z,q=c+2;k>q;q++){if(i[q][j](0)===D){0==i[q-1]&&Z&&(br=Z.substr(0,Z.length-1));break}Z==E?Z=i[q]:Z+=i[q]}break}break}break}return function(F){return[-F[0],-F[1],-F[2]]}}(),tc=function(J,w){return 3===J.length?J[0]*w[0]+J[1]*w[1]+J[2]*w[2]:J[0]*w[0]+J[1]*w[1]},Tc=function(){var D=new Array(16);return D[0]=1,D[1]=0,D[2]=0,D[3]=0,D[4]=0,D[5]=1,D[6]=0,D[7]=0,D[8]=0,D[9]=0,D[10]=1,D[11]=0,D[12]=0,D[13]=0,D[14]=0,D[15]=1,D},Jm=Tc(),mf=function(d){var F=new Array(16);return F[0]=d[0],F[1]=d[1],F[2]=d[2],F[3]=d[3],F[4]=d[4],F[5]=d[5],F[6]=d[6],F[7]=d[7],F[8]=d[8],F[9]=d[9],F[10]=d[10],F[11]=d[11],F[12]=d[12],F[13]=d[13],F[14]=d[14],F[15]=d[15],F},Oe=function(r,j){return r[0]=j[0],r[1]=j[1],r[2]=j[2],r[3]=j[3],r[4]=j[4],r[5]=j[5],r[6]=j[6],r[7]=j[7],r[8]=j[8],r[9]=j[9],r[10]=j[10],r[11]=j[11],r[12]=j[12],r[13]=j[13],r[14]=j[14],r[15]=j[15],r},db=function(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},kc=function(P,M){var j=P[0],F=P[1],_=P[2];return P[0]=M[0]*j+M[4]*F+M[8]*_+M[12],P[1]=M[1]*j+M[5]*F+M[9]*_+M[13],P[2]=M[2]*j+M[6]*F+M[10]*_+M[14],P},El=function(R,L){var d=R[0],v=R[1],i=R[2],J=R[3];return R[0]=L[0]*d+L[4]*v+L[8]*i+L[12]*J,R[1]=L[1]*d+L[5]*v+L[9]*i+L[13]*J,R[2]=L[2]*d+L[6]*v+L[10]*i+L[14]*J,R[3]=L[3]*d+L[7]*v+L[11]*i+L[15]*J,R},Gq=function(){var F,D,k,d,L=fi(cm[1]+cm[7]),I=fi(cm[0]+cm[3]-cm[10]),W=fi(cm[8]+2),x=function(){return D=k.charAt(F),F+=1,D},S=function(){var b="";if(D===W)for(;x();){if(D===W)return x(),b;b+=D}else x()},V=function(){for(;D&&" ">=D;)x()},Z=function(){var $,i={};if(D===L){if(x(),V(),D===I)return x(),i;for(;D;){if($=S(),V(),x(),i[$]=d(),V(),D===I)return x(),i;x(),V()}}};return d=function(){switch(V(),D){case L:return Z();default:return S()}},function(s){if(y={},s){var x;if(k=s,F=0,D=" ",x=d(),V(),!D)return x}}}(),uo=function(U,h){if(h){var T=l(h),M=W(h),O=U[4],B=U[5],i=U[6],o=U[7],P=U[8],e=U[9],K=U[10],N=U[11];U[4]=O*M+P*T,U[5]=B*M+e*T,U[6]=i*M+K*T,U[7]=o*M+N*T,U[8]=P*M-O*T,U[9]=e*M-B*T,U[10]=K*M-i*T,U[11]=N*M-o*T}},rh=function(u,B){if(B){var C=l(B),D=W(B),p=u[0],i=u[1],Z=u[2],V=u[3],Y=u[8],G=u[9],E=u[10],e=u[11];u[0]=p*D-Y*C,u[1]=i*D-G*C,u[2]=Z*D-E*C,u[3]=V*D-e*C,u[8]=p*C+Y*D,u[9]=i*C+G*D,u[10]=Z*C+E*D,u[11]=V*C+e*D}},Ao=function($,C){if(C){var v=l(C),i=W(C),T=$[0],Q=$[1],L=$[2],c=$[3],j=$[4],M=$[5],p=$[6],Z=$[7];$[0]=T*i+j*v,$[1]=Q*i+M*v,$[2]=L*i+p*v,$[3]=c*i+Z*v,$[4]=j*i-T*v,$[5]=M*i-Q*v,$[6]=p*i-L*v,$[7]=Z*i-c*v}},$f=function(z,L,k){return Gg(E,k===!1?E:z.getFinalScale3d(),z.getFinalRotation3d(),z.getRotationMode(),z.p3(),E,L)},Gg=function(H,d,h,i,c,o,P){return o||(o=Tc()),c&&sp(o,c),Qc(o,h,i),P&&Cq(o,o,P),d&&vc(o,d),H&&Cq(o,o,H),o},Zl=function(c,D,U){D=sr(D),U=sr(U);var Q=this;Q.g=c,Q._84O=D,Q._85O=U,Q._70I=!0,Q.F=0,Q._83O=D+U,Q.pen={x:0,y:0}},Bp="lineDashOffset",lg="setLineDash",Zh=function(i){for(var y in i)1===y.length&&(Bp=i[y]);return y?1:0},Ii=function(I,_,n){return Ug(_)?I:I[lg]?(I[lg](_),n&&(I.lineDashOffset=n),I):new Zl(I,_[0],_.length>1?_[1]:_[0])},ks=function(p,B){!Ug(B)&&p[lg]&&(p[lg](of),p.lineDashOffset=0)};gd(Zl,O,{_69I:6,moveTo:function(H,S){var J=this,m=J.pen;m.x=H,m.y=S,J.g.moveTo(H,S),J.start||(J.start={x:H,y:S})},lineTo:function(s,J){var $=this,e=$.pen,z=s-e.x,b=J-e.y,f=Hr(b,z),j=W(f),q=l(f),M=$._23O(e.x,e.y,s,J),K=$._85O,O=$._84O,c=$._83O;if($.F){if($.F>M)return $._70I?$._72I(s,J):$.moveTo(s,J),$.F-=M,void 0;if($._70I?$._72I(e.x+j*$.F,e.y+q*$.F):$.moveTo(e.x+j*$.F,e.y+q*$.F),M-=$.F,$.F=0,$._70I=!$._70I,!M)return}var A=X(M/c);if(A){for(var D=j*O,w=q*O,m=j*K,H=q*K,k=0;A>k;k++)$._70I?($._72I(e.x+D,e.y+w),$.moveTo(e.x+m,e.y+H)):($.moveTo(e.x+m,e.y+H),$._72I(e.x+D,e.y+w));M-=c*A}$._70I?M>O?($._72I(e.x+j*O,e.y+q*O),$.moveTo(s,J),$.F=K-(M-O),$._70I=!1):($._72I(s,J),M===O?($.F=0,$._70I=!$._70I):($.F=O-M,$.moveTo(s,J))):M>K?($.moveTo(e.x+j*K,e.y+q*K),$._72I(s,J),$.F=O-(M-K),$._70I=!0):($.moveTo(s,J),M===K?($.F=0,$._70I=!$._70I):$.F=K-M)},quadraticCurveTo:function($,k,Z,A){var _,g=this,O=g.pen,x=O.x,M=O.y,p=g._22O(x,M,$,k,Z,A),l=0,y=0,c=g._85O,Q=g._84O;if(g.F){if(g.F>p)return g._70I?g._71I($,k,Z,A):g.moveTo(Z,A),g.F-=p,void 0;if(l=g.F/p,_=g._20O(x,M,$,k,Z,A,l),g._70I?g._71I(_[2],_[3],_[4],_[5]):g.moveTo(_[4],_[5]),g.F=0,g._70I=!g._70I,!p)return}var G=p-p*l,n=X(G/g._83O),o=Q/p,T=c/p;if(n)for(var W=0;n>W;W++)g._70I?(y=l+o,_=g._21O(x,M,$,k,Z,A,l,y),g._71I(_[2],_[3],_[4],_[5]),l=y,y=l+T,_=g._21O(x,M,$,k,Z,A,l,y),g.moveTo(_[4],_[5])):(y=l+T,_=g._21O(x,M,$,k,Z,A,l,y),g.moveTo(_[4],_[5]),l=y,y=l+o,_=g._21O(x,M,$,k,Z,A,l,y),g._71I(_[2],_[3],_[4],_[5])),l=y;G=p-p*l,g._70I?G>Q?(y=l+o,_=g._21O(x,M,$,k,Z,A,l,y),g._71I(_[2],_[3],_[4],_[5]),g.moveTo(Z,A),g.F=c-(G-Q),g._70I=!1):(_=g._19O(x,M,$,k,Z,A,l),g._71I(_[2],_[3],_[4],_[5]),p===Q?(g.F=0,g._70I=!g._70I):(g.F=Q-G,g.moveTo(Z,A))):G>c?(y=l+T,_=g._21O(x,M,$,k,Z,A,l,y),g.moveTo(_[4],_[5]),_=g._19O(x,M,$,k,Z,A,y),g._71I(_[2],_[3],_[4],_[5]),g.F=Q-(G-c),g._70I=!0):(g.moveTo(Z,A),G===c?(g.F=0,g._70I=!g._70I):g.F=c-G)},bezierCurveTo:function(){var P=arguments;this.pen={x:P[4],y:P[5]},this.g.bezierCurveTo(P[0],P[1],P[2],P[3],P[4],P[5])},arc:function($,u,d,H,J,f){f||(H=-H,J=-J),Ip(this,$,u,H,J-H,d,d,!1)},rect:function(u,D,g,q){var _=this;_.pen={x:u,y:D},_.moveTo(u,D),_.lineTo(u,D+q),_.lineTo(u+g,D+q),_.lineTo(u+g,D),_.lineTo(u,D)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(w,x,J,N){var f=J-w,h=N-x;return A(f*f+h*h)},_22O:function($,k,z,H,I,n,T){for(var m,b,e,K,F,R,D,d=0,G=$,O=k,Y=T>0?T:this._69I,U=1;Y>=U;U++)e=U/Y,K=1-e,F=K*K,R=2*e*K,D=e*e,m=F*$+R*z+D*I,b=F*k+R*H+D*n,d+=this._23O(G,O,m,b),G=m,O=b;return d},_21O:function(T,P,L,S,V,J,r,p){var y=this;if(0===r)return y._20O(T,P,L,S,V,J,p);if(1===p)return y._19O(T,P,L,S,V,J,r);var F=y._20O(T,P,L,S,V,J,p);return F.push(r/p),y._19O.apply(y,F)},_20O:function(P,Z,k,A,q,O,s){if(1!==s){var V=k+(q-k)*s,U=A+(O-A)*s;k=P+(k-P)*s,A=Z+(A-Z)*s,q=k+(V-k)*s,O=A+(U-A)*s}return[P,Z,k,A,q,O]},_19O:function(P,c,R,y,v,N,Z){if(1!==Z){var t=P+(R-P)*Z,q=c+(y-c)*Z;R+=(v-R)*Z,y+=(N-y)*Z,P=t+(R-t)*Z,c=q+(y-q)*Z}return[P,c,R,y,v,N]},_72I:function(N,H){var m=this.pen;(N!==m.x||H!==m.y)&&(m.x=N,m.y=H,this.g.lineTo(N,H))},_71I:function(z,P,A,Q){var Z=this.pen;(z!==A||P!==Q||A!==Z.x||Q!==Z.y)&&(Z.x=A,Z.y=Q,this.g.quadraticCurveTo(z,P,A,Q))}}),wp.ms_quickVisible=function(t){t._4BQ=!1,t._4CQ=function(t){var y=t._4EQ;return y!==P?y:y=t._4EQ=this._4FQ(t)},t._4DQ=function(s){if(!s)return this.dm().each(function(F){F._4EQ=P}),void 0;s._4EQ=P;var R=this;if(s instanceof aq||Kp(s)||s instanceof Sg||s.ISubGraph)s.eachChild(function(K){R.invalidateQuickVisible(K)});else if(s.getEdges){var F=s.getEdges();F&&F.each(function(S){R.invalidateQuickVisible(S)})}},t.enableQuickVisibleMode=function(){this._4BQ||(this._4BQ=!0,this._4FQ=this.isVisible,this.isVisible=this._4CQ,this.invalidateQuickVisible=this._4DQ)},t.disableQuickVisibleMode=function(){this._4BQ&&(this._4BQ=!1,this.isVisible=this._4FQ,this.invalidateQuickVisible=Aj)},t.isQuickVisibleMode=function(){return this._4BQ},t.invalidateQuickVisible=Aj},Rh=Cn()+1,Zr&&Q.console&&Rh&&!1&&(Q.navigator&&Q.navigator.userAgent.toLowerCase().indexOf("chrome")>-1?Q.console.log.apply(console,["Hightopo - Version"+h.Default.getVersion()+" - %cTrialhttp://hightopo.com/request.html","color: #f00;"]):Q.console.log("Hightopo - Version"+h.Default.getVersion()+" - Trialhttp://hightopo.com/request.html"));var wd=E,Sf=E,cg=K.checkLoadingCompType=function(o){wd&&!o._72O_&&(Sf||(Sf={}),Sf[o._72O_=jc()]=o)},dm=function(i,D){if(D||(D=i),D&&(wd||(wd={}),!wd[i])){var Z=new rb;if(wd[D]={request:Z,url:D},D=K.beforeLoadURL(D,i),D.data){var g=K.parse(D.data);Mh(i,g),K.handleCompTypeLoaded(i,g)}else{Z.onload=function(){if(200===this.status||0===this.status){var D=K.parse(Z.getResponseText());Mh(i,D),K.handleCompTypeLoaded(i,D)}else Mh(i,E)},Z.onerror=function(){Mh(i,E)};var S={};S.url=encodeURI(D),S.sync=!1,Z.send(S)}}},Mh=function(U,g){if(Gi[U]=g,delete wd[U],Cp(wd)&&(wd=E,Sf)){for(var Y in Sf){var n=Sf[Y];n.invalidateAll&&n.invalidateAll(P,"compTypeLoaded",U),n.redraw&&n.redraw(),n.iv(),delete n._72O_}Sf=E}if(g&&Sf)for(var Y in Sf){var n=Sf[Y];n.invalidateAll&&n.invalidateAll(P,"compTypeLoading",U),n.redraw&&n.redraw(),n.iv()}},ki=T.chart,ip="",Fd=!0,eh=K.compStack=[],Xn=/^style@/,ve=/^attr@/,Bb=/^field@/,cq={x:.5,y:.5},Wn=function(){Fd=!0},gq=function(){return Fd},Hc=function(p,j,O){if(!p)return!1;var f;return O&&O.isImageFitSize&&(f=O.isImageFitSize(j,p)),f==E&&(f=as(p.fitSize,j,O)),f},_r=function(k,Y,D,R){if(!k)return 0;if(Hc(k,Y,D)&&R)return R;var P=as(k.width,Y,D);return null==P?20:P},wm=function(z,Y,Z,r){if(!z)return 0;if(Hc(z,Y,Z)&&r)return r;var U=as(z.height,Y,Z);return null==U?20:U},as=function(j,e,u){if(!j||!j.func)return j;var r,J=j.func,w=j.value;return r=tj(J)?u&&u.vectorDataBindingDisabled&&!j.isSafeFunc?w:J(e,u):e instanceof Lk||(h.ui?e instanceof h.ui.View:0)?ve.test(J)?e.a(ip+J.slice(5)):Xn.test(J)?e.s(ip+J.slice(6)):Bb.test(J)?e[J.slice(6)]:e[J]?e[J](u):w:w,w!==P&&r==E?w:r},Pp=K.drawImage=function(){var X,s,R,b,B,S,i=3,C=6,m=function(o,l){o.getValue&&o.getValue.compType===l||(o.getValue=function(I){var y=V(o,I);if(y===P&&l.properties){var x=l.properties[I];x&&(y=x.defaultValue)}return y},o.getColor=function(A,H){return H===!0?e(A):e(o.getValue(A))},o.getValue.compType=l)},V=function(K,F,Z){var A,h=!1;if(K.prefix&&s instanceof Lk){var S=s.a(ip+F);S!==P&&(h=!0,A=S)}return A===P&&(A=K[F]),A&&A.func&&(h=!0,A=as(A,s,R)),Z&&(A=Z(A),h||(K[F]=A)),A},e=function(y,Y){var b;return b=Y?V(y,Y):y,X&&X.compGray&&b?K.toGrayColor(b):B&&b?tb(b,B,S):b},t=function(J){if(bs(J)){for(var x=new oc,d=J.length,g=0;d>g;g+=2)x.add({x:J[g],y:J[g+1]});J=x}return J},M=function(i){var U=V(i,"anchorX"),h=V(i,"anchorY");if(U!==P||h!==P)return{x:U===P?cq.x:U,y:h===P?cq.y:h};var F=V(i,"type"),S=V(i,"name");if("image"!==F||!S)return cq;var v=fl(S);return v&&v.anchorX!==P&&v.anchorY!==P?{x:v.anchorX,y:v.anchorY}:cq},p=function(K,a){var d=V(K,Vd),l=M(K);if(bs(d)){var O=d.length,t=V(K,"relative"),X=a.width,_=a.height;if(4===O)d={x:d[0],y:d[1],width:d[2],height:d[3]},t&&(d.x*=X,d.y*=_,d.width*=X,d.height*=_);else if(3===O){var j=d[0];d={width:d[1],height:d[2]},t&&(d.width*=X,d.height*=_),"object"==typeof j?j.length&&(j={x:j[0],y:j[1]}):j=Ac(j,a,d),d.x=j.x-d.width*l.x,d.y=j.y-d.height*l.y}d.x+=V(K,"offsetX")||0,d.y+=V(K,"offsetY")||0,!t&&a.fitSize&&(d=r(K,d,a))}return d},r=function(i,D,w){if(D){var T,P,s,y={x:D.x,y:D.y,width:D.width,height:D.height},L=M(i),z=V(i,"layoutH"),S=V(i,"layoutV"),I=1,F=1,O=0,G=0,A=1,d=1;switch(z){case"left":break;case"right":y.x+=w.width-w.rw;break;case"center":y.x+=.5*(w.width-w.rw);break;case"scale":case"leftright":default:T=V(i,Wk)||0,T&&(O=Math.abs(G=Math.sin(T)),A=Math.abs(d=Math.cos(T))),"leftright"!==z?(I+=A*(w.widthScale-1),F+=O*(w.widthScale-1)):(I+=y.width?A*(w.width-w.rw)/y.width:0,F+=y.height?O*(w.width-w.rw)/y.height:0,P=-Math.min(-L.x*d+L.y*G,-L.x*d-(1-L.y)*G,(1-L.x)*d+L.y*G,(1-L.x)*d-(1-L.y)*G))}switch(S){case"top":break;case"bottom":y.y+=w.height-w.rh;break;case"center":y.y+=.5*(w.height-w.rh);break;case"scale":case"topbottom":default:T==E&&(T=V(i,Wk),T&&(O=Math.abs(G=Math.sin(T)),A=Math.abs(d=Math.cos(T)))),"topbottom"!==S?(I+=O*(w.heightScale-1),F+=A*(w.heightScale-1)):(I+=y.width?O*(w.height-w.rh)/y.width:0,F+=y.height?A*(w.height-w.rh)/y.height:0,s=-Math.min(-L.x*G-L.y*d,-L.x*G+(1-L.y)*d,(1-L.x)*G-L.y*d,(1-L.x)*G+(1-L.y)*d))}return(1!==I||1!==F)&&("scale"!==z&&z?"leftright"===z&&(y.x+=y.width*(1-I)*L.x+P*(w.width-w.rw)):y.x+=y.x*(w.widthScale-1)+L.x*y.width*(w.widthScale-I),"scale"!==S&&S?"topbottom"===S&&(y.y+=y.height*(1-F)*L.y+s*(w.height-w.rh)):y.y+=y.y*(w.heightScale-1)+L.y*y.height*(w.heightScale-F),y.width*=I,y.height*=F),y.width<0&&(y.width=0),y.height<0&&(y.height=0),y}},x=function(d){return bs(d)?new oc(d):d},O=function(B,z,L,I,$,U,F){var N=X.interactiveInfo,g=B.transform;if(g)return X.save(),X.setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),N&&N.compInfos.push({comp:B,rect:z,matrix:g.clone(),prefix:ip,refRect:N.refRect}),!0;$===P&&($=1),U===P&&(U=1);var l=V(B,"clipPercentage"),f=sl(L,z);if(f&&!I&&1===$&&1===U&&l==P)return N&&N.compInfos.push({comp:B,rect:z,matrix:N.matrix.clone(),prefix:ip,refRect:N.refRect}),!1;F=F||cq;var n=z.x+z.width*F.x,b=z.y+z.height*F.y,u=L.x+L.width*F.x,O=L.y+L.height*F.y,h=L.width?$*(z.width/L.width):1,t=L.height?U*(z.height/L.height):1;if(X.save(),N&&(N.matrix.appendTranslate(n,b).appendRotate(I).appendScale(h,t).appendTranslate(-u,-O),N.compInfos.push({comp:B,rect:z,matrix:N.matrix.clone(),prefix:ip,refRect:N.refRect})),xc(X,n,b),pl(X,I||0),Hl(X,h,t),xc(X,-u,-O),l!=P){var G=fg(L,V(B,"clipDirection"),l);X.beginPath(),X.rect(G.x,G.y,G.width,G.height),X.clip()}return!0},$=function(){X.restore()},y=function(y,_,S){var K=V(y,"path"),u=V(y,Wk),A=V(y,"scaleX"),W=V(y,"scaleY"),g=M(y),R=E,w=Fj(null,K);if(S||(S=y.unionRect,S||(S=Nd(w),y.path.func||(y.unionRect=S)),R=S),S){R||(R=y.unionRect,R||(R=Nd(w),y.path.func||(y.unionRect=R)));var j=O(y,S,R,u,A,W,g),L=V(y,"borderPattern"),t=Ii(X,L),I=e(y,"background"),i=e(y,"borderColor"),D=V(y,"borderWidth"),o=V(y,"gradient"),m=e(y,"gradientColor"),U=V(y,"border3d"),k=e(y,"border3dColor"),C=V(y,"border3dAccuracy"),Z=X.lineJoin,P=X.lineCap;X.lineJoin=V(y,"borderJoin")||Wh,X.lineCap=V(y,"borderCap")||Vg,I?(ln(X,I,o,m,R),Fj(X,K),X.fill(),t!==X&&Fj(X,K)):Fj(X,K);var d=V(y,"borderWidthAbsolute");if(d&&(X.save(),X.setTransform(1,0,0,1,0,0)),D&&i&&(X.lineWidth=D,X.strokeStyle=i,X.stroke(),U&&Bc(X,i,k,D,b,C)),ks(X,L),V(y,"dash")){var h=V(y,"dashWidth")||D;if(h>0){L=V(y,"dashPattern")||fj;var t=Ii(X,L,V(y,"dashOffset")),s=e(y,"dashColor")||e(Ur);t!==X&&Fj(X,K),X.strokeStyle=s,X.lineWidth=h,X.stroke(),V(y,"dash3d")&&Bc(X,s,e(y,"dash3dColor"),h,b,V(y,"dash3dAccuracy")),ks(X,L)}}d&&X.restore(),_===Vd&&Pd(X,I,V(y,"depth"),R),X.lineJoin=Z,X.lineCap=P,j&&$()}},u=function(g,v,C,k){var u=V(g,Qr,t),j=V(g,Wk),z=M(g);if(u&&k.fitSize){var W=new oc,_=Nd(u),y=r(g,_,k),m=_.x+z.x*_.width,T=_.y+z.y*_.height,n=y.x+z.x*y.width,f=y.y+z.y*y.height,K=_.width?y.width/_.width:1,Q=_.height?y.height/_.height:1;u.each(function(Z){W.add({x:n+(Z.x-m)*K,y:f+(Z.y-T)*Q})}),u=W,g.unionRect=null}var h=V(g,"scaleX"),L=V(g,"scaleY"),o=v===Ph,F=E;if(!C&&o&&(C=g.unionRect,C||(C=Nd(u),g.points.func||(g.unionRect=C)),F=C),C){o?F||(F=g.unionRect,F||(F=Nd(u),g.points.func||(g.unionRect=F))):F=C;var U,d,N,c,p=O(g,C,F,j,h,L,z),D=V(g,"borderPattern"),i=Ii(X,D),G=e(g,"background"),H=fl(V(g,"repeatImage"),B,S),I=V(g,"gradientPack"),A=V(g,"borderGradientPack"),l=e(g,"borderColor"),q=V(g,"borderWidth"),Y=fl(V(g,"borderRepeatImage"),B,S),a=V(g,"segments",x),w=V(g,"gradient"),J=e(g,"gradientColor"),Z=V(g,"border3d"),Lm=e(g,"border3dColor"),li=V(g,"border3dAccuracy"),Dq=V(g,"closePath"),qp=V(g,"fillRule")||"nonzero",fp=X.lineJoin,ec=X.lineCap;if(X.lineJoin=V(g,"borderJoin")||Wh,X.lineCap=V(g,"borderCap")||Vg,o)if(G||H||I){var sq=V(g,"fillClipPercentage");if(sq!=P){var Kd=fg(F,V(g,"fillClipDirection"),sq);X.save(),X.beginPath(),X.rect(Kd.x,Kd.y,Kd.width,Kd.height),X.clip()}xj(X,u,a,Dq),I?nn(X,I,e,!1,F):H?vb(X,H,B,S,s,R):ln(X,G,w,J,F),X.fill(qp),I&&X.restore(),sq!=P&&X.restore(),i!==X&&xj(i,u,a,Dq)}else xj(i,u,a,Dq);else if("roundRect"===v?U=V(g,"cornerRadius"):"polygon"===v?(U=V(g,"polygonSide"),d=V(g,"cornerRadius"),N=V(g,"regular")):"arc"===v&&(U=V(g,"arcFrom"),d=V(g,"arcTo"),N=V(g,"arcClose"),c=V(g,"arcOval")),G||H||I){var sq=V(g,"fillClipPercentage");if(sq!=P){var Kd=fg(F,V(g,"fillClipDirection"),sq);X.save(),X.beginPath(),X.rect(Kd.x,Kd.y,Kd.width,Kd.height),X.clip()}ug(X,v,F,U,d,N,c),I?nn(X,I,e,!1,F):H?vb(X,H,B,S,s,R):ln(X,G,w,J,F),X.fill(qp),I&&X.restore(),sq!=P&&X.restore(),X!==i&&ug(i,v,F,U,d,N,c)}else ug(i,v,F,U,d,N,c);var Gi=V(g,"borderWidthAbsolute");if(Gi&&(X.save(),X.setTransform(1,0,0,1,0,0)),q&&(l||Y||A)&&(X.lineWidth=q,A?nn(X,A,e,!0,F):Y?rj(X,Y,B,S,s,R):X.strokeStyle=l,X.stroke(),A&&X.restore(),Z&&Bc(X,l,Lm,q,b,li)),ks(X,D),V(g,"dash")){var Dj=V(g,"dashWidth")||q;if(Dj>0){D=V(g,"dashPattern")||fj;var i=Ii(X,D,V(g,"dashOffset")),mk=e(g,"dashColor")||e(Ur);i!==X&&(o?xj(i,u,a,Dq):ug(i,v,F,U,d,N,c)),X.strokeStyle=mk,X.lineWidth=Dj,X.stroke(),V(g,"dash3d")&&Bc(X,mk,e(g,"dash3dColor"),Dj,b,V(g,"dash3dAccuracy")),ks(X,D)}}Gi&&X.restore(),v===Vd&&Pd(X,G,V(g,"depth"),F),X.lineJoin=fp,X.lineCap=ec,p&&$()}},z=function(h,z){var J=B||V(h,$h),_=S||V(h,"blendMode"),K=V(h,"name"),t=fl(K,J,_);t&&t.cacheRule!=E&&(t=no(X,t,V(h,"stretch"),z.width,z.height,s,R,J)),t?_c(X,t,V(h,"stretch"),z.x,z.y,z.width,z.height,s,R,J,null,_):Fd=!1},v=function(g,b){var f=V(g,"text");if(f!=E){f+="";var H,O=V(g,"gradientPack"),w=V(g,"gradient"),l=e(g,"gradientColor"),W=V(g,"font"),D=V(g,"vertical"),i=V(g,"verticalGap")||0,t=V(g,"align"),Q=V(g,"vAlign"),u=V(g,"decoration"),r=V(g,"letterGap")||0,p=V(g,"wrap"),y=V(g,"borderWidth"),N=V(g,"borderColor"),s=_p(W,f);if(O?(H=nn(X,O,e,!1,b),X.restore()):H=e(g,$h),!O&&w&&(H=K.createGradient(X,w,H||K.labelColor,l||T.imageGradient,b.x,b.y,b.width,b.height)),y&&bs(N)&&(N=nn(X,N,e,!1,b),X.restore()),D){null==i&&(i=1);var P,J,v,o=[],h=[];P=p?Vq(f,b.height,W,r,D,i):[f],X.textBaseline=Mo,X.font=W,P.forEach(function(F){for(var b=F.length,A=0,z=(b-1)*i,K=0;b>K;K++){var f=X.measureText(F[K]);o.push(f),z+=f.fontBoundingBoxDescent||s.height,A=_(A,f.width)}h.push({width:A,height:z})});var M=(P.length-1)*r;h.forEach(function(z){M+=z.width}),J=t&&t!==zi?t===es?b.x+b.width-M:b.x+(b.width-M)/2:b.x;var R=0;P.forEach(function(l,E){var L=h[E],S=l.length;v=Q&&Q!==zh?Q===Mo?b.y:b.y+b.height-L.height:b.y+(b.height-L.height)/2;for(var x=0;S>x;x++){var m=l[x],I=o[R],A=I.fontBoundingBoxDescent||s.height;Ob(X,m,W,H,{x:J,y:v,width:L.width,height:A},Xj,Q,u,r,y,N),v+=A+i,R++}J+=L.width+r})}else{var P=p?Vq(f,b.width,W,r,D,i):f.split("\n"),L=P.length;if(L>1){var k=_p(W,f),z=k.height,I=L*z+i*(L-1),m=fo(b);return Q&&Q!==zh?Q===de&&(m.y=b.y+b.height-I):m.y=b.y+(b.height-I)/2,m.height=I,ai(X,P,m,W,H,t||zi,u,r,y,N),void 0}Ob(X,f,W,H,b,t,Q,u,r,y,N)}}},d=function(s,M){di(X,e(s,$h),M.x,M.y,M.width,M.height,V(s,"width"))},j=function(q,O){var x=V(q,ah),G=0;if(x&&(x.forEach(function(O){G+=O}),G>0)){for(var K=V(q,"colors")||ki,g=V(q,"startAngle")||0,p=V(q,"hollow"),n=V(q,em),j=V(q,ee),d=V(q,Yi),P=n?new oc:E,C=O.x,R=O.y,e=O.width,f=O.height,c=C+e/2,N=R+f/2,Y=I(e,f)/2,y=0,U=0;U<x.length;U++){var Z=x[U],w=a*Z/G,v=g+w;if(X.fillStyle=K[y++],y===K.length&&(y=0),X.beginPath(),p){var H=c+W(g)*Y/2,L=N+l(g)*Y/2,B=c+W(v)*Y,o=N+l(v)*Y;X.moveTo(H,L),X.arc(c,N,Y/2,g,v,!1),X.lineTo(B,o),X.arc(c,N,Y,v,g,!0)}else X.moveTo(c,N),X.arc(c,N,Y,v,g,!0);P&&(w=(g+v)/2,P.add({text:tj(n)?n(Z,U,G,s):Z,x:c+.75*W(w)*Y,y:N+.75*l(w)*Y})),X.closePath(),X.fill(),g=v}P&&P.each(function(i){_k(X,i.text,j,d,i.x,i.y,0,0,Xj)})}},k=function(W,P){var Q=V(W,ce);if(Q&&Q.length>0){var G=Q.length,I=V(W,em),D=V(W,ee),$=V(W,Yi),q=I?new oc:E,R=V(W,"minValue")||0,o=V(W,"maxValue");
if(o==E&&(o=0,Q.forEach(function(W){V(W,ah).forEach(function(b){o=_(o,b)})})),R===o)return;for(var d=P.height/(o-R),l=P.y+o*d,B=V(Q[0],ah).length,L=P.width/(3*B+1),F=2*L/G,k=0,M=0;G>M;M++)for(var n=Q[M],S=V(n,$h),Z=V(n,"colors"),g=V(n,ah),e=0;B>e;e++){Z?X.fillStyle=Z[e]:S?X.fillStyle=S:(X.fillStyle=ki[k++],k===ki.length&&(k=0));var Y=g[e],z=Y*d,a=P.x+(1+3*e)*L+M*F;if(cs(X,a,l-z,F,z),q){var h=tj(I)?I(Y,e,n,s):Y,f=_p(D,h).height;q.add({x:a,y:l-z-f,width:F,height:f,text:h})}}q&&q.each(function(i){_k(X,i.text,D,$,i.x,i.y,i.width,i.height,Xj)})}},n=function(U,I){var r=V(U,ce);if(r&&r.length>0){var x=r.length,q=V(r[0],ah).length,j=I.width/(3*q+1),Y=0,z=V(U,"maxValue"),w=V(U,em),S=V(U,ee),J=V(U,Yi),t=w?new oc:E;if(z==E){z=0;for(var N=0;q>N;N++){for(var k=0,o=0;x>o;o++)k+=V(r[o],ah)[N];z=_(z,k)}}if(z>0){for(var N=0;q>N;N++)for(var $=I.y+I.height,o=0;x>o;o++){var R=r[o],Z=V(R,$h),F=V(R,ah)[N],P=F/z*I.height;Z?X.fillStyle=Z:(X.fillStyle=ki[Y++],Y===ki.length&&(Y=0)),$-=P;var T={x:I.x+(1+3*N)*j,y:$,width:2*j,height:P};cs(X,T.x,T.y,T.width,T.height),t&&(T.text=tj(w)?w(F,N,R,s):F,t.add(T))}t&&t.each(function(N){_k(X,N.text,S,J,N.x,N.y,N.width,N.height,Xj)})}}},G=function(D,T){var S=V(D,ce);if(S&&S.length>0){for(var K=S.length,C=V(S[0],ah).length,z=T.width/(3*C+1),k=0,A=V(D,em),J=V(D,ee),e=V(D,Yi),m=A?new oc:E,p=0;C>p;p++){for(var d=0,l=0;K>l;l++)d+=V(S[l],ah)[p];if(d>0){var B=T.y+T.height;for(l=0;K>l;l++){var t=S[l],w=V(t,$h),Y=V(t,ah)[p],$=Y/d*T.height;w?X.fillStyle=w:(X.fillStyle=ki[k++],k===ki.length&&(k=0)),B-=$;var W={x:T.x+(1+3*p)*z,y:B,width:2*z,height:$};cs(X,W.x,W.y,W.width,W.height),m&&(W.text=tj(A)?A(Y,p,t,s):Y,m.add(W))}}}m&&m.each(function(q){_k(X,q.text,J,e,q.x,q.y,q.width,q.height,Xj)})}},L=function(H,d){var U=V(H,ce);if(U&&U.length>0){var u=U.length,t=V(H,"minValue")||0,z=V(H,"maxValue");if(z==E&&(z=0,U.forEach(function(C){V(C,ah).forEach(function(Q){z=_(z,Q)})})),t===z)return;for(var D=d.height/(z-t),N=d.y+z*D,r=V(U[0],ah).length,k=d.width/(3*r+1),q=0,L=V(H,"lineWidth")||2,v=V(H,"line3d"),m=V(H,"linePoint"),Q=V(H,em),Y=V(H,ee),$=V(H,Yi),w=0;u>w;w++){var R=U[w],j=V(R,$h),O=V(R,ah);j?X.strokeStyle=j:(j=X.strokeStyle=ki[q++],q===ki.length&&(q=0)),X.beginPath();for(var I=0;r>I;I++){var y=d.x+(2+3*I)*k,P=N-O[I]*D;0===I?X.moveTo(y,P):X.lineTo(y,P)}if(X.lineWidth=L,X.stroke(),v&&Bc(X,j,E,L,b),m||Q){var g,F=L/2+2;for(I=0;r>I;I++){var c=O[I];if(y=d.x+(2+3*I)*k,P=N-c*D,tj(m)?m(X,y,P,j,I,R,s):m&&(X.fillStyle=j,X.beginPath(),X.arc(y,P,F,0,a,!0),X.fill()),tj(Q)?g=Q(c,I,R,s):Q&&(g=c),g){var J=_p(Y,g).height,M=X.shadowBlur;if(M){var S=X.shadowOffsetX,e=X.shadowOffsetY,C=X.shadowColor;X.shadowOffsetX=0,X.shadowOffsetY=0,X.shadowBlur=0,X.shadowColor=E}_k(X,g,Y,$,y,P-J-F+2,0,J,Xj),M&&(X.shadowOffsetX=S,X.shadowOffsetY=e,X.shadowBlur=M,X.shadowColor=C)}}}}}},f=function(n){X=n[0],s=n[1],R=n[2],b=n[3],B=n[4],S=n[5]},D=function(){return[X,s,R,b,B,S]},N=function(i,C){var H;R&&R.getDrawableState?H=R.getDrawableState(s):R&&R.getState?H=R.getState(s):(H=s instanceof Lk?s.s(qp):null,(H===P||null===H)&&(H=V(i,qp)));var Z=V(C,qp);return Z!==P&&null!==Z&&Z!==H?!1:V(C,Fm)},H={border:d,image:z,text:v,pieChart:j,columnChart:k,stackedColumnChart:n,percentageColumnChart:G,lineChart:L};return function(A,c,T,q,z,l,Z,a,L,w){if(c&&z&&l){var U=D();X=A,s=Z,R=a,!s&&R&&R.isSelfViewEvent&&(s=R),b=R?R._zoom?R._zoom:1:1,B=L,S=w;var o=z,G=l;if(eo()){var d,j,I,W,Y,k,r;0===X[Mg]?eo[0]&&(d=!0):d=!0,X.texureImage2D?eo[1]&&(j=!0):j=!0,X.texureImage3D?eo[2]&&(I=!0):I=!0,X.drawDNDState?eo[3]&&(Y=!0):Y=!0,X.drawRect?eo[ee[2]]&&(r=!0):r=!0,h[Dh[1]+dj[0]+Ig[1]]?eo[dj[0]]&&(k=!0):k=!0,Jd.widget[0]?eo[4]&&(W=!0):W=!0,d&&j&&I&&W&&Y&&k&&r&&(o=T,G=q)}if(c.tagName)return Om(br)&&!Q[br]||X.drawImage(c,o,G,z,l),f(U),void 0;if(0==V(c,"visible"))return f(U),void 0;B||(B=as(c.color,s,R)),w||(S=as(c.blendMode,s,R)),Om(br)&&!Q[br]&&(z=o,l=G);var J=_r(c,s,R,z),g=wm(c,s,R,l),n={x:0,y:0,width:J,height:g,fitSize:Hc(c,s,R)},_=V(c,"clip"),v=V(c,"opacity");if(n.fitSize){var F=n.rw=as(c.width,s,R)||20;n.widthScale=J/F;var Ud=n.rh=as(c.height,s,R)||20;n.heightScale=g/Ud}if(X.save(),X.interactiveInfo){var qf=X.interactiveInfo.matrix,sq=qf.clone();qf.appendTranslate(o,G).appendScale(z/J,l/g),X.interactiveInfo.refRect=n}xc(X,o,G),(J!==z||g!==l)&&X.scale(z/J,l/g),_&&(tj(_)?_(X,J,g,s,R,c):(X.beginPath(),X.rect(0,0,J,g),X.clip())),v!=E&&(X.globalAlpha*=v),V(c,"comps").forEach(function(j){if(j.prefix){var w=ip,L=as(j.prefix,s,R);L&&(ip=ip+L+".")}if(0==N(c,j))return j.prefix&&(ip=w),void 0;if(eh.splice(0,0,j),X.interactiveInfo)var S=X.interactiveInfo.matrix.clone();var v=V(j,"opacity"),_=V(j,"shadow"),W=V(j,"type"),A=V(j,"refRect")||n,T=p(j,A);if(v!=E){var o=X.globalAlpha;X.globalAlpha*=v}if(_){var Q=b*K.devicePixelRatio,F=X.shadowOffsetX,J=X.shadowOffsetY,q=X.shadowBlur,Y=X.shadowColor,k=V(j,"shadowOffsetX"),f=V(j,"shadowOffsetY"),r=V(j,"shadowBlur"),G=e(j,"shadowColor");X.shadowOffsetX=(k==E?i:k)*Q,X.shadowOffsetY=(f==E?i:f)*Q,X.shadowBlur=(r==E?C:r)*Q,X.shadowColor=G||e(Yc)}if("save"===W)X.save();else if("endClip"===W||"restore"===W)X.restore();else if("clip"===W)X.save(),xj(X,V(j,"points",t),V(j,"segments",x),!0),X.clip();else if(Sj[W]){if(T=T||{x:0,y:0,width:A.width,height:A.height},u(j,W,T,A),j.prefix&&0===j.prefix.indexOf("ui.")&&R&&h.ui&&R instanceof h.ui.View){R._vectorCompInfo||(R._vectorCompInfo=[]);for(var z=!1,B=0;B<R._vectorCompInfo.length;B++){var g=R._vectorCompInfo[B];if(j.prefix===g.comp.prefix&&Z===g.data){R._vectorCompInfo[B]={comp:j,type:W,rect:T,compRefRect:A,data:Z,image:c,transform:X.getTransform()},z=!0;break}}z||R._vectorCompInfo.push({comp:j,type:W,rect:T,compRefRect:A,data:Z,image:c,transform:X.getTransform()})}}else if(W===Ph)u(j,W,T,A);else if("SVGPath"===W)y(j,W,T);else{T=T||{x:0,y:0,width:A.width,height:A.height};var d=V(j,Wk),l=V(j,"scaleX"),a=V(j,"scaleY"),U=M(j),I=O(j,T,T,d,l,a,U);if(tj(W))m(j,W),K.drawCompType(W,X,T,j,s,R);else if(K.getCompType(W)){var D=K.getCompType(W),lo=D.func||D;m(j,D),K.drawCompType(lo,X,T,j,s,R)}else H[W]?H[W](j,T):K.getCompType(W)===P&&jr.test(W)&&(dm(W),Fd=!1);I&&$()}_&&(X.shadowOffsetX=F,X.shadowOffsetY=J,X.shadowBlur=q,X.shadowColor=Y),v!=E&&(X.globalAlpha=o),X.interactiveInfo&&(X.interactiveInfo.matrix=S),j.prefix&&(ip=w),eh.splice(0,1)}),X.interactiveInfo&&(X.interactiveInfo.matrix=sq),X.restore(),f(U)}}}();K.getCurrentComp=function(){return eh[0]},K.getParentComp=function(){return eh[1]},K.getInternal=function(){return{isEnter:ol,isEsc:xq,isSpace:Vo,isLeft:oj,isUp:mp,isRight:Lf,isDown:Wq,addMethod:Sn,superCall:cb,toPointsArray:_h,translateAndScale:Rf,appendArray:Zn,createWorldMatrix:Gg,vec3TransformMat4:kc,setCanvas:Gm,createDiv:Xi,createView:Of,createCanvas:ej,createImage:ti,initContext:Te,layout:Xb,fillRect:cs,Mat:Jh,drawBorder:di,isString:Om,setBorder:$e,getPropertyValue:ri,setPropertyValue:pp,drawVerticalLine:Sd,draw3DRect:Pd,getPinchDist:ro,isSameRect:sl,getPosition:Ac,intersectionLineRect:Oj,getNodeRect:ps,getEdgeAgentPosition:Hb,getEdgeHostPosition:yg,getImageWidth:_r,getImageHeight:wm,initItemElement:Ff,drawPoints:xj,createG2:Ii,closePopup:tk,isH:oo,createAnim:md,createNormalMatrix:Em,makeUVMatrix:$n,toColorArray:Ql,createNormals:Gd,toFloatArray:Hi,glMV:qs,glPop:Vh,batchShape:ys,createNodeMatrix:$f,getShapeModel:wq,getFaceInfo:qc,transformAppend:Df,drawFaceInfo:In,glUploadData:Mk,glUploadElementData:Vj,glDrawArray:Mp,glDrawElement:Dg,glBindTexture:ef,pickValueToColor:Ws,to3dPointsArray:Bq,setGLDebugMode:function(r){Fi=r},cube:function(){return{vs:Qo,is:kn,uv:Ag}},ui:function(){return{DataUI:Jo,NodeUI:mk,EdgeUI:cc,GroupUI:vi,ShapeUI:wl,GridUI:Ad,Data3dUI:kt,Node3dUI:lt,Shape3dUI:ot}},getInternalVersion:function(){return"U2FsdGVkX1/7ZE9oW8tE7Z4YzcriHqnRQZZ5xiV3oOE="},getDragger:function(){return Yb},addMSMap:function(H){Sn(wp,H)},k:n,overrideTimerFunc:function(N,w){dd=h.Default.callLater=N,Jc=h.Default.cancelLater=w},canEnterEditDetailMode:Fo,addEventListener:F,removeEventListener:J,createGradientByPackedData:nn}},function(N){function h(Z,w){Z!=E&&(w==E&&Mq!=typeof Z?this._54O(Z,256):this._54O(Z,w))}function k(){return new h(E)}function S(u,K,q,r,W,G){for(;--G>=0;){var d=K*this[u++]+q[r]+W;W=X(d/67108864),q[r++]=67108863&d}return W}function J(u,E,c,R,C,B){for(var o=32767&E,n=E>>15;--B>=0;){var s=32767&this[u],D=this[u++]>>15,e=n*s+D*o;s=o*s+((32767&e)<<15)+c[R]+(1073741823&C),C=(s>>>30)+(e>>>15)+n*D+(C>>>30),c[R++]=1073741823&s}return C}function U(I,F,B,b,l,J){for(var f=16383&F,D=F>>14;--J>=0;){var u=16383&this[I],v=this[I++]>>14,t=D*u+v*f;u=f*u+((16383&t)<<14)+B[b]+l,l=(u>>28)+(t>>14)+D*v,B[b++]=268435455&u}return l}function s(F){return sn.charAt(F)}function B($,v){var A=Sp[$.charCodeAt(v)];return A==E?-1:A}function C(K){for(var u=this.t-1;u>=0;--u)K[u]=this[u];K.t=this.t,K.s=this.s}function Y(c){this.t=1,this.s=0>c?-1:0,c>0?this[0]=c:-1>c?this[0]=c+this.DV:this.t=0}function F(P){var W=k();return W._58O(P),W}function d(q,Y){var d,O=this;if(16==Y)d=4;else if(8==Y)d=3;else if(256==Y)d=8;else if(2==Y)d=1;else if(32==Y)d=5;else{if(4!=Y)return O.fromRadix(q,Y),void 0;d=2}O.t=0,O.s=0;for(var m=q.length,z=!1,R=0;--m>=0;){var K=8==d?255&q[m]:B(q,m);0>K?"-"==q.charAt(m)&&(z=!0):(z=!1,0==R?O[O.t++]=K:R+d>O.DB?(O[O.t-1]|=(K&(1<<O.DB-R)-1)<<R,O[O.t++]=K>>O.DB-R):O[O.t-1]|=K<<R,R+=d,R>=O.DB&&(R-=O.DB))}8==d&&0!=(128&q[0])&&(O.s=-1,R>0&&(O[O.t-1]|=(1<<O.DB-R)-1<<R)),O._57O(),z&&h.ZERO._78O(O,O)}function x(){for(var n=this,g=n.s&n.DM;n.t>0&&n[n.t-1]==g;)--n.t}function y(I){var p=this;if(p.s<0)return"-"+p._85O()[ik](I);var Z;if(16==I)Z=4;else if(8==I)Z=3;else if(2==I)Z=1;else if(32==I)Z=5;else{if(4!=I)return p.toRadix(I);Z=2}var Y,x=(1<<Z)-1,H=!1,D="",G=p.t,V=p.DB-G*p.DB%Z;if(G-->0)for(V<p.DB&&(Y=p[G]>>V)>0&&(H=!0,D=s(Y));G>=0;)Z>V?(Y=(p[G]&(1<<V)-1)<<Z-V,Y|=p[--G]>>(V+=p.DB-Z)):(Y=p[G]>>(V-=Z)&x,0>=V&&(V+=p.DB,--G)),Y>0&&(H=!0),H&&(D+=s(Y));return H?D:"0"}function z(){var B=k();return h.ZERO._78O(this,B),B}function R(){return this.s<0?this._85O():this}function g(W){var s=this,D=s.s-W.s;if(0!=D)return D;var _=s.t;if(D=_-W.t,0!=D)return s.s<0?-D:D;for(;--_>=0;)if(0!=(D=s[_]-W[_]))return D;return 0}function Z(C){var l,q=1;return 0!=(l=C>>>16)&&(C=l,q+=16),0!=(l=C>>8)&&(C=l,q+=8),0!=(l=C>>4)&&(C=l,q+=4),0!=(l=C>>2)&&(C=l,q+=2),0!=(l=C>>1)&&(C=l,q+=1),q}function Q(){var f=this;return f.t<=0?0:f.DB*(f.t-1)+Z(f[f.t-1]^f.s&f.DM)}function $(u,E){var i;for(i=this.t-1;i>=0;--i)E[i+u]=this[i];for(i=u-1;i>=0;--i)E[i]=0;E.t=this.t+u,E.s=this.s}function G(n,b){for(var m=n;m<this.t;++m)b[m-n]=this[m];b.t=_(this.t-n,0),b.s=this.s}function q(P,U){var b,v=this,z=P%v.DB,I=v.DB-z,_=(1<<I)-1,r=X(P/v.DB),l=v.s<<z&v.DM;for(b=v.t-1;b>=0;--b)U[b+r+1]=v[b]>>I|l,l=(v[b]&_)<<z;for(b=r-1;b>=0;--b)U[b]=0;U[r]=l,U.t=v.t+r+1,U.s=v.s,U._57O()}function j(Y,s){var f=this;s.s=f.s;var O=X(Y/f.DB);if(O>=f.t)return s.t=0,void 0;var P=Y%f.DB,t=f.DB-P,_=(1<<P)-1;s[0]=f[O]>>P;for(var U=O+1;U<f.t;++U)s[U-O-1]|=(f[U]&_)<<t,s[U-O]=f[U]>>P;P>0&&(s[f.t-O-1]|=(f.s&_)<<t),s.t=f.t-O,s._57O()}function K(Q,u){for(var q=this,r=0,X=0,t=I(Q.t,q.t);t>r;)X+=q[r]-Q[r],u[r++]=X&q.DM,X>>=q.DB;if(Q.t<q.t){for(X-=Q.s;r<q.t;)X+=q[r],u[r++]=X&q.DM,X>>=q.DB;X+=q.s}else{for(X+=q.s;r<Q.t;)X-=Q[r],u[r++]=X&q.DM,X>>=q.DB;X-=Q.s}u.s=0>X?-1:0,-1>X?u[r++]=q.DV+X:X>0&&(u[r++]=X),u.t=r,u._57O()}function P(Z,Q){var K=this.abs(),s=Z.abs(),D=K.t;for(Q.t=D+s.t;--D>=0;)Q[D]=0;for(D=0;D<s.t;++D)Q[D+K.t]=K.am(0,s[D],Q,D,0,K.t);Q.s=0,Q._57O(),this.s!=Z.s&&h.ZERO._78O(Q,Q)}function D(H){for(var G=this.abs(),b=H.t=2*G.t;--b>=0;)H[b]=0;for(b=0;b<G.t-1;++b){var _=G.am(b,G[b],H,2*b,0,1);(H[b+G.t]+=G.am(b+1,2*G[b],H,2*b+1,_,G.t-b-1))>=G.DV&&(H[b+G.t]-=G.DV,H[b+G.t+1]=1)}H.t>0&&(H[H.t-1]+=G.am(b,G[b],H,2*b,0,1)),H.s=0,H._57O()}function t(q,A,I){var Y=q.abs(),C=this;if(!(Y.t<=0)){var D=C.abs();if(D.t<Y.t)return A!=E&&A._58O(0),I!=E&&C._77O(I),void 0;I==E&&(I=k());var v=k(),l=C.s,c=q.s,f=C.DB-Z(Y[Y.t-1]);f>0?(Y._44O(f,v),D._44O(f,I)):(Y._77O(v),D._77O(I));var o=v.t,J=v[o-1];if(0!=J){var Q=J*(1<<C.F1)+(o>1?v[o-2]>>C.F2:0),m=C.FV/Q,p=(1<<C.F1)/Q,B=1<<C.F2,r=I.t,G=r-o,y=A==E?k():A;for(v._59O(G,y),I._52O(y)>=0&&(I[I.t++]=1,I._78O(y,I)),h.ONE._59O(o,y),y._78O(v,v);v.t<o;)v[v.t++]=0;for(;--G>=0;){var e=I[--r]==J?C.DM:X(I[r]*m+(I[r-1]+B)*p);if((I[r]+=v.am(0,e,I,G,0,o))<e)for(v._59O(G,y),I._78O(y,I);I[r]<--e;)I._78O(y,I)}A!=E&&(I._45O(o,A),l!=c&&h.ZERO._78O(A,A)),I.t=o,I._57O(),f>0&&I._46O(f,I),0>l&&h.ZERO._78O(I,I)}}}function H(J){var s=k();return this.abs()._49O(J,E,s),this.s<0&&s._52O(h.ZERO)>0&&J._78O(s,s),s}function b(V){this.m=V}function o(f){return f.s<0||f._52O(this.m)>=0?f.mod(this.m):f}function m(G){return G}function p(N){N._49O(this.m,E,N)}function L(q,M,p){q._47O(M,p),this._74O(p)}function e(U,b){U._48O(b),this._74O(b)}function T(){if(this.t<1)return 0;var c=this[0];if(0==(1&c))return 0;var o=3&c;return o=15&o*(2-(15&c)*o),o=255&o*(2-(255&c)*o),o=65535&o*(2-(65535&(65535&c)*o)),o=o*(2-c*o%this.DV)%this.DV,o>0?this.DV-o:-o}function w(N){var G=this;G.m=N,G.mp=N._50O(),G.mpl=32767&G.mp,G.mph=G.mp>>15,G.um=(1<<N.DB-15)-1,G.mt2=2*N.t}function r(d){var y=k();return d.abs()._59O(this.m.t,y),y._49O(this.m,E,y),d.s<0&&y._52O(h.ZERO)>0&&this.m._78O(y,y),y}function O(w){var f=k();return w._77O(f),this._74O(f),f}function f(W){for(var N=this;W.t<=N.mt2;)W[W.t++]=0;for(var J=0;J<N.m.t;++J){var h=32767&W[J],K=h*N.mpl+((h*N.mph+(W[J]>>15)*N.mpl&N.um)<<15)&W.DM;for(h=J+N.m.t,W[h]+=N.m.am(0,K,W,J,0,N.m.t);W[h]>=W.DV;)W[h]-=W.DV,W[++h]++}W._57O(),W._45O(N.m.t,W),W._52O(N.m)>=0&&W._78O(N.m,W)}function V(l,V){l._48O(V),this._74O(V)}function u(B,m,N){B._47O(m,N),this._74O(N)}function hn(){return 0==(this.t>0?1&this[0]:this.s)}function gs(B,Q){if(B>4294967295||1>B)return h.ONE;var y=k(),L=k(),X=Q._73O(this),K=Z(B)-1;for(X._77O(y);--K>=0;)if(Q._76O(y,L),(B&1<<K)>0)Q._75O(L,X,y);else{var f=y;y=L,L=f}return Q.revert(y)}function Pi(X,S){var d;return d=256>X||S._51O()?new b(S):new w(S),this.exp(X,d)}function xn(){var g=this;if(g.s<0){if(1==g.t)return g[0]-g.DV;if(0==g.t)return-1}else{if(1==g.t)return g[0];if(0==g.t)return 0}return(g[1]&(1<<32-g.DB)-1)<<g.DB|g[0]}function Cl(W,A){return new h(W,A)}function ds(){var T=this;T.n=E,T.e=0,T.d=E,T.p=E,T.q=E,T.dmp1=E,T.dmq1=E,T._10A=E}function _p(Q){return Q._53O(this.e,this.n)}function yd(Z){var T,A,I,Q="",g=0;for(T=0;T<Z.length&&Z.charAt(T)!=Rm;++T)I=Iq.indexOf(Z.charAt(T)),0>I||(0==g?(Q+=s(I>>2),A=3&I,g=1):1==g?(Q+=s(A<<2|I>>4),A=15&I,g=2):2==g?(Q+=s(A),Q+=s(I>>2),A=3&I,g=3):(Q+=s(A<<2|I>>4),Q+=s(15&I),g=0));return 1==g&&(Q+=s(A<<2)),Q}function ql($){var f=$.split(""),W=yd($);return f.forEach(function(A){var h=A.length;h>0&&W&&(Jl+=sr(A))}),W}function im(s,j){var q=Wc._4O.Util._56O(s,"ss"),J={},H=0;return J.v=q==j,J.t=1,J.s=0>H?-1:0,vq=J.v,H>0?J[0]=H:-1>H?J[0]=H+J.DV:J.t=0,[q,J]}function to(b){var e=38,E=b.substring(0,e);if(E&&30==E.indexOf("05000420")){var z=["ss",b.substring(e)];return z}return[]}function Tn(v,J){J=J.replace(pc,""),J=J.replace(/[ \n]+/g,"");var f=Cl(J,16);if(f._55O()>this.n._55O())return 0;var o=this._37O(f),Y=o[ik](16).replace(/^1f+00/,""),O=to(Y);if(0==O.length)return!1;for(var x,s,X,F=.5,E=Lb,Z=[0,.5,.75,.875,.9375],t=[],N=[],I=[],w=a/E,Q=O[1],R=im(v,Q)[0],r=0,H=0;r<Z.length;r++){var D=0===r%2?0:.5;for(x=0;E>=x;x++)s=(x+D)*w,X=1-Z[r],t.push(W(s)*F*X,-F+2*Z[r]*F,-l(s)*F*X),N.push((x+D)/E,X)}for(r=0;r<Z.length-1;r++){var u=r*(E+1),q=(r+1)*(E+1);for(x=0;E>x;x++)I.push(u+x,q+x+1,q+x,u+x,u+x+1,q+x+1)}return I.forEach(function(C){H+=C}),Q==R&&H>10}var le,Ol=0xdeadbeefcafe,Sc=15715070==(16777215&Ol),ik="toString",Mj="",or="nat",Tb=function(){};v=N["D"+11182[ik](c(2,5))];var Pp=h.prototype;lh+=Zb.substr(0,1);var Tj=N.navigator?N.navigator.appName:"";Sc&&"Microsoft Internet Explorer"==Tj?(Pp.am=J,le=30):Sc&&"Netscape"!=Tj?(Pp.am=S,le=26):(Pp.am=U,le=28),Pp.DB=le,Pp.DM=(1<<le)-1,Pp.DV=1<<le;var aj=52;Pp.FV=c(2,aj),Pp.F1=aj-le,Pp.F2=2*le-aj;var nr,ff,sn="0123456789abcdefghijklmnopqrstuvwxyz",Sp=[],Zk=function(Q){return String.fromCharCode(Q)};for(nr="0".charCodeAt(0),ff=0;9>=ff;++ff)Sp[nr++]=ff;for(nr="a".charCodeAt(0),ff=10;36>ff;++ff)Sp[nr++]=ff;for(nr="A".charCodeAt(0),ff=10;36>ff;++ff)Sp[nr++]=ff;var Cs=b.prototype;Cs._73O=o,Cs.revert=m,Cs._74O=p,Cs._75O=L,Cs._76O=e;var tl=w.prototype;tl._73O=r,tl.revert=O,tl._74O=f,tl._75O=u,tl._76O=V,Pp._77O=C,Pp._58O=Y,Pp._54O=d,Pp._57O=x,Pp._59O=$,Pp._45O=G,Pp._44O=q,Pp._46O=j,Pp._78O=K,Pp._47O=P,Pp._48O=D,Pp._49O=t,Pp._50O=T,Pp._51O=hn,Pp.exp=gs,Pp.toString=y,Pp._85O=z,Pp.abs=R,Pp._52O=g,Pp._55O=Q,Pp.mod=H,Pp._53O=Pi,h.ZERO=F(0),h.ONE=F(1),Pp._86O=xn;var bm=function(i,U){var J=this;J.isPublic=!0,typeof i!==Mq?(J.n=i,J.e=U):i!=E&&U!=E&&i.length>0&&U.length>0&&(J.n=Cl(i,16),J.e=sr(U,16))};wo=function(){var D,A,e=ql(Wh),$=e.substr(0,4),C=e.substr(4,2),B=e.substr(6,2),S=1,x=!S,j=n,R=[],c=hd.charAt(7);if(v&&(v[ik]().indexOf(or)<0||v[lh][ik]().indexOf(or)<0||!e?D=E:(e=new v($-0,C-S,B-0),A=e.setHours(9),v[lh]()>A?D=zk[c]:x=!0)),e&&D&&D[0]&&D[i(.5)]&&j){var V=Gq(D[0]),I=Gq(D[1]);for(var h in I)R.push(h);var d,l=0,G=V[R[l]],Z=I[R[l++]],F=I[R[l++]],L=I[R[l++]],X=I[R[l++]],p=I[R[l++]],f=I[R[l++]],_=V[R[l]],H=I[R[l++]],m=ul._27O(j);if(G===Z&&m&&H){d=Z+F+L+X+p+f;var W=!f||f===Nc||!Nc&&f===(jr+"")[0];if(!W&&f)for(var w,y=0,q=f.length;q>y;y++)f[y]===np[l]?w===Nc?W=!0:w[0]===Li[5]&&Nc&&Nc.indexOf(w.substr(1))>=0?W=!0:w=E:(w==E?w=f[y]:w+=f[y],y===q-1&&(w===Nc?W=!0:w[0]===Li[5]&&Nc&&Nc.indexOf(w.substr(1))>=0&&(W=!0)));d&&m._31O(d,H)&&m._31O(G,_)&&W&&(!p||v[lh]()<p)&&(x=!0)}}return x||(ug=Ug),c};var Hc=ds.prototype;Hc._37O=_p,Hc._38O=bm;var Iq="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rm="=",wg=25,Rb=10,Wh="ICISFQ==",xi=xi||function(K,d){var o={},x=o._7A={},E=x._6A=function(){function D(){}return{_80O:function(P){D.prototype=this;var y=new D;return P&&y._5A(P),y.hasOwnProperty("_82O")||(y._82O=function(){y.$super._82O.apply(this,arguments)}),y._82O.prototype=y,y.$super=this,y},_3A:function(){var V=this._80O();return V._82O.apply(V,arguments),V},_82O:function(){},_5A:function(x){for(var n in x)x.hasOwnProperty(n)&&(this[n]=x[n]);x.hasOwnProperty(ik)&&(this.toString=x.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),A=x._39O=E._80O({_82O:function(v,L){v=this._84O=v||[],this._65O=L!=d?L:4*v.length},toString:function(m){return(m||U).stringify(this)},_89O:function(o){var L=this._84O,i=o._84O,M=this._65O,T=o._65O;if(this._57O(),M%4)for(var q=0;T>q;q++){var J=255&i[q>>>2]>>>24-8*(q%4);L[M+q>>>2]|=J<<24-8*((M+q)%4)}else if(i.length>65535)for(var q=0;T>q;q+=4)L[M+q>>>2]=i[q>>>2];else L.push.apply(L,i);return this._65O+=T,this},_57O:function(){var C=this._84O,B=this._65O;C[B>>>2]&=4294967295<<32-8*(B%4),C.length=i(B/4)},_88O:function(){var I=E._88O.call(this);return I._84O=this._84O.slice(0),I},_87O:function(q){for(var z=[],K=0;q>K;K+=4)z.push(0|4294967296*Cn);return new A._82O(z,q)}}),m=o._2A={},U=m._69O={stringify:function(F){var y,s=F._84O,h=F._65O,i=[];for(y=0;h>y;y++){var m=255&s[y>>>2]>>>24-8*(y%4);i.push((m>>>4).toString(16)),i.push((15&m).toString(16))}return i.join("")},_68O:function(Q){for(var k=Q.length,O=[],z=0;k>z;z+=2)O[z>>>3]|=sr(Q.substr(z,2),16)<<24-4*(z%8);return new A._82O(O,k/2)}},c=m._8A={stringify:function(q){var c,x=q._84O,p=q._65O,m=[];for(c=0;p>c;c++){var F=255&x[c>>>2]>>>24-8*(c%4);m.push(Zk(F))}return m.join("")},_68O:function(_){var x,V=_.length,q=[];for(x=0;V>x;x++)q[x>>>2]|=(255&_.charCodeAt(x))<<24-8*(x%4);return new A._82O(q,V)}},a=m._9A={stringify:function(Q){try{return decodeURIComponent(escape(c.stringify(Q)))}catch(y){throw new Error("")}},_68O:function(f){return c._68O(unescape(encodeURIComponent(f)))}},$=x._32O=E._80O({_1A:function(){this._83O=new A._82O,this._23O=0},_33O:function(y){typeof y==Mq&&(y=a._68O(y)),this._83O._89O(y),this._23O+=y._65O},_25O:function(q){var X=this._83O,Y=X._84O,y=X._65O,g=this._79O,M=4*g,L=y/M;L=q?i(L):_((0|L)-this._22O,0);var J=L*g,W=I(4*J,y);if(J){for(var r=0;J>r;r+=g)this._20O(Y,r);var f=Y.splice(0,J);X._65O-=W}return new A._82O(f,W)},_88O:function(){var W=E._88O.call(this);return W._83O=this._83O._88O(),W},_22O:0});x._66O=$._80O({cfg:E._80O(),_82O:function(P){this.cfg=this.cfg._80O(P),this._1A()},_1A:function(){$._1A.call(this),this._34O()},_81O:function(E){return this._33O(E),this._25O(),this},_72O:function(J){J&&this._33O(J);var K=this._21O();return K},_79O:16,_26O:function($){return function(n,r){return new $._82O(r)._72O(n)}},_19O:function(y){return function(R,G){return new l._71O._82O(y,G)._72O(R)}}});var l=o._67O={};return o}();!function(){var H=xi,D=H._7A,Z=D._39O,x=D._66O,C=H._67O,F=[],w=[];!function(){function S(J){for(var U=A(J),L=2;U>=L;L++)if(!(J%L))return!1;return!0}function g(Z){return 0|4294967296*(Z-(0|Z))}for(var H=2,Y=0;64>Y;)S(H)&&(8>Y&&(F[Y]=g(c(H,.5))),w[Y]=g(c(H,1/3)),Y++),H++}();var m=[],f=C._41O=x._80O({_34O:function(){this._64O=new Z._82O(F.slice(0))},_20O:function(g,L){for(var A=this._64O._84O,I=A[0],r=A[1],D=A[2],J=A[3],G=A[4],q=A[5],O=A[6],C=A[7],y=0;64>y;y++){if(16>y)m[y]=0|g[L+y];else{var p=m[y-15],E=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,b=m[y-2],W=(b<<15|b>>>17)^(b<<13|b>>>19)^b>>>10;m[y]=E+m[y-7]+W+m[y-16]}var i=G&q^~G&O,M=I&r^I&D^r&D,N=(I<<30|I>>>2)^(I<<19|I>>>13)^(I<<10|I>>>22),j=(G<<26|G>>>6)^(G<<21|G>>>11)^(G<<7|G>>>25),x=C+j+i+w[y]+m[y],h=N+M;C=O,O=q,q=G,G=0|J+x,J=D,D=r,r=I,I=0|x+h}A[0]=0|A[0]+I,A[1]=0|A[1]+r,A[2]=0|A[2]+D,A[3]=0|A[3]+J,A[4]=0|A[4]+G,A[5]=0|A[5]+q,A[6]=0|A[6]+O,A[7]=0|A[7]+C},_21O:function(){var L=this._83O,f=L._84O,N=8*this._23O,r=8*L._65O;return f[r>>>5]|=128<<24-r%32,f[(r+64>>>9<<4)+14]=X(N/4294967296),f[(r+64>>>9<<4)+15]=N,L._65O=4*f.length,this._25O(),this._64O},_88O:function(){var e=x._88O.call(this);return e._64O=this._64O._88O(),e}});H._41O=x._26O(f),H._42O=x._19O(f)}();var pc=new RegExp("");pc.compile("[^0-9a-f]","gi"),ds._28O=-1,ds._29O=-2,Hc._31O=Tn,Hc._63O=Tn,ds._43O=-2;var lj=new function(){var J=this;J._5O=function(n,E){if("8"!=n.substring(E+2,E+3))return 1;var R=sr(n.substring(E+3,E+4));return 0==R?-1:R>0&&10>R?R+1:-2},J._13O=function(o,u){var q=J._5O(o,u);return 1>q?"":o.substring(u+2,u+2+2*q)},J._12O=function(L,K){var Q=J._13O(L,K);if(""==Q)return-1;var m;return m=sr(Q.substring(0,1))<8?new h(Q,16):new h(Q.substring(2),16),m._86O()},J._6O=function(R,I){var D=J._5O(R,I);return 0>D?D:I+2*(D+1)},J._11O=function(e,y){var f=J._6O(e,y),C=J._12O(e,y);return e.substring(f,f+2*C)},J._10O=function(D,X){var I=J._6O(D,X),m=J._12O(D,X);return I+2*m},J._7O=function(t,O){var Y=[],_=J._6O(t,O);Y.push(_);for(var u=J._12O(t,O),j=_,M=0;;){var S=J._10O(t,j);if(S==E||S-_>=2*u)break;if(M>=200)break;Y.push(S),j=S,M++}return Y}};if(lj._90O=Zk(Rb+24),lj._91O=M+Zk(Rb*Rb+8),Wc==E||!Wc)var Wc={};Wc._4O!=E&&Wc._4O||(Wc._4O={});var Nl=Wc._4O;Wc._4O.Util=new function(){var X=this;X._56O=function(J){var D=new Wc._4O._3O;return D._30O(J)},X._4A=function(y){var j=new Wc._4O._3O;return j._36O(y)},X._11A=function(X){var L=new Nl._3O;return L._30O(X)}},Wc._4O._3O=function(){var Q=this;Q._8O=function(z,_){if("ss"==z&&"cj"==_){try{Q.md=xi._67O._41O._3A()}catch(o){Tb(Mj)}Q._24O=function(i){Q.md._81O(i)},Q._35O=function(P){var h=xi._2A._69O._68O(P);Q.md._81O(h)},Q._60O=function(){var g=Q.md._72O();return g[ik](xi._2A._69O)},Q._30O=function(R){return Q._24O(R),Q._60O()},Q._36O=function(Y){return Q._35O(Y),Q._60O()}}},Q._24O=function(){Tb(Mj)},Q._35O=function(){Tb(Mj)},Q._60O=function(){Tb(Mj)},Q._30O=function(){Tb(Mj)},Q._36O=function(){Tb(Mj)},Q._8O("ss","cj")},Eo=function(j){var U=Lj[Tl[7]],d=1,S=!1;if(ge.a!=Lj[Qi])return ge.a;if(ge.forEach(function(o){d*=o}),j>d){if(U&&U[1]&&U[0]){var t=U[0],B=U[1];B=B.split(lj._90O),t=t.split(lj._90O);var C=B[3],y=t[3],Q=B[7],F=B[11],Y=B[15],L=B[19],x=B[23],O=B[27],m=t[7],E=C+Q+F+Y+L+x,V=x?!1:!0,w=y===C;if(x===fp.toString()[0]&&(x=x+x+x),x){var e=x&&x.split(sh("firefox")[3]);if(e)for(var R=0;R<e.length;R++){var Z=e[R];if(Z[0]===jj[8]&&(Z=Z.substring(1)),nd.indexOf(Z)>=0){V=!0;break}}}S=w&&Xd()(y,m)&&Xd()(E,O)&&V&&(!L||L>j),S&&F.indexOf(Rk.length)>=0&&(Eo[Rk.length]=Rk),S&&F.indexOf(Rk.length+1)>=0&&(Eo[Rk.length+1]=Rk),S&&F.indexOf(Rk.length+3)>=0&&(Eo[Rk.length+3]=Rk),S&&F.indexOf(vj.length)>=0&&(Eo[vj.length]=vj)}S||(Jo.prototype._42=lo)}else S=!0,Eo[Rk.length]=Eo[Rk.length+1]=Eo[Rk.length+3]=Eo[vj.length]=Rk;return ge.a=S,S},wg=String.fromCharCode(wg+20);var zg=function(E){return E=E.replace(pc,Mj),E=E.replace(/[ \n]+/g,Mj)},ei="30",Tq="06",ok="02",bn="03",Zo=Cl,ir=/^1f+00/,ul=function(){var G;return G={_18O:function(H){var C=H,m=C.replace(/\s+/g,""),F=yd(m);return F},_14O:function(m){var $=this._18O(m),u=this._15O($);return u},_15O:function(m){var R=this._17O(m);if("2a864886f70d010101"==R._61O){var d=this._16O(R.key),u=new ds;return u._38O(d.n,d.e),u}Tb(Mj)},_16O:function(S){var A={};S.substr(0,2)!=ei&&Tb(Mj);var x=lj._7O(S,0);return 2!=x.length&&Tb(Mj),S.substr(x[0],2)!=ok&&Tb(Mj),A.n=lj._11O(S,x[0]),S.substr(x[1],2)!=ok&&Tb(Mj),A.e=lj._11O(S,x[1]),A},_17O:function(k){var s={};s._40O=E;var p=lj._7O(k,0);2!=p.length&&Tb(Mj);var v=p[0];k.substr(v,2)!=ei&&Tb(Mj);var e=lj._7O(k,v);return 2!=e.length&&Tb(Mj),k.substr(e[0],2)!=Tq&&Tb(Mj),s._61O=lj._11O(k,e[0]),k.substr(e[1],2)==Tq?s._40O=lj._11O(k,e[1]):k.substr(e[1],2)==ei&&(s._40O={},s._40O.p=lj._70O(k,e[1],[0],ok),s._40O.q=lj._70O(k,e[1],[1],ok),s._40O.g=lj._70O(k,e[1],[2],ok)),k.substr(p[1],2)!=bn&&Tb(Mj),s.key=lj._11O(k,p[1]).substr(2),s}},G._17O?G:E}(),gq=ul._27O=function(B){return ul._14O(B)};Xd=function(){return function(M,y){if(M&&y){y=zg(y);var u=Zo(y,c(2,4)),l=this;if(!l||!l.n||u._55O()>l.n._55O())return 0;var b=l._37O(u),i=b[ik](c(2,4)).replace(ir,""),J=to(i);if(0==J.length)return!1;var m=J[0],k=J[1],H=function(L){return Wc._4O.Util._56O(L,m)},L=H(M);return k==L}}.bind(gq(n))};var Um,gc;return function(){var m=_e.length-Xh.length;if(m>0)for(var e=0;m>e;e++)Um=Nl.Util,gc=zg}(),If=function(d,B){B=gc(B);var H=gq(Bp),h=yr.length,F=2*h,x=Zo(B,c(h,F)),P=H,n=!0;if(P){var f=P[cn[0]];f&&x._55O()<=f._55O()&&(n=!1)}if(n)return 0;var L=P._37O(x),m=L[ik](c(h,F)).replace(ir,""),X=to(m);if(0==X.length)return!1;var R=X[0],w=X[1],a=Um._11A(d,R);return w==a},ul}(Q,O),Sn(K,{load:function(){var o={},T=function(I){return I?"c_"+(I.sync?"1":"0")+"_"+(I.post?"1":"0")+"_"+(I.responseType||"H")+"_"+(I.mimeType||"H")+"_"+(I.data?JSON.stringify(I.data):"H"):""};return function(U,A,X){var z,W=o[U],P=T(X);return W&&(z=W[P])?(z.push(A),void 0):(o[U]||(W=o[U]={count:0}),z=W[P]=[A],W.count++,K.xhrLoad(U,function(_){delete W[P],W.count--,W.count||delete o[U],z.forEach(function(I){I(_)})},X),void 0)}}(),asyncEach:function(o,B,i){"function"!=typeof i&&(i=Function.prototype);var p=new Array(o.length),f=0,w=!1;o.forEach(function(I,G){B(I,function(e,m){return w?void 0:e?(w=!0,i(null)):(p[G]=m,f++,f===o.length?i(p):void 0)})})},xhrLoad:function(Q,L,R){var p=!1;bs(Q)||(p=!0,Q=[Q]),R=R||{};var w=R.sync,q=null,t=R.method||"GET";return R.post&&(t="POST"),R.method=t,K.asyncEach(Q,function(N,A){if(N=K.beforeLoadURL(N),N.data)A(null,N.data);else{R.url=encodeURI(N);var I=new rb;I.onload=function(){200===this.status||0===this.status?A(null,I.getResponseText()):A(!0)},I.onerror=function(){A(!0)},I.send(R)}},function(c){var n="function"==typeof L;(n||w)&&(q=p&&c?c[0]:c,n&&L(q))}),w?q:void 0}});var Dk=O.setPrototypeOf||function(V,X){return V.__proto__=X,V},Ld=O.getPrototypeOf||function(B){return B.__proto__},Ze=O.freeze;O.isFrozen;var ws=function(){var g=function(H){return H};return function(r){return r&&r.length?new Function("o",["return o['",r.join("']['"),"'];"].join("")):g}}(),ao=function(){var w=function(u,B){return u=B};return function(_){return _&&_.length?new Function("o","v",["return o['",_.join("']['"),"'] = v;"].join("")):w}}();!function(){function c(C){var x=[];if(C)for(var c;(c=v.exec(C))!=P;)x.push(c[1]);return x}function W(H,m){var _=I.exec(m);this._cell=H,this._key=_[1],this._format=_[2],this._style=c(_[3])}function S(I){for(var w=this._cellList=[],i=this._paramList=[],o=I.split(D),E=0,L=o.length;L>E;++E){var p=o[E];if("{{"!==p)for(var u=p.split(q),c=0,X=u.length;X>c;++c){var B=u[c];q.test(B)?(i.push(new W(w.length,B)),w.push(P)):B.length>0&&w.push(B)}else w.push("{")}this._formatList=this._cellList.slice(0)}var m={},e={},D=/(\{\{)/,q=/(\{\w+(?:\:\w+(?:\&[\w\.])*)?\})/,I=/\{(\w+)(?:\:(\w+)((?:\&[\w\.])*))?\}/,v=/\&([\w\.]*)/g;S.prototype._73O=function(C){for(var u=this._paramList.length;u--;){var b=this._paramList[u],K=C[sr(b._key)+1],j=e[b._format];j&&(K=j(K,b._style)),this._formatList[b._cell]=K}return this._formatList.join("")},S.prototype._map=function(K){for(var g=this._paramList.length;g--;){var k=this._paramList[g],b=K[k._key],u=e[k._format];u&&(b=u(b,k._style)),this._formatList[k._cell]=b}return this._formatList.join("")};var h=function(L){var C=m[L];return C||(m[L]=C=new S(L)),C._73O(arguments)};return h.map=function(P,p){var K=m[P];return K||(m[P]=K=new S(P)),K._map(p)},h.setValueFormat=function($,h){e[$]=h},h.gc=function(){m.length=0},h.__parsed=m,h}();var oh=function(){function S(F,f,w,q){var k=F?F.path.slice(0):[];f&&k.push(f),this.desc=w,this.name=f,this.path=Ze(k),this.getter=ws(k),this.setter=ao(k),this.isLeaf=q,this.parent=F,this.children=[],this.childMap={}}return S.create=function(){function d(H,U,v,E){var l=E(v),u=new S(H,U,v,l);if(!l){for(var J=u.children,X=u.childMap,n=O.keys(v),y=0,Q=n.length;Q>y;++y){var f=n[y],M=d(u,f,v[f],E);J.push(M),X[M.name]=M}u.children=Ze(J),u.childMap=Ze(X)}return Ze(u),u}return function(I,z){return d(P,P,I,z)}}(),S.prototype.forEach=function(I,p){for(var e=this.children,_=0,c=e.length;c>_;++_){var s=e[_];I(s,p)}},S}(),Ze=O.freeze,$d={main:{mask:1,priority:K.cameraPriority.main,clearDepth:!1,ignore:!1},top:{mask:2,priority:K.cameraPriority.top,ignore:!1}},Ud="main",ql=$d[Ud].mask,dr=function(W,A){W=W||0;var S;if(A in $d)S=$d[A].mask;else{if(!(32>xh))throw new Error("Only 31 render layer can be defined.");$d[A]={mask:1<<xh++,priority:$d[Ud].priority},S=$d[A].mask,nb=kf(O.keys($d)),xh=nb.length}return W|=S},Sh=function(o,t){return o&&t&&o&t},kf=function(_){return _.sort(function(A,q){return $d[A].priority-$d[q].priority})},nb=kf(O.keys($d)),xh=nb.length;Sn(K,{setRenderLayerInfo:function(q,u){if(dr(0,q),u){for(var z in u)$d[q][z]=u[z];u.priority&&(nb=kf(O.keys($d)))}},getRenderLayerInfo:function(M){return $d[M]}},!0);var oc=h.List=function(){this._as=[];var c,T,X=arguments.length;if(1===X){var j=arguments[0];if(xg(j)&&(j=j._as),bs(j))for(T=j.length,c=0;T>c;c++)this._as.push(j[c]);else j!=E&&this._as.push(j)}else if(X>1)for(c=0;X>c;c++)this._as.push(arguments[c])};lq("List",O,{forEach:function(p,z){this.each(p,z)},push:function(){for(var L=0;L<arguments.length;L++)this.add(arguments[L])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(v,n){return n===P?this._as.push(v):this._as.splice(n,0,v)},addAll:function(a){xg(a)&&(a=a._as),bs(a)?Zn(this._as,a):this._as.push(a)},get:function(Z){return this._as[Z]},slice:function(N,w){return new oc(this._as.slice(N,w))},remove:function(p){var L=this._as.indexOf(p);return L>=0&&L<this._as.length&&this.removeAt(L),L},removeAt:function(H){return this._as.splice(H,1)[0]},set:function(D,B){return this._as[D]=B},clear:function(){return this._as.splice(0,this._as.length)},contains:function(R){return this._as.indexOf(R)>=0},indexOf:function(o){return this._as.indexOf(o)},each:function(e,B){for(var v=0,n=this._as.length;n>v;v++){var l=this._as[v];B?e.call(B,l,v,this):e(l,v,this)}},reverseEach:function(S,A){for(var b=this._as.length-1;b>=0;b--){var F=this._as[b];A?S.call(A,F):S(F)}},getArray:function(){return this._as},toArray:function(l,Z){if(l){for(var T,q=[],k=0,U=this._as.length;U>k;k++)T=this._as[k],Z?l.call(Z,T)&&q.push(T):l(T)&&q.push(T);return q}return this._as.concat()},toList:function(c,j){if(c){for(var v,D=new oc,M=0,S=this._as.length;S>M;M++)v=this._as[M],j?c.call(j,v)&&D.add(v):c(v)&&D.add(v);return D}return new oc(this)},reverse:function(){this._as.reverse()},sort:function(Z){return this._as.sort(Z?Z:As),this},toString:function(){return this._as.toString()}}),O.defineProperties(oc.prototype,{length:{get:function(){return this._as.length
},set:function(V){this._as.length=V}}});var Kd=new oc;Sn(Kd,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Aj,each:Aj,reverseEach:Aj,toArray:function(){return[]},toList:function(){return new oc},add:ym,addAll:ym,set:ym,remove:ym,removeAt:ym,clear:ym});var Lm=h.Notifier=function(){this._f=0};lq("Notifier",O,{contains:function(u,z){if(this._ls)for(var P,L=0,y=this._ls.size();y>L;L++)if(P=this._ls.get(L),u===P.l&&z===P.s)return!0;return!1},add:function($,k,N){var h=this,F={l:$,s:k,a:N};h._ls||(h._ls=new oc),h._f?(h._as||(h._as=new oc),h._as.add(F)):F.a?h._ls.add(F,0):h._ls.add(F)},remove:function(i,k){var A=this;A._ls&&(A._f?(A._rs||(A._rs=new oc),A._rs.add({l:i,s:k})):A._remove(i,k))},_remove:function(F,N){for(var k,w=this._ls,U=0,G=w.size();G>U;U++)if(k=w.get(U),k.l===F&&k.s===N)return w.removeAt(U),void 0},fire:function(M){var q=this,n=q._ls;if(q._b=1e4,n){++q._f;try{for(var N,f=0,A=n.size();A>f;f++)N=n.get(f),N.s?N.l.call(N.s,M):N.l(M)}catch(M){Jn(function(){throw M})}finally{if(--q._f)return;if(q._rs){for(A=q._rs.size(),f=0;A>f;f++)N=q._rs.get(f),q._remove(N.l,N.s);delete q._rs}if(q._as){for(A=q._as.size(),f=0;A>f;f++)N=q._as.get(f),N.a?n.add(N,0):n.add(N);delete q._as}}}}});var Lk=h.Data=function(){this._id=jc()};lq("Data",O,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","renderLayer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:E,_parent:E,_children:Kd,_childMap:E,_styleMap:E,_layer:"0",_renderLayer:Ud,_adjustChildrenToTop:!1,getRenderLayer:function(){return this._renderLayer||Ud},getUIClass:function(){return E},_22Q:function(){return E},beginTransaction:function(){this._dataModel&&this._dataModel.beginTransaction()},endTransaction:function(){this._dataModel&&this._dataModel.endTransaction()},s:function(H,b){var r=this;if(2===arguments.length)r.setStyle(H,b);else{if(!Hh(H))return r.getStyle(H);for(var C in H)r.setStyle(C,H[C])}return r},fp:function(t,R,A,W,C){return this.firePropertyChange(t,R,A,W,C)},firePropertyChange:function(_,b,R,p,y){if(p){if(p(b,R))return!1}else if(b===R)return!1;var t=this,m=y||{};return m.property=_,m.oldValue=b,m.newValue=R,m.data=t,t._dataModel&&t._dataModel.handleDataPropertyChange(m),t.onPropertyChanged(m),!0},onPropertyChanged:function(c){var N=this,g=N._parent,_=c.property;if(Kp(g)){var u=N.s(eb),z="s:ingroup"===_;(u&&yk[_]||_===z)&&g._81I(),(u||z)&&g.fp("childChange",!0,!1)}Rp(g)&&(yk[_]||"elevation"===_||Wj[_]||"scaleTall"===_||"tall"===_)&&g.updateFromChildren(),("s:alwaysOnTop"===_||"s:shape3d.alwaysOnTop"===_)&&(c.newValue?this.setRenderLayer("top"):this.setRenderLayer(P))},_21I:function(s){var Z=this;if(s&&Z._dataModel)throw"Remove data from dataModel before adding";Z._dataModel=s},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var I=0,U=this._children.toArray(),a=U.length;a>I;I++)U[I].removeFromDataModel()},getId:function(){return this._id},setId:function(J){this._id=J},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(v,t){return this._children.toList(v,t)},eachChild:function(k,m){this._children.each(k,m)},addChild:function(K,q){var j=this;K!==j&&(j._children===Kd&&(j._children=new oc,j._childMap={}),q>=0||(q=j._children.size()),j._childMap[K._id]||j.isDescendantOf(K)||(K._parent&&K._parent.removeChild(K),(0>q||q>j._children.size())&&(q=j._children.size()),j._children.add(K,q),j._childMap[K._id]=K,K.setParent(j),j.onChildAdded(K,q),j.fp(Qb,E,K)))},onChildAdded:function(){},removeChild:function(y){var m=this;if(m._childMap&&m._childMap[y._id]){var V=m._children.remove(y);delete m._childMap[y._id],m.fp(Qb,y,E),y.setParent(E,V),m.onChildRemoved(y,V)}},onChildRemoved:function(){},getChildAt:function(M){return this._children.get(M)},clearChildren:function(){var _=this;if(!_._children.isEmpty())for(var X=0,c=_._children.toArray(),d=c.length;d>X;X++)_.removeChild(c[X])},getParent:function(){return this._parent},setParent:function(Y,I){var j=this;if(!(j._73I||j._parent===Y||j===Y||Y&&Y.isDescendantOf(j))){var J,$=j._parent;j._parent=Y,j._73I=1,$?(I==E&&(I=$.getChildren().indexOf(j)),$.removeChild(j)):j._dataModel&&I==E&&(I=j._dataModel.getRoots().indexOf(j)),Y&&(Y.addChild(j),J=Y.getChildren().indexOf(j)),delete j._73I,j.fp("parent",$,Y,P,{oldIndex:I,newIndex:J}),j.onParentChanged($,Y)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(R){return R?this.isDescendantOf(R)||R.isDescendantOf(this):!1},isParentOf:function(F){return F&&this._childMap?!!this._childMap[F._id]:!1},isDescendantOf:function(s){if(!s||s.isEmpty())return!1;for(var Q=this._parent;Q;){if(s===Q)return!0;Q=Q._parent}return!1},getStyle:function(w,U){U===P&&(U=1);var I=this._styleMap?this._styleMap[w]:P;return I===P&&U?N[w]:I},setStyle:function(V,x){var p=this;p._styleMap||(p._styleMap={});var C=p._styleMap[V];x===P?delete p._styleMap[V]:p._styleMap[V]=x,p.fp("s:"+V,C,x)&&p.onStyleChanged(V,C,x)},onStyleChanged:function(){},iv:function(P){this.invalidate(P)},invalidate:function(j){this.fp(j||"*",!1,!0)},toString:function(){var y=this;return y._displayName||y._name||y._tag||y._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(S,L){var x=this,W=x.s(kj);x.beginTransaction(),W||x.s(kj,W={}),L?W[S]=L:delete W[S],x.fp(kj,E,W),x.endTransaction()},removeStyleIcon:function(n){var e=this.s(kj);if(e){var V=e[n];delete e[n],this.fp(kj,E,e)}return V},_calcAnchorMatrix3d:function(){},appendAnchorMatrix3d:function(Q){var j=this;if(j.hasOwnProperty("_anchor")||j.hasOwnProperty("_anchorElevation")){var e=j.getAnchor3d(),D={x:e.x-.5,y:e.y-.5,z:e.z-.5};sp(Q,[-D.x,-D.y,-D.z])}},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,renderLayer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var P,M={};for(P in this._styleMap)M[P]=1;return M},getCurrentPrefix:function(){return this._interactPrefix||ip},ca:function(R,n){var d=this.getCurrentPrefix();return R=d+R,2===arguments.length?this.a(R,n):this.a(R)}});var ed=h.DataModel=function(){var N=this;N._isDeserializing=0,N._datas=new oc,N._dataMap={},N._roots=new oc,N._rootMap={},N._fsDataMap={},N._78O={},N._reflectorMap={},N._36I=new Lm,N._35I=new Lm,N._serializeNotifier=new Lm,N._selectionModel=new gi(N);var m=N._29Q=[],w=N._scheduleCallback=function(){for(var F=Date.now(),Z=0;Z<m.length;Z++){var C=m[Z];C.enabled&&F-C.lastTime>C.interval&&(C.beforeAction&&C.beforeAction(),C.action&&N.each(function(s){C.action(s)}),C.afterAction&&C.afterAction(),C.lastTime=F)}m.length&&(N._30Q=Q.requestAnimationFrame(w))}};lq("DataModel",O,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmapType","envmap","postProcessingData","init"],_name:P,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:P,_init:P,_envmap:P,_envmapType:P,_postProcessingData:P,sm:function(){return this.getSelectionModel()},mm:function(d,D,X){this.addDataModelChangeListener(d,D,X)},umm:function(M,v){this.removeDataModelChangeListener(M,v)},md:function(E,T,V){this.addDataPropertyChangeListener(E,T,V)},umd:function(G,Y){this.removeDataPropertyChangeListener(G,Y)},mh:function(P,a,A){this.addHierarchyChangeListener(P,a,A)},umh:function(Z,A){this.removeHierarchyChangeListener(Z,A)},getAttrObject:function(){return this._attrObject},setAttrObject:function(M){return this._attrObject=M},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(v){return this._dataMap[v]},removeDataById:function(w){this.remove(this.getDataById(w))},toDatas:function(C,M){return this._datas.toList(C,M)},each:function(l,f){this._datas.each(l,f)},getDataByTag:function(o){return this._78O[o]},getTagMap:function(){return this._78O},removeDataByTag:function(x){this.remove(this.getDataByTag(x))},add:function(X,G,i){var b=this,d=X._id,_=X._tag,j=b._roots;if(b._dataMap[d])throw"'"+d+"' already exists";_!=E&&(b._78O[_]=X),b._dataMap[d]=X,i>=0?b._datas.add(X,i):b._datas.add(X),X._parent||(b._rootMap[d]=X,G>=0?j.add(X,G):j.add(X)),X.s("fullscreen")!==P&&(b._fsDataMap[d]=X),X.s("shape3d.reflector")&&(b._reflectorMap[d]=X),X._21I(b),b.onAdded(X),b._36I.fire({kind:"add",data:X,rootsIndex:G,datasIndex:i})},onAdded:function(){},remove:function(P,j){if(P){var J=this,F=P._id,V=j&&j.keepStructure,y=j&&j.keepChildren,s=P.getTag();if(P._dataModel===J){var Q=P instanceof aq;Q&&K.setIsolating(!0),this.beginTransaction(),V?J._removingData||(J._removingData=P):J.prepareRemove(P),y||P.toChildren().each(function(D){J.remove(D,j)},J),V?J._removingData===P&&(P._parent&&P._parent.removeChild(P),delete J._removingData):P._parent&&P._parent.removeChild(P);var t=J._datas.remove(P);delete J._dataMap[F],s!=E&&delete J._78O[s];var b;J._rootMap[F]&&(delete J._rootMap[F],b=J._roots.remove(P)),J._fsDataMap[F]&&delete J._fsDataMap[F],J._reflectorMap[F]&&delete J._reflectorMap[F],P._21I(E),J.onRemoved(P),J._36I.fire({kind:Fk,data:P,rootsIndex:b,datasIndex:t}),this.endTransaction(),Q&&K.setIsolating(!1)}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var M=this;if(M._datas.size()){var r=M._historyManager?this.toJSON():P;M._datas.toArray().forEach(function(q){q._21I(E)}),M._datas.clear(),M._dataMap={},M._roots.clear(),M._rootMap={},M._fsDataMap={},M._reflectorMap={},M._78O={},M._36I.fire({kind:cl,json:r})}},contains:function(S){return S&&S._dataModel===this},handleDataPropertyChange:function(U){var Z=this,l=U.data,r=U.property;if("parent"===r){var I=l._id,e=Z._rootMap,o=Z._roots;l._parent?e[I]&&(delete e[I],o.remove(l)):e[I]||(e[I]=l,o.add(l))}else if("tag"===r){var y=U.oldValue,V=U.newValue,a=Z._78O;y!=E&&delete a[y],V!=E&&(a[V]=l)}else if("s:fullscreen"===r){var I=l._id,d=Z._fsDataMap;U.oldValue!=E&&delete d[I],U.newValue!=E&&(d[I]=l)}else if("s:shape3d.reflector"===r){var I=l._id,f=Z._reflectorMap;U.oldValue&&delete f[I],U.newValue&&(f[I]=l)}this.onDataPropertyChanged(l,U),this._35I.fire(U)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(f,w,W){this._36I.add(f,w,W)},removeDataModelChangeListener:function(z,k){this._36I.remove(z,k)},addSerializeListener:function(T,B,s){this._serializeNotifier.add(T,B,s)},removeSerializeListener:function(k,x){this._serializeNotifier.remove(k,x)},fireSerializeEvent:function(I){this._serializeNotifier.fire(I)},addDataPropertyChangeListener:function(F,M,L){this._35I.add(F,M,L)},removeDataPropertyChangeListener:function(H,q){this._35I.remove(H,q)},_38I:function(T,e,l){this._37I&&this._37I.fire({data:T,oldIndex:e,newIndex:l})},addHierarchyChangeListener:function(i,b,W){this._37I||(this._37I=new Lm),this._37I.add(i,b,W)},removeHierarchyChangeListener:function(K,V){this._37I.remove(K,V)},getSiblings:function(g){var Q=g._parent;return Q?Q._children:this._roots},eachByHierarchical:function(h,O,l){if(O)return this._eachByHierarchical(h,O,l);for(var X=0,v=this._roots,T=v.size();T>X;X++)if(this._eachByHierarchical(h,v.get(X),l)===!1)return!1;return!0},_eachByHierarchical:function(h,K,V){if(V){if(h.call(V,K)===!1)return!1}else if(h(K)===!1)return!1;for(var N=K.size(),r=0;N>r;r++)if(this._eachByHierarchical(h,K.getChildAt(r),V)===!1)return!1;return!0},reverseEachByHierarchical:function(z,U,V){if(U)return this._reverseEachByHierarchical(z,U,V);for(var o=this._roots,r=o.size(),t=r-1;t>=0;t--)if(this._reverseEachByHierarchical(z,o.get(t),V)===!1)return!1;return!0},_reverseEachByHierarchical:function(F,u,t){for(var o=u.size(),e=o-1;e>=0;e--)if(this._reverseEachByHierarchical(F,u.getChildAt(e),t)===!1)return!1;if(t){if(F.call(t,u)===!1)return!1}else if(F(u)===!1)return!1;return!0},eachByDepthFirst:function(H,D,$){if(D)return this._11I(H,D,$);for(var k=0,b=this._roots,A=b.size();A>k;k++)if(this._11I(H,b.get(k),$)===!1)return!1;return!0},_11I:function(x,o,v){for(var j=o.size(),J=0;j>J;J++)if(this._11I(x,o.getChildAt(J),v)===!1)return!1;if(v){if(x.call(v,o)===!1)return!1}else if(x(o)===!1)return!1;return!0},eachByBreadthFirst:function(U,l,G){var O=new oc;for(l?O.add(l):this._roots.each(O.add,O);O.size()>0;)if(l=O.removeAt(0),l.eachChild(O.add,O),G){if(U.call(G,l)===!1)return!1}else if(U(l)===!1)return!1;return!0},moveTo:function(_,y){var A=this.getSiblings(_),C=A.indexOf(_);C===y||0>C||y>=0&&y<=A.size()&&(A.remove(_),y>A.size()&&y--,A.add(_,y),this._38I(_,C,y))},moveUp:function(K){this.moveTo(K,this.getSiblings(K).indexOf(K)-1)},moveDown:function(f){this.moveTo(f,this.getSiblings(f).indexOf(f)+1)},moveToTop:function(d){this.moveTo(d,0)},moveToBottom:function(X){this.moveTo(X,this.getSiblings(X).size())},moveSelectionUp:function(f){this.beginTransaction(),f||(f=this.sm());var q=new oc;om(f,q,this._roots),q.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(D){this.beginTransaction(),D||(D=this.sm());var y=new oc;go(D,y,this._roots),y.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(o){this.beginTransaction(),o||(o=this.sm());var U=new oc;lm(o,U,this._roots),U.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(J){this.beginTransaction(),J||(J=this.sm());var B=new oc;Rm(J,B,this._roots),B.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(V,_,f){var k=this.getDatas();null==f&&(f=k.indexOf(V)),f===_||0>f||_>=0&&_<=k.size()&&(k.remove(V),_>k.size()&&_--,k.add(V,_),this._76I(V,f,_))},bringForward:function(V){this.moveToIndex(V,this.getDatas().indexOf(V)+1)},bringToFront:function(q){this.moveToIndex(q,this.size())},sendBackward:function(Z){this.moveToIndex(Z,this.getDatas().indexOf(Z)-1)},sendToBack:function(B){this.moveToIndex(B,0)},bringSelectionForward:function(p){this.beginTransaction(),p||(p=this.sm());for(var A=new oc,o=this.getDatas(),k=!1,J=0;J<o.size();J++){var T=o.get(o.size()-1-J);p.contains(T)?k&&A.add(T):k=!0}A.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(A){this.beginTransaction(),A||(A=this.sm());for(var C=new oc,s=this.getDatas(),X=0;X<s.size();X++){var H=s.get(X);A.contains(H)&&C.add(H)}C.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(g){this.beginTransaction(),g||(g=this.sm());for(var h=new oc,X=this.getDatas(),e=!1,C=0;C<X.size();C++){var b=X.get(C);g.contains(b)?e&&h.add(b):e=!0}h.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(A){this.beginTransaction(),A||(A=this.sm());for(var X=new oc,Z=this.getDatas(),M=0;M<Z.size();M++){var C=Z.get(Z.size()-1-M);A.contains(C)&&X.add(C)}X.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(b){var C=this;C.removeScheduleTask(b),b.enabled==E&&(b.enabled=!0),b.interval==E&&(b.interval=10),b.lastTime=Date.now(),C._29Q.push(b),C._30Q==E&&(C._30Q=Q.requestAnimationFrame(C._scheduleCallback))},removeScheduleTask:function(w){var I=this,f=I._29Q,v=f.indexOf(w);v>=0&&f.splice(v,1),f.length||I._30Q==E||(Q.cancelAnimationFrame(I._30Q),delete I._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(P){this._historyManager||new h.HistoryManager(this),null!=P&&this._historyManager.setMaxHistoryCount(P),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(G){this._historyManager&&this._historyManager.undo(G)},redo:function(x){this._historyManager&&this._historyManager.redo(x)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(p){this._historyManager&&this._historyManager.addHistory(p)},onHistoryManagerChanged:function(){},isDeserializing:function(){return this._isDeserializing>0},setDeserializing:function(K){K?this._isDeserializing++:this._isDeserializing--},isCubicEnvmap:function(){return!1},setCubicEnvmap:function(){},setEnvmap:function(v){var N=this._envmap;this._envmap=v,N===v&&bs(N)&&bs(v)&&(N=[]),this.fp("envmap",N,v)}});var gi=h.SelectionModel=function(U){var z=this;z._68O=Ho,z._map={},z._73O=new oc,z._74I=new Lm,z._21I(U)};lq("SelectionModel",O,{ms_fire:1,ms_dm:1,ms:function(l,a,H){this.addSelectionChangeListener(l,a,H)},ums:function(Q,K){this.removeSelectionChangeListener(Q,K)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===qr},co:function(W){return this._map[W._id]!=E},ss:function(O){this.setSelection(O)},as:function(O){this.appendSelection(O)},rs:function(x){this.removeSelection(x)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(d){var X=this;if(X._68O!==d&&(d===cn||d===qr||d===Ho)){X.cs();var m=X._68O;X._68O=d,X.fp("selectionMode",m,d)}},_21I:function(R){var K=this,Z=K._dataModel;Z!==R&&(Z&&(K.cs(),Z.umm(K.handleDataModelChange,K)),K._dataModel=R,R.mm(K.handleDataModelChange,K,!0),K.fp(ac,Z,R))},dispose:function(){var G=this;G.cs(),G._dataModel.umm(G.handleDataModelChange,G)},handleDataModelChange:function(B){var G=this;if(B.kind===Fk){var c=B.data;G.co(c)&&(G._73O.remove(c),delete G._map[c._id],G._75I(Fk,new oc(c)))}else B.kind===cl&&G.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(n){var M=this;if(M._filterFunc!==n){M.cs();var P=M._filterFunc;M._filterFunc=n,M.fp("filterFunc",P,M._filterFunc)}},_75I:function(J,s,$,A){$&&(this._73O.each(function(F){A[F._id]?$.remove(F):$.add(F)}),s=$.toList()),this._74I.fire({kind:J,datas:new oc(s)})},addSelectionChangeListener:function(h,v,E){this._74I.add(h,v,E)},removeSelectionChangeListener:function(o,U){this._74I.remove(o,U)},_97O:function(T,o){for(var L,Z=this,s=0,i=new oc(T);s<i.size();s++)L=i.get(s),(Z._filterFunc&&!Z._filterFunc(L)||o&&Z.co(L)||!o&&!Z.co(L)||!Z._dataModel.contains(L))&&(i.removeAt(s),s--);return i},appendSelection:function(D){var d=this;if(d._68O!==cn){var s,X,U=d._73O,M=d._97O(D,!0);M.isEmpty()||(d.sg()&&(s=new oc(U),X=d._map,U.clear(),d._map={},M=new oc(M.get(M.size()-1))),M.each(function(y){U.add(y),d._map[y._id]=y}),d._75I("append",M,s,X))}},removeSelection:function(q){var n=this,m=n._97O(q),J=0,H=m.size();if(0!==H){for(;H>J;J++){var V=m.get(J);n._73O.remove(V),delete n._map[V._id]}n._75I(Fk,m)}},toSelection:function(B,r){return this._73O.toList(B,r)},getSelection:function(){return this._73O},each:function(E,_){this._73O.each(E,_)},setSelection:function(S){var A=this,f=A._73O;if(A._68O!==cn&&!(f.isEmpty()&&!S||1===f.size()&&A.ld()===S)){var e=new oc(f),N=A._map;f.clear(),A._map={};var y=A._97O(S,!0);A.sg()&&y.size()>1&&(y=new oc(y.get(y.size()-1))),y.each(function(x){f.add(x),A._map[x._id]=x}),A._75I("set",E,e,N)}},clearSelection:function(){var u=this,$=u._73O;if($.size()>0){var e=$.toList();$.clear(),u._map={},u._75I(cl,e)}},selectAll:function(){var C=this;if(C._68O!==cn){var U,Q,G=C._dataModel.toDatas();if(C._filterFunc)for(U=0;U<G.size();U++)Q=G.get(U),C._filterFunc(Q)||(G.removeAt(U),U--);var i=C._73O,p=new oc(i),o=C._map;i.clear(),C._map={},C.sg()&&G.size()>1&&(G=new oc(G.get(G.size()-1)));var l=G.size();for(U=0;l>U;U++)Q=G.get(U),i.add(Q),C._map[Q._id]=Q;C._75I("all",E,p,o)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(b){return this._map[b._id]!=E},getLastData:function(){var h=this._73O;return h.size()>0?h.get(h.size()-1):E},getFirstData:function(){var o=this._73O;return o.size()>0?o.get(0):E},isSelectable:function(s){var u=this;return s&&u._68O!==cn?u._filterFunc?u._filterFunc(s):!0:!1},getTopSelection:function(){var P=this,W=new oc;return P._73O.each(function(w){for(var e=w.getParent();e;){if(P.contains(e)){w=E;break}e=e.parent}w&&W.add(w)}),W}});var ps=function(){return hb(0),function(a,W){var t;if(Dl(W)){var A=a.getDataUI(W);A&&A._88I&&(t=A._88I.rect)}return t?t:W.getRect()}}();Sn(K,{edgeGroupAgentFunc:E,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:T.rectSelectBorder,graphViewRectSelectBackground:nm,graphViewEditPointSize:kd?17:7,graphViewEditPointBorderColor:T.editPointBorder,graphViewEditPointBackground:T.editPointBackground,setEdgeType:function(L,u,C){nr[L]=u,fm[L]=C},getEdgeType:function(K){return nr[K]},getEdgeTypeMap:function(){return nr},getNodeRect:ps},!0);var yn={"layout.h":P,"layout.v":P,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":P,"2d.attachable":!1,"2d.hostable":!1,interactive:!1,preventDefaultWhenInteractive:!0,disableDoubleClick:!1,"image.stretch":"fill",icons:P,ingroup:!0,"body.color":P,"2d.gray":!1,fullscreen:P,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:P,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"vector.layoutable":!1,"clip.direction":"top","clip.percentage":P,"clip.host":!1,"select.color":Yc,"select.width":1,"select.padding":2,"select.type":Vd,"shadow.interactable":!0,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,shadow2:!1,"shadow2.color":Yc,"shadow2.blur":6,"shadow2.offset.x":3,"shadow2.offset.y":3,"border.color":P,"border.width":2,"border.padding":2,"border.type":Vd,label:P,"label.font":P,"label.color":Hq,"label.background":P,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":P,"label.max":P,"label.opacity":P,"label.scale":1,"label.align":P,"label.selectable":!0,"label.decoration":P,label2:P,"label2.font":P,"label2.color":Hq,"label2.background":P,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":P,"label2.max":P,"label2.opacity":P,"label2.scale":1,"label2.align":P,"label2.selectable":!0,"label2.decoration":P,note:P,"note.expanded":!0,"note.font":P,"note.color":Km,"note.background":Yc,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":P,"note.toggleable":!0,"note.border.width":1,"note.border.color":P,"note.opacity":P,"note.scale":1,"note.align":P,note2:P,"note2.expanded":!0,"note2.font":P,"note2.color":Km,"note2.background":Yc,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":P,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":P,"note2.opacity":P,"note2.scale":1,"note2.align":P,"group.type":P,"group.image":P,"group.image.stretch":"fill","group.repeat.image":P,"group.border.repeat.image":P,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":P,"group.title.color":Km,"group.title.background":T.groupTitleBackground,"group.title.align":zi,"group.title.orientation":Mo,"group.background":T.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":P,"group.border.color":hk,"group.border.radius":P,"group.border.cap":Vg,"group.border.join":Wh,"group.border.width.absolute":!1,"group.splitLine":!1,"group.gradient":E,"group.gradient.color":"#FFF",shape:P,"shape.background":hk,"shape.repeat.image":P,"shape.border.repeat.image":P,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":hk,"shape.border.3d":!1,"shape.border.3d.color":P,"shape.border.3d.accuracy":P,"shape.border.cap":Vg,"shape.border.join":Wh,"shape.border.pattern":P,"shape.gradient":E,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":fj,"shape.dash.offset":0,"shape.dash.color":Ur,"shape.dash.width":P,"shape.dash.3d":!1,"shape.dash.3d.color":P,"shape.dash.3d.accuracy":P,"shape.polygon.side":6,"shape.arc.from":D,"shape.arc.to":a,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":P,"shape.gradient.pack":P,"shape.border.gradient.pack":P,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":P,"shape.foreground":P,"shape.foreground.gradient":E,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":P,"shape.regular":!0,"autolayout.gap":P,"autolayout.hgap":P,"autolayout.vgap":P,"edge.type":P,"edge.points":P,"edge.segments":P,"edge.color":hk,"edge.width":2,"edge.width.absolute":!1,"edge.repeat.image":null,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":P,"edge.3d.accuracy":P,"edge.cap":Vg,"edge.join":Wh,"edge.source.position":17,"edge.source.anchor.x":P,"edge.source.anchor.y":P,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.source.index":-1,"edge.source.percent":0,"edge.target.position":17,"edge.target.anchor.x":P,"edge.target.anchor.y":P,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.target.index":-1,"edge.target.percent":0,"edge.pattern":P,"edge.dash":!1,"edge.dash.pattern":fj,"edge.dash.offset":0,"edge.dash.color":Ur,"edge.dash.width":P,"edge.dash.3d":!1,"edge.dash.3d.color":P,"edge.dash.3d.accuracy":P,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":P,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":P,"grid.column.percents":P,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":T.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":T.gridCellBorderColor,"grid.block":P,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":T.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":Hq,"text.gradient.pack":P,"text.font":Th,"text.shadow":!1,"text.shadow.color":Yc,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,"text.gradient":P,"text.gradient.color":"#FFF","text.decoration":P,"text.vertical":!1,"text.vertical.gap":1,"text.wrap":!1,"text.letter.gap":null,"text.border.color":Yc,"text.border.width":0,keepPosition:!0};yn[qp]=P,Sn(N,yn,!0),Sn(ed,{_76I:function(v,T,L){this._39I&&this._39I.fire({data:v,oldIndex:T,newIndex:L})},addIndexChangeListener:function(_,z,k){var M=this;M._39I||(M._39I=new Lm),M._39I.add(_,z,k)},removeIndexChangeListener:function(T,p){this._39I.remove(T,p)},prepareRemove:function(O){bf(O)&&(O.setSource(E),O.setTarget(E)),O._70O&&O._70O.toList().each(this.remove,this),O._69O&&O._69O.toList().each(function(N){N.setHost(E)}),O._host&&O.setHost(E)},onAdded:function(e){this.isAutoAdjustIndex()&&this.adjustIndex(e)},onDataPropertyChanged:function(S,b){Yd[b.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(S)},isAdjustable:function(E){return bk(E)||bf(E)},isAdjustedToBottom:function(l){return Kp(l)?l.isExpanded()&&qg(l):!1},adjustIndex:function(R){var S=this;this.isHierarchicalRendering()||(S.isAdjustedToBottom(R)?(S.sendToBottom(R),R.eachChild(S.adjustIndex,S)):S.sendToTop(R))},sendToTop:function(v){var e=this;if(e.contains(v)&&e.isAdjustable(v)){var f=e._datas;if(v!==f.get(e.size()-1)){var J=f.indexOf(v);f.removeAt(J),f.add(v),e._76I(v,J,e.size()-1)}if(bf(v)){var s=v._40I;s&&!e.isAdjustedToBottom(s)&&e.sendToTop(s),s=v._41I,s&&!e.isAdjustedToBottom(s)&&e.sendToTop(s)}v._69O&&v._69O.each(function(L){L.isRelatedTo(v)||bk(v)&&L.isLoopedHostOn(v)||e.sendToTop(L)}),v.ISubGraph||(!Kp(v)||v.isExpanded())&&v._adjustChildrenToTop&&v.eachChild(function(X){bf(X)||e.sendToTop(X)})}},sendToBottom:function(c,F){var r=this;if(c!==F&&r.contains(c)&&r.isAdjustable(c)&&(!F||r.contains(F))){var X=r._datas,D=X.remove(c),E=F?r._datas.indexOf(F):0;if(X.add(c,E),D!==E){r._76I(c,D,E);var C=c._parent;!C||C.ISubGraph||bf(C)||r.sendToBottom(c._parent,c)}}}}),Sn(wp,{ms_edit:function(A){A._46O=function(D){var v=this,p=v.gv.dm(),F=v._index,y=v._89I,n=v._node,m=v._shape,l=v._edge,i=v._77I;n&&y?(this.fi({kind:"endEditRect",event:D,data:n,direction:y}),p.endTransaction()):m&&F>=0?(v.fi({kind:"endEditPoint",event:D,data:m,index:F}),p.endTransaction()):l&&F>=0?(v.fi({kind:"endEditPoint",event:D,data:l,index:F}),p.endTransaction()):i&&(v.fi({kind:"endEditRotation",event:D,data:i}),p.endTransaction())},A._78I=function(d){var g=this;g.autoScroll(d);var r=g.gv.lp(d),X=g._index,n=g._89I,z=g._node,c=g._shape,A=g._edge,w=g._77I;if(z&&n)g._80O(r),g.fi({kind:"betweenEditRect",event:d,data:z,direction:n});else if(c&&X>=0)r.e=c.getPoints().get(X).e,c.setPoint(X,r),g.fi({kind:"betweenEditPoint",event:d,data:c,index:X});else if(A&&X>=0){var T=A.s(rs);r.e=T.get(X).e,T.set(X,r),A.fp(rs,E,T),g.fi({kind:"betweenEditPoint",event:d,data:A,index:X})}else if(w){var q=w.p(),Y=w.getScale(),o=ss+Hr(r.y-q.y,r.x-q.x);Y.y<0&&(o+=D),B(o)<.04&&(o=0),w.setRotation(o),g.fi({kind:"betweenEditRotation",event:d,data:w})}},A._80O=function(B){var w=this,P=w._node,Y=w._rect,A=Y.x,m=Y.y,o=Y.width,K=Y.height,C=w._89I,x=w._anchor,E=w._matrix,B=E.tfi(B);"northwest"===C?Y=Nd(B,{x:A+o,y:m+K}):C===Rk?Y=Nd({x:A,y:B.y},{x:A+o,y:m+K}):"northeast"===C?Y=Nd({x:A,y:B.y},{x:B.x,y:m+K}):C===Zb?Y=Nd({x:B.x,y:m},{x:A+o,y:m+K}):C===Tp?Y=Nd({x:A,y:m},{x:B.x,y:m+K}):"southwest"===C?Y=Nd({x:B.x,y:m},{x:A+o,y:B.y}):"south"===C?Y=Nd({x:A,y:m},{x:A+o,y:B.y}):"southeast"===C&&(Y=Nd({x:A,y:m},B)),P.setPosition(E.tf(Y.x+Y.width*x.x,Y.y+Y.height*x.y)),P.setWidth(Y.width),P.setHeight(Y.height)},A._80I=function(K,k,A,B){var W=this,F=W.gv._zoom,w=(W.gv.getEditPointSize()+2)/F;return mg({x:k-w/2,y:A-w/2,width:w,height:w},K)?(W._89I!==B&&(W._89I=B),!0):!1},A._79I=function(T,G,n){var k=this,q=k.gv,B=G?q.getDataUI(G):E,C=B?B._55O:E;if(C){var e,O,R,c,j=q._zoom,Z=(q.getEditPointSize()+2)/j,z=q.lp(T);if(bk(G)){if(C._56O&&bk(G)&&(O=C._98o,mg({x:O.x-Z/2,y:O.y-Z/2,width:Z,height:Z},z)))return k._77I=G,n&&k.fi({kind:"beginEditRotation",event:T,data:G}),k.setCursor("crosshair"),!0;if(C._43O&&G instanceof Ap)for(R=G.getPoints(),e=R.size()-1;e>=0;e--)if(O=R.get(e),mg({x:O.x-Z/2,y:O.y-Z/2,width:Z,height:Z},z))return k._index=e,k._shape=G,n&&k.fi({kind:"beginEditPoint",event:T,data:G,index:e}),k.setCursor("crosshair"),!0;if(C._42O)for(var S=G.getEditControlPoints(),r=["northwest",-1,-1,Zb,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Tp,1,0,"northeast",1,-1,Rk,0,-1],e=0,c=S.length;c>e;e++){var P=r[3*e],b=S[e];if(k._80I(z,b.x,b.y,P)){k._node=G;var p=G.getWidth(),F=G.getHeight(),V=G.getAnchor();k._rect={x:-p*V.x,y:-F*V.y,width:p,height:F},k._anchor=V,k._matrix=G.getMatrix();var I=G.getRotation(),L=W(I),X=l(I),M=r[3*e+1]*ji(G.getScale().x),x=r[3*e+2]*ji(G.getScale().y),o=Math.atan2(-X*M-L*x,L*M-X*x),Y=(Math.round(o/(Math.PI/4))+8)%8,U=[sj,"nesw-resize",hd,"nwse-resize",sj,"nesw-resize",hd,"nwse-resize"][Y];return k.setCursor(U),n&&k.fi({kind:"beginEditRect",event:T,data:G,direction:k._89I}),!0}}}if(C._43O&&bf(G)&&G.s(Ig)===Qr&&(R=G.s(rs)))for(e=R.size()-1;e>=0;e--)if(O=R.get(e),mg({x:O.x-Z/2,y:O.y-Z/2,width:Z,height:Z},z))return k._index=e,k._edge=G,n&&k.fi({kind:"beginEditPoint",event:T,data:G,index:e}),k.setCursor("crosshair"),!0}return!1}},ms_gv:function(e){e._currentSubGraph=E,e._initView=function(){this._fpsInfo={time:0,fps:0,frames:0}},e.upSubGraph=function(){this.setCurrentSubGraph(gs(this._currentSubGraph))},e.isVisible=function(p){var d=this;if(gs(p)!==d._currentSubGraph)return!1;if(bf(p)){var U=p._40I,M=p._41I;if(!U||!M)return!1;
if(!(p.s("edge.independent")||d.isVisible(U)&&d.isVisible(M)))return!1;if(p.isEdgeGroupHidden())return!1}else for(var X=p._parent;X&&!X.ISubGraph;){if(Kp(X)&&(!X.isExpanded()||!d.isVisible(X)))return!1;X=X._parent}if(p._parent instanceof aq&&!d.isVisible(p._parent))return!1;if(p._refGraph instanceof Sg&&!d.isVisible(p._refGraph))return!1;if(d instanceof Gs){if(!p.s("3d.visible"))return!1}else{var R=d.getLayersInfo();if(R){var I=R[p._layer];if(I&&I.visible===!1)return!1}if(!p.s("2d.visible"))return!1}return d._visibleFunc?d._visibleFunc(p):!0},e.handleSelectionChange=function(r){var U=this;r.datas.each(function(D){U.invalidateData(D);var q=D._parent;Kp(q)&&bk(D)&&D.s(eb)&&(U.invalidateData(q),q._49I&&q._49I.each(function(j){U.invalidateData(j)}))}),U.onSelectionChanged(r)},e.onSelectionChanged=function(N){var s=this,Q=s.sm();if(1===Q.size()&&("set"===N.kind||"append"===N.kind)){var d=Q.ld();s.isAutoMakeVisible()&&s.makeVisible(d),s.adjustIndex&&s._dataModel.isAutoAdjustIndex()&&s.adjustIndex(d)}},e.makeVisible=function(s){if(s){var F=this,h=F.getDataUI?F.getDataUI(s):F.getData3dUI(s);if(h){var j=s,O=gs(s);for(O!==F._currentSubGraph&&F.setCurrentSubGraph(O);(j=j._parent)&&j!==O;)Kp(j)&&j.setExpanded(!0);F._23I=s,F.iv()}}},e.getLabel=function(f){var e=f.getStyle(em);return e===P?f.getName():e},e.getLabelBackground=function(M){return M.getStyle("label.background")},e.getLabelColor=function(m){return m.getStyle("label.color")},e.getLabel2=function(q){return q.getStyle("label2")},e.getLabel2Background=function(w){return w.getStyle("label2.background")},e.getLabel2Color=function(R){return R.getStyle("label2.color")},e.getNote=function(p){return p.getStyle(qh)},e.getNoteBackground=function(K){return K.getStyle("note.background")},e.getNote2=function(T){return T.getStyle(qk)},e.getNote2Background=function(B){return B.getStyle("note2.background")},e.handleClick=function(O,r,X){var s=this;r?(s.fi({kind:"clickData",event:O,data:r,part:X}),s.onDataClicked(r,O)):(s.fi({kind:"clickBackground",event:O}),s.onBackgroundClicked(O))},e.handleDoubleClick=function(x,b,g){var v=this;kp(x)&&(b?(v.fi({kind:"doubleClickData",event:x,data:b,part:g}),v.onDataDoubleClicked(b,x,g),v.checkDoubleClickOnNote(x,b,g)||v.checkDoubleClickOnRotation&&v.checkDoubleClickOnRotation(x,b,g)||(bf(b)?v.onEdgeDoubleClicked(b,x,g):b.ISubGraph?v.onSubGraphDoubleClicked(b,x,g):Kp(b)?v.onGroupDoubleClicked(b,x,g):b.IDoorWindow?v.onDoorWindowDoubleClicked(b,x,g):b.ICSGBox&&v.onCSGBoxDoubleClicked(b,x,g))):(v.fi({kind:"doubleClickBackground",event:x}),v.onBackgroundDoubleClicked(x)))},e.onSubGraphDoubleClicked=function(J){this.setCurrentSubGraph(J)},e.onEdgeDoubleClicked=function(w,Y){this.isEditable(w)||(w.ISubGraph&&!Bj(Y)?this.setCurrentSubGraph(w):w.s("edge.toggleable")&&w.toggle())},e._39Q=function(R){return this.isInteractive(R)?this.preventDefaultWhenInteractive(R):!1},e.preventDefaultWhenInteractive=function(f){return f.s("preventDefaultWhenInteractive")},e.onGroupDoubleClicked=function(M){M.s("group.toggleable")&&M.toggle()},e.onDoorWindowDoubleClicked=function(o){o.s("dw.toggleable")&&o.toggle(!0)},e.onCSGBoxDoubleClicked=function(s,V){var n=this;if(n instanceof Gs){var j=n.intersectObject(V,s);j&&s.s(j.part+".toggleable")&&s.toggleFace(j.part,!0)}},e.onBackgroundClicked=function(){},e.onBackgroundDoubleClicked=function(){this.upSubGraph()},e.onDataClicked=function(){},e.onDataDoubleClicked=function(){},e.onAutoLayoutEnded=function(){},e.onMoveEnded=function(){},e.onPanEnded=function(){},e.onPinchEnded=function(){},e.onRectSelectEnded=function(){},e.onZoomEnded=function(){},e.serialize=function(H){return this.dm().serialize(H)},e.toJSON=function(){return this.dm().toJSON()},e.deserialize=function(k,Z){var z=this;Z=Z instanceof Lk?{rootParent:Z}:mh(Z)?{setId:Z}:tj(Z)?{finishFunc:Z}:Z||{},Z.view=z;var m=z.dm();return Z.reset&&(m.setAttrObject({}),m.setLayers(P),m.setName(P),m.setAutoAdjustIndex(!0),m.setHierarchicalRendering(!1),m.setBackground(P),m.setInit(P),m.setPostProcessingData(P),m.setEnvmap(P),m.setEnvmapType(P),z.disableToolTip(),z instanceof h.graph.GraphView?(z.setZoomable(K.graphViewZoomable),z.setPannable(K.graphViewPannable),z.setRectSelectable(K.graphViewRectSelectable)):z instanceof h.graph3d.Graph3dView&&(z.shadowMap.resetProperties(),z.setDashDisabled(K.graph3dViewDashDisabled),z.setUvClipEnabled(K.graph3dViewUvClipEnabled),z.getHighlightHelper().resetProperties(),z.resetHeadlightProperties(),z.resetFogProperties(),z.setBatchInfoMap({}),z.setBatchColorDisabled(K.graph3dViewBatchColorDisabled),z.setBatchInstancedDisabled(K.graph3dViewBatchInstancedDisabled),z.setBatchBlendDisabled(K.graph3dViewBatchBlendDisabled),z.setBatchBrightnessDisabled(K.graph3dViewBatchBrightnessDisabled),z.setFlowBlendMode(K.graph3dViewFlowBlendMode),z.setMoveStep(K.graph3dViewMoveStep),z.setRotateStep(K.graph3dViewRotateStep),z.setSortable(K.graph3dViewSortable),z.setSortFunc(P),z.setSkybox(P),Zi(z))),Z.__innerHandler__=function(r){if(mh(m.a("toolTipEnable"))&&(m.a("toolTipEnable")?z.enableToolTip():z.disableToolTip()),bs(m.a("fontFaces"))&&m.a("fontFaces").forEach(function(y){K.addFontFace(y.name,y.url)}),z instanceof h.graph.GraphView&&(mh(m.a("zoomable"))&&z.setZoomable&&z.setZoomable(m.a("zoomable")),mh(m.a("pannable"))&&z.setPannable&&z.setPannable(m.a("pannable")),mh(m.a("rectSelectable"))&&z.setRectSelectable&&z.setRectSelectable(m.a("rectSelectable")),m.a("fitContent")===!0&&z.fitContent&&z.fitContent(!0,0)),z instanceof h.graph3d.Graph3dView){var O=r.scene;O&&O.shadow!=E&&z.shadowMap.setShadow(O.shadow,O.shadowParams);var M=m.a("sceneContext");M?(M.eye&&z.setEye(M.eye),M.center&&z.setCenter(M.center),Kg(M.far)&&z.setFar(M.far),Kg(M.near)&&z.setNear(M.near)):(Kg(m.a("sceneNear"))&&z.setNear(m.a("sceneNear")),Kg(m.a("sceneFar"))&&z.setFar(m.a("sceneFar")),O&&(O.eye&&z.setEye(O.eye),O.center&&z.setCenter(O.center))),Kg(m.a("sceneFovy"))&&z.setFovy(m.a("sceneFovy")),mh(m.a("sceneOrtho"))&&z.setOrtho(m.a("sceneOrtho")),Kg(m.a("sceneOrthoWidth"))&&z.setOrthoWidth(m.a("sceneOrthoWidth")),mh(m.a("sceneShadowEnabled"))&&(m.a("sceneShadowEnabled")?z.enableShadow():z.disableShadow()),Kg(m.a("sceneShadowDegreeX"))&&z.setShadowDegreeX(m.a("sceneShadowDegreeX")),Kg(m.a("sceneShadowDegreeZ"))&&z.setShadowDegreeZ(m.a("sceneShadowDegreeZ")),Kg(m.a("sceneShadowIntensity"))&&z.setShadowIntensity(m.a("sceneShadowIntensity")),m.a("sceneShadowQuality")!=E&&z.setShadowQuality(m.a("sceneShadowQuality")),m.a("sceneShadowType")&&z.setShadowType(m.a("sceneShadowType")),Kg(m.a("sceneShadowRadius"))&&z.setShadowRadius(m.a("sceneShadowRadius")),Kg(m.a("sceneShadowBias"))&&z.setShadowBias(m.a("sceneShadowBias")),mh(m.a("sceneDashEnable"))&&z.setDashDisabled(!m.a("sceneDashEnable")),mh(m.a("sceneUvClipEnabled"))&&z.setUvClipEnabled(m.a("sceneUvClipEnabled")),Om(m.a("sceneHighlightMode"))&&z.setHighlightMode(m.a("sceneHighlightMode")),Kg(m.a("sceneHighlightWidth"))&&z.setHighlightWidth(m.a("sceneHighlightWidth")),m.a("sceneHighlightColor")&&z.setHighlightColor(m.a("sceneHighlightColor")),m.a("sceneHighlightType")&&z.setHighlightType(m.a("sceneHighlightType")),m.a("sceneHighlightGlow")&&z.setHighlightGlow(m.a("sceneHighlightGlow")),m.a("sceneHighlightStrength")&&z.setHighlightStrength(m.a("sceneHighlightStrength")),mh(m.a("sceneHeadlightEnable"))&&z.setHeadlightDisabled(!m.a("sceneHeadlightEnable")),m.a("sceneHeadlightDirection")!=E&&z.setHeadlightDirection(m.a("sceneHeadlightDirection")),Kg(m.a("sceneHeadlightRange"))&&z.setHeadlightRange(m.a("sceneHeadlightRange")),m.a("sceneHeadlightColor")&&z.setHeadlightColor(m.a("sceneHeadlightColor")),Kg(m.a("sceneHeadlightIntensity"))&&z.setHeadlightIntensity(m.a("sceneHeadlightIntensity")),Kg(m.a("sceneHeadlightAmbientIntensity"))&&z.setHeadlightAmbientIntensity(m.a("sceneHeadlightAmbientIntensity")),Kg(m.a("sceneHeadlightGroup"))&&z.setHeadlightGroup(m.a("sceneHeadlightGroup")),mh(m.a("sceneFogEnable"))&&z.setFogDisabled(!m.a("sceneFogEnable")),m.a("sceneFogMode")&&z.setFogMode(m.a("sceneFogMode")),Kg(m.a("sceneFogDensity"))&&z.setFogDensity(m.a("sceneFogDensity")),m.a("sceneFogColor")&&z.setFogColor(m.a("sceneFogColor")),Kg(m.a("sceneFogNear"))&&z.setFogNear(m.a("sceneFogNear")),Kg(m.a("sceneFogFar"))&&z.setFogFar(m.a("sceneFogFar")),mh(m.a("sceneBatchBrightnessDisabled"))&&z.setBatchBrightnessDisabled(m.a("sceneBatchBrightnessDisabled")),m.a("sceneFlowBlendMode")!==P&&z.setFlowBlendMode(m.a("sceneFlowBlendMode")),mh(m.a("sceneBatchBlendDisabled"))&&z.setBatchBlendDisabled(m.a("sceneBatchBlendDisabled")),mh(m.a("sceneBatchColorDisabled"))&&z.setBatchColorDisabled(m.a("sceneBatchColorDisabled")),mh(m.a("sceneBatchInstancedDisabled"))&&z.setBatchInstancedDisabled(m.a("sceneBatchInstancedDisabled")),m.a("sceneBatchInfoMap")&&z.setBatchInfoMap(m.a("sceneBatchInfoMap")),m.a("sceneRenderLayerInfoMap")&&z.setRenderLayerInfoMap(m.a("sceneRenderLayerInfoMap")),Kg(m.a("sceneMoveStep"))&&z.setMoveStep(m.a("sceneMoveStep")),Kg(m.a("sceneRotateStep"))&&z.setRotateStep(m.a("sceneRotateStep")),mh(m.a("sceneSortable"))&&z.setSortable(m.a("sceneSortable")),tj(m.a("sceneSortFunc"))&&z.setSortFunc(m.a("sceneSortFunc"));var p=m.a("sceneSkyboxType")||"sphere";if(p!=E){var v={},n=!1;if("sphere"===p){v.shape3d=p;var e=m.a("sceneSkyboxImage");e&&(v["shape3d.image"]=e,n=!0)}else"cube"===p?(v.shape3d=P,["front","back","left","right","top","bottom"].forEach(function(U){var O=U+".image",s=U.charAt(0).toUpperCase()+U.slice(1),i=m.a("sceneSkybox"+s+"Image");i&&(v[O]=i,n=!0)})):"color"===p&&(n=!0);if(n){var N=new xi,d=m.a("sceneSkyboxDiameter");if(Kg(d)?N.s3(d,d,d):N.s3(20,20,20),v["body.color"]=m.a("sceneSkyboxBodyColor"),v.envmap=m.a("sceneSkyboxEnvmap"),v["envmap.probe"]=m.a("sceneSkyboxEnvmapProbe"),v.roughness=m.a("sceneSkyboxRoughness"),v["shape3d.light"]=v["all.light"]=m.a("sceneSkyboxLight"),v["light.mask"]=m.a("sceneSkyboxLightMask"),v["headlight.ambientIntensity"]=m.a("sceneSkyboxHeadLightAmbientIntensity"),v["texture.wrap"]="clampToEdge",v["3d.clipbox.mask"]=yi,v["effect.flow.mask"]=yi,"color"===p){v.shape3d="sphere";var V=2,H=1024,e=N.s("shape3d.image"),t=e&&h.Default.getImage(e);t&&"CANVAS"===t.tagName||(t=f.createElement("canvas"),e=h.Math.generateUUID(),h.Default.setImage(e,t)),e&&z.getTextureMap()&&z.deleteTexture(e),h.Default.setCanvas(t,V,H,1);var G=t.getContext("2d");G.clearRect(0,0,V,H),G.beginPath(),G.rect(0,0,V,H),nn(G,m.a("sceneSkyboxColor"),function(I){return I},!1,{x:0,y:0,width:V,height:H}),G.fill(),G.restore(),v["shape3d.image"]=e}N.s(v),["X","Y","Z"].forEach(function(s){var l=m.a("sceneSkyboxRotation"+s);Kg(l)&&N["setRotation"+s](l)}),z.setSkybox(N)}}}},m.deserialize(k,Z.rootParent,Z)},e.isDebugTipShowing=function(){return!!this._debugDiv},e.showDebugTip=function(){var R=this,l=R._debugDiv;if(!l){l=R._debugDiv=f.createElement("div"),l.style.position="absolute",l.style.overflow="hidden",l.style.font=K.debugTipLabelFont,l.style.padding="6px",l.style.backgroundColor=K.debugTipBackground,l.style.color=K.debugTipLabelColor;var Q=R.getView();R._79O?Q.insertBefore(l,R._79O):Q.appendChild(l);var M=function(){R.redraw();var v=R._canvas,w="FPS: "+R._fpsInfo.fps+"<br/>"+"Datas: "+R.dm().getDatas().length+(v?"<br/>Size: "+v.width+" * "+v.height:""),t=R.dm()._historyManager;t&&(w+="<br/>Undoes: "+t.getHistories().length+" index: "+t.getHistoryIndex());var N=R.getDebugTip();N&&(w+="<hr>"+N),l.innerHTML=w,R._isDebugging&&requestAnimationFrame(M)};requestAnimationFrame(M),R._isDebugging=!0}},e.hideDebugTip=function(){var c=this,r=c._debugDiv;r&&(delete c._debugDiv,c.getView().removeChild(r),c._isDebugging=!1)},e.updateDOMAppendMatrix=function(){var s=this.getView();s&&(s.updateAppendMatrix=!0)},e.countFrame=function(){if(this._isDebugging){var J=Date.now(),_=this._fpsInfo;J-_.time>1e3?(_.fps=Math.round(1e5*(_.frames+1)/(J-_.time))/100,_.time=J,_.frames=0):_.frames++}}},ms_icons:function(t){t.getRotation=function(M){return M==E?0:M},t._15O=function(){var W=this,L=W.s(kj);if(L){var O=W,C=W.data||W._data,x=C.getRotation&&C.getRotation(),Z=W._38o={icons:L,rects:{}};for(var V in L){var M=L[V],r=as(M.shape3d,C,O);if(!(as(M.visible,C,O)===!1||as(M.for3d,C,O)&&!W.I3d||r&&!W.I3d)){var Y=r?[r]:as(M.names,C,O),j=Y?Y.length:0,f=as(M.position,C,O)||3,I=as(M.offsetX,C,O)||0,J=as(M.offsetY,C,O)||0,R=as(M.direction,C,O)||Tp,s=as(M.gap,C,O),a=s!=E?s:1,P=as(M.rotation,C,O),h=as(M.keepOrien,C,O),o=as(M.rotationFixed,C,O)?P:W.getRotation(P,h,f),u=E,B=Z.rects[V]=new Array(j);Kg(x)&&(Kg(o)?o+=x:o=x),B.rotation=o;for(var c=0;j>c;c++){var Q,z,e,l,y=Y[c];if(r)e=0,l=0;else{var F=fl(y);e=as(M.width,C,O),l=as(M.height,C,O),e==E&&(e=_r(F,C)),l==E&&(l=wm(F,C))}if(u?R===Tp?I+=e/2:R===Zb?I-=e/2:R===Rk?J-=l/2:J+=l/2:u={width:e,height:l},W.I3d){var q=-e/2,S=-l/2;z={width:e,height:l,mat:W._16O(as(M.autorotate,C,O),f,u,as(M.face,C,O)||Yp,as(M.t3,C,O),as(M.r3,C,O),as(M.rotationMode,C,O),I,J),vs:new Ui([q,-S,0,q,-S-l,0,q+e,-S-l,0,q+e,-S,0])}}else Q=W.getPosition(f,I,J,u,as(M.positionFixed,C,O)),z={x:Q.x-e/2,y:Q.y-l/2,width:e,height:l},W._68o(z,o);B[c]=z,R===Tp?I+=e/2+a:R===Zb?I-=e/2+a:R===Rk?J-=l/2+a:J+=l/2+a}}}}}}});var On={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},eg={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},zs={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Yd={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},yk={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},$q={"edge.type":1,"edge.group":1},Wj={rotation:1,rotationX:1,rotationZ:1,rotation3d:1},ud={rotation:1,position:1,width:1,height:1,anchor:1,scale:1,host:1,"s:vector.layoutable":1,"s:2d.visible":1},Np={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},ko={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},gr={shape:1,thickness:1,position:1,anchor:1,scale:1},gs=function(D){if(!D)return E;if(bf(D)){var s=D._40I,y=D._41I;if(!s||!y)return E;var d=gs(s),e=gs(y);return d===e?d:E}for(var X=D._parent;bf(X)&&!X.ISubGraph;)X=X._parent;return X?X.ISubGraph?X:gs(X):E},hs=function(j,h,a,E){var y=h.getStyle(a)*E;y&&rk(j,y),y=h.getStyle(a+".left")*E,y&&(j.x-=y,j.width+=y),y=h.getStyle(a+".right")*E,y&&(j.width+=y),y=h.getStyle(a+".top")*E,y&&(j.y-=y,j.height+=y),y=h.getStyle(a+".bottom")*E,y&&(j.height+=y),j.width<0&&(j.width=-j.width,j.x-=j.width),j.height<0&&(j.height=-j.height,j.y-=j.height)},qg=function(f){for(var M,_=0,U=f.size();U>_;_++)if(M=f.getChildAt(_),bk(M)&&qg(M))return!0;return f.hasAgentEdges()},Ee=function(V){if(!V)return E;for(var r=V._parent;Kp(r);){if(!Kp(r._parent))return r.isExpanded()?V:r;r.isExpanded()||(V=r),r=r._parent}return V},gh=function(B,F){if(!B||!F)return E;var b,y,h,c=gs(B),Q=gs(F);if(c!==Q){for(;Q&&c!==Q;)Q=gs(Q);if(c===Q)return B;b=new oc,b.add(B,0);for(var V=B._parent;bk(V)&&!F.isDescendantOf(V);)b.add(V,0),V=V._parent;for(h=b.size(),y=0;h>y;y++){var H=b.get(y);if(Kp(H)&&!H.isExpanded())return H;if(H.ISubGraph)return H}return B}return B},sd=function(I){if(I.isLooped())return I._source;var N=Ee(I._source),z=Ee(I._target);return N===z?I._source:gh(N,z)},Kk=function(U){if(U.isLooped())return U._target;var p=Ee(U._source),t=Ee(U._target);return p===t?U._target:gh(t,p)},yg=function(x,D,e){"target"!==e&&(e="source");var X="target"===e?D.getTargetAgent():D.getSourceAgent(),J="edge."+e+".";if(bf(X)){var E=x.getDataUI(X);E._79o();var R=D.s(J+"index");if(R>=0){var U=el(E);return U[Math.max(0,Math.min(R,U.length-1))]}var z=D.s(J+"percent")||0;z=Math.max(0,Math.min(z,1));var r=qo(E);return $r(r,100*z)}return Hb(x,X,D.s(J+"position"),D.s(J+"offset.x"),D.s(J+"offset.y"),D.s(J+"anchor.x"),D.s(J+"anchor.y"))},Hb=function(T,L,g,u,c,Y,e){if(!L)return E;var Q,I=L.getRotation?L.getRotation():0;if(Y!==P||e!==P){Y=Y===P?.5:Y,e=e===P?.5:e;var i=L.getScale();if(I&&!Dl(L,T)||i.x<0||i.y<0){var H=L.getPosition(),K=L.getWidth(),N=L.getHeight(),V=L.getAnchor(),D=new Jh(I,H.x,H.y,i.x,i.y);g=D.tf((Y-V.x)*K,(e-V.y)*N)}else Q=ps(T,L),g={x:Q.x+Y*Q.width,y:Q.y+e*Q.height}}else g=Ac(g,ps(T,L));if(I){var r=W(I),z=l(I),f=u*r-c*z;c=u*z+c*r,u=f}return g.x+=u,g.y+=c,g},Up=function(T,h){if(!T||!h)return E;var D,b,P,U,n,g;if(T===h){if(U=T.getLoopedEdges(),!U)return E;U=new oc(U)}else{if(n=T.getAgentEdges(),g=h.getAgentEdges(),!n||!g)return E;for(b=n.size(),D=0;b>D;D++)P=n.get(D),g.contains(P)&&(U||(U=new oc),U.add(P))}if(U)for(D=0;D<U.size();D++)P=U.get(D),P.getStyle(Ig)===Qr&&(P._22I(E),U.removeAt(D),D--);return U},ob=function(l,w){var n=Up(l,w);if(n&&!n.isEmpty()){if(1===n.size())return n.get(0)._22I(E),void 0;var O=new oc,Z=new oc;n.each(function(U){var q=U.s("edge.group");O.contains(q)||O.add(q)}),O.sort(),O.each(function(u){Z.add(new h.EdgeGroup(n.toList(function(E){return u===E.s("edge.group")}),Z))}),Z.each(function(b){b.each(function(S){S._22I(b)})})}},ns=function(O,S,l){var y=O._canvas;O._zoom;var m=Fg(S,y),z=Fg(l,y);return{x:m.x-z.x,y:m.y-z.y}},co=function(v,L){if(L){var C=L.rect,s=L.color,X=L.rotation,Z=L.labelWidth,K=L.background,A=L.opacity,m=L.scale,F=m!=E&&1!==m;if(A!=E){var u=v.globalAlpha;v.globalAlpha*=A}if(X||F){v.save();var j=C.x+C.width/2,k=C.y+C.height/2;xc(v,j,k),X&&pl(v,X),F&&v.scale(m,m),xc(v,-j,-k)}if(K&&cs(v,C.x,C.y,C.width,C.height,K),Z){var r=C.width,f=v.createLinearGradient(C.x,C.y,C.x+r,C.y);f.addColorStop(0,s),f.addColorStop(.9,s),f.addColorStop(1,Mm),s=f,C.width=Z}ai(v,L.ss,C,L.font,s,L.align,L.decoration),Z&&(C.width=r),(X||F)&&v.restore(),A!=E&&(v.globalAlpha=u)}},cp=function(u,C){if(C){var w=C.rect,O=w.x,o=w.y,i=w.width,j=w.height,R=C.background,$=C.backgroundImage,x=C.borderWidth,G=C.borderColor,f=C.labelWidth,_=C.opacity,Q=C.scale,L=Q!=E&&1!==Q;if(_!=E){var Y=u.globalAlpha;u.globalAlpha*=_}if(L){u.save();var e=w.x+w.width/2,y=w.y+w.height/2;xc(u,e,y),u.scale(Q,Q),xc(u,-e,-y)}if(C.expanded){var N=I(8,i/4),J=o+j-8;if(u.fillStyle=R,u.beginPath(),u.moveTo(O,o),u.lineTo(O,J),u.lineTo(O+i/2,J),u.lineTo(O+i/2,o+j),u.lineTo(O+i/2+N,J),u.lineTo(O+i,J),u.lineTo(O+i,o),u.closePath(),u.fill(),x&&(u.lineWidth=x,u.lineJoin="round",u.lineCap="round",G?(u.strokeStyle=G,u.stroke()):(u.strokeStyle=th(R),u.beginPath(),u.moveTo(O+i,o),u.lineTo(O+i,J),u.lineTo(O+i/2+N,J),u.lineTo(O+i/2,o+j),u.stroke(),u.strokeStyle=sm(R),u.beginPath(),u.moveTo(O+i,o),u.lineTo(O,o),u.lineTo(O,J),u.lineTo(O+i/2,J),u.lineTo(O+i/2,o+j),u.stroke())),$)_c(u,fl($),nl,w.x,w.y,w.width,w.height-8,C.data,C.view);else{if(w.height-=8,R=C.color,f){var B=i,M=u.createLinearGradient(O,o,O+B,o);M.addColorStop(0,R),M.addColorStop(.9,R),M.addColorStop(1,Mm),R=M,w.width=f}ai(u,C.ss,w,C.font,R,C.align),f&&(w.width=B),w.height+=8}}else if(C.icon)Pp(u,fl(C.icon),O,o,i,j,C.data,C.view);else{var l=i/2;x&&(u.lineWidth=x,u.lineJoin="round",u.lineCap="round",u.strokeStyle=G?G:th(R),u.beginPath(),u.arc(O+l,o+l,l,ss,1.6*D,!0),u.moveTo(O+l,o+j),u.lineTo(O+i-l/5,o+l),u.stroke(),u.strokeStyle=G?G:sm(R),u.beginPath(),u.arc(O+l,o+l,l,1.6*D,ss,!0),u.moveTo(O+l,o+j),u.lineTo(O+l/5,o+l),u.stroke()),u.fillStyle=R,u.beginPath(),u.arc(O+l,o+l,l,0,a,!0),u.moveTo(O+l,o+j),u.lineTo(O+i-l/5,o+l),u.lineTo(O+l/5,o+l),u.closePath(),u.fill(),u.fillStyle=C.color,u.beginPath(),u.arc(O+l,o+l,l/3,0,a,!0),u.fill()}L&&u.restore(),_!=E&&(u.globalAlpha=Y)}},Er=function(b,D){return D>2*b?b:D/2},rn=function(U,X,n,O){if(!U||!X)return 0;var S=Hr(X.y-U.y,X.x-U.x);return n||(S=X.x<U.x?S+D:S),S+O},Eg=function(g,K,h,R,o,H,d){d&&(g.x>K.x||g.x===K.x&&g.y>K.y)&&(h=so[h],o=-o);var G=Ac(h,{x:0,y:0,width:nk(g,K),height:0},H);return G.x+=R,G.y+=o,G=new Jh(Hr(K.y-g.y,K.x-g.x)).tf(G),G.x+=g.x,G.y+=g.y,G},kr=function(b,N,M,g,u){if(b._19Q=!0,!M.getEdgeGroup())return g?M.s("edge.gap"):0;if(bf(M.getSourceAgent())||bf(M.getTargetAgent()))return 0;var C,d=0,a=0,H=0;if(M.getEdgeGroup().getSiblings().each(function(B){B.each(function(S){if(N.isVisible(S)&&S.s(Ig)==u){var b=S.s("edge.gap");C?(a+=H/2+b/2,H=b):(C=S,H=b),S===M&&(d=a)}})}),g)return a-d+H;var W=d-a/2;return C&&M._40I!==C._40I&&(b._19Q=!1),W},Fo=function(i){var v=i._getValidSelection();if(1===v.length){var R=v[0],X=R instanceof h.Edge;if(R instanceof h.Shape||X){if(X){var z=R.s("edge.type");if(z&&"points"!==z)return}var s=i.gv;if((!s.isPointEditable||s.isPointEditable(R))&&s.isEditable(R))return R}}},je=function(){var x=function(F){var a=[];return F.forEach(function(N){a.push({x:N.x,y:N.y}),a.push({x:N.x+N.width,y:N.y+N.height}),a.push({x:N.x+N.width,y:N.y}),a.push({x:N.x,y:N.y+N.height})}),a};return function(w,H,T){if("oval"===w){var U=0,W=T.height/T.width,t=W*W,u=T.x+T.width/2,V=T.y+T.height/2,i=x(H);i.forEach(function(K){var b=K.x-u,Y=K.y-V,J=b*b+Y*Y/t;J>U&&(U=J)}),U=A(U);var g=W*U;return{x:u-U,y:V-g,width:2*U,height:2*g}}if("circle"===w){var o=0,u=T.x+T.width/2,V=T.y+T.height/2,i=x(H);return i.forEach(function(z){var s=z.x-u,_=z.y-V,n=s*s+_*_;n>o&&(o=n)}),o=A(o),{x:u-o,y:V-o,width:2*o,height:2*o}}return"roundRect"===w?(rk(T,I(T.width,T.height)/16),T):T}}(),pj=h.graph={},jp=function(D,r,g){gd(M+".graph."+D,r,g)};h.layout={};var io={},no=function(K,f,T,n,c,i,X,D){var A=X._zoom;if(!A)return f;if(A!==X._cacheZoom&&(X._cacheZoom=A,X._cacheImage={}),A*=qq,n=Math.ceil(n),c=Math.ceil(c),n*A>2048||c*A>2048)return f;var U=[f.uuid,n,c,T].join("_");if(i instanceof h.Data){var d=f.dataBindings;if(d)for(var G=d.length-1;G>=0;G--){var r=i.a(d[G].attr);Hh(r)||bs(r)||(U+="_"+r)}}if(f.cacheRule){var s;s=tj(f.cacheRule)?f.cacheRule(i,X):as(f.cacheRule,i,X),U+="_"+s}var z,N=1;c>=n&&N>n*A?(z=c/n,n=N/A,c=n*z):n>=c&&N>c*A&&(z=n/c,c=N/A,n=c*z),n=Math.ceil(n),c=Math.ceil(c);var _=X._cacheImage[U];if(!_){if(Wn(),_=h.Default.toCanvas(f,n,c,T,i,X,D,A),!gq())return f;X._cacheImage[U]=_}return _};Sn(K,{setImageCacheRule:function(p,N){var m;N||"object"!=typeof p?(m={},m[p]=N):m=p;for(var q in m){var s=m[q];Om(q)?(gd=fl(q),gd?gd.cacheRule=s:io[q]=s):q.cacheRule=s}}});var ub={comps:[{type:Ph,points:[85,50,70,115,100,71,86,107,88,49,57,109,108,49,66,97,90,49,67,86,87,43,48,82,113,99,51,85,56,105,99,43,84,101,49,84,106,52,68,72,101,73,107,61],borderWidth:1,borderColor:E}]};if(ub[il]=ub[Cr]=160,Q.Image){var kg=new Q.Image;kg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",wr("default_blank",kg)}wr("node_image",ti(30,30,[{type:Vd,rect:[4,5,22,16],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[2,3,26,20],borderWidth:1,borderColor:hk},{type:Vd,rect:[11,23,8,4],background:hk},{type:Vd,rect:[6,27,18,2],background:hk}])),wr("node_icon",ti(16,16,[{type:Vd,rect:[2,2,12,10],gradient:Ki,gradientColor:ec,background:hk},{type:Pe,rect:[2,2,12,10],width:1,color:hk},{type:Vd,rect:[6,12,4,2],background:hk},{type:Vd,rect:[4,14,8,1],background:hk}])),wr("block_icon",ti(16,16,[{type:Pe,rect:[1,1,14,14],width:1,color:hk}])),wr("group_image",ti(66,39,[{type:Vd,rect:[44.3,18,18.1,12.8],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[3.3,17.8,18.1,12.8],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:hk,gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[26.2,29.4,12.8,4.2],background:hk},{type:Vd,rect:[21.3,33.5,22.5,2.3],background:hk},{type:Vd,rect:[5.3,32.7,14.1,2.1],background:hk},{type:Vd,rect:[9,30.4,6.7,2.4],background:hk},{type:Vd,rect:[50,30.7,6.7,2.4],background:hk},{type:Vd,rect:[46.3,33,14.1,2.1],background:hk}])),wr("group_icon",ti(16,16,[{type:Vd,rect:[4,12,4,2],background:hk},{type:Vd,rect:[2,13,8,1],background:hk},{type:Vd,rect:[12,12,2,1],background:hk},{type:Vd,rect:[11,13,4,1],background:hk},{type:Vd,rect:[10,7,6,5],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[1,2,10,10],gradient:Ki,gradientColor:ec,background:hk},{type:Pe,rect:[1,2,10,10],width:1,color:hk}])),wr("refGraph_icon",ti(16,16,[{type:"shape",borderWidth:1,borderColor:hk,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:hk,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),wr("edge_icon",ti(16,16,[{type:Vd,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[10.8,1,4,4],background:hk},{type:Vd,rect:[1,11,4,4],background:hk}])),wr("subGraph_image",ti(72,45,[{type:Ph,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[29.6,30.7,3.6,1.8],background:hk},{type:Vd,rect:[28.4,32.3,6,1.2],background:hk},{type:Vd,rect:[37.3,32,10.8,1.8],background:hk},{type:Vd,rect:[39.1,29.9,7.2,2.3],background:hk},{type:Vd,rect:[26.6,23.7,9.6,7.2],gradient:Ki,gradientColor:ec,background:hk},{type:Vd,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:hk,gradient:Ki,gradientColor:ec,background:hk}])),wr("subGraph_icon",ti(17,17,[{type:Ph,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Ki,gradientColor:ec,background:hk}])),wr("shape_icon",ti(16,16,[{type:Ph,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:hk}])),wr("polyline_icon",ti(16,16,[{type:Ph,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:hk},ik(7.5,.4),ik(7.5,6.3),ik(13.6,6.3),ik(13.6,14),ik(.7,13.9),ik(.7,.3)])),wr("grid_icon",ti(16,16,[{type:Vd,rect:[1,1,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[6,1,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[11,1,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[11,6,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[6,6,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[1,6,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[11,11,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[6,11,4,4],background:hk,gradient:Ki,gradientColor:ec},{type:Vd,rect:[1,11,4,4],background:hk,gradient:Ki,gradientColor:ec}])),wr("light_icon",ti(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:hk},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:hk,gradient:Ki,gradientColor:ec,background:{func:function(z){var K=z?z.s(us):E;return bs(K)?"rgb("+sr(255*K[0])+","+sr(255*K[1])+","+sr(255*K[2])+")":K||hk}}}])),wr("text_icon",ti(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:hk}])),wr("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),wr("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),wr("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),wr("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var kb=function(f,u,M,i,v,o){var G,$,p,E,j,k,c,t,e,H,T,S=[];if(Math.abs(i)>2*Math.PI&&(i=2*Math.PI),j=Math.ceil(Math.abs(i)/(Math.PI/4)),G=i/j,$=-G,p=-M,j>0){k=f+Math.cos(M)*v,c=u+Math.sin(-M)*o,S.push({x:k,y:c});for(var b=0;j>b;b++)p+=$,E=p-$/2,t=f+Math.cos(p)*v,e=u+Math.sin(p)*o,H=f+Math.cos(E)*(v/Math.cos($/2)),T=u+Math.sin(E)*(o/Math.cos($/2)),S.push({x:H,y:T}),S.push({x:t,y:e})}return S},Si=function(D){if(D){var M=D._data;if(M instanceof h.Shape)return{points:M.getPoints(),segments:M.getSegments()};var b;if(M instanceof h.Edge&&(b=D._78o)){var N,m,U=b.type,L=b.points,K=b.segments,x=b.edgeTypeInfo;if(!U||L){var o=b.sourcePoint,Y=o.x,r=o.y,j=b.targetPoint,R=j.x,a=j.y;if(U)K?(N=new oc({x:Y,y:r}),N.addAll(L),N.add({x:R,y:a}),m=new oc(K._as)):(N=new oc({x:Y,y:r}),L.each(function(m){N.add(m)}),N.add({x:R,y:a}));else if(b.looped){N=new oc(kb(Y,r,0,2*Math.PI,b.radius,b.radius)),m=new oc([1]);for(var W=0;W<(N.size()-1)/2;W++)m.add(3)}else N=new oc,b.center?(N.add({x:b.c1.x,y:b.c1.y}),N.add({x:Y,y:r}),N.add({x:R,y:a}),N.add({x:b.c2.x,y:b.c2.y})):(N.add({x:Y,y:r}),N.add({x:R,y:a}))}else x&&(N=new oc(x.points._as),x.segments&&(m=new oc(x.segments._as)));return{points:N,segments:m}}}},qo=function(b,g,w){if(null==g){var E=Si(b);if(!E)return;g=E.points,w=E.segments}if(g){if(Array.isArray(g)&&(g=new oc(g)),"number"==typeof g.get(0)){for(var u=new h.List,z=0;z<g.size();z+=2)u.add({x:g.get(z),y:g.get(z+1)});g=u}if(!w){w=[1];for(var W=g.length-1;W>0;W--)w.push(2)}Array.isArray(w)&&(w=new oc(w));for(var S=_h(g._as,w._as,50),q=S.length,V=[],z=0;q>z;z++){var o=S[z];o.length>1&&V.push(o)}return V}},Wd=function(R){for(var $=0,C=R.length-1,j=0;C>j;j++){var B=R[j],v=R[j+1],H=v.x-B.x,K=v.y-B.y;$+=Math.sqrt(H*H+K*K)}return $},xr=function(d,V){for(var W=0,b=V.length,C=0;b>C;C++){var F=V[C];if(W+=F,W>d)return C}return Math.min(C,b-1)},vh=function(o,W){for(var M=0,b=0,i=0,X=o.length-1,l=0;X>l;l++){var x=o[l],n=o[l+1],K=n.x-x.x,Q=n.y-x.y;if(i=Math.sqrt(K*K+Q*Q),M+=i,M>W){M-=i,b=l;break}}var G=o[b],J=o[b+1],$=Math.atan2(J.y-G.y,J.x-G.x),V=W-M,Q=Math.sin($)*V,K=Math.cos($)*V;return{x:G.x+K,y:G.y+Q}},$r=function(j,D){if(j){var u;if(0===D)u=j[0][0];else if(100===D)j=j[j.length-1],u=j[j.length-1];else{for(var R=0,J=[],$=j.length,s=0;$>s;s++){var E=j[s],m=Wd(E);R+=m,J.push(m)}for(var i=R*D/100,o=xr(i,J),t=0,l=0;o>l;l++)t+=J[l];i-=t,u=vh(j[o],i)}return u}},el=function(T){var M,I;if(T instanceof Jo){var y=Si(T);M=y.points,I=y.segments}else M=arguments[0],I=arguments[1];var P,n,r,E,s=[],C=-1;for(n=0,r=I?I.length:M.length;r>n;n++){if(P=I?I.get(n):1,3===P)E=2;else if(4===P)E=3;else{if(5===P)continue;E=1}C+=E,s.push(M.get(C))}return s},xf=function(N,M,h,t){function W(Y){if(Y>=0&&1>=Y){C=M(Y);var y=(N.x-C.x)*(N.x-C.x)+(N.y-C.y)*(N.y-C.y);return b>y?(b=y,k=Y,!0):!1}}h=h||100,t=t||1e-5;for(var b=1/0,k=0,C=new Vl,g=0;h>g;++g)W(g/h);for(var s=1/(2*h);s>t;)W(k-s)||W(k+s)||(s/=2);return k};Sn(K,{_edgeProtectMethod:{getStraightLinePoints:qo,calculateLineLength:Wd,calcSegmentIndexByDistance:xr,calculatePointAlongLine:vh,getPercentPosition:$r,getRealPointsFromDataUI:el}});var ak=function(F,Q){for(var M=F.vertices,I=0;I<M.length;I++){var A=M[I],X=A.y;A.y=A.z,A.z=-X,Q&&(A.y+=Q)}},Gj=function(A){for(var Y,B,u,F,R,a,s=[],H=[],q=[],z=A.faces,G=0,S=0,k=0,V=z.length;V>G;G++,S+=6,k+=9){var d=z[G];1===d.i?(Y||(Y=[],B=[],u=[]),Hn(d,G,S,k,A,Y,u,B)):2===d.i?(F||(F=[],R=[],a=[]),Hn(d,G,S,k,A,F,a,R)):Hn(d,G,S,k,A,s,q,H)
}return{vs:s,uv:H,ns:q,top_vs:Y,top_uv:B,top_ns:u,bottom_vs:F,bottom_uv:R,bottom_ns:a}},Hn=function(w,J,S,z,j,r,R,E){var I=j.vertices,m=j.faceVertexUvs,B=I[w.a],C=I[w.b],k=I[w.c];r.push(B.x,B.y,B.z,C.x,C.y,C.z,k.x,k.y,k.z);var d,M,c,O=w.vertexNormals;3===O.length?(d=O[0],M=O[1],c=O[2]):d=M=c=w.normal,R.push(d.x,d.y,d.z,M.x,M.y,M.z,c.x,c.y,c.z);var P=m[0][J][0],V=m[0][J][1],q=m[0][J][2];E.push(P.x,P.y,V.x,V.y,q.x,q.y)},zn=function(P){var C;C=bs(P)?P:[P];var L,x,V,r,l,z,H,c,A=1/0,Z=1/0,M=1/0,i=-1/0,J=-1/0,d=-1/0,G=["vs","top_vs","bottom_vs"];for(L=0,x=C.length;x>L;L++)for(c=C[L],V=0,r=G.length;r>V;V++)if(H=c[G[V]])for(l=0,z=H.length;z>l;l+=3)A=I(A,H[l]),Z=I(Z,H[l+1]),M=I(M,H[l+2]),i=_(i,H[l]),J=_(J,H[l+1]),d=_(d,H[l+2]);var w={min:{x:A,y:Z,z:M},max:{x:i,y:J,z:d}};return P.boundingBox=w,w},ck=function(){function p(K,T){return K.dot(T)>0}function u(I,c,d,n,T,m,E){for(var J,L,N=[c,d,n],D=[T,m,E],W=[],l=N.length,X=!0;l--&&X;){for(var q=N[l],$=D.length,g=!1;$--;)if(q.equals(D[$])){D.splice($,1),W.push(q),g=!0;break}if(!g){if(J){X=!1;break}J=q}}return X&&2===W.length&&(L=D[0],s.subVectors(J,W[0]),A.subVectors(L,W[0]),_.subVectors(J,W[1]),s.x*_.y*A.z+_.x*A.y*s.z+A.x*s.y*_.z-A.x*_.y*s.z-A.y*_.z*s.x-A.z*_.x*s.y<1e-6&&(b.subVectors(L,W[1]),f.subVectors(W[1],W[0]),p(f,s)&&p(f,A)&&(f.negate(),p(f,_)&&p(f,b))))?(I.push(W[1].x,W[1].y,W[1].z),I.push(J.x,J.y,J.z),I.push(J.x,J.y,J.z),I.push(W[0].x,W[0].y,W[0].z),I.push(W[0].x,W[0].y,W[0].z),I.push(L.x,L.y,L.z),I.push(L.x,L.y,L.z),I.push(W[1].x,W[1].y,W[1].z),2):(I.push(c.x,c.y,c.z),I.push(d.x,d.y,d.z),I.push(d.x,d.y,d.z),I.push(n.x,n.y,n.z),I.push(n.x,n.y,n.z),I.push(c.x,c.y,c.z),1)}function D(){this._vertexMap={},this._lineMap={},this._lineList=[]}function M(p,P,A,E,v,t,R){var b=[A,v];p[0]===E&&b.reverse();var W=[b[0]._key,b[1]._key].join("|"),L=p._triangles[W];L||(p._triangles[W]=L={});var x=[t._key,R._key].join("|");L[x]||(L[x]=[t,R])}function m(r,d,$){var L=r._planes[$._key];if(!L)for(var k in r._planes){var W=r._planes[k];if(W._normal.angleTo($)<.001){L=W;break}}return L?(L._vertices.indexOf(d)<0&&L._vertices.push(d),void 0):(r._planes[$._key]={_normal:$,_vertices:[d]},void 0)}function N(Q,D){return 0===D?"0|0|0":1/0===Math.abs(D)?[Q.x,Q.y,Q.z].join("|"):[Math.round(L.angleTo(Q)*D),Math.round(S.angleTo(Q)*D),Math.round(R.angleTo(Q)*D)].join("|")}function E(A,T){var R=A._ctlineModel;if(R||(A._ctlineModel=R=[]),R[0])return R[0];var Q;Q=bs(A)?A:[A];var Z,S,g,M,x,G,J,y,I,L,_,E,o,t,$,p,D,d,n,C=["","top_","bottom_"];R=[];var K=[];for(Hf(Q,T,K),Z=0,S=K.length;S>Z;Z++)if(L=K[Z])for(Lr(L),g=0,M=C.length;M>g;g++)if(I=L[C[g]+"lvs"])for(D=R.length,d=I.length,R.length=D+d,n=0;d>n;++n,++D)R[D]=I[n];else if(J=L[C[g]+"vs"]){y=L[C[g]+"is"],G=y?y.length:J.length/3;for(var x=0;G-1>x;)y?(_=y[x],E=y[x+1],o=y[x+2],t=y[x+3],$=y[x+4],p=y[x+5]):(_=x,E=x+1,o=x+2,t=x+3,$=x+4,p=x+5),q.fromArray(J,3*_),i.fromArray(J,3*E),w.fromArray(J,3*o),X.fromArray(J,3*t),j.fromArray(J,3*$),H.fromArray(J,3*p),x+=3*u(R,q,i,w,X,j,H);G>x&&(y?(_=y[x],E=y[x+1],o=y[x+2]):(_=x,E=x+1,o=x+2),q.fromArray(J,3*_),i.fromArray(J,3*E),w.fromArray(J,3*o),R.push(q.x,q.y,q.z),R.push(i.x,i.y,i.z),R.push(i.x,i.y,i.z),R.push(w.x,w.y,w.z),R.push(w.x,w.y,w.z),R.push(q.x,q.y,q.z))}return A._ctlineModel[0]=R,R}function K(b,g,e){var M=b._ctlineModel;M||(b._ctlineModel=M=[]);var G=M[1];if(G&&G.epsilon===e)return G;G=[],G.epsilon=e;var V;V=bs(b)?b:[b];var p,E,F,h,X,N,L,x,K,O,C,i,B=["","top_","bottom_"],U=new D,l=[];for(Hf(V,g,l),p=0,E=l.length;E>p;p++)if(K=l[p])for(Lr(K),F=0,h=B.length;h>F;F++)if(L=K[B[F]+"vs"]){x=K[B[F]+"is"],N=x?x.length:L.length/3;for(var X=0,X=0;N>X;X+=3)x?(O=x[X],C=x[X+1],i=x[X+2]):(O=X,C=X+1,i=X+2),U._addTriangle(L,P,O,C,i,e)}return U._toLineVS(G),b._ctlineModel[1]=G,G}function $(P,v,g){var i=P._ctlineModel;i||(P._ctlineModel=i=[]);var q=i[2];if(q&&q.epsilon===g)return q;q=[],q.epsilon=g;var H;H=bs(P)?P:[P];var B,y,z,Z,U,o,d,t,$,K,F,Q,S,f=["","top_","bottom_"],k=new D,L=[];for(Hf(H,v,L),B=0,y=L.length;y>B;B++)if(K=L[B])for(Lr(K),z=0,Z=f.length;Z>z;z++)if(d=K[f[z]+"vs"]){t=K[f[z]+"is"],$=K[f[z]+"ns"],o=t?t.length:d.length/3;for(var U=0,U=0;o>U;U+=3)t?(F=t[U],Q=t[U+1],S=t[U+2]):(F=U,Q=U+1,S=U+2),k._addTriangle(d,$,F,Q,S,g)}return k._toLineVS(q),P._ctlineModel[2]=q,q}var q=new Ab,i=new Ab,w=new Ab,X=new Ab,j=new Ab,H=new Ab,s=new Ab,_=new Ab,A=new Ab,b=new Ab,f=new Ab,C=new Ab;D.prototype._findVertex=function(G,B){C.fromArray(G,3*B);var E=[C.x,C.y,C.z].join(","),P=this._vertexMap[E];if(!P){var v=C.clone();v._key=E,this._vertexMap[E]=P=v}return P},D.prototype._findLine=function(Z,i){var E=[Z,i];Z._key>i._key&&E.reverse(),E._key=[E[0]._key,E[1]._key].join("|");var y=this._lineMap[E._key];return y||(this._lineMap[E._key]=y=E,E._triangles={},E._planes={},this._lineList.push(E)),y};var L=new Ab(1,0,0),S=new Ab(0,1,0),R=new Ab(0,0,1),F=new Ab,y=new Ab;return D.prototype._addTriangle=function(E,n,w,L,A,k){var j,v,J,W=this._findVertex(E,w),z=this._findVertex(E,L),H=this._findVertex(E,A),B=this._findLine(W,z),T=this._findLine(z,H),c=this._findLine(H,W);n?(j=(new Ab).fromArray(n,3*w),j._key=N(j,k),v=(new Ab).fromArray(n,3*L),v._key=N(v,k),J=(new Ab).fromArray(n,3*A),J._key=N(J,k),M(B,W,j,z,v,H,J),M(T,z,v,H,J,W,j),M(c,H,J,W,j,z,v)):(y.subVectors(H,z),F.subVectors(z,W),j=(new Ab).crossVectors(F,y),j._key=N(j,k),m(B,H,j),m(T,W,j),m(c,z,j))},D.prototype._toLineVS=function(D){for(var h=this._lineList,f=0,x=h.length;x>f;++f){var t=h[f],F=!1;for(var d in t._triangles)if(1==O.keys(t._triangles[d]).length){D.push(t[0].x,t[0].y,t[0].z,t[1].x,t[1].y,t[1].z),F=!0;break}if(!F)for(var W in t._planes)if(1==t._planes[W]._vertices.length){D.push(t[0].x,t[0].y,t[0].z,t[1].x,t[1].y,t[1].z),F=!0;break}}},[E,K,$]}(),Dm=function(n,z){var e=n._lineModel;if(e)return e;var u;u=bs(n)?n:[n];var F,X,w,r,E,i,Z,s,v,x,p,D,j=["","top_","bottom_"];e=[];var L=[];for(Hf(n,z,L),F=0,X=L.length;X>F;F++)if(v=L[F])for(w=0,r=j.length;r>w;w++)if(Z=v[j[w]+"vs"]){s=v[j[w]+"is"],i=s?s.length:Z.length/3;for(var E=0;i>E;E+=3)s?(x=s[E],p=s[E+1],D=s[E+2]):(x=E,p=E+1,D=E+2),x*=3,p*=3,D*=3,e.push(Z[x],Z[x+1],Z[x+2],Z[p],Z[p+1],Z[p+2],Z[p],Z[p+1],Z[p+2],Z[D],Z[D+1],Z[D+2],Z[D],Z[D+1],Z[D+2],Z[x],Z[x+1],Z[x+2])}return n._lineModel=e,e},Yl=function(W,d,V,r,X,o,j,A,f,h){V==E&&(V=!0),r==E&&(r=!0),j==E&&(j=1),A==E&&(A=0);var a=new hm;xj(a,W,d,f),a=a.toShapes();var L=P;return h&&(h.length?L={minX:h[0],minY:-h[3],maxX:h[2],maxY:-h[1]}:(L={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},a.forEach(function(Z){var o=Z.getBoundingBox();L.minX=I(o.minX,L.minX),L.minY=I(o.minY,L.minY),L.maxX=_(o.maxX,L.maxX),L.maxY=_(o.maxY,L.maxY)}))),Gj(new Ye(a,{top:V,bottom:r,curveSegments:X,amount:j,repeatUVLength:o,boundingBox:L},-j/2+A))},se=function(H,P){this.repeatUVLength=H,this._bb=P};se.prototype={generateTopUV:function(w,q,x,u,F,N,C){var D,O,z,t,A=w.vertices,R=A[u].x,H=A[u].y,B=A[F].x,M=A[F].y,b=A[N].x,n=A[N].y,U=this.repeatUVLength;if(U)D=0,O=0,z=U,t=U;else{this._bb||(this._bb=q.getBoundingBox());var e=this._bb;D=e.minX,O=e.minY,z=e.maxX-D,t=e.maxY-O}return C?[new Zo((R-D)/z,(H-O)/t),new Zo((B-D)/z,(M-O)/t),new Zo((b-D)/z,(n-O)/t)]:[new Zo((R-D)/z,1-(H-O)/t),new Zo((B-D)/z,1-(M-O)/t),new Zo((b-D)/z,1-(n-O)/t)]},generateBottomUV:function(p,H,y,b,e,q){return this.generateTopUV(p,H,y,b,e,q,!0)},generateSideWallUV:function(O,q,B,F,G,h,p,T,D,V,C,a){if(!this._cl){for(var o,w,i=[],Y=0,Z=B.length,t=0;Z>t;t++){o=B[t],w=B[(t+1)%Z];var $=o.x-w.x,J=o.y-w.y,P=A($*$+J*J);i.push(Y),Y+=P}for(var t=0;Z>t;t++)i[t]/=Y;this._cl=i}var i=this._cl,U=1-D/V,j=1-(D+1)/V,N=i[C],E=i[a];return E>N&&(N+=1),[new Zo(N,U),new Zo(E,U),new Zo(E,j),new Zo(N,j)]}};var hl=function(o,G,r,J,e,C){this.a=o,this.b=G,this.c=r,this.i=C,this.normal=J instanceof ll?J:new ll,this.vertexNormals=J instanceof Array?J:[]};hl.prototype={constructor:hl};var Kj=[-8,14,0,7,-5,10,-1,6,-1],eo=function(){if(eo[ui]!=E)return eo[ui];for(var m=zd[ui],g=Kj,d=Lk.prototype.getClassName(),Z='"',h=0,_="",H=!1,A=+new(Q[d.substr(3,3)+sj[h]]),n=h;n<g.length;n++){var i=g.length-n;_+=n%2===h?g[n]+i+"":g[n]-i+""}for(var n=h;4>n;n++)_+=h;if(_=_*_.length/_.length,A>_){if(m&&m[h]&&m[4/Vd.length]){for(var p,X,N,y,r,q,a,o,D=m[0],M=m[1],l="",K=0,n=0;n<M.length;n++)M[n]===Z?o?(o=!1,0!==K%2&&(p==E?p=l:X==E?X=l:N==E?N=l:y==E?y=l:r==E?r=l:q==E?q=l:a==E&&(a=l)),K++,l=""):o=!0:o&&(l+=M[n]);for(var v,L,G,R="",S=0,n=0;n<D.length;n++)D[n]===Z?v?(v=!1,0!==S%2&&(L==E?L=R:G==E&&(G=R)),S++,R=""):v=!0:v&&(R+=D[n]);var $=p+X+N+y+r+q,w=!q||q===Nc||!Nc&&q===uc.toString()[0];if(!w&&q)for(var T,n=0,t=q.length;t>n;n++)q[n]===Uc[4]?T===Nc?w=bc:T[0]===Bs[7]&&Nc&&Nc.indexOf(T.substr(1))>=0?w=gp:T=E:(T==E?T=q[n]:T+=q[n],n===t-1&&(T===Nc?w=bc:T[0]===Bs[7]&&Nc&&Nc.indexOf(T.substr(1))>=0&&(w=gp)));(H=If($,a)&&If(L,G)&&L===p&&w&&(!r||r>A))&&N.indexOf(Kl[0])>=0&&(eo[Kl[0]]=1),H&&N.indexOf(1)>=0&&(eo[1]=1),H&&N.indexOf(3)>=0&&(eo[2]=1),H&&N.indexOf(4)>=0&&(eo[3]=1),H&&N.indexOf(7)>=0&&(eo[4]=1),H&&N.indexOf(ac[1])>=0&&(eo[ac[1]]=1),H&&N.indexOf(ar[0])>=0&&(eo[ar[0]]=1)}}else H=!0,eo[Kl[0]]=eo[1]=eo[2]=eo[3]=eo[4]=eo[ac[1]]=eo[ar[0]]=1;return eo[ui]=H,H},Vc=function(){},pg=Vc.prototype;pg.getPointAt=function(l){var c=this.getUtoTmapping(l);return this.getPoint(c)},pg.getPoints=function($){$||($=5);var V,o=[];for(V=0;$>=V;V++)o.push(this.getPoint(V/$));return o},pg.getSpacedPoints=function(e){e||(e=5);var a,d=[];for(a=0;e>=a;a++)d.push(this.getPointAt(a/e));return d},pg.getLength=function(){var C=this.getLengths();return C[C.length-1]},pg.getLengths=function(U){if(U||(U=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==U+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var I,d,D=[],J=this.getPoint(0),R=0;for(D.push(0),d=1;U>=d;d++)I=this.getPoint(d/U),R+=I.distanceTo(J),D.push(R),J=I;return this.cacheArcLengths=D,D},pg.getUtoTmapping=function($,w){var C,V=this.getLengths(),h=0,R=V.length;C=w?w:$*V[R-1];for(var H,f=0,m=R-1;m>=f;)if(h=X(f+(m-f)/2),H=V[h]-C,0>H)f=h+1;else{if(!(H>0)){m=h;break}m=h-1}if(h=m,V[h]==C){var g=h/(R-1);return g}var I=V[h],F=V[h+1],S=F-I,N=(C-I)/S,g=(h+N)/(R-1);return g},pg.getTangent=function(r){var A=1e-4,J=r-A,i=r+A;0>J&&(J=0),i>1&&(i=1);var k=this.getPoint(J),b=this.getPoint(i),t=b.clone().sub(k);return t.normalize()},pg.getTangentAt=function(k){var r=this.getUtoTmapping(k);return this.getTangent(r)},Vc.create=function(T,k){return T.prototype=uj(Vc.prototype),T.prototype.getPoint=k,T};var op=function(){this.curves=[],this.autoClose=!1},Qg=op.prototype=uj(pg);Qg.add=function(J){this.curves.push(J)},Qg.closePath=function(){var D=this.curves[0].getPoint(0),v=this.curves[this.curves.length-1].getPoint(1);D.equals(v)||this.curves.push(new me(v,D))},Qg.getPoint=function(E){for(var K,q,N=E*this.getLength(),J=this.getCurveLengths(),p=0;p<J.length;){if(J[p]>=N){K=J[p]-N,q=this.curves[p];var f=1-K/q.getLength();return q.getPointAt(f)}p++}return null},Qg.getLength=function(){var B=this.getCurveLengths();return B[B.length-1]},Qg.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var f,c=[],S=0,t=this.curves.length;for(f=0;t>f;f++)S+=this.curves[f].getLength(),c.push(S);return this.cacheLengths=c,c},Qg.getTransformedPoints=function(C){return this.getPoints(C)},Qg.getBoundingBox=function(){var G,e,z,C,j,r,V=this.getPoints();G=e=Number.NEGATIVE_INFINITY,C=j=Number.POSITIVE_INFINITY;var p,N,A,q,L=V[0]instanceof ll;for(q=L?new ll:new Zo,N=0,A=V.length;A>N;N++)p=V[N],p.x>G&&(G=p.x),p.x<C&&(C=p.x),p.y>e&&(e=p.y),p.y<j&&(j=p.y),L&&(p.z>z&&(z=p.z),p.z<r&&(r=p.z)),q.add(p);var h={minX:C,minY:j,maxX:G,maxY:e};return L&&(h.maxZ=z,h.minZ=r),h};var yc=function(H){op.call(this),this.actions=[],H&&this.fromPoints(H)},Ue=yc.prototype=uj(op.prototype),Gf="moveTo",Vk="lineTo",dc="quadraticCurveTo",yj="bezierCurveTo",Fn="arc",gf="ellipse";Ue.fromPoints=function(b){this.moveTo(b[0].x,b[0].y);for(var z=1,L=b.length;L>z;z++)this.lineTo(b[z].x,b[z].y)},Ue.moveTo=function(){var D=Array.prototype.slice.call(arguments);this.actions.push({action:Gf,args:D})},Ue.lineTo=function(n,I){var X=Array.prototype.slice.call(arguments),_=this.actions[this.actions.length-1].args,J=_[_.length-2],x=_[_.length-1],u=new me(new Zo(J,x),new Zo(n,I));this.curves.push(u),this.actions.push({action:Vk,args:X})},Ue.quadraticCurveTo=function(Q,v,$,b){var W=Array.prototype.slice.call(arguments),E=this.actions[this.actions.length-1].args,T=E[E.length-2],r=E[E.length-1],K=new Uo(new Zo(T,r),new Zo(Q,v),new Zo($,b));this.curves.push(K),this.actions.push({action:dc,args:W})},Ue.bezierCurveTo=function(g,L,f,v,Q,J){var n=Array.prototype.slice.call(arguments),V=this.actions[this.actions.length-1].args,B=V[V.length-2],i=V[V.length-1],r=new Ti(new Zo(B,i),new Zo(g,L),new Zo(f,v),new Zo(Q,J));this.curves.push(r),this.actions.push({action:yj,args:n})},Ue.arc=function(m,f,s,D,O,k){var W=this.actions[this.actions.length-1].args,H=W[W.length-2],J=W[W.length-1];this.absarc(m+H,f+J,s,D,O,k)},Ue.absarc=function(M,R,u,T,H,l){this.absellipse(M,R,u,u,T,H,l)},Ue.ellipse=function(t,n,k,g,_,a,p){var P=this.actions[this.actions.length-1].args,j=P[P.length-2],Y=P[P.length-1];this.absellipse(t+j,n+Y,k,g,_,a,p)},Ue.absellipse=function(v,m,$,d,q,W,i){var V=Array.prototype.slice.call(arguments),u=new Do(v,m,$,d,q,W,i);this.curves.push(u);var D=u.getPoint(1);V.push(D.x),V.push(D.y),this.actions.push({action:gf,args:V})},Ue.getSpacedPoints=function(i){i||(i=40);for(var p=[],N=0;i>N;N++)p.push(this.getPoint(N/i));return p},Ue.getPoints=function(k,L){k=k||12;var G,a,K,j,g,Z,b,O,J,t,R,M,S,z,d,_,m,T,h=[];for(G=0,a=this.actions.length;a>G;G++)switch(K=this.actions[G],j=K.action,g=K.args,j){case Gf:h.push(new Zo(g[0],g[1]));break;case Vk:h.push(new Zo(g[0],g[1]));break;case dc:for(Z=g[2],b=g[3],t=g[0],R=g[1],h.length>0?(z=h[h.length-1],M=z.x,S=z.y):(z=this.actions[G-1].args,M=z[z.length-2],S=z[z.length-1]),d=1;k>=d;d++)_=d/k,m=Ah.b2(_,M,t,Z),T=Ah.b2(_,S,R,b),h.push(new Zo(m,T));break;case yj:for(Z=g[4],b=g[5],t=g[0],R=g[1],O=g[2],J=g[3],h.length>0?(z=h[h.length-1],M=z.x,S=z.y):(z=this.actions[G-1].args,M=z[z.length-2],S=z[z.length-1]),d=1;k>=d;d++)_=d/k,m=Ah.b3(_,M,t,O,Z),T=Ah.b3(_,S,R,J,b),h.push(new Zo(m,T));break;case Fn:var u,X=g[0],i=g[1],Y=g[2],q=g[3],v=g[4],U=!!g[5],w=v-q,s=2*k;for(d=1;s>=d;d++)_=d/s,U||(_=1-_),u=q+_*w,m=X+Y*W(u),T=i+Y*l(u),h.push(new Zo(m,T));break;case gf:var u,X=g[0],i=g[1],y=g[2],e=g[3],q=g[4],v=g[5],U=!!g[6],w=v-q,s=2*k;for(d=1;s>=d;d++)_=d/s,U||(_=1-_),u=q+_*w,m=X+y*W(u),T=i+e*l(u),h.push(new Zo(m,T))}var A,P,F=N["shape3d.point.epsilon"],x=!1;for(a=h.length,G=0,a=h.length;a>G;G++)A=h[G],P=G===a-1?h[0]:h[G+1],A&&P&&B(A.x-P.x)<F&&B(A.y-P.y)<F&&(x=!0,h[G]=null);if(x){var f=[];for(G=0;a>G;G++)h[G]&&f.push(h[G]);h=f}return L&&h.push(h[0]),h},Ue.toShapes=function(i,t){function X(C){var _,A,a,n,X,Q=[],T=new yc;for(_=0,A=C.length;A>_;_++)a=C[_],X=a.args,n=a.action,n==Gf&&0!=T.actions.length&&(Q.push(T),T=new yc),T[n].apply(T,X);return 0!=T.actions.length&&Q.push(T),Q}function D(w){for(var z=[],r=0,y=w.length;y>r;r++){var e=w[r],q=new hm;q.actions=e.actions,q.curves=e.curves,z.push(q)}return z}function b(P,i){for(var K=1e-10,n=i.length,d=!1,y=n-1,R=0;n>R;y=R++){var c=i[y],v=i[R],f=v.x-c.x,r=v.y-c.y;if(B(r)>K){if(0>r&&(c=i[R],f=-f,v=i[y],r=-r),P.y<c.y||P.y>v.y)continue;if(P.y==c.y){if(P.x==c.x)return!0}else{var q=r*(P.x-c.x)-f*(P.y-c.y);if(0==q)return!0;if(0>q)continue;d=!d}}else{if(P.y!=c.y)continue;if(v.x<=P.x&&P.x<=c.x||c.x<=P.x&&P.x<=v.x)return!0}}return d}var o=X(this.actions);if(0==o.length)return[];if(t===!0)return D(o);var M,r,l,a=[];if(1==o.length)return r=o[0],l=new hm,l.actions=r.actions,l.curves=r.curves,a.push(l),a;var y=!Ah.isClockWise(o[0].getPoints());y=i?!y:y;var v,W=[],s=[],e=[],w=0;s[w]=P,e[w]=[];var G,q;for(G=0,q=o.length;q>G;G++)r=o[G],v=r.getPoints(),M=Ah.isClockWise(v),M=i?!M:M,M?(!y&&s[w]&&w++,s[w]={s:new hm,p:v},s[w].s.actions=r.actions,s[w].s.curves=r.curves,y&&w++,e[w]=[]):e[w].push({h:r,p:v[0]});if(!s[0])return D(o);if(s.length>1){for(var Q=!1,V=[],u=0,d=s.length;d>u;u++)W[u]=[];for(var u=0,d=s.length;d>u;u++){s[u];for(var F=e[u],K=0;K<F.length;K++){for(var $=F[K],g=!0,C=0;C<s.length;C++)b($.p,s[C].p)&&(u!=C&&V.push({froms:u,tos:C,hole:K}),g?(g=!1,W[C].push($)):Q=!0);g&&W[u].push($)}}V.length>0&&(Q||(e=W))}var j,S,h;for(G=0,q=s.length;q>G;G++)for(l=s[G].s,a.push(l),j=e[G],S=0,h=j.length;h>S;S++)l.holes.push(j[S].h);return a};var hm=function(){yc.apply(this,arguments),this.holes=[]},ms=hm.prototype=uj(Ue);ms.getPointsHoles=function(r){var O,j=this.holes.length,e=[];for(O=0;j>O;O++)e[O]=this.holes[O].getTransformedPoints(r);return e},ms.extractAllPoints=function(Q){return{shape:this.getTransformedPoints(Q),holes:this.getPointsHoles(Q)}},ms.extractPoints=function(i){return this.extractAllPoints(i)};var Ah={triangulateShape:function(c,O){function p(y,w,Y){return y.x!=w.x?y.x<w.x?y.x<=Y.x&&Y.x<=w.x:w.x<=Y.x&&Y.x<=y.x:y.y<w.y?y.y<=Y.y&&Y.y<=w.y:w.y<=Y.y&&Y.y<=y.y}function Z(y,D,V,x,k){var L=1e-10,Y=D.x-y.x,E=D.y-y.y,W=x.x-V.x,G=x.y-V.y,l=y.x-V.x,_=y.y-V.y,U=E*W-Y*G,i=E*l-Y*_;if(B(U)>L){var F;if(U>0){if(0>i||i>U)return[];if(F=G*l-W*_,0>F||F>U)return[]}else{if(i>0||U>i)return[];if(F=G*l-W*_,F>0||U>F)return[]}if(0==F)return!k||0!=i&&i!=U?[y]:[];if(F==U)return!k||0!=i&&i!=U?[D]:[];if(0==i)return[V];if(i==U)return[x];var R=F/U;return[{x:y.x+R*Y,y:y.y+R*E}]}if(0!=i||G*l!=W*_)return[];var z=0==Y&&0==E,d=0==W&&0==G;if(z&&d)return y.x!=V.x||y.y!=V.y?[]:[y];if(z)return p(V,x,y)?[y]:[];if(d)return p(y,D,V)?[V]:[];var I,h,j,S,n,e,o,b;return 0!=Y?(y.x<D.x?(I=y,j=y.x,h=D,S=D.x):(I=D,j=D.x,h=y,S=y.x),V.x<x.x?(n=V,o=V.x,e=x,b=x.x):(n=x,o=x.x,e=V,b=V.x)):(y.y<D.y?(I=y,j=y.y,h=D,S=D.y):(I=D,j=D.y,h=y,S=y.y),V.y<x.y?(n=V,o=V.y,e=x,b=x.y):(n=x,o=x.y,e=V,b=V.y)),o>=j?o>S?[]:S==o?k?[]:[n]:b>=S?[n,h]:[n,e]:j>b?[]:j==b?k?[]:[I]:b>=S?[I,h]:[I,e]}function $(X,i,S,L){var K=1e-10,T=i.x-X.x,Y=i.y-X.y,R=S.x-X.x,$=S.y-X.y,p=L.x-X.x,f=L.y-X.y,y=T*$-Y*R,z=T*f-Y*p;if(B(y)>K){var n=p*$-f*R;return y>0?z>=0&&n>=0:z>=0||n>=0}return z>0}function y(s,T){function i(Y,b){var Z=A.length-1,t=Y-1;0>t&&(t=Z);var s=Y+1;s>Z&&(s=0);var G=$(A[Y],A[t],A[s],H[b]);if(!G)return!1;var v=H.length-1,w=b-1;0>w&&(w=v);var O=b+1;return O>v&&(O=0),G=$(H[b],H[w],H[O],A[Y]),G?!0:!1}function o(J,j){var M,R,H;for(M=0;M<A.length;M++)if(R=M+1,R%=A.length,H=Z(J,j,A[M],A[R],!0),H.length>0)return!0;return!1}function x(V,G){var o,y,R,X,W;for(o=0;o<u.length;o++)for(y=T[u[o]],R=0;R<y.length;R++)if(X=R+1,X%=y.length,W=Z(V,G,y[R],y[X],!0),W.length>0)return!0;return!1}for(var H,g,M,k,C,w,D,a,v,L,Q,A=s.concat(),u=[],W=[],j=0,O=T.length;O>j;j++)u.push(j);for(var S=0,e=2*u.length;u.length>0&&(e--,!(0>e));)for(M=S;M<A.length;M++){k=A[M],g=-1;for(var j=0;j<u.length;j++)if(w=u[j],D=k.x+":"+k.y+":"+w,W[D]===P){H=T[w];for(var l=0;l<H.length;l++)if(C=H[l],i(M,l)&&!o(k,C)&&!x(k,C)){g=l,u.splice(j,1),a=A.slice(0,M+1),v=A.slice(M),L=H.slice(g),Q=H.slice(0,g+1),A=a.concat(L).concat(Q).concat(v),S=M;break}if(g>=0)break;W[D]=!0}if(g>=0)break}return A}for(var A,L,D,x,U,X,R={},f=c.concat(),h=0,q=O.length;q>h;h++)Array.prototype.push.apply(f,O[h]);for(A=0,L=f.length;L>A;A++)U=f[A].x+":"+f[A].y,R[U]!==P,R[U]=A;var N=y(c,O),r=Nk.Triangulate(N,!1);for(A=0,L=r.length;L>A;A++)for(x=r[A],D=0;3>D;D++)U=x[D].x+":"+x[D].y,X=R[U],X!==P&&(x[D]=X);return r.concat()},isClockWise:function(l){return Nk.Triangulate.area(l)<0},b2p0:function(q,a){var L=1-q;return L*L*a},b2p1:function(U,r){return 2*(1-U)*U*r},b2p2:function(T,k){return T*T*k},b2:function(v,p,R,n){return this.b2p0(v,p)+this.b2p1(v,R)+this.b2p2(v,n)},b3p0:function(j,n){var O=1-j;return O*O*O*n},b3p1:function(s,r){var J=1-s;return 3*J*J*s*r},b3p2:function(b,L){var t=1-b;return 3*t*b*b*L},b3p3:function(P,Y){return P*P*P*Y},b3:function(X,S,d,O,I){return this.b3p0(X,S)+this.b3p1(X,d)+this.b3p2(X,O)+this.b3p3(X,I)}},Nk={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var l=O.keys(this.faces);return l.length?l[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(W){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(I){var h=I.familyName.toLowerCase(),w=this;return w.faces[h]=w.faces[h]||{},w.faces[h][I.cssFontWeight]=w.faces[h][I.cssFontWeight]||{},w.faces[h][I.cssFontWeight][I.cssFontStyle]=I,I},drawText:function(x){var A,g=this.getFace(),C=this.size/g.resolution,$=0,P=String(x).split(""),r=P.length,c=[];for(A=0;r>A;A++){var G=new yc,N=this.extractGlyphPoints(P[A],g,C,$,G);N&&($+=N.offset*this.spacing,c.push(N.path))}var s=$/2;return{paths:c,offset:s}},extractGlyphPoints:function(D,$,V,G,T){var L,s,F,w,M,U,v,u,p,_,o,n,g,j,E,C,J,Y,R,x=[],S=$.glyphs[D]||$.glyphs["?"];if(S){if(S.o)for(w=S._cachedOutline||(S._cachedOutline=S.o.split(" ")),U=w.length,v=V,u=V,L=0;U>L;)switch(M=w[L++]){case"m":p=w[L++]*v+G,_=w[L++]*u,T.moveTo(p,_);break;case"l":p=w[L++]*v+G,_=w[L++]*u,T.lineTo(p,_);break;case"q":if(o=w[L++]*v+G,n=w[L++]*u,E=w[L++]*v+G,C=w[L++]*u,T.quadraticCurveTo(E,C,o,n),R=x[x.length-1])for(g=R.x,j=R.y,s=1,F=this.divisions;F>=s;s++){var z=s/F;Ah.b2(z,g,E,o),Ah.b2(z,j,C,n)}break;case"b":if(o=w[L++]*v+G,n=w[L++]*u,E=w[L++]*v+G,C=w[L++]*u,J=w[L++]*v+G,Y=w[L++]*u,T.bezierCurveTo(E,C,J,Y,o,n),R=x[x.length-1])for(g=R.x,j=R.y,s=1,F=this.divisions;F>=s;s++){var z=s/F;Ah.b3(z,g,E,J,o),Ah.b3(z,j,C,Y,n)}}return{offset:S.ha*V,path:T}}}};Nk.generateShapes=function(w,d){d=d||{};var J=d.font;if(J===P&&(J=Nk.getDefaultFont(),!J))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var o=d.size!==P?d.size:1,z=d.curveSegments!==P?d.curveSegments:4,m=d.spacing!==P?d.spacing:1,Q=d.weight!==P?d.weight:"normal",y=d.style!==P?d.style:"normal";Nk.size=o,Nk.divisions=z,Nk.face=J,Nk.weight=Q,Nk.style=y,Nk.spacing=m;for(var c=Nk.drawText(w),k=c.paths,p=[],_=0,R=k.length;R>_;_++)Array.prototype.push.apply(p,k[_].toShapes());return p},function(a){var T=1e-10,q=function(r,N){var A=r.length;if(3>A)return null;var O,P,L,B=[],x=[],n=[];if(Z(r)>0)for(P=0;A>P;P++)x[P]=P;else for(P=0;A>P;P++)x[P]=A-1-P;var S=A,v=2*S;for(P=S-1;S>2;){if(v--<=0)return N?n:B;if(O=P,O>=S&&(O=0),P=O+1,P>=S&&(P=0),L=P+1,L>=S&&(L=0),i(r,O,P,L,S,x)){var g,b,c,e,w;for(g=x[O],b=x[P],c=x[L],B.push([r[g],r[b],r[c]]),n.push([x[O],x[P],x[L]]),e=P,w=P+1;S>w;e++,w++)x[e]=x[w];S--,v=2*S}}return N?n:B},Z=function(h){for(var Z=h.length,p=0,N=Z-1,P=0;Z>P;N=P++)p+=h[N].x*h[P].y-h[P].x*h[N].y;return.5*p},i=function(J,k,t,n,Z,p){var S,b,w,A,Y,l,e,y,N;if(b=J[p[k]].x,w=J[p[k]].y,A=J[p[t]].x,Y=J[p[t]].y,l=J[p[n]].x,e=J[p[n]].y,T>(A-b)*(e-w)-(Y-w)*(l-b))return!1;var g,G,W,D,$,d,o,i,_,E,Q,r,H,R,U;for(g=l-A,G=e-Y,W=b-l,D=w-e,$=A-b,d=Y-w,S=0;Z>S;S++)if(y=J[p[S]].x,N=J[p[S]].y,!(y===b&&N===w||y===A&&N===Y||y===l&&N===e)&&(o=y-b,i=N-w,_=y-A,E=N-Y,Q=y-l,r=N-e,U=g*E-G*_,H=$*i-d*o,R=W*r-D*Q,U>=-T&&R>=-T&&H>=-T))return!1;return!0};return a.Triangulate=q,a.Triangulate.area=Z,a}(Nk),Q._typeface_js={faces:Nk.faces,loadFace:Nk.loadFace};var pn=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Io=pn.prototype={constructor:pn,computeFaceNormals:function(){for(var i=new ll,H=new ll,X=0,L=this.faces.length;L>X;X++){var F=this.faces[X],j=this.vertices[F.a],p=this.vertices[F.b],u=this.vertices[F.c];i.subVectors(u,p),H.subVectors(j,p),i.cross(H),i.normalize(),F.normal.copy(i)}},computeVertexNormals:function(p){var X,b,j,A,m,L;for(L=new Array(this.vertices.length),X=0,b=this.vertices.length;b>X;X++)L[X]=new ll;if(p){var s,N,Z,V=new ll,M=new ll;for(j=0,A=this.faces.length;A>j;j++)m=this.faces[j],s=this.vertices[m.a],N=this.vertices[m.b],Z=this.vertices[m.c],V.subVectors(Z,N),M.subVectors(s,N),V.cross(M),L[m.a].add(V),L[m.b].add(V),L[m.c].add(V)}else for(j=0,A=this.faces.length;A>j;j++)m=this.faces[j],L[m.a].add(m.normal),L[m.b].add(m.normal),L[m.c].add(m.normal);for(X=0,b=this.vertices.length;b>X;X++)L[X].normalize();for(j=0,A=this.faces.length;A>j;j++)m=this.faces[j],m.vertexNormals[0]=L[m.a].clone(),m.vertexNormals[1]=L[m.b].clone(),m.vertexNormals[2]=L[m.c].clone()},mergeVertices:function(){var N,m,v,V,U,o,M,Y,n={},b=[],E=[],k=4,l=c(10,k);for(v=0,V=this.vertices.length;V>v;v++)N=this.vertices[v],m=j(N.x*l)+"_"+j(N.y*l)+"_"+j(N.z*l),n[m]===P?(n[m]=v,b.push(this.vertices[v]),E[v]=b.length-1):E[v]=E[n[m]];var i=[];for(v=0,V=this.faces.length;V>v;v++){U=this.faces[v],U.a=E[U.a],U.b=E[U.b],U.c=E[U.c],o=[U.a,U.b,U.c];for(var u=0;3>u;u++)if(o[u]==o[(u+1)%3]){i.push(v);break}}for(v=i.length-1;v>=0;v--){var F=i[v];for(this.faces.splice(F,1),M=0,Y=this.faceVertexUvs.length;Y>M;M++)this.faceVertexUvs[M].splice(F,1)}var W=this.vertices.length-b.length;return this.vertices=b,W}},Do=function($,M,i,j,K,m,o){this.aX=$,this.aY=M,this.xRadius=i,this.yRadius=j,this.aStartAngle=K,this.aEndAngle=m,this.aClockwise=o};Do.prototype=uj(pg),Do.prototype.getPoint=function(Z){var $,h=this.aEndAngle-this.aStartAngle;0>h&&(h+=a),h>a&&(h-=a),$=this.aClockwise===!0?this.aEndAngle+(1-Z)*(a-h):this.aStartAngle+Z*h;var I=this.aX+this.xRadius*W($),F=this.aY+this.yRadius*l($);return new Zo(I,F)};var me=function(H,E){this.v1=H,this.v2=E},Qd=me.prototype=uj(pg);Qd.getPoint=function(m){var c=this.v2.clone().sub(this.v1);return c.multiplyScalar(m).add(this.v1),c},Qd.getPointAt=function(g){return this.getPoint(g)},Qd.getTangent=function(){var c=this.v2.clone().sub(this.v1);return c.normalize()};var Uo=function(W,O,Z){this.v0=W,this.v1=O,this.v2=Z};Uo.prototype=uj(pg),Uo.prototype.getPoint=function(P){var c,x;return c=Ah.b2(P,this.v0.x,this.v1.x,this.v2.x),x=Ah.b2(P,this.v0.y,this.v1.y,this.v2.y),new Zo(c,x)};var Ti=function(q,X,e,M){this.v0=q,this.v1=X,this.v2=e,this.v3=M};Ti.prototype=uj(pg),Ti.prototype.getPoint=function(H){var Y,C;return Y=Ah.b3(H,this.v0.x,this.v1.x,this.v2.x,this.v3.x),C=Ah.b3(H,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Zo(Y,C)},Vc.create(function(r,q){this.v1=r,this.v2=q},function(U){var B=new ll;return B.subVectors(this.v2,this.v1),B.multiplyScalar(U),B.add(this.v1),B});var Tm=Vc.create(function(A,b,i){this.v0=A,this.v1=b,this.v2=i},function(m){var $,N,y;return $=Ah.b2(m,this.v0.x,this.v1.x,this.v2.x),N=Ah.b2(m,this.v0.y,this.v1.y,this.v2.y),y=Ah.b2(m,this.v0.z,this.v1.z,this.v2.z),new ll($,N,y)}),Fq=Vc.create(function(y,d,N,V){this.v0=y,this.v1=d,this.v2=N,this.v3=V},function(g){var Y,V,I;return Y=Ah.b3(g,this.v0.x,this.v1.x,this.v2.x,this.v3.x),V=Ah.b3(g,this.v0.y,this.v1.y,this.v2.y,this.v3.y),I=Ah.b3(g,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new ll(Y,V,I)}),Iq=function(n,b,v,V,B,k,j,d){pn.call(this),V=V!==P?V:.5,B=B!==P?B:.5,d=d!==P?d:1,n=n||8,k=k||0,j=j||a;var _,R,X=1,Q=d/2,U=[],Y=[],r=this.vertices,M=this.faces,J=this.faceVertexUvs;for(R=0;X>=R;R++){var u=[],H=[],G=R/X,C=G*(B-V)+V;for(_=0;n>=_;_++){var F=_/n,T=new ll,D=-(F*j+k);T.z=C*l(D),T.y=-G*d+Q,T.x=C*W(D),r.push(T),u.push(r.length-1),H.push(new Zo(F,G))}U.push(u),Y.push(H)}var N,K,q=(B-V)/d;for(_=0;n>_;_++)for(0!==V?(N=r[U[0][_]].clone(),K=r[U[0][_+1]].clone()):(N=r[U[1][_]].clone(),K=r[U[1][_+1]].clone()),N.setY(A(N.x*N.x+N.z*N.z)*q).normalize(),K.setY(A(K.x*K.x+K.z*K.z)*q).normalize(),R=0;X>R;R++){var e=U[R][_],E=U[R+1][_],S=U[R+1][_+1],p=U[R][_+1],c=N.clone(),Z=N.clone(),i=K.clone(),o=K.clone(),z=Y[R][_].clone(),x=Y[R+1][_].clone(),h=Y[R+1][_+1].clone(),w=Y[R][_+1].clone();M.push(new hl(e,E,p,[c,Z,o])),J[0].push([z,x,w]),M.push(new hl(E,S,p,[Z.clone(),i,o.clone()])),J[0].push([x.clone(),h,w.clone()])}if(b&&V>0)for(this.vertices.push(new ll(0,Q,0)),_=0;n>_;_++){var e=U[0][_],E=U[0][_+1],S=this.vertices.length-1,c=new ll(0,1,0),Z=new ll(0,1,0),i=new ll(0,1,0),z=Y[0][_].clone(),x=Y[0][_+1].clone(),h=new Zo(x.x,0);M.push(new hl(e,E,S,[c,Z,i],null,1));var g=_/n*a,f=W(g),m=l(g),s=(_+1)/n*a,y=W(s),O=l(s);J[0].push([new Zo(.5+.5*f,.5+.5*m),new Zo(.5+.5*y,.5+.5*O),new Zo(.5,.5)])}if(v&&B>0)for(this.vertices.push(new ll(0,-Q,0)),_=0;n>_;_++){var e=U[R][_+1],E=U[R][_],S=r.length-1,c=new ll(0,-1,0),Z=new ll(0,-1,0),i=new ll(0,-1,0),z=Y[R][_+1].clone(),x=Y[R][_].clone();M.push(new hl(e,E,S,[c,Z,i],null,2));var g=_/n*a,f=W(g),m=l(g),s=(_+1)/n*a,y=W(s),O=l(s);J[0].push([new Zo(.5+.5*y,.5-.5*O),new Zo(.5+.5*f,.5-.5*m),new Zo(.5,.5)])}};Iq.prototype=uj(Io);var Rj=function($,f,R,d,j,g,F){pn.call(this),F=F||.5,$=$||16,f=f||16,R=(R!==P?R:0)-D,d=d!==P?d:a,j=j!==P?j:0,g=g!==P?g:D;var L,C,k=[],y=[],t=this.vertices,x=this.faces,K=this.faceVertexUvs;for(C=0;f>=C;C++){var z=[],I=[];for(L=0;$>=L;L++){var n=L/$,O=C/f,Z=new ll;Z.x=-F*W(R+n*d)*l(j+O*g),Z.y=F*W(j+O*g),Z.z=F*l(R+n*d)*l(j+O*g),t.push(Z),z.push(t.length-1),I.push(new Zo(n,O))}k.push(z),y.push(I)}for(C=0;f>C;C++)for(L=0;$>L;L++){var w=k[C][L+1],G=k[C][L],i=k[C+1][L],H=k[C+1][L+1],o=t[w].clone().normalize(),S=t[G].clone().normalize(),E=t[i].clone().normalize(),T=t[H].clone().normalize(),Q=y[C][L+1].clone(),q=y[C][L].clone(),r=y[C+1][L].clone(),A=y[C+1][L+1].clone();B(t[w].y)===F?(Q.x=(Q.x+q.x)/2,x.push(new hl(w,i,H,[o,E,T])),K[0].push([Q,r,A])):B(t[i].y)===F?(r.x=(r.x+A.x)/2,x.push(new hl(w,G,i,[o,S,E])),K[0].push([Q,q,r])):(x.push(new hl(w,G,H,[o,S,T])),K[0].push([Q,q,A]),x.push(new hl(G,i,H,[S.clone(),E,T.clone()])),K[0].push([q.clone(),r,A.clone()]))}};Rj.prototype=uj(Io);var uk=function(C,T,A,U,R,u){pn.call(this),C=C||.33,T=T||.17,U=U||8,A=A||6,R=R||0,u=u||a;for(var I=new ll,y=[],M=[],x=0;U>=x;x++)for(var t=x/U*a+D,f=0;A>=f;f++){var z=f/A*u+R;I.x=C*W(z),I.z=-C*l(z);var $=new ll,Q=C+T*W(t);$.x=Q*W(z),$.z=-Q*l(z),$.y=T*l(t),this.vertices.push($),y.push(new Zo(f/A,1-x/U)),M.push($.clone().sub(I).normalize())}for(var x=1;U>=x;x++)for(var f=1;A>=f;f++){var h=(A+1)*x+f-1,m=(A+1)*(x-1)+f-1,e=(A+1)*(x-1)+f,F=(A+1)*x+f,r=new hl(h,m,F,[M[h].clone(),M[m].clone(),M[F].clone()]);this.faces.push(r),this.faceVertexUvs[0].push([y[h].clone(),y[m].clone(),y[F].clone()]),r=new hl(m,e,F,[M[m].clone(),M[e].clone(),M[F].clone()]),this.faces.push(r),this.faceVertexUvs[0].push([y[m].clone(),y[e].clone(),y[F].clone()])}this.computeFaceNormals()};uk.prototype=uj(Io);var Ye=function(E,e,S){return E?(pn.call(this),E=E instanceof Array?E:[E],this.addShapeList(E,e),e.convertYZ!==!1&&ak(this,S),this.computeFaceNormals(),void 0):(E=[],void 0)},we=Ye.prototype=uj(pn.prototype);we.addShapeList=function(Y,r){for(var d=Y.length,G=0;d>G;G++){var b=Y[G];this.addShape(b,r)}},we.addShape=function(h,v){function o(){if(v.bottom)for(var r=0;a>r;r++)X=L[r],I(X[2],X[1],X[0],!0);if(v.top)for(r=0;a>r;r++)X=L[r],I(X[0]+t*T,X[1]+t*T,X[2]+t*T,!1)}function s(){var X=0;for(b(q,X),X+=q.length,J=0,E=l.length;E>J;J++)S=l[J],b(S,X),X+=S.length}function b(y,X){for(var z,g,n=y.length;--n>=0;){z=n,g=n-1,0>g&&(g=y.length-1);var Q=0,x=T;for(Q=0;x>Q;Q++){var v=t*Q,e=t*(Q+1),u=X+z+v,P=X+g+v,Y=X+g+e,d=X+z+e;k(u,P,Y,d,y,Q,x,z,g)}}}function O(l,K,z){C.vertices.push(new ll(l,K,z))}function I(l,S,c,a){l+=p,S+=p,c+=p,C.faces.push(new hl(l,S,c,null,null,a?2:1));var R=a?j.generateBottomUV(C,h,v,l,S,c):j.generateTopUV(C,h,v,l,S,c);C.faceVertexUvs[0].push(R)}function k(Q,P,q,e,S,r,V,O,t){Q+=p,P+=p,q+=p,e+=p,C.faces.push(new hl(Q,P,e)),C.faces.push(new hl(P,q,e));var g=j.generateSideWallUV(C,h,S,v,Q,P,q,e,r,V,O,t);C.faceVertexUvs[0].push([g[0],g[1],g[3]]),C.faceVertexUvs[0].push([g[1],g[2],g[3]])}var e,W,z,D,Z,r=v.amount,f=v.curveSegments||on,T=v.steps||1,G=v.extrudePath,x=!1,j=new se(v.repeatUVLength,v.boundingBox);G&&(e=G.getSpacedPoints(T),x=!0,W=v.frames!==P?v.frames:new $o.FrenetFrames(G,T,!1),z=new ll,D=new ll,Z=new ll);var S,J,E,C=this,p=this.vertices.length,y=h.extractPoints(f),M=y.shape,l=y.holes,m=!Ah.isClockWise(M);if(m){for(M=M.reverse(),J=0,E=l.length;E>J;J++)S=l[J],Ah.isClockWise(S)&&(l[J]=S.reverse());m=!1}var L=Ah.triangulateShape(M,l),q=M;for(J=0,E=l.length;E>J;J++)S=l[J],M=M.concat(S);for(var _,X,t=M.length,a=L.length,$=0;t>$;$++)_=M[$],x?(D.copy(W.normals[0]).multiplyScalar(_.x),z.copy(W.binormals[0]).multiplyScalar(_.y),Z.copy(e[0]).add(D).add(z),O(Z.x,Z.y,Z.z)):O(_.x,_.y,0);var K;for(K=1;T>=K;K++)for($=0;t>$;$++)_=M[$],x?(D.copy(W.normals[K]).multiplyScalar(_.x),z.copy(W.binormals[K]).multiplyScalar(_.y),Z.copy(e[K]).add(D).add(z),O(Z.x,Z.y,Z.z)):O(_.x,_.y,r/T*K);o(),s()};var $o=function(D,$,v,p,f){function g(i,p,n){return B.vertices.push(new ll(i,p,n))-1
}pn.call(this),$=$||64,v=v||1,p=p||8,f=f||!1;var q,Z,i,u,x,o,R,j,J,s,n,w,c,t,S,M,h,Y,T,E,z=[],B=this,K=$+1,I=new ll,d=new $o.FrenetFrames(D,$,f),X=d.tangents,O=d.normals,Q=d.binormals;for(this.tangents=X,this.normals=O,this.binormals=Q,J=0;K>J;J++)for(z[J]=[],u=J/(K-1),j=D.getPointAt(u),q=X[J],Z=O[J],i=Q[J],s=0;p>s;s++)x=s/p*a,o=-v*W(x),R=v*l(x),I.copy(j),I.x+=o*Z.x+R*i.x,I.y+=o*Z.y+R*i.y,I.z+=o*Z.z+R*i.z,z[J][s]=g(I.x,I.y,I.z);for(J=0;$>J;J++)for(s=0;p>s;s++)n=f?(J+1)%$:J+1,w=(s+1)%p,c=z[J][s],t=z[n][s],S=z[n][w],M=z[J][w],h=new Zo(J/$,s/p),Y=new Zo((J+1)/$,s/p),T=new Zo((J+1)/$,(s+1)/p),E=new Zo(J/$,(s+1)/p),this.faces.push(new hl(c,t,M)),this.faceVertexUvs[0].push([h,Y,E]),this.faces.push(new hl(t,S,M)),this.faceVertexUvs[0].push([Y.clone(),T,E.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};$o.prototype=uj(Io),$o.FrenetFrames=function(q,v,W){function i(){r[0]=new ll,K[0]=new ll,G=Number.MAX_VALUE,m=B(t[0].x),w=B(t[0].y),N=B(t[0].z),G>=m&&(G=m,H.set(1,0,0)),G>=w&&(G=w,H.set(0,1,0)),G>=N&&H.set(0,0,1),Q.crossVectors(t[0],H).normalize(),r[0].crossVectors(t[0],Q),K[0].crossVectors(t[0],r[0])}var s,G,m,w,N,I,z,H=new ll,t=[],r=[],K=[],Q=new ll,h=new jo,c=v+1,X=1e-4;for(this.tangents=t,this.normals=r,this.binormals=K,I=0;c>I;I++)z=I/(c-1),t[I]=q.getTangentAt(z),t[I].normalize();for(i(),I=1;c>I;I++)r[I]=r[I-1].clone(),K[I]=K[I-1].clone(),Q.crossVectors(t[I-1],t[I]),Q.length()>X&&(Q.normalize(),s=e(lj(t[I-1].dot(t[I]),-1,1)),r[I].applyMatrix4(h.makeRotationAxis(Q,s))),K[I].crossVectors(t[I],r[I]);if(W)for(s=e(lj(r[0].dot(r[c-1]),-1,1)),s/=c-1,t[0].dot(Q.crossVectors(r[0],r[c-1]))>0&&(s=-s),I=1;c>I;I++)r[I].applyMatrix4(h.makeRotationAxis(t[I],s*I)),K[I].crossVectors(t[I],r[I])};var Db=function(M,p,C,y){pn.call(this),p=p||18,C=C||0,y=y==E?a:y;for(var L=1/(M.length-1),r=1/p,D=0,A=p;A>=D;D++)for(var Y=C+D*r*y,w=W(Y),n=l(Y),v=0,d=M.length;d>v;v++){var f=M[v],V=new ll;V.x=w*f.x-n*f.y,V.y=n*f.x+w*f.y,V.z=f.z,this.vertices.push(V)}for(var e=M.length,D=0,A=p;A>D;D++)for(var v=0,d=M.length-1;d>v;v++){var c=v+e*D,t=c,S=c+e,w=c+1+e,s=c+1,U=D*r,x=v*L,I=U+r,H=x+L;this.faces.push(new hl(t,s,S)),this.faceVertexUvs[0].push([new Zo(U,x),new Zo(U,H),new Zo(I,x)]),this.faces.push(new hl(S,s,w)),this.faceVertexUvs[0].push([new Zo(I,x),new Zo(U,H),new Zo(I,H)])}this.mergeVertices(),ak(this),this.computeFaceNormals(),this.computeVertexNormals()};Db.prototype=uj(Io);var Cs=function(p,m){m=m||{};var J=Nk.generateShapes(p,m);m.amount=m.amount!==P?m.amount:.5,m.convertYZ=!1,m.fill!==!1&&(m.bottom=!0,m.top=!0),Ye.call(this,J,m)};Cs.prototype=uj(we);var xi=h.Node=function(){cb(xi,this)},al={X:uo,Y:rh,Z:Ao},Ji={X:0,Y:1,Z:2},Jp={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},wi=new _d,gj="xzy",Qc=function(F,J,P){if(J){var g=J[0],x=J[1],H=J[2];"xzy"===P?(rh(F,x),Ao(F,H),uo(F,g)):"xyz"===P?(Ao(F,H),rh(F,x),uo(F,g)):"yxz"===P?(Ao(F,H),uo(F,g),rh(F,x)):"yzx"===P?(uo(F,g),Ao(F,H),rh(F,x)):"zxy"===P?(rh(F,x),uo(F,g),Ao(F,H)):"zyx"===P?(uo(F,g),rh(F,x),Ao(F,H)):(rh(F,x),Ao(F,H),uo(F,g))}};lq("Node",Lk,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:gj,_64O:0,_rotationX:0,_53O:0,_host:E,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return mk},_22Q:function(){return lt},getX:function(){return this.p().x},setX:function(s){this.p(s,this.p().y)},getY:function(){return this.p().y},setY:function(C){this.p(this.p().x,C)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(q){this.setAnchor(q,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(m){this.setAnchor(this.getAnchor().x,m)},getScaleX:function(){return this.getScale().x},setScaleX:function(s){this.setScale(s,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(I){this.setScale(this.getScale().x,I)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},setQuaternion:function(m){var s=(new bn).setFromQuaternion(m,bn.ReverseOrder(this.getRotationMode()));return this._applyClosestR3(s.x,s.y,s.z)},getQuaternion:function(){var J=new bn,K=new bn,M=new _d;return function(p){return p||(p=new _d),this.getEuler(J),J.equals(K)?p.copy(M):p.copy(M.setFromEuler(K.copy(J)))}}(),getEuler:function(p){var $=this.r3();return p||(p=new bn),p.set($[0],$[1],$[2],bn.ReverseOrder(this.getRotationMode()))},setEuler:function(w){return w=w.clone().reorder(bn.ReverseOrder(this.getRotationMode())),this.r3(w.x,w.y,w.z)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(k,M){kc(k,Gg(E,E,this.r3(),this.getRotationMode())),this.translate3d(k[0]*M,k[1]*M,k[2]*M)},translateFront:function(l){this.translate3dBy([0,0,1],l)},translateBack:function(K){this.translate3dBy([0,0,-1],K)},translateLeft:function(z){this.translate3dBy([-1,0,0],z)},translateRight:function(X){this.translate3dBy([1,0,0],X)},translateTop:function(F){this.translate3dBy([0,1,0],F)},translateBottom:function(k){this.translate3dBy([0,-1,0],k)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(l,n,U){1===arguments.length&&(n=l[1],U=l[2],l=l[0]),this.p(l,U),this.setElevation(n)},translate3d:function(r,Y,k){1===arguments.length&&(Y=r[1],k=r[2],r=r[0]),this.translate(r,k),this.setElevation(this._54O+Y)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(y,Y,H){1===arguments.length&&(Y=y[1],H=y[2],y=y[0]),this.setSize(y,H),this.setTall(Y)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(N,K,E){var c=this;if(!c._updatingRotation3d){c._updatingRotation3d=1,1===arguments.length&&(K=N[1],E=N[2],N=N[0]);var f=[c._rotationX,-c._64O,c._53O];c._rotationX=N,c._64O=-K,c._53O=E,c.fp("rotation3d",f,[N,K,E]),delete c._updatingRotation3d}},_applyClosestR3:function(){function y(N){return N%=a,0>N&&(N+=a),N>D?a-N:N}function W(j,s){return y(j[0]-s[0])+y(j[1]-s[1])+y(j[2]-s[2])}return function(x,N,V){var X,R,q,c=this.r3(),M=this.getRotationMode();"xzy"===M||"yzx"===M?(X=x>0?x-D:x+D,R=N>0?N-D:N+D,q=V>0?D-V:-D-V):"xyz"===M||"zyx"===M?(X=x>0?x-D:x+D,q=V>0?V-D:V+D,R=N>0?D-N:-D-N):("yxz"===M||"zxy"===M)&&(q=V>0?V-D:V+D,R=N>0?N-D:N+D,X=x>0?D-x:-D-x),W([X,R,q],c)<W([x,N,V],c)?this.r3(X,R,q):this.r3(x,N,V)}}(),setRotationY:function(E){this.setRotation(-E)},getRotationY:function(){return-this._64O},lookAtDirection:function(o,U){U=U||Yp;var y=this,c=nk(o);U===Yp?(y.r3([-q(o[1]/c),-Hr(o[2],o[0])+ss,0]),y.setRotationMode("xzy")):U===es?(y.r3(0,-Hr(o[2],o[0]),q(o[1]/c)),y.setRotationMode("zyx")):U===zi?(y.r3(0,-Hr(o[2],o[0])+D,-q(o[1]/c)),y.setRotationMode("zyx")):U===Mo?(y.r3([-q(o[1]/c)+ss,-Hr(o[2],o[0])+ss,0]),y.setRotationMode("xzy")):U===de&&(y.r3([-q(o[1]/c)-ss,-Hr(o[2],o[0])+ss,0]),y.setRotationMode("xzy")),U===mc&&(y.r3([-q(o[1]/c)+D,-Hr(o[2],o[0])+ss,D]),y.setRotationMode("zxy"))},lookAt:function(c,v){return this.lookAtDirection(tf(c,this.p3()),v)},lookAtX:function(){var w=new Ab,m=new Ab,N=new Ab,$=new jo,T=new jo,f=new bn;return function(c,S){var Y=$f(this);if($.fromArray(Y),N.copy(this.p3()),w.copy(c).sub(N),!(w.lengthSq()<1e-6)){w.normalize(),S=S||Yp,"string"==typeof S?S===Yp?m.set(0,0,1):S===mc?m.set(0,0,-1):S===zi?m.set(-1,0,0):S===es?m.set(1,0,0):S===Mo?m.set(0,1,0):S===de&&m.set(0,-1,0):m.copy(S).normalize(),m.applyMatrix4($).sub(N).normalize();var o=Math.acos(w.dot(m));if(o){var L=w.clone().cross(m);L.lengthSq()<1e-6&&(S===Mo||S===de||0===S[0]&&0===S[1]?L.set(0,0,1).applyMatrix4($).sub(N):L.set(0,1,0).applyMatrix4($).sub(N)),L.normalize(),f.set(this.r3(),this.getRotationMode(),!0),$.makeRotationFromEuler(f),T.makeRotationAxis(L,-o),f.setFromRotationMatrix(T.multiply($)),this._applyClosestR3(f.x,f.y,f.z)}}}}(),getHost:function(){return this._host},setHost:function(n){var e=this;if(e!==n&&e._host!==n){var Z=e._host;Z&&(Z._removeAttach(e),Z.updateLayoutAttaches()),e._host=n,e._host&&e._host._addAttach(e),e.fp("host",Z,n),e.onHostChanged(Z,n)}},getAttaches:function(){return this._69O},_addAttach:function(Z){var X=this;X._69O||(X._69O=new oc),X._69O.add(Z),X.fp("attaches",E,Z)},_removeAttach:function(R){var h=this;h._69O.remove(R),h._69O.isEmpty()&&delete h._69O,h.fp("attaches",R,E)},getImage:function(){if(this._pendingCheckImageJSON){var j=K.getImage(this._image);j&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Sg&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(l){var D=this,A=D._image,N=D.getWidth(),H=D.getHeight();if(D._image=l,D.fp("image",A,l)){if(null!=l&&(Hh(l)||Om(l)&&/\.json$/i.test(l))&&(this._pendingCheckImageJSON=!0),sn)return;D.fp(il,N,D.getWidth()),D.fp(Cr,H,D.getHeight())}},getElevation:function(){return this._54O},setElevation:function(s){var a=this;if(!a._50O){a._50O=1;var j=a._54O;a._54O=s,a.fp(vj,j,s),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(q){var x=this;if(!x._49O){x._49O=1;var Y=x._64O;x._64O=q,x.fp(Wk,Y,q),delete x._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(h){var k=this;if(!k._51O){k._51O=1;var Z=k._rotationX;k._rotationX=h,k.fp("rotationX",Z,h),delete k._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(s){var W=this;if(!W._52O){W._52O=1;var x=W._53O;W._53O=s,W.fp("rotationZ",x,s),delete W._52O}},getPosition:function(){return this._position},setPosition:function(D,E){var g=this;if(!g._50I){g._50I=1;var L;if(L=2===arguments.length?{x:D,y:E}:D,L.x!==g._position.x||L.y!==g._position.y){var T=g._position;g._position=L,g.fp(Fr,T,L)}delete g._50I}},translate:function(U,P){var z=this._position;this.p(z.x+U,z.y+P)},hasInheritedSize:function(){var D=this,z=D.getStyle("shape3d");if(z){var g=sg(z);if(g&&g.rawS3)return!0;if(("billboard"===z||"plane"===z)&&fl(D.getStyle("shape3d.image")))return!0}return D.hasOwnProperty("_image")&&fl(D._image)?!0:!1},getWidth:function(){var a=this;if(a._width>=0)return a._width;var V=a.getStyle("shape3d");if(V){var S=sg(V);if(S&&S.rawS3)return S.rawS3[0];if("billboard"===V||"plane"===V){var j=fl(a.getStyle("shape3d.image"));return j?_r(j,a):20}}var j=fl(a._image);return j?_r(j,a):20},setWidth:function(T){var S=this,l=S._width;S._width=T,S.fp(il,l,T)},getHeight:function(){var x=this;if(x._height>=0)return x._height;var E=x.getStyle("shape3d");if(E){var $=sg(E);if($&&$.rawS3)return $.rawS3[2];if("plane"===E){var a=fl(x.getStyle("shape3d.image"));return a?wm(a,x):20}if("billboard"===E)return 2}var a=fl(x._image);return a?wm(a,x):20},setHeight:function(X){var S=this,_=S._height;S._height=X,S.fp(Cr,_,X)},getTall:function(){var A=this;if(A._tall>=0)return A._tall;var n=A.getStyle("shape3d");if(n){var $=sg(n);if($&&$.rawS3)return $.rawS3[1];if("billboard"===n){var I=fl(A.getStyle("shape3d.image"));return I?wm(I,A):20}if("plane"===n)return 2}return 20},setTall:function(X){var D=this,m=D._tall;D._tall=X,D.fp("tall",m,X)},setSize:function(Z,h){var l=this;2===arguments.length?(l.setWidth(Z),l.setHeight(h)):(l.setWidth(Z.width),l.setHeight(Z.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(r,N,p,u,E){var Y=this,n=Y.getAnchor(),m=Y.getScale();arguments.length<=2&&(E=N,N=r.y,p=r.width,u=r.height,r=r.x);var T=E&&m.x<0?1-n.x:n.x,A=E&&m.y<0?1-n.y:n.y;Y.p(r+p*T,N+u*A),E&&(p/=Math.abs(m.x),u/=Math.abs(m.y)),Y.setWidth(p),Y.setHeight(u)},getMatrix:function(){var A=this,d=A._64O,F=A._position,s=A.getScale();return new Jh(d,F.x,F.y,s.x,s.y)},getMatrix4:function(){var V=new Ab,A=new _d,_=new Ab;return function(S){return this.getQuaternion(A),V.copy(this.p3()),_.copy(this.getFinalScale3d()),S||(S=new jo),S.compose(V,A,_)}}(),getAnchorRect:function(){var s=this,P=s.getWidth(),H=s.getHeight(),N=s.getAnchor();return{x:-P*N.x,y:-H*N.y,width:P,height:H}},toLocal:function(B){return this.getMatrix().tfi(B)},toGlobal:function(K){return this.getMatrix().tf(K)},getAttachPosition:function(){var w=new Jh;return function(b,j,X,W){X=X||0,W=W||0;var v=this,t=v.getAnchor(),i=v._64O,e=v._position,V=v.getScale();return w.setFromTransform(i,e.x,e.y).tf({x:X+V.x*v.getWidth()*(b-t.x),y:W+V.y*v.getHeight()*(j-t.y)})}}(),isInRect:function($){$=this.toLocal($);var R=this.getWidth(),q=this.getHeight();return $.x+=R*this.getAnchorX(),$.y+=q*this.getAnchorY(),!($.x<0||$.y<0||$.x>R||$.y>q)},getRect:function(){var t=this,T=t.getWidth(),u=t.getHeight(),x=t.getAnchor(),r={x:-T*x.x,y:-u*x.y,width:T,height:u},m=t.getMatrix();return r=Nd([m.tf(r.x,r.y),m.tf(r.x+r.width,r.y),m.tf(r.x+r.width,r.y+r.height),m.tf(r.x,r.y+r.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var Z=this,G=Z.getAnchor(),i=Z._anchorElevation;return{x:G.x,y:i,z:G.y}},setAnchorElevation:function(n){var N=this,g=N._anchorElevation;return g!==n?(N._anchorElevation=n,N.fp("anchorElevation",g,n),!0):!1},setAnchor3d:function(T,u,P,I){var L,K=this;"number"==typeof T?L={x:T,y:u,z:P}:(L=T.length?{x:T[0],y:T[1],z:T[2]}:T,I=u),K.beginTransaction();var V=K.getAnchor3d(),Y=K.setAnchor(L.x,L.z);if(K.setAnchorElevation(L.y)&&(Y=!0),Y&&I&&!sn){K.getAnchor3d();var Z=$f(K),W=kc([L.x-V.x,L.y-V.y,L.z-V.z],Z);K.p3(W)}return K.endTransaction(),Y},getAnchor:function(){var p=this;if(p.hasOwnProperty("_anchor"))return p._anchor;var H=fl(p._image);return H&&H.anchorX!==P?{x:H.anchorX,y:H.anchorY}:p._anchor},setAnchor:function(Q,j,n){var o,U=this;"number"==typeof Q?o={x:Q,y:j}:(o=Q.length?{x:Q[0],y:Q[1]}:Q,n=j);var t=U.getAnchor();if(t.x!==o.x||t.y!==o.y){if(U.beginTransaction(),U._anchor=o,U.fp("anchor",t,o),n&&!sn){var h=U.getPosition(),b=U.getSize(),c=U.getRotation(),f=U.getScale(),q=-b.width*(t.x-o.x)*f.x,C=-b.height*(t.y-o.y)*f.y,x=l(c),g=W(c);U.setPosition(h.x+g*q-x*C,h.y+x*q+g*C)}return U.endTransaction(),!0}return!1},getLocalQuaternion:function(S){var X=this,b=X.getHost();if(!b)return X.getQuaternion(S);var C=b.getQuaternion(),E=X.getQuaternion();return S||(S=new _d),S.copy(C).inverse().multiply(E)},setLocalQuaternion:function(Y){var Z=this,p=Z.getHost();if(!p)return Z.setQuaternion(Y);var T=p.getQuaternion();Z.setQuaternion(T.clone().multiply(Y))},getLocalEuler:function(){var T=new _d;return function(k){var S=this,Z=S.getHost();return Z?(S.getLocalQuaternion(T),k||(k=new bn),k.setFromQuaternion(T,bn.ReverseOrder(this.getRotationMode()))):S.getEuler(k)}}(),setLocalEuler:function(){var m=new _d;return function(F){var y=this,x=y.getHost();return x?(m.setFromEuler(F),y.setLocalQuaternion(m)):y.setEuler(F)}}(),getLocalPosition3d:function(L){var $=this;L||(L=new Ab),L.copy($.p3());var Z=$.getHost();if(!Z)return L;var K=Z.getMatrix4();return L.applyMatrix4(K.getInverse(K))},setLocalPosition3d:function(E){var e=this,I=e.getHost();if(!I)return E.x!==P?e.p3(E.x,E.y,E.z):e.p3(E),void 0;var K=I.getMatrix4(),O=new Ab(E);O.applyMatrix4(K),e.p3(O.x,O.y,O.z)},getScale:function(){return this._scale},setScale:function(x,g){var T,X=this;T=2===arguments.length?{x:x,y:g}:x;var Y=X.getScale();(Y.x!==T.x||Y.y!==T.y)&&(X._scale=T,X.fp("scale",Y,T))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var e=this,_=e._scaleTall,V=e.getScale();return[V.x,_,V.y]},getFinalScale3d:function(){var i=this,g=i.s3(),T=i._dynamicScale3d,v=i.getScale3d();return g&&(v[0]*=g[0],v[1]*=g[1],v[2]*=g[2]),T&&(v[0]*=T[0],v[1]*=T[1],v[2]*=T[2]),v},getFinalRotation3d:function(){var C=this;return C._dynamicRotation||C.r3()},setScaleTall:function(B){var e=this,M=e._scaleTall;M!==B&&(e._scaleTall=B,e.fp("scaleTall",M,B))},setScale3d:function(k,_,E){var h,d=this;h="number"==typeof k?{x:k,y:_,z:E}:k.length?{x:k[0],y:k[1],z:k[2]}:k,d.setScaleTall(h.y),d.setScale(h.x,h.z)},getCorners:function(Y,t){Y==E&&(Y=0),t==E&&(t=Y);var V=this,k=V.getAnchor(),D=V.getWidth(),y=V.getHeight(),a=-D*k.x-Y,S=-y*k.y-t,J=D+2*Y,r=y+2*t,e=V.getMatrix();return[e.tf(a,S),e.tf(a,S+r),e.tf(a+J,S+r),e.tf(a+J,S)]},getEditControlPoints:function(M,$,v){$==E&&($=0),v==E&&(v=$);var y=this,p=y.getAnchor(),A=y.getWidth(),j=y.getHeight(),U=-A*p.x-$,a=-j*p.y-v,w=A+2*$,m=j+2*v;if(M)return[{x:U,y:a},{x:U,y:0},{x:U,y:a+m},{x:0,y:a+m},{x:U+w,y:a+m},{x:U+w,y:0},{x:U+w,y:a},{x:0,y:a}];var R=y.getMatrix();return[R.tf(U,a),R.tf(U,0),R.tf(U,a+m),R.tf(0,a+m),R.tf(U+w,a+m),R.tf(U+w,0),R.tf(U+w,a),R.tf(0,a)]},rotateAt:function(g,K,s){var u=this,c=u._position,t=u._64O,G=new Jh(t,c.x,c.y).tf(g,K),k=A(g*g+K*K),T=Hr(c.y-G.y,c.x-G.x)+s;u.setRotation(t+s),u.p(G.x+k*W(T),G.y+k*l(T))},rotateAroundAxis:function(X,r){this.setQuaternion(this.getQuaternion().multiply(wi.setFromAxisAngle(X,r)))},rotateAroundWorldAxis:function(n,g){this.setQuaternion(this.getQuaternion().premultiply(wi.setFromAxisAngle(n,g)))},rotateX:function(v){return this.rotateAroundAxis(Ab.AxisX,v)},rotateY:function(h){return this.rotateAroundAxis(Ab.AxisY,h)},rotateZ:function(Q){return this.rotateAroundAxis(Ab.AxisZ,Q)},onParentChanged:function(){xi.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var o={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(F){o[F]=!0}),function(T){var B=this;xi.superClass.onPropertyChanged.call(B,T);var e=T.property;if(o[e]&&!B._layoutUpdating&&B.updateLayoutParameters(null,e),B._69O&&B._69O.each(function(h){h.handleHostPropertyChange(T)}),B._49I&&B._49I.each(function(H){H.fp("agentChange",!0,!1)}),ud[e]||"a:layout"===e.substring(0,8)){this.updateLayoutAttaches();var S=B._host;S&&S.updateLayoutAttaches()}("s:shape3d.autorotate"===e||"s:autorotate"===e||"s:shape3d.fixSizeOnScreen"===e||"s:fixSizeOnScreen"===e||"s:hide.overlapping.group"===e)&&(B._47Q=B.s("autorotate")||B.s("shape3d.autorotate")||B.s("fixSizeOnScreen")||B.s("shape3d.fixSizeOnScreen")||B.s("hide.overlapping.group"))}}(),onHostChanged:function(){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(f){this.updateAttach(f)},onStyleChanged:function(C){xi.superClass.onStyleChanged.apply(this,arguments),ko[C]&&this.updateAttach()},updateLayoutAttaches:function(){if(!sn&&this.s("vector.layoutable")){var h,P,W=this;return h=fl(W.getImage()),h&&h.layoutAttach&&(P=h.layoutAttach,P&&P(W))?!0:void 0}},updateAttach:function(R){var v=this;return sn?(v.updateLayoutParameters(),void 0):(v._51I||(v._51I=1,v._71O(R),delete v._51I),void 0)},_71O:function(a){var g,I,K,B,M,$,m=this,_=m._host,z=a?a.property:E,V=a?a.oldValue:E,A=a?a.newValue:E;if(_ instanceof xi&&(!a||ud[z])){var o;if(o=fl(_.getImage()),o&&o.layoutAttach)return}if(_ instanceof h.Grid){if(z===vj)m.setElevation(m._54O+A-V);else if(!a||Np[z]){if(g=m.s("attach.row.index"),I=m.s("attach.column.index"),K=_.getCellRect(g,I),!K)return;B=m.s("attach.row.span"),M=m.s("attach.column.span"),(1!==B||1!==M)&&(K=jm(K,_.getCellRect(g+B-1,I+M-1))),hs(K,m,"attach.padding",1),m.setRect(K)}}else if(_ instanceof Ap&&($=m.s("attach.index"))>=0&&(!a||gr[z])){var L=m.s("attach.thickness"),s=_.getScale(),p=Math.max(s.x,s.y);L>0&&m.setHeight(_.getThickness()*L*p);var q=m.s("attach.offset"),e=_.getPoints(),P=e.size();if(P>$){var R=_.getPointsMatrix2d(),S=e.get($),W=P===$+1?e.get(0):e.get($+1);S=R.apply(S),W=R.apply(W);var D=[W.x-S.x,W.y-S.y],j=nk(D);if(j){m.s("attach.offset.relative")&&(q*=j),m.s("attach.offset.opposite")&&(q=j-q);var H={x:S.x+D[0]/j*q,y:S.y+D[1]/j*q},u=m.s("attach.gap");u&&(m.s("attach.gap.relative")&&(u*=_.getThickness()*p),H=Mc(E,H,W,u)),m.p(H),m.setRotation(Hr(D[1],D[0]))}}}else a&&(z===Fr?m.translate(A.x-V.x,A.y-V.y):z===vj?m.setElevation(m._54O+A-V):Wj[z]?"rotation3d"===z?m.syncRotation3d(_,A,V):m._11Q(_,z,A-V):("anchor"===z||"width"===z||"height"===z||"scale"===z)&&m.layout(_))},_11Q:function(){var P=new h.Math.Euler,G=h.Math.Euler.ReverseOrder,z=new h.Math.Vector2,N=new h.Math.Vector2;return function($,A,M){var Z=this,S=$.p3(),X=$.r3(),q=Z.p3(),i=Z.r3();if(A===Wk&&(A="rotationY",M=-M),(A===Wk||"rotationY"===A)&&0===i[0]&&0===i[2]&&0===X[0]&&0===X[2]&&0===q[1]&&0===S[1])return Z.setRotation(-i[1]-M),z.set(q[0],q[2]).rotateAround(N.set(S[0],S[2]),-M),Z.p(z.x,z.y),void 0;var f=Jp[$.getRotationMode()],t=f[0],Y=f[1],s=f[2],y=al[t],O=al[Y],H=al[s],W=Tc();A===Wk+t?(H(W,X[Ji[s]]),O(W,X[Ji[Y]]),y(W,M),O(W,-X[Ji[Y]]),H(W,-X[Ji[s]])):A===Wk+Y?(H(W,X[Ji[s]]),O(W,M),H(W,-X[Ji[s]])):A===Wk+s&&H(W,M);var F=tf(q,S);kc(F,W),Z.p3(S[0]+F[0],S[1]+F[1],S[2]+F[2]);var u=Z.getRotationMode();Qc(W,Z.r3(),u),P.setFromRotationMatrix(W,G(u)),Z.r3([P.x,P.y,P.z])}}(),syncRotation3d:function(){var T=new _d,O=new bn,r=new Ab;return function(F,K,n){var $=this;if(n[0]!==K[0]||n[1]!==K[1]||n[2]!==K[2]){var X=bn.ReverseOrder(F.getRotationMode());wi.setFromEuler(O.set(n[0],n[1],n[2],X)),T.setFromEuler(O.set(K[0],K[1],K[2],X)),T.multiply(wi.inverse());var i=F.p3(),E=$.p3();r.set(E[0]-i[0],E[1]-i[1],E[2]-i[2]).applyQuaternion(T),$.p3(i[0]+r.x,i[1]+r.y,i[2]+r.z),$.setQuaternion($.getQuaternion(wi).premultiply(T))}}}(),isHostOn:function(b){var T=this;if(T._host&&b&&b._69O)for(var o={},U=T._host;U&&U!==T&&!o[U._id];){if(U===b)return!0;o[U._id]=U,U=U._host}return!1},isLoopedHostOn:function(d){return this.isHostOn(d)&&d.isHostOn(this)},getScaledSize:function(){var U=this.getSize(),t=this.getScale();return U.width*=Math.abs(t.x),U.height*=Math.abs(t.y),U},layout:function(a){if(a=a||this.getHost()){var j=this,S=j.s("layout.h")||"center",W=j.s("layout.v")||"center";if("center"!==S||"center"!==W){var f=new h.Math.Vector2,E=a.getPosition(),l=a.getAnchor(),K=a.getScaledSize();j.getPosition();var b,Q,A,v,R,I=1,d=1;switch(j._layoutUpdating=!0,S){case"left":f.setX(j._layoutHValue-l.x*K.width);break;case"right":f.setX((1-l.x)*K.width-j._layoutHValue);break;case"leftright":b=K.width-j._layoutHValue[2],A=j.getRotation()-a.getRotation(),v=Math.abs(Math.sin(A)),R=Math.abs(Math.cos(A)),I+=R*b/j._layoutHValue[3],d+=v*b/j._layoutHValue[4],f.setX(j._layoutHValue[1]+(j._layoutHValue[5]-l.x)*K.width);break;case"center":f.setX((.5-l.x)*K.width-j._layoutHValue);break;case"scale":A=j.getRotation()-a.getRotation(),v=Math.abs(Math.sin(A)),R=Math.abs(Math.cos(A)),f.setX((.5-l.x)*K.width-j._layoutHValue[1]*K.width/j._layoutHValue[0]),Q=K.width/j._layoutHValue[2]-1,I+=R*Q,d+=v*Q}switch(W){case"top":f.setY(j._layoutVValue-l.y*K.height);break;case"bottom":f.setY((1-l.y)*K.height-j._layoutVValue);break;case"topbottom":A||(A=j.getRotation()-a.getRotation(),v=Math.abs(Math.sin(A)),R=Math.abs(Math.cos(A))),b=K.height-j._layoutVValue[2],I+=v*b/j._layoutVValue[3],d+=R*b/j._layoutVValue[4],f.setY(j._layoutVValue[1]+(j._layoutVValue[5]-l.y)*K.height);break;case"center":f.setY((.5-l.y)*K.height-j._layoutVValue);break;case"scale":A||(A=j.getRotation()-a.getRotation(),v=Math.abs(Math.sin(A)),R=Math.abs(Math.cos(A))),f.setY((.5-l.y)*K.height-j._layoutVValue[1]*K.height/j._layoutVValue[0]),Q=K.height/j._layoutVValue[2]-1,I+=v*Q,d+=R*Q}if("leftright"===S||"scale"===S||"topbottom"===W||"scale"===W){var V=this.getScale(),O=Math.abs(V.x),n=Math.abs(V.y);"leftright"===S||"scale"===S?j.setSize(j._layoutHValue[3]*I/O,j._layoutHValue[4]*d/n):j.setSize(j._layoutVValue[3]*I/O,j._layoutVValue[4]*d/n)}f.rotateAround(null,a.getRotation()),this.setPosition(f.x+E.x,f.y+E.y),j._layoutUpdating=P}}},updateLayoutParameters:function(s,I){if(s=s||this.getHost()){var H=this,J=H.s("layout.h"),k=H.s("layout.v");if(J||k){var C,Z,N,j,O,Q,v=new h.Math.Vector2,K=s.getPosition(),_=s.getAnchor(),o=s.getScaledSize(),D=H.getPosition(),z=H.getScaledSize();switch(v.set(D.x-K.x,D.y-K.y),v.rotateAround(null,-s.getRotation()),J){case"left":H._layoutHValue=v.x+_.x*o.width;break;case"right":H._layoutHValue=-v.x+(1-_.x)*o.width;break;case"center":H._layoutHValue=-v.x+(.5-_.x)*o.width;break;case"leftright":case"scale":"scale"===J?C=-v.x+(.5-_.x)*o.width:(Z=H.getAnchor(),N=H.getRotation()-s.getRotation(),j=Math.cos(N),O=Math.sin(N),Q=-Math.min(-Z.x*j+Z.y*O,-Z.x*j-(1-Z.y)*O,(1-Z.x)*j+Z.y*O,(1-Z.x)*j-(1-Z.y)*O),C=v.x-(Q-_.x)*o.width),"position"===I&&"object"==typeof H._layoutHValue?(H._layoutHValue[0]=o.width,H._layoutHValue[1]=C):H._layoutHValue=[o.width,C,o.width,z.width,z.height,Q]}switch(k){case"top":H._layoutVValue=v.y+_.y*o.height;break;case"bottom":H._layoutVValue=-v.y+(1-_.y)*o.height;break;case"center":H._layoutVValue=-v.y+(.5-_.y)*o.height;break;case"topbottom":case"scale":"scale"===k?C=-v.y+(.5-_.y)*o.height:(N||(Z=H.getAnchor(),N=H.getRotation()-s.getRotation(),j=Math.cos(N),O=Math.sin(N)),Q=-Math.min(-Z.x*O-Z.y*j,-Z.x*O+(1-Z.y)*j,(1-Z.x)*O-Z.y*j,(1-Z.x)*O+(1-Z.y)*j),C=v.y-(Q-_.y)*o.height),"position"===I&&"object"==typeof H._layoutVValue?(H._layoutVValue[0]=o.height,H._layoutVValue[1]=C):H._layoutVValue=[o.height,C,o.height,z.width,z.height,Q]}}}},getSerializableProperties:function(){var H=xi.superClass.getSerializableProperties.call(this);return Sn(H,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),H}});var fb=h.Edge=function(N,R){var x=this;cb(fb,x),x.setSource(N),x.setTarget(R)};lq("Edge",Lk,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return cc},_22Q:function(){return nt},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(x){if(x===this)return!1;if(bk(x))return!0;for(var v,S,o,E,n,B=[this],_=-1,u=0;u>_;)if(_++,v=B[_],S=v._44I)for(S=S.getArray(),E=0,n=S.length;n>E;E++)if(o=S[E],bf(o)&&!(B.indexOf(o)>=0)){if(o===x)return!1;B.push(o),u++}return!0},setSource:function(A){var d=this;if(d._source!==A&&d.canSetSourceTarget(A)){var q=d._source;d._source=A,q&&q._16I(d),A&&A._2I(d),d._7I(),d.fp("source",q,A)}},setTarget:function(R){var n=this;if(n._target!==R&&n.canSetSourceTarget(R)){var C=n._target;n._target=R,C&&C._18I(n),R&&R._4I(n),n._7I(),n.fp("target",C,R)}},isLooped:function(){var k=this;return k._source===k._target&&bk(k._source)&&bk(k._target)},onPropertyChanged:function(){var K={};return["source","target","sourceAgent","targetAgent","edgeGroup","agentChange","s:edge.width","s:edge.type","s:edge.offset","s:edge.center","s:edge.points","s:edge.segments","s:edge.gap","s:edge.source.t3","s:edge.target.t3","s:edge.color","s:edge.gradient.color","s:edge.pattern","s:edge.dash","s:edge.dash.color","s:edge.dash.pattern","s:edge.dash.offset","s:edge.dash","s:edge.dash","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(C){K[C]=!0}),function(_){var M=this;M._49I&&M._49I.each(function(_){_.fp("agentChange",!0,!1)}),("s:alwaysOnTop"===_.property||"s:shape3d.alwaysOnTop"===_.property)&&(_.newValue?this.setRenderLayer("top"):this.setRenderLayer(P)),K[_.property]&&(this._needChangeGeometry=!0)}}(),_7I:function(){var r,J=this,y=sd(J);J._40I!==y&&(r=this._40I,r&&r._15I(J),J._40I=y,y&&y._1I(J),J.fp("sourceAgent",r,y),ob(r,J._41I),ob(y,J._41I));var H=Kk(J);J._41I!==H&&(r=J._41I,r&&r._17I(J),J._41I=H,H&&H._3I(J),J.fp("targetAgent",r,H),ob(r,J._40I),ob(H,J._40I))},_22I:function(C){this._52I=C,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var f=this;return f._52I&&f._52I.get(0)!==f&&!f.getStyle(Mn)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var v=this,Z=v._52I;return Z&&!v.getStyle(Mn)&&Z.size()>1&&v===Z.get(0)},toggle:function(){this.beginTransaction();var A=this._52I,U=!this.s(Mn);A&&A.size()>1&&(A.each(function(n){n.s(Mn,U)}),A.getSiblings().each(function(g){g!==A&&g.each(function(A){A.fp("edgeGroup",E,g)})})),this.endTransaction()},setStyle:function(P,Z){(P===rs||"edge.segments"===P)&&(Z=Ub(Z)),fb.superClass.setStyle.call(this,P,Z)},onStyleChanged:function(z){fb.superClass.onStyleChanged.apply(this,arguments),$q[z]&&ob(this._41I,this._40I)},getSerializableProperties:function(){var v=fb.superClass.getSerializableProperties.call(this);return Sn(v,{source:1,target:1}),v}});var wk=h.Group=function(){cb(wk,this)};lq("Group",xi,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return vi},onChildAdded:function(){wk.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){wk.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var J=this;if(!J._54I&&!sn){var L=J.getChildrenRect();L&&(J._53I=1,J.p(Ac(J.s("group.position"),L,J.getSize())),delete J._53I)}},getChildrenRect:function(){var F,u=this;return u.eachChild(function(X){bk(X)&&(F=jm(F,u.getChildRect(X)))}),F},getChildRect:function(j){var K;return bk(j)&&j.s(eb)&&(Kp(j)&&j.isExpanded()&&j.eachChild(function(c){K=jm(K,j.getChildRect(c))}),!K&&j.getRect&&(K=j.getRect())),K},setPosition:function(E,B){var K=this;if(!K._54I){var v;v=2===arguments.length?{x:E,y:B}:E,sn||K._53I||(K._54I=1,kl(K._children,v.x-K._position.x,v.y-K._position.y),delete K._54I),wk.superClass.setPosition.call(this,v)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(V){var Q=this;if(Q._57O!==V){var Y=Q._57O;Q._57O=V,Q.fp("expanded",Y,Q._57O),Q._fireInvalidateDeep(),Q._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(I){Kp(I)?I._fireInvalidateDeep():I.iv()})},_8I:function(){wk.superClass._8I.call(this),this.eachChild(function(M){bk(M)&&M._8I()})},onStyleChanged:function(D){wk.superClass.onStyleChanged.apply(this,arguments),"group.position"===D&&this._81I()},getSerializableProperties:function(){var b=wk.superClass.getSerializableProperties.call(this);return b.expanded=1,b}});var rq=h.Camera=function(){cb(rq,this),this.s({"shadow.cast":!1,"shadow.receive":!1,shape3d:"billboard"}),this._viewMatrix=new Uj.Matrix4,this._projectMatrix=new Uj.Matrix4,this.setScale3d(1,1,-1),this._projectMatrixDirty=!0};rq.CubeDirectionParam=[1,0,0,0,-1,0,-1,0,0,0,-1,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,1,0,-1,0,0,0,-1,0,-1,0],lq("Camera",xi,{ms_ac:["cullingMask"],_cullingMask:3,_22Q:function(){return Camera3dUI},attachRenderTarget:function(B){this._projectMatrixDirty=!0,this.renderTarget=B},detachRenderTarget:function(){this._projectMatrixDirty=!0,this.renderTarget=null},isLayerVisible:function(B){return Sh(this._cullingMask,B)},isOrtho:function(){return"ortho"===this.s("camera.type")&&!this.isCube()},isCube:function(){return this.renderTarget&&this.renderTarget.isCube()},isPerspective:function(){return!this.isOrtho()},setViewMatrix:function(){var O=new h.Math.Matrix4,B=new h.Math.Euler;return function(Y){var M=this;Y.isMatrix4?M._viewMatrix.copy(Y):M._viewMatrix.fromArray(Y),O.getInverse(M._viewMatrix),M.p3(O.getPosition().toArray()),B.set(0,0,0,M.getRotationMode(),!0).setFromRotationMatrix(O),M.r3([B.x,B.y,B.z])}}(),getViewMatrix:function(F){var W=this,p=Gg(null,null,W.r3(),W.getRotationMode(),W.p3()),h=W._viewMatrix;return h.fromArray(p).getInverse(h),h.toArray(F)},setProjectMatrix:function(D){var W=this;D.isMatrix4?W._projectMatrix.copy(D):W._projectMatrix.fromArray(D),D=W._projectMatrix.getElements(),W.isOrtho()?W.s({"camera.near":(D[14]+1)/D[10],"camera.far":(D[14]-1)/D[10],"camera.ortho.width":2/D[0]}):W.s({"camera.near":D[14]/(D[10]-1),"camera.far":D[14]/(D[10]+1),"camera.fovy":2*Math.atan(1/D[5]),"camera.aspect":D[5]/D[0]}),W._projectMatrixDirty=!1
},onPropertyChanged:function(w){var D=this;rq.superClass.onPropertyChanged.call(D,w);var n=w.property;("s:camera.near"===n||"s:camera.far"===n||"s:camera.fovy"===n||"s:camera.aspect"===n||"s:camera.ortho.width"===n)&&(D._projectMatrixDirty=!0)},getProjectMatrix:function(){var F=this;if(F._projectMatrixDirty){var t=F.gv,n=F.isCube(),E=n?1:F.s("camera.aspect")||(t?t.getAspect():null)||K.graph3dViewAspect,v=F.s("camera.near")||(t?t.getNear():null)||K.graph3dViewNear,O=F.s("camera.far")||(t?t.getFar():null)||K.graph3dViewFar,Z=Tc();if(F.isOrtho()){var i=F.s("camera.ortho.width")||(t?t.getOrthoWidth():null)||K.graph3dViewOrthoWidth,u=i/2,A=u/E;Pb(Z,-u,u,-A,A,v,O)}else{var l=n?Math.PI/2:F.s("camera.fovy")||(t?t.getFovy():null)||K.graph3dViewFovy;xl(Z,l,E,v,O)}F._projectMatrix.fromArray(Z),F._projectMatrixDirty=!1}return F._projectMatrix.toArray()},lookAt:function(z,A){var j=this.p3();return z.x?this.lookAtDirection([z.x-j[0],z.y-j[1],z.z-j[2]],A):this.lookAtDirection([z[0]-j[0],z[1]-j[1],z[2]-j[2]],A)},lookAtDirection:function(){var U=new h.Math.Matrix4,T=new h.Math.Euler,M=new h.Math.Vector3,C=new h.Math.Vector3;return function(J,W){U.lookAtDirection(M.copy(J).multiplyScalar(-1),W?C.copy(W):C.set(0,1,0)),T.set(0,0,0,this.getRotationMode(),!0).setFromRotationMatrix(U),this.r3([T.x,T.y,T.z])}}(),updateAndRender:function($){return $.syncRenderState(),$.updateScene(),this.render($)},render:function(P){var _=this,$=P.getGL();if(!$)return!1;var K,A,M=_.renderTarget;if(M)K=M.width,A=M.height;else{var d=P.getDevicePixelRatio();K=P.getWidth()*d,A=P.getHeight()*d}_.gv=P,P._camera=_,P._18Q=null;var i=P._frameState.renderState.glState,J=i.color.clear.slice(0);Wf($,_.s("camera.background"));var T=P.getEye;if(P.getEye=function(){return _.p3()},_.isCube())for(var r=rq.CubeDirectionParam,p=0;6>p;p++)M&&M.bind($,p),_.lookAtDirection([r[6*p+0],r[6*p+1],r[6*p+2]],[r[6*p+3],r[6*p+4],r[6*p+5]]),_.s("camera.clear")!==!1&&$.clear($.COLOR_BUFFER_BIT),P.setViewport($,0,0,K,A),_.s("camera.onlySky")?P.renderSky():P.renderScene({renderAxis:_.s("camera.renderAxis"),renderGrid:_.s("camera.renderGrid"),renderEdit:_.s("camera.renderEdit"),renderReflector:!1}),M&&M.unbind($);else M&&M.bind($),_.s("camera.clear")!==!1&&$.clear($.COLOR_BUFFER_BIT),P.overlappingBox.clear(),P.setViewport($,0,0,K,A),_.s("camera.onlySky")?P.renderSky():P.renderScene({renderAxis:_.s("camera.renderAxis"),renderGrid:_.s("camera.renderGrid"),renderEdit:_.s("camera.renderEdit")}),M&&M.unbind($);return P.getEye=T,Wf($,J),P._18Q=null,P._camera=null,_.gv=null,!0}});var aq=h.Block=function(){cb(aq,this),this.s({"shadow.cast":!1,"shadow.receive":!1})};lq("Block",xi,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,_scaleMode:"2d",ms_ac:["clickThroughEnabled","syncSize","scaleMode"],getUIClass:function(){return Xm},_22Q:function(){return mt},onChildAdded:function(){aq.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){aq.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},_getBoundingBox:function(){function G(C,F,r){M.fromArray($f(F));var t=F.getAnchor3d();C.push((new Ab).set(0-t.x,0-t.y,0-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(0-t.x,0-t.y,1-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(0-t.x,1-t.y,0-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(0-t.x,1-t.y,1-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(1-t.x,0-t.y,0-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(1-t.x,0-t.y,1-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(1-t.x,1-t.y,0-t.z).applyMatrix4(M).applyMatrix4(r)),C.push((new Ab).set(1-t.x,1-t.y,1-t.z).applyMatrix4(M).applyMatrix4(r))}function B(g,X){var f=(new jo).makeRotationFromEuler(this.getEuler()).setPosition((new Ab).fromArray(this.p3()));f.getInverse(f),g.forEach(function(m){bk(m)&&G(X,m,f)})}var M=new jo;return function(f,H){if(f instanceof xi&&(f=[f]),!f||0===f.length)return E;var H=[];B.call(this,f,H);var h=[1/0,1/0,1/0],I=[-1/0,-1/0,-1/0];return H.forEach(function(q){h[0]=Math.min(q.x,h[0]),h[1]=Math.min(q.y,h[1]),h[2]=Math.min(q.z,h[2]),I[0]=Math.max(q.x,I[0]),I[1]=Math.max(q.y,I[1]),I[2]=Math.max(q.z,I[2])}),{min:h,max:I}}}(),updateFromChildren:function(){var o=this;if(!sn&&!o._updatingToChildren&&o._syncSize&&0!==o.size()&&!o._freezeSyncFromChildren){var N=this._getBoundingBox(o.toChildren(bk));if(N){o._updatingFromChildren=1;var e=(new Ab).fromArray(this.getScale3d()),u=(new Ab).fromArray(N.min),Q=(new Ab).fromArray(N.max),V=K.blockMinSize,U=new Ab,J=Q.clone().sub(u);0===J.x&&U.setX(.5),0===J.y&&U.setY(.5),0===J.z&&U.setZ(.5);var T=this._width==E||-1===this._width,$=new Ab(this.getAnchor3d()),t=e.clone().multiply((new Ab).fromArray(this.s3())),b=J.clone();0===b.x&&b.setX(V),0===b.y&&b.setY(V),0===b.z&&b.setZ(V);var r=$.clone().multiply(t),s=r.clone().multiplyScalar(-1).sub(u).divide(b).add(r.divide(b)).add(U),O=this.s("keepPosition");if(T||this._anchorChanged||this._scaleChanged||!O){!T&&O&&($=s);var p=$.clone().multiply(J).add(u).applyEuler(this.getEuler()).add((new Ab).fromArray(this.p3()));this.p3([p.x,p.y,p.z])}else this.setAnchor3d(s.x,s.y,s.z);var R=new Ab(1,1,1).divide(e).multiply(J);this.s3(Math.abs(R.x),Math.abs(R.y),Math.abs(R.z)),delete o._updatingFromChildren}}},setPosition:function(o,S){var k=this;if(!k._updatingToChildren){var e;e=2===arguments.length?{x:o,y:S}:o,sn||k._updatingFromChildren||(k._updatingToChildren=1,kl(k._children,e.x-k._position.x,e.y-k._position.y),delete k._updatingToChildren),aq.superClass.setPosition.call(this,e)}},setSize3d:function(){this.beginTransaction(),aq.superClass.setSize3d.apply(this,arguments),this.endTransaction()},setTall:function(A){var l=this;if(!l._updatingToChildren){this.beginTransaction(),A=_(A,K.blockMinSize);var e=l.getTall();if(A!==e&&aq.superClass.setTall.call(l,A),!sn&&!l._updatingFromChildren){l._updatingToChildren=1;var q=A/e;l._adjustChildTallOrScale(q,"size"),delete l._updatingToChildren,l.updateFromChildren()}this.endTransaction()}},setWidth:function(F){return this.setSize(F,this.getHeight())},setHeight:function(R){return this.setSize(this.getWidth(),R)},setSize:function(r,w){var b=K.blockMinSize;r=_(r,b),w=_(w,b);var c=this;if(!c._updatingToChildren){2!==arguments.length&&(w=r.height,r=r.width),this.beginTransaction();var s=c.getWidth(),M=c.getHeight();if(r!==s&&aq.superClass.setWidth.call(c,r),w!==M&&aq.superClass.setHeight.call(c,w),!sn&&!c._updatingFromChildren){c._updatingToChildren=1;var j=r/s,C=w/M;c._adjustChildScaleOrSize(j,C,"size"),delete c._updatingToChildren,c.updateFromChildren()}this.endTransaction()}},_adjustChildScaleOrSize:function(C,k,j){var v=this;if(v._syncSize){var s=v.getPosition(),J=v.getRotation();v.eachChild(function($){if(bk($)){var d=$.getPosition(),Z=$.getRotation(),O=$.getWidth(),f=$.getHeight(),L=$.getScale(),v=L.x*O,p=L.y*f;if(0!==v&&0!==p){0>C*k&&$.setRotation(-1*Z);var x=new Jh(Z,d.x,d.y,v,p);x.translate(-s.x,-s.y),x.rotate(-J),Z=Hr(x.b*Math.sign(v),x.a*Math.sign(v)),x.scale(C,k);var N,R,X,F=W(Z);if(Math.abs(F)<.001?(N=l(Z),R=x.b/N,X=-x.c/N):(R=x.a/F,X=x.d/F),"scale"===j)$.setScale(R/O,X/f);else if("size"===j){var H=R/L.x,o=X/L.y;$.setScale(ji(R)*Math.abs(L.x),ji(X)*Math.abs(L.y)),$ instanceof h.Shape?($.setWidthForce(Math.max(Math.abs(H),1e-5)),$.setHeightForce(Math.max(Math.abs(o),1e-5))):$.setSize(Math.max(.01,Math.abs(H)),Math.max(.01,Math.abs(o)))}x.rotate(J),x.translate(s.x,s.y),$.setPosition(x.tx,x.ty)}}})}},_calcChangeFactor:function(Y,U,q,F){var m,s,X,N;return m=B(Y),s=B(q),X=m>s?m/s:s/m,m=B(U),s=B(F),N=m>s?m/s:s/m,_(X,N)},setElevation:function(z){var k=this;if(!k._updatingToChildren){var w=k.getElevation(),b=z-w;0!==b&&(sn||k._updatingFromChildren||(k._updatingToChildren=1,kl(k._children,0,b,0),delete k._updatingToChildren),aq.superClass.setElevation.apply(k,arguments))}},setScaleTall:function(q){var o=this;if(!o._updatingToChildren){var V=o.getScaleTall();if(B(q)<.01&&(q=.01*(ji(q)||ji(V))),"3d"===o._scaleMode){var h=o.getScale();return o.setScale3d(h.x,q,h.y),void 0}if(aq.superClass.setScaleTall.call(o,q),!sn&&!o._updatingFromChildren){o._updatingToChildren=1;var J=q/V;o._adjustChildTallOrScale(J,"scale"),delete o._updatingToChildren,o._scaleChanged=1,this.updateFromChildren(),delete o._scaleChanged}}},_adjustChildTallOrScale:function(f,k){var U=this;if(U._syncSize){var S=U.getElevation();U.eachChild(function(b){if(bk(b)){if("size"===k){var I=b.getTall();0>f&&b.setScaleTall(-1*b.getScaleTall()),b.setTall(Math.max(.01,Math.abs(I*f)))}else{var s=b.getScaleTall();b.setScaleTall(s*f)}b.setElevation(S+(b.getElevation()-S)*f)}})}},setAnchor3d:function(){if(!this._updatingToChildren){this.beginTransaction();var j=aq.superClass.setAnchor3d.apply(this,arguments);return j&&!sn&&!this._updatingFromChildren&&this._syncSize&&(this._anchorChanged=1,this.updateFromChildren(),delete this._anchorChanged),this.endTransaction(),j}},setAnchor:function(){var K=this;if(!K._updatingToChildren){var x=K.getAnchor(),I=aq.superClass.setAnchor.apply(K,arguments);if(sn||K._updatingFromChildren||!K._syncSize)return I;K._updatingToChildren=1;var d=K.getAnchor(),b=K.getSize(),M=b.width*(x.x-d.x),Y=b.height*(x.y-d.y),R=(new jo).compose(new Ab,this.getQuaternion(),new Ab(this.getScale3d())),T=new Ab(M,0,Y).applyMatrix4(R);return K.eachChild(function(E){if(bk(E)){var k=new Ab(E.p3());E.p3(k.add(T).toArray())}}),delete K._updatingToChildren,I}},setAnchorElevation:function(){var K=this;if(!K._updatingToChildren){var U=K.getAnchorElevation(),c=aq.superClass.setAnchorElevation.apply(K,arguments);if(sn||K._updatingFromChildren||!K._syncSize)return c;K._updatingToChildren=1;var X=K.getAnchorElevation(),J=K.getTall()*(U-X),n=(new jo).compose(new Ab,this.getQuaternion(),new Ab(this.getScale3d())),y=new Ab(0,J,0).applyMatrix4(n);return K.eachChild(function(G){if(bk(G)){var Y=new Ab(G.p3());G.p3(Y.add(y).toArray())}}),delete K._updatingToChildren,c}},setRotation:function(G){this._updateChildrenRotation3d("rotation",G)},setRotationX:function(_){this._updateChildrenRotation3d("rotationX",_)},setRotationZ:function(S){this._updateChildrenRotation3d("rotationZ",S)},setRotation3d:function(){var u=this;if(!u._updatingToChildren){var L=u.r3();aq.superClass.setRotation3d.apply(u,arguments);var P=u.r3();sn||u._updatingFromChildren||(u._updatingToChildren=1,u.eachChild(function(w){bk(w)&&w.syncRotation3d(u,P,L)}),delete u._updatingToChildren)}},_updateChildrenRotation3d:function(g,y){var u=this;if(!u._updatingToChildren){var k=u[Bn(g)]();aq.superClass[sh(g)].call(u,y),sn||u._updatingFromChildren||this._updateRotationToChildren(g,y-k)}},_updateRotationToChildren:function(q,W){var J=this;J._updatingToChildren=1,J.eachChild(function(H){bk(H)&&H._11Q(J,q,W)}),delete J._updatingToChildren},setScale:function(e,D){var W=this;if(!W._updatingToChildren){null==D&&(D=e.y,e=e.x);var m=W.getScale();if(B(e)<.01&&(e=.01*(ji(e)||ji(m.x))),B(D)<.01&&(D=.01*(ji(D)||ji(m.y))),"3d"===W._scaleMode)return W.setScale3d(e,W.getScaleTall(),D),void 0;if(aq.superClass.setScale.call(W,e,D),!sn&&!W._updatingFromChildren){W._updatingToChildren=1;var h=e/m.x,o=D/m.y;W._adjustChildScaleOrSize(h,o,"scale"),delete W._updatingToChildren,W._scaleChanged=1,W.updateFromChildren(),delete W._scaleChanged}}},onPropertyChanged:function(J){aq.superClass.onPropertyChanged.call(this,J),"s:3d.visible"===J.property&&this._invalidateChildrenBatch()},_invalidateChildrenBatch:function(){this.eachChild(function(R){(R.s("batch")||R.s("wf.geometry")||R.s("wf.visible"))&&R.iv(),R instanceof aq&&R._invalidateChildrenBatch()})},getSerializableProperties:function(){var b=aq.superClass.getSerializableProperties.call(this);return b.clickThroughEnabled=1,b.syncSize=1,b.scaleMode=1,b},setScale3d:function(){var i=new Ab,f=new Ab,t=new Ab,d=new jo,J=new _d,U=new Ab;return function(x,l,O){var a,b=this;if(a="number"==typeof x?{x:x,y:l,z:O}:x.length?{x:x[0],y:x[1],z:x[2]}:x,"3d"!==b._scaleMode)return aq.superClass.setScale3d.apply(b,arguments),void 0;if(b._syncSize&&0!==b.size()){var H=b.getMatrix4();H.getInverse(H),aq.superClass.setScaleTall.call(b,a.y),aq.superClass.setScale.call(b,a.x,a.z);var j=b.getMatrix4();sn||b._updatingFromChildren||(b._updatingToChildren=1,b.eachChild(function(n){if(bk(n)){if(f.fromArray(n.s3()),n instanceof h.Polyline){var m=n.getThickness();f.x=f.x||m,f.y=f.y||m,f.z=f.z||m,U.copy(n.getScale3d()).multiplyScalar(m),n.getQuaternion(J),i.copy(n.p3()),t.copy(n.getFinalScale3d()),t.x=t.x||U.x,t.y=t.y||U.y,t.z=t.z||U.z,d.compose(i,J,t)}else n.getMatrix4(d);d.premultiply(H).premultiply(j),d.decompose(i,J,t),t.divide(f),n.setQuaternion(J),n.p3(i.toArray()),n.setScale3d(t.toArray())}}),delete b._updatingToChildren,b._scaleChanged=1,b.updateFromChildren(),delete b._scaleChanged)}}}()});var ze=h.Grid=function(){cb(h.Grid,this)};lq("Grid",xi,{IRotatable:!1,_icon:"grid_icon",_image:E,getUIClass:function(){return Ad},setRotation:function(){},getCellRect:function(Y,$){var g=this,N=g.s("grid.row.count"),k=g.s("grid.column.count");if(0>=N||0>=k||0>Y||Y>=N||0>$||$>=k)return E;var y,O,T,j=g.getRect(),o=g.s("grid.row.percents"),F=g.s("grid.column.percents");if(hs(j,g,"grid.border",-1),o&&o._as&&(o=o._as),F&&F._as&&(F=F._as),o&&o.length===N){for(T=0,y=0;Y>y;y++)T+=j.height*o[y];j.y+=T,j.height=j.height*o[Y]}else j.height=j.height/N,j.y+=j.height*Y;if(F&&F.length===k){for(O=0,y=0;$>y;y++)O+=j.width*F[y];j.x+=O,j.width=j.width*F[$]}else j.width=j.width/k,j.x+=j.width*$;return rk(j,-g.s("grid.gap")),j}});var si=h.Text=function(){cb(si,this),this.setSize(100,50),this.s("text","TEXT")};lq("Text",xi,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Ko},setWidth:function(e){e||(e=.001),si.superClass.setWidth.call(this,e)},setHeight:function(U){U||(U=.001),si.superClass.setHeight.call(this,U)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),wr("__text__",{width:{value:100,isSafeFunc:!0,func:function(M){return M?M._width:100}},height:{value:50,isSafeFunc:!0,func:function(B){return B?B._height:50}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"},gradient:{func:"style@text.gradient"},gradientColor:{func:"style@text.gradient.color"},gradientPack:{func:"style@text.gradient.pack"},decoration:{func:"style@text.decoration"},vertical:{func:"style@text.vertical"},verticalGap:{func:"style@text.vertical.gap"},wrap:{func:"style@text.wrap"},letterGap:{func:"style@text.letter.gap"},borderWidth:{func:"style@text.border.width"},borderColor:{func:"style@text.border.color"}}]});var Ap=h.Shape=function(){cb(Ap,this),this._59O=new oc};Ap.__de__=ub,lq("Shape",xi,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return wl},_22Q:function(){return ot},getLength:function(t){return Dc(_h(this._59O,this._58O,t,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var i=this._58O;return i?new oc(i._as.slice(0)):i},setSegments:function(b){var j=this._58O;b=b?bs(b)?new oc(b.slice(0)):new oc(b._as.slice(0)):null,(j&&b&&j._as.join(",")!==b._as.join(",")||j!==b)&&(this._58O=b,this.fp("segments",j,b))},getPoints:function(){return this._59O},toPoints:function(){var p=this._59O;return new oc(p._as.slice(0))},getPointsMatrix2d:function(){var U=this,F=new Uj.Matrix2d,q=U.getPosition(),I=U.getScale(),l=U.getRotation();return F.translate(-q.x,-q.y).scale(I.x,I.y).rotate(l).translate(q.x,q.y),F},getPointsMatrix3d:function(){return function(){var C=this,B=new Uj.Matrix4,F=B.getElements(),X=C.p3();sp(F,X),Qc(F,C.getFinalRotation3d(),C.getRotationMode());var L=C.getScale3d(),W=C._dynamicScale3d;return W&&(L[0]*=W[0],L[1]*=W[1],L[2]*=W[2]),vc(F,L),sp(F,uf(X)),B}}(),setPoints:function(c,r){var d=this,y=d._59O;c=c?bs(c)?new oc(c.slice(0)):new oc(c._as.slice(0)):new oc;var O,m,W,X,F,_;r&&(O=d.getPosition(),_=new Jh(d.getRotation(),0,0,d.getScale().x,d.getScale().y)),(y&&c&&y._as.join(",")!==c._as.join(",")||y!==c)&&(d._59O=c,d.fs(),d.fp("points",y,c)),r&&(m=d.getPosition(),W=m.x-O.x,X=m.y-O.y,F=_.tf(W,X),d.setPosition(m.x-W+F.x,m.y-X+F.y))},setPoints3d:function(f,h){var $=new Ab(this.p3()),D=this.getPointsMatrix3d();if(D.setPosition(new Ab),bq.superClass.setPoints.call(this,f),h){var s=new Ab(this.p3()),o=s.clone().sub($).applyMatrix4(D);$.add(o),this.p3($.x,$.y,$.z)}},addPoint:function(y,V,u){var a=this.toPoints();a.add(y,V),this.setPoints(a,u)},setPoint:function($,r,y){var b=this.toPoints();b.set($,r),this.setPoints(b,y)},removePointAt:function(l){var x=this.toPoints();x.removeAt(l),this.setPoints(x)},setWidthForce:function(R){var y=this;if(!y._55I&&!sn&&y.getWidth()){y._55I=1;var a=y._position.x,u=R/y.getWidth(),D=y.toPoints(),H=new oc;1!==u&&(D.each(function(J){H.add({x:(J.x-a)*u+a,y:J.y,e:J.e})}),y.setPoints(H),zk(y,[u,0,0,1,a*(1-u),0]),y.fs()),delete y._55I}Ap.superClass.setWidth.call(y,R)},setWidth:function(S){return this.setWidthForce(pq>S?pq:S)},setHeightForce:function(v){var i=this;if(!i._55I&&!sn&&i.getHeight()){i._55I=1;var P=i._position.y,s=v/i.getHeight(),L=i.toPoints(),B=new oc;1!==s&&(L.each(function(A){B.add({x:A.x,y:(A.y-P)*s+P,e:A.e})}),i.setPoints(B),zk(i,[1,0,0,s,0,P*(1-s)]),i.fs()),delete i._55I}Ap.superClass.setHeight.call(i,v)},setHeight:function(C){return this.setHeightForce(pq>C?pq:C)},setAnchorElevation:function(G){var s=this;s._55I=!0;var q=s._updatingAnchor3d,W=!sn&&!q;if(W){var B,u=G,n=s.getAnchorElevation(),S=s.getTall();B=S*(n-u),0!==B&&s.shiftPointsElevation(B)}var X=Ap.superClass.setAnchorElevation.apply(s,arguments);return q||delete s._55I,X},getShapeElevation:function(){var K=this,H=K._54O;return H-(K.getTall()||0)*(K._anchorElevation-.5)},setAnchor3d:function(m,$,y,P){var g,v=this;if("number"==typeof m?g={x:m,y:$,z:y}:(g=m.length?{x:m[0],y:m[1],z:m[2]}:m,P=$),v._55I=!0,v._updatingAnchor3d=!0,v.beginTransaction(),!sn){var M=v.getAnchor3d(),G=v.getSize(),O=v.getTall(),R=G.width*(M.x-g.x),F=G.height*(M.z-g.z),f=O*(M.y-g.y);P||v.shiftPoints(R,F,f);var A=v.p3()}var h=Ap.superClass.setAnchor3d.apply(v,arguments);if(!sn&&P){var i=v.p3();v.shiftPoints(i[0]-A[0]+R,i[2]-A[2]+F,i[1]-A[1]+f)}return v.endTransaction(),delete v._updatingAnchor3d,delete v._55I,h},setAnchor:function(I,Q,T){var Z=this;Z._55I=!0;var t=Z._updatingAnchor3d,a=!sn&&!t;if(a){var m,M,i;"number"==typeof I?i={x:I,y:Q}:(i=I.length?{x:I[0],y:I[1]}:I,T=Q);var D=Z.getAnchor(),C=Z.getSize();m=C.width*(D.x-i.x),M=C.height*(D.y-i.y),T||Z.shiftPoints(m,M);var J=Z.getPosition()}var Y=Ap.superClass.setAnchor.apply(Z,arguments);if(a){var c=Z.getPosition();T&&Z.shiftPoints(c.x-J.x+m,c.y-J.y+M)}return t||delete Z._55I,Y},shiftPoints:function(j,B,u){if(j||B||u){var d=this,p=d.getElevation()||0,V=d.toPoints(),x=new oc;V.each(function(v){var k=v.e;u&&(k=(k==E?p:k)+u),x.add({x:v.x+j,y:v.y+B,e:k})}),d.setPoints(x),d.fs()}},shiftPointsElevation:function(E){return this.shiftPoints(0,0,E)},setPosition:function(L,O){var k,B=this;if(!B._28Q){if(B._28Q=1,!B._55I&&!sn){k=2===arguments.length?{x:L,y:O}:L;var e=k.x-B._position.x,H=k.y-B._position.y;if(0===e&&0===H)return delete B._28Q,void 0;B._55I=1,B.shiftPoints(e,H),zk(B,[1,0,0,1,e,H]),delete B._55I}Ap.superClass.setPosition.apply(B,arguments),delete B._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var k=this;if(2!==k._59O.size())return!1;var L=k._58O;return L?2===L.size()&&1===L.get(0)&&2===L.get(1)?!0:!1:!0},fireShapeChange:function(){var V=this;if(!V._55I&&!sn){var Y=Nd(V._59O);Y&&(V._55I=1,V.setRect(Y),delete V._55I)}V.fp(Ph,!1,!0)},getSerializableProperties:function(){var f=Ap.superClass.getSerializableProperties.call(this);return f.segments=1,f.points=1,f.thickness=1,f.closePath=1,f}});var Pm=h.Points=function(){cb(Pm,this)};lq("Points",xi,{_59O:[],_colors:[],_sizes:[],_uvoffsets:[],_22Q:function(){return pt},getPoints:function(){return this._59O},setPoints:function(C){var Y=this._59O;C=C?C.slice(0):[];var M=C[0];if(Kg(M)){var y=C;C=[];for(var F=0,v=y.length;v>F;F+=3)C.push({x:y[F],e:y[F+1],y:y[F+2]})}this._59O=C,this._pointsDirty=!0,this.fp("points",Y,this._59O)},setPoint:function(k,t){var h=this._59O.slice(0);h[k]=t,this.setPoints(h)},addPoint:function(V){this.setPoint(this._59O.length,V)},getColors:function(){return this._colors},setColors:function(P){var D=this._colors;P=P?P.slice(0):[],this._colors=P,this._colorsDirty=!0,this.fp("colors",D,P)},setPointColor:function(c,b){var Y=this._colors.slice(0);Y[c]=b,this.setColors(Y)},getSizes:function(){return this._sizes},setSizes:function(O){var D=this._sizes;O=O?O.slice(0):[],this._sizes=O,this._sizesDirty=!0,this.fp("sizes",D,this._sizes)},setPointSize:function(q,A){var f=this._sizes.slice(0);f[q]=A,this.setSizes(f)},getUvoffsets:function(){return this._uvoffsets},setUvoffsets:function(E){var U=this._uvoffsets;E=E?E.slice(0):[],this._uvoffsets=E,this._offsetsDirty=!0,this.fp("uvoffsets",U,this._uvoffsets)},setPointUvoffset:function(h,Z,j){var x;"object"==typeof Z?(x=Z[0],j=Z[1]):x=Z;var e=this._uvoffsets.slice(0);e[2*h+0]=x,e[2*h+1]=j,this.setUvoffsets(e)},getPointInfo:function(P){var I=this.getPoints();if(!I||I[P]==E)return E;var k=I[P],o=[k.x,k.e,k.y],Z=this.mat||$f(this),D=[o[0],o[1],o[2]];kc(D,Z);var A=this.getColors(),L=A[P]||this.s("points.color"),U=this.getSizes(),b=U[P];return{size:b==E?this.s("points.size"):b,color:L,local:o,world:D}},getSerializableProperties:function(){var t=Pm.superClass.getSerializableProperties.call(this);return t.points=1,t.colors=1,t.sizes=1,t.uvoffsets=1,t},onPropertyChanged:function(E){Pm.superClass.onPropertyChanged.call(this,E);var C=E.property;"s:points.color"===C?this._colorsDirty=!0:"s:points.size"===C?this._sizesDirty=!0:"s:points.model"===C&&(this._modelDirty=!0)},getWidth:function(){var N=this;if(N._width>=0)return N._width;var h=N.getStyle("points.model");if(h){var j=sg(h);if(j&&j.rawS3)return j.rawS3[0]}return 1},getHeight:function(){var _=this;if(_._height>=0)return _._height;var M=_.getStyle("points.model");if(M){var p=sg(M);if(p&&p.rawS3)return p.rawS3[2]}return 1},getTall:function(){var v=this;if(v._tall>=0)return v._tall;var z=v.getStyle("points.model");if(z){var D=sg(z);if(D&&D.rawS3)return D.rawS3[1]}return 1}});var bq=h.Polyline=function(){cb(bq,this),this.s({"shape.background":null,"shape.border.width":2})};lq("Polyline",Ap,{_icon:"polyline_icon",_22Q:function(){return st},getUIClass:function(){return gk},setClosePath:function(){},setTall:function(y){var A=this;if(A.beginTransaction(),!A._55I&&!A._24Q&&!sn&&A.getTall()){A._24Q=1;var _=A._54O,x=y/A.getTall();if(1!==x){var F=A.toPoints(),h=new oc;F.each(function(O){h.add({x:O.x,y:O.y,e:O.e==E?O.e:(O.e-_)*x+_})}),A.setPoints(h),A.fs()}delete A._24Q}bq.superClass.setTall.call(A,y),A.endTransaction()},setElevation:function(b){var G=this;if(G.beginTransaction(),!G._55I&&!G._24Q&&!sn){G._24Q=1;var D=b-G._54O;0!==D&&G.shiftPointsElevation(D),delete G._24Q}bq.superClass.setElevation.apply(G,arguments),G.endTransaction()},fireShapeChange:function(){var x=this,z=x._59O;if(!x._55I&&!x._24Q&&!sn){var w=z.size();if(w){var T=1,F=z.get(0),f=x._54O;F.e==E&&(F.e=f);for(var Y=F.e,j=0;w>T;T++){F=z.get(T),F.e==E&&(F.e=f);var H=I(Y,F.e),$=_(Y+j,F.e);Y=H,j=$-H}x._24Q=1,x.setTall(j),x.setElevation(Y+j*x._anchorElevation),delete x._24Q}}bq.superClass.fireShapeChange.apply(x,arguments)},onPropertyChanged:function(){var m={};return["points","segments","thickness","position","elevation","rotation","rotationX","rotationZ","rotationMode","scale","scaleTall","s:shape.border.color","s:shape.border.gradient.color","s:shape.border.pattern","s:shape.dash","s:shape.dash.color","s:shape.dash.pattern","s:shape.dash.offset","s:shape.dash","s:shape.dash","s:3d.clip.direction","s:repeat.uv.length","s:body.color","s:shape3d","s:shape3d.visible","s:shape3d.image","s:shape3d.smooth","s:shape3d.resolution","s:shape3d.color","s:shape3d.blend","s:shape3d.side","s:shape3d.start.angle","s:shape3d.sweep.angle","s:shape3d.top.cap","s:shape3d.top.image","s:shape3d.top.visible","s:shape3d.top.color","s:shape3d.bottom.cap","s:shape3d.bottom.image","s:shape3d.bottom.visible","s:shape3d.bottom.color","s:shape3d.from.visible","s:shape3d.from.color","s:shape3d.to.visible","s:shape3d.to.color","s:shape3d.uv.union"].forEach(function(z){m[z]=!0}),function(I){bq.superClass.onPropertyChanged.call(this,I),m[I.property]&&(this._needChangeGeometry=!0)}}()});var Ih=h.SubGraph=function(){cb(Ih,this)};lq("SubGraph",xi,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Ih.superClass._8I.call(this),this.eachChild(function(A){bk(A)&&A._8I()})}}),K.loadingRefGraph=0;var Sg=h.RefGraph=function(){cb(Sg,this)};lq("RefGraph",aq,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(C){var N=this._ref;this._ref=C,this.fp("ref",N,C),this.updateRef()},_21I:function(){Sg.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var X=this;if(K.loadingRefGraph++,X.clearChildrenFromDataModel(),K.loadingRefGraph--,X._ref&&X._dataModel){X._xhrLoadHandler&&(X._xhrLoadHandler.cancel=!0);var k=sn,x=X._xhrLoadHandler=function(Z){if(Z&&X._dataModel){K.loadingRefGraph++;var d=X._pendingUpdateInfo={needToRestore:k};k&&(d.p3=X.p3(),d.s3=X.s3(),d.r3=X.r3(),d.anchor3d=X.getAnchor3d(),d.scale3d=X.getScale3d()),X.r3(0,0,0),X.setScale3d(1,1,1),X.setAnchor3d(.5,.5,.5),X.p3(0,0,0);var g=K.parse(Z),E=X._dataModel.deserialize(g,X,{justDatas:!0});E.each(function(Y){Y._refGraph=X}),X.checkPendingUpdateInfo(),K.loadingRefGraph--,K.handleRefGraphLoaded(X,E,g)}};x.xhrLoadCalled=!1,K.load(X._ref,function(s){x.cancel||(x.xhrLoadCalled?x(s):dd(function(){x(s)}))}),x.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var T=this,c=T._pendingUpdateInfo;if(!c)return T.onPendingUpdated&&(K.loadingRefGraph++,T.onPendingUpdated(),K.loadingRefGraph--),void 0;var U=!0;this.eachChild(function(Q){(Q._pendingCheckImageJSON||Q._pendingUpdateInfo)&&(U=!1)}),U&&(K.loadingRefGraph++,T._pendingUpdateInfo=null,T.updateFromChildren(),c.needToRestore&&(T.setAnchor3d(c.anchor3d),T.setScale3d(c.scale3d),T.r3(c.r3),T.p3(c.p3)),this.getParent()instanceof Sg&&this.getParent().checkPendingUpdateInfo(),T.onPendingUpdated&&T.onPendingUpdated(),K.loadingRefGraph--)},getSerializableProperties:function(){var e=Sg.superClass.getSerializableProperties.call(this);return e.ref=1,e}}),h.EdgeGroup=function(z,g){this._70O=z,this._siblings=g;for(var R,t,Q=0,i=z.size(),m=N[Mn];i>Q;Q++)if(R=z.get(Q).getStyle(Mn,!1),R!=E){m=R;break}m==E&&(m=!0);var b=K.edgeGroupAgentFunc;for(b&&(t=b(z),t&&t!==z.get(0)&&(z.remove(t),z.add(t,0))),Q=0;i>Q;Q++)z.get(Q).s(Mn,m)},lq("EdgeGroup",O,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(V){return this._70O.get(V)},indexOf:function(D){return this._70O.indexOf(D)},each:function(d,z){this._70O.each(d,z)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(R,D){this._siblings.each(function(X){X._70O.each(R,D)})}});var ij=function(n,S,Z){var A=Nb[n]={type:n,action:S};if(Z)for(var w in Z)A[w]=Z[w]};Sn(K,{setConnectAction:ij,getConnectAction:function(k,Y){if(!Y){if(!k)return null;Y=k.getCurrentConnectActionType()}return Nb[Y]},doConnectAction:function(a,W,r,B){B=B||a.getCurrentConnectActionType();var A=Nb[B];if(!A)return!1;var Z=A.action;return Z?(W instanceof id.Group?a.sm().getSelection().each(function(M){Z.call(null,a,M,r)}):Z.call(null,a,W,r),!0):!1},doDeleteConnectionAction:function(q,S,m){m=m||q.getCurrentConnectActionType();var u=Nb[m];if(!u||!u.delete)return!1;var A=u.delete.action;return A?(S instanceof id.Group?q.sm().getSelection().each(function(w){A.call(null,q,w)}):A.call(null,q,S),!0):!1}});var cf=h.JSONSerializer=function(S,o){this.dm=this._dataModel=S,this._hierarchical=K.forceHierarchicalSerialization?!0:o==E?S.isHierarchicalRendering():o};lq("JSONSerializer",O,{ms_ac:["hierarchical"],serialize:function(l){return K.stringify(this.toJSON(),l)},toJSON:function(){var F,O=this,L=O.dm,v=L.getRoots(),c=O.json={v:K.getVersion(),p:{},a:{},d:[]},h=L.getSerializableAttrs();(F=L.getInit())&&(c.init=F),(F=L.getName())&&(c.p.name=F),(F=L.getBackground())&&(c.p.background=F),(F=L.getLayers())&&(c.p.layers=F),(F=L.getEnvmap())&&(c.p.envmap=F),(F=L.getEnvmapType())&&(c.p.envmapType=F),c.p.autoAdjustIndex=L.isAutoAdjustIndex(),c.p.hierarchicalRendering=L.isHierarchicalRendering();for(var m in h){var A=L.a(m);A!==P&&O[Tl](m,A,c.a)}return Cp(c.a)&&delete c.a,O._hierarchical?v.each(O.serializeData,this):L.each(function(u){O.serializeData(u)}),L.fireSerializeEvent({type:"serialize",json:c}),L.getPostProcessingData()&&(c.p.postProcessingData=L.getPostProcessingData()),c},isSerializable:function(){return!0},getProperties:function(p){return p.getSerializableProperties()},getStyles:function(i){return i.getSerializableStyles()},getAttrs:function(J){return J.getSerializableAttrs()},serializeData:function(r){var H=this;if(H.isSerializable(r)&&!r._refGraph){var S,s,R,e,w,X,n=Zp(r.getClassName())||r.getClass(),o=new n,b={c:r.getClassName(),i:r.getId(),p:{},s:{},a:{}};H.json.d.push(b),S=H.getProperties(r);for(s in S)if(/^_/.test(s)){if(R=r[s],!("_width"!==s&&"_height"!==s||R!=E&&-1!==R)){if(w==P){var m;X=(r.s("layout.h")||r.s("layout.v"))&&r.getHost()||r instanceof h.Node&&(m=r.getParent())&&m instanceof h.Block||r.s("fullscreen"),w=r.hasInheritedSize()}X&&w&&(R=r[s]="_width"===s?r.getWidth():r.getHeight())}R!==o[s]&&H[Tl](s.substr(1),R,b.p)}else e=Bn(s),r[e]&&(R=r[e](),R!==o[e]()&&H[Tl](s,R,b.p));S=H.getStyles(r);for(s in S)R=r.s(s),R!==o.s(s)&&H[Tl](s,R,b.s);S=H.getAttrs(r);for(s in S)R=r.a(s),R!==o.a(s)&&H[Tl](s,R,b.a);Cp(b.p)&&delete b.p,Cp(b.s)&&delete b.s,Cp(b.a)&&delete b.a}H._hierarchical&&r.getChildren().each(H.serializeData,H)},serializeValue:function(Y,h,e){xg(h)?h={__a:h._as}:h instanceof Lk?h={__i:h.getId()}:h instanceof ed&&(h={__dm:h.serialize(0)}),e[Y]=h},deserialize:function(Q,l,x){var i=this;return Om(Q)&&/.json$/.test(Q)?(K.xhrLoad(Q,function(t){i.deserializeImpl(t,l,x)}),void 0):i.deserializeImpl(Q,l,x)},deserializeImpl:function(G,L,w){var J=this,q=J.dm;q.setDeserializing(!0),w=mh(w)?{setId:w}:tj(w)?{finishFunc:w}:w||{},G=J.json=Om(G)?K.parse(G):G,!w.justDatas&&G.a&&G.a.onPreDeserialize&&!w.disableOnPreDeserialize&&G.a.onPreDeserialize(G,q,w.view),q.beginTransaction(),sn++,J._82I={};var P=new oc,R=new oc,u=0,U=G.d.length;if(w.justDatas||(!w.disableInit&&tj(G.init)&&G.init(q),q.setInit(G.init)),!w.justDatas){for(var f in G.a)q.a(f,J[Ro](G.a[f]));for(var B in G.p)q[sh(B)](G.p[B])}for(;U>u;u++){var H=G.d[u],a=Zp(H.c),x=new a,I=H.i;w.setId&&I!=E&&(x._id=I),J._82I[I]=x,P.add(x),R.add(H)}for(u=0;U>u;u++)J.deserializeData(P.get(u),R.get(u));return P.each(function(f){L&&!f.getParent()&&f.setParent(L),q.add(f)}),w.__innerHandler__&&w.__innerHandler__(G,q,w.view,P),q.fireSerializeEvent({type:"deserialize",json:G}),sn--,yp||q.each(function(z){z instanceof xi&&z.updateLayoutAttaches()}),q.endTransaction(),!w.justDatas&&G.a&&G.a.onPostDeserialize&&!w.disableOnPostDeserialize&&G.a.onPostDeserialize(G,q,w.view,P),w.finishFunc&&w.finishFunc(G,q,w.view,P),q.setDeserializing(!1),P},deserializeData:function(s,L){for(var j in L.p)s[sh(j)](this[Ro](L.p[j]));for(j in L.s)s.s(j,this[Ro](L.s[j]));for(j in L.a)s.a(j,this[Ro](L.a[j]))},deserializeValue:function(m){if(Hh(m)){var M=m.__i;if(M!=E)return this._82I[M];if(M=m.__dm,M!=E){var f=new h.DataModel;return f.deserialize(M),f}if(M=m.__a,bs(M))return new oc(M)}return m}}),Sn(ed,{serialize:function(S,F){return new cf(this,F).serialize(S)},toJSON:function(l){return new cf(this,l).toJSON()},deserialize:function(j,t,F){return new cf(this).deserialize(j,t,F)}});var Ol=h.OverlappingBox=function($){this.gv=$,this.boxes={}};lq("OverlappingBox",O,{clear:function(){var j,_,V=this.boxes;
for(j in V)_=V[j],_.length=0},isOverlapping:function(g,Q){var h,Y,E=this,l=E.boxes,L=l[g];L?(h=L.rects,Y=L.length):L=l[g]={rects:h=[],length:Y=0};var R,C,Q;for(R=0;Y>R;R++)if(C=h[R],C.x<Q.x+Q.w&&C.x+C.w>Q.x&&C.y<Q.y+Q.h&&C.h+C.y>Q.y)return!0;return h.length<=Y?(h.push(Q),L.length++):h[L.length++]=Q,!1}}),Sn(K,{fetch:function(C,Z){Z=Z||{},C.open(Z.method||"GET",Z.url||"",!(null!=Z.sync?Z.sync:!1)),"json"===Z.dataType&&C.setRequestHeader("Content-Type","application/json"),Z.responseType&&(C.responseType=Z.responseType),C.send(Z.data)},convertImageSrc:function(F,c){c&&"function"==typeof c||(c=function(){}),c(F)}});var rb=h.Request=function(){};lq("Request",O,{_mimeType:P,getXhr:function(){return this._xhr||(this._xhr=new XMLHttpRequest,this.overrideMimeType("text/plain")),this._xhr},send:function(B){var S=this.getXhr();B.mimeType&&this.overrideMimeType(B.mimeType),S.onload=this.onload,S.onerror=this.onerror,K.fetch(S,B)},onload:function(){},onerror:function(){},getResponseType:function(){return this.getXhr().responseType},setOverrideMimeType:function(v){this.overrideMimeType(v)},getMimeType:function(){return this._mimeType},overrideMimeType:function(e){this.getXhr().overrideMimeType(this._mimeType=e)},getResponseHeader:function(T){return this.getXhr().getResponseHeader(T)},getResponseText:function(){var b=this.getXhr();return b.response||b.responseText},getStatus:function(){return this.getXhr().status}}),pj.GraphView=function(f){var m=this;m._24I={},m._34I=new oc,m.enableDirtyRect(),m._25I={},m._56I={},m._view=Of(1,m),m._canvas=ej(m._view),m.dm(f?f:new ed),this._coreInteractor=new fr(this),m.setEditable(!1),m.setScrollBarVisible(K.graphViewScrollBarVisible),m._initView()},jp("GraphView",O,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[tm,Dh,dj,jj,"resettable","editInteractor",Bs,"zoomable","pannable","rectSelectable","autoScrollZone",np,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:K.graphViewZoomable,_resettable:K.graphViewResettable,_pannable:K.graphViewPannable,_rectSelectable:K.graphViewRectSelectable,_autoScrollZone:K.graphViewAutoScrollZone,_rectSelectBackground:K.graphViewRectSelectBackground,_rectSelectBorderColor:K.graphViewRectSelectBorderColor,_editPointSize:K.graphViewEditPointSize,_editPointBorderColor:K.graphViewEditPointBorderColor,_editPointBackground:K.graphViewEditPointBackground,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoHideScrollBar:Vb,_autoMakeVisible:Kc,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(I){this._dataModel.setLayers(I)},setEditable:function(T){var F=this,h=F.__interactorMap__;if(!h){var u=pj.XEditInteractor;h=F.__interactorMap__={scrollBar:new Yn(F),select:new qb(F),edit:u?new u(F):new Mb(F),text:new bm(F),move:new jd(F),"default":new Vn(F),touch:new mq(F,{editable:!1})}}T?(F._uieditable=!0,F.setInteractors([h.scrollBar,h.select,h.text,h.edit,h.move,h.default,h.touch])):(F._uieditable=!1,F.setInteractors([h.scrollBar,h.select,h.move,h.default,h.touch]))},getCanvas:function(){return this._canvas},_33I:function(e){var S=e.getUIClass();return S?new S(this,e):E},getDataUI:function(Z){var S=this,r=S._25I[Z._id];return r===P&&(r=S._33I(Z),S._25I[Z._id]=r),r},getNodeRect:function(v){return K.getNodeRect(this,v)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(g){var e=this.getDataUI(g);return e?(e._79o(),e._78o):null},getEdgeSourcePosition:function(L){var I=this,M=I.getDataUI(L),V=M.s,c=M._data._40I;return Hb(I,c,V("edge.source.position"),V("edge.source.offset.x"),V("edge.source.offset.y"),V("edge.source.anchor.x"),V("edge.source.anchor.y"))},getEdgeTargetPosition:function(s){var S=this,i=S.getDataUI(s),F=i.s,$=i._data._41I;return Hb(S,$,F("edge.target.position"),F("edge.target.offset.x"),F("edge.target.offset.y"),F("edge.target.anchor.x"),F("edge.target.anchor.y"))},invalidateAll:function(O){var b=this;if(O){for(var _ in b._25I){var p=b._25I[_];p&&p.dispose()}b._25I={},b._56I={},b._24I={},b._34I.clear(),b.redraw()}else b.dm().each(function(t){b.invalidateData(t)})},invalidateSelection:function(){var y=this;y.sm().each(function(X){y.invalidateData(X)})},invalidateData:function(x){var S=this;S._24I[x._id]=x,S._21Q(x),S.iv()},_21Q:function(o){var A=this,X=A._24I;if(bf(o)&&fm[o.s(Ig)]){var z=o.getSourceAgent();z&&z.getAgentEdges().each(function(p){X[p._id]=p}),z=o.getTargetAgent(),z&&z.getAgentEdges().each(function(v){X[v._id]=v}),A.iv()}},redraw:function(o){var q=this;q._32I||(o?q._34I.add(o):(q._32I=1,q._34I.clear()),q.iv())},each:function(R,l){var I,M,$,P=0,u=this.getLayers(),A=this._dataModel,d=A._datas._as,i=d.length;if(u){var t,H={};A.isHierarchicalRendering()&&A.eachByHierarchical(function(k){$=k._layer,t=H[$],t||(t=H[$]=[]),t.push(k)});for(var C=u.length;C>P;P++)if($=u[P],Hh($)&&($=$.name),A.isHierarchicalRendering()){t=H[$];var c,I,y;if(t&&(c=t.length)>0)for(var N=0;c>N;N++)if(I=t[N],y=l?R.call(l,I):R(I),y===!1)return}else for(var N=0;i>N;N++)if(I=d[N],I._layer===$&&(M=l?R.call(l,I):R(I),M===!1))return}else if(A.isHierarchicalRendering())this._dataModel.eachByHierarchical(R,null,l);else for(;i>P;P++)if(I=d[P],M=l?R.call(l,I):R(I),M===!1)return},reverseEach:function(B,Q){var W,Z,F,v,N=this._dataModel,S=N._layers,w=N._datas._as,u=w.length;if(S){var A,j={};for(N.isHierarchicalRendering()&&N.reverseEachByHierarchical(function(L){v=L._layer,A=j[v],A||(A=j[v]=[]),A.push(L)}),W=S.length-1;W>=0;W--)if(v=S[W],Hh(v)&&(v=v.name),N.isHierarchicalRendering()){A=j[v];var h,Z,z;if(A&&(h=A.length)>0)for(var f=0;h>f;f++)if(Z=A[f],z=Q?B.call(Q,Z):B(Z),z===!1)return}else for(var f=u-1;f>=0;f--)if(Z=w[f],Z._layer===v&&(F=Q?B.call(Q,Z):B(Z),F===!1))return}else if(N.isHierarchicalRendering())N.reverseEachByHierarchical(B,null,Q);else for(W=u-1;W>=0;W--)if(Z=w[W],F=Q?B.call(Q,Z):B(Z),F===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var I=this,T=I._84I;if(!T){var f=this.dm().a("width"),l=this.dm().a("height");f>0&&l>0?I._84I={x:0,y:0,width:f,height:l}:(I.each(function(w){I.isVisible(w)&&(T=jm(T,I.getDataUIBounds(w)))}),I._84I=T?T:Cm)}return I._84I},getScrollRect:function(){return jm(this.getContentRect(),this._29I)},makeCenter:function(h,F,O){var f=this;if(!f.getWidth()||!f.getHeight())return O||dd(f.makeCenter,f,[h,F,!0],500),void 0;f.makeVisible(h),f.validate();var Y=f.getDataUIBounds(h);if(Y){var R=f.getWidth(),r=f.getHeight(),K=Y.x+Y.width/2,$=Y.y+Y.height/2,b=-K*f._zoom+R/2,B=-$*f._zoom+r/2;f.setTranslate(b,B,F)}},fitData:function(Y,O,C,n,B){var x=this;if(!x.getWidth()||!x.getHeight())return B||dd(x.fitData,x,[Y,O,C,n,!0],500),void 0;var R=function(){x.makeVisible(Y),x.validate();var J=x.getDataUIBounds(Y);J&&(J=fo(J),rk(J,C==E?20:C),x.fitRect(J,O,n))};O?K.callWhenLoaded(R):R()},fitContent:function(k,$,u,f){var H=this;if(!H.getWidth()||!H.getHeight())return f||dd(H.fitContent,H,[k,$,u,!0],500),void 0;var q=function(){H.validate();var q=fo(H.getContentRect());rk(q,$==E?20:$),H.fitRect(q,k,u)};k?K.callWhenLoaded(q):q()},fitRect:function(A,$,r){var v=this,b=v.getWidth(),Z=v.getHeight(),x=A.x+A.width/2,J=A.y+A.height/2,B=I(b/A.width,Z/A.height),U=v._zoom,g=-x*U+b/2,d=-J*U+Z/2;0===B||isNaN(B)||(r&&(B=I(1,B)),$?(v._65I&&(delete v._65I.finishFunc,v._65I.stop(!0)),v._14o&&v._14o.stop(!0),v.setTranslate(g,d,{finishFunc:function(){v.setZoom(B,$)}})):(v.setTranslate(g,d),v.setZoom(B)))},fitSelection:function(p,E,A){var k=this,i=k.sm(),K=null;i.size()&&(i.each(function(E){K=jm(k.getDataUIBounds(E),K)}),p&&rk(K,p),k.fitRect(K,E,A))},toCanvas:function(f,G,R){G=G||this._zoom,this.validateImpl();var r=this,c=r.getContentRect();R&&rk(c,R),c.width||(c.width=10),c.height||(c.height=10);var C=ej(),K=c.x*G,W=c.y*G,d=Math.ceil(c.width*G),E=Math.ceil(c.height*G);Gm(C,d,E,1);var L=Te(C);f=f||this._dataModel.getBackground(),f&&cs(L,0,0,d,E,f),xc(L,-K,-W),L.scale(G,G);var y=this._zoom;return this._zoom=G,r._42(L),this._zoom=y,L.restore(),this.redraw(),C},toDataURL:function(F,k,Y,o){return this.toCanvas(F,Y,o).toDataURL(k||"image/png",1)},getClipBounds:function(){return this._74O},_42:function($,P){var X=this,w=X.dm().getBackground();if(w){var T=X.dm().a("width"),q=X.dm().a("height");T>0&&q>0&&cs($,0,0,T,q,w)}var Q=X.__htmlOrderList,M=[],j=X._forcedLayoutHTML;if(X._93db($,P),X.each(function(D){var V=X.getDataUI(D);if(V){var e=X._56I[D._id],U=V._htmlView;if(e){var m=V._79o();if(U=V._htmlView,h.HtmlNode&&D instanceof h.HtmlNode)V._42($);else{var g=X.getViewRect(),x=U&&U.layoutHTML;!P||mn(P,m)?(x&&(U.layoutHTML(),V.__outerLayout&&delete V.__outerLayout),V._42($)):mn(g,m)||!x||V.__outerLayout&&!j||(U.layoutHTML(),V.__outerLayout=!0)}}U&&(M.push(U),U.getView&&(U=U.getView()),U.style.display=e?"block":cn)}}),Q&&M.length>0){var p=!1;if(Q.length!==M.length)p=!0;else for(var U=0;U<M.length;U++)if(M[U]!==Q[U]){p=!0;break}p&&(M.forEach(function($){$.autoAdjustIndex!==!1&&X.appendHTML($,!0)}),this.__htmlOrderList=M)}else this.__htmlOrderList=M;X._92db($,P)},disableDirtyRect:function(){this._shouldRedrawAll=Z},enableDirtyRect:function(){var _=this;_._shouldRedrawAll=function(){return _._32I}},validateImpl:function(){this.tryUpdateRootData();var m,D,l,t,R,k=this,b=k.tx(),p=k.ty(),C=k._zoom,H=k._canvas,S=this.getWidth(),Z=this.getHeight(),Y=k._29I,y={x:-b/C,y:-p/C,width:S/C,height:Z/C},h={},A=k._34I,O=k._24I,Q=k._shouldRedrawAll(),J=k._23I;k._24I={},(S!==H.clientWidth||Z!==H.clientHeight)&&(Gm(H,S,Z),Q=1,k._forcedLayoutHTML=1),Q||sl(y,Y)||(Q=1,k._forcedLayoutHTML=1),k._29I=y,k.each(function(L){D=L._id;var I=h[D]=k.isVisible(L);I!==k._56I[D]&&(O[D]=L,l=k.getDataUI(O[D]),l&&l._84o(I),k._84o(L,I))},k);for(D in O)l=k.getDataUI(O[D]),l&&(!Q&&k._56I[D]&&(R=l._79o(),R&&A.add(R)),l.invalidate()),k._83I=1;if(k._56I=h,!Q)for(D in O)h[D]&&(l=k.getDataUI(O[D]),l&&(R=l._79o(),R&&A.add(R)));if(Q?t=y:(A.each(function(g){mn(y,g)&&(t=jm(t,g))}),t&&(rk(t,_(1,1/C)),t.x=X(t.x*C)/C,t.y=X(t.y*C)/C,t.width=i(t.width*C)/C,t.height=i(t.height*C)/C,t=rd(y,t))),k._74O=t,t&&0!==t.width&&0!==t.height){m=Te(H);var T=t.x,N=t.y,n=t.width,o=t.height;T=Math.floor((T*C+b)*qq),N=Math.floor((N*C+p)*qq),n=Math.ceil(n*C*qq)+1,o=Math.ceil(o*C*qq)+1,Q||(t.x=(T/qq-b)/C,t.y=(N/qq-p)/C,t.width=n/qq/C,t.height=o/qq/C),m.beginPath(),m.rect(T,N,n,o),m.clip(),m.clearRect(T,N,n,o),Rf(m,b,p,C),k._42(m,t),m.restore(),delete k._74O}if(A.clear(),delete k._32I,delete k._forcedLayoutHTML,J&&S>0&&Z>0){var l=k.getDataUI(J);if(l){var R=l._79o(),M=k._29I,a=M.x,V=M.y,d=M.width,E=M.height,C=k._zoom;R&&!mn(R,M)&&(R.x+R.width<a&&k.tx(-R.x*C),R.x>a+d&&k.tx(-(R.x+R.width-d)*C),R.y+R.height<V&&k.ty(-R.y*C),R.y>V+E&&k.ty(-(R.y+R.height-E)*C))}delete k._23I}k._83I&&(delete k._83I,delete k._84I),k._98O(),k.countFrame(),Cp(k._24I)||dd(k.iv,k)},isValidGuideLineSource:function(){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var O,z=this.getFullscreenDatas();for(var m in z)O=z[m],this.scaleRootData(O);this.onRootDataUpdated&&this.onRootDataUpdated(),this._rootDataUpdating=!1}},scaleRootData:function(z){var m=z.s("fullscreen");if("uniform"===m||"fill"===m){z.getRotation()&&z.setRotation(0);var u=z.s("fullscreen.gap")||0,O=this.getWidth(),T=this.getHeight();if(O&&T){var x,B,Z,W=O-2*u,n=T-2*u,E=z.getAnchor(),f=z.getScaledSize(),r=f.width,S=f.height,s=z.s("fullscreen.lock");if(s)return"uniform"===m?W/n>r/S?(x=n/S,r=S*W/n):(x=W/r,S=r*n/W):"v"===s?(x=n/S,r=W/x,z.getWidth()!==r&&z.setWidth(r)):(x=W/r,S=n/x,z.getHeight()!==S&&z.setHeight(S)),this.setZoom(x),B=u-(z.getX()-E.x*r)*x,Z=u-(z.getY()-E.y*S)*x,B!==this.tx()&&this.tx(B),Z!==this.ty()&&this.ty(Z),void 0;B=this.tx(),Z=this.ty(),x=this._zoom;var P={x:(-B+u)/x,y:(-Z+u)/x,width:W/x,height:n/x};if("uniform"===m){var L=r/S,y=Math.min(P.width,P.height*L),v=y/L;P.x+=.5*(P.width-y),P.y+=.5*(P.height-v),P.width=y,P.height=v}W=P.width/z.getScaleX(),n=P.height/z.getScaleY(),(z.getWidth()!=W||z.getHeight()!==n)&&z.setSize(W,n);var Y=P.x+E.x*P.width,l=P.y+E.y*P.height,K=z.getPosition();(Y!==K.x||l!==K.y)&&z.setPosition(Y,l)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(U){var r=this;U!==r.isScrollBarVisible()&&(U?(Ej(r._view,r._79O=Xi()),Ej(r._79O,r._27I=Xi()),Ej(r._79O,r._28I=Xi())):(gl(r._79O),delete r._79O,delete r._27I,delete r._28I),r.fp("scrollBarVisible",!U,U))},getDebugTip:function(){return""},showScrollBar:function(){var c=this;c._79O&&(c._85I||(Jn(function(){c._86I()},bo),c.iv()),c._85I=new Date)},_86I:function(){var k=this;if(k._85I){var S=new Date,u=S.getTime();u-k._85I.getTime()>=bo?(delete k._85I,k.iv()):Jn(function(){k._86I()},bo)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var d=this,s=this._27I,x=this._28I;if(d._79O){if(d._autoHideScrollBar&&!d._85I)return s.style.visibility=gb,x.style.visibility=gb,void 0;var h=d.getScrollBarColor(),v=d._zoom,Q=d.getScrollBarSize(),P=d.getViewRect(),U=d.getScrollRect(),t=P.height*v,Z=U.height*v,C=P.width*v-Q-2,w=t*((P.y-U.y)*v/Z),N=t*(t/Z),_=s.style;Z-.5>t?(Wl>N&&(w=w+N/2-Wl/2,0>w&&(w=0),w+Wl>t&&(w=t-Wl),N=Wl),Xb(s,C,w,Q,N),_.visibility=Fm,_.background=h,_.borderRadius=Q/2+yr):_.visibility=gb;var b=P.width*v,R=U.width*v,w=P.height*v-Q-2,C=b*((P.x-U.x)*v/R),O=b*(b/R),_=x.style;R-.5>b?(Wl>O&&(C=C+O/2-Wl/2,0>C&&(C=0),C+Wl>b&&(C=b-Wl),O=Wl),Xb(x,C,w,O,Q),_.visibility=Fm,_.background=h,_.borderRadius=Q/2+yr):_.visibility=gb}},setDataModel:function(p){var v=this,U=v._dataModel,x=v._selectionModel;U!==p&&(U&&(U.ump(v.handleDataModelPropertyChange,v),U.umm(v.handleDataModelChange,v),U.umd(v.handleDataPropertyChange,v),U.removeIndexChangeListener(v._75O,v),U.removeHierarchyChangeListener(v.handleHierarchyChange,v),x||U.sm().ums(v.handleSelectionChange,v)),v._dataModel=p,p.mp(v.handleDataModelPropertyChange,v),p.mm(v.handleDataModelChange,v),p.md(v.handleDataPropertyChange,v),p.addIndexChangeListener(v._75O,v),p.addHierarchyChangeListener(v.handleHierarchyChange,v),x?x._21I(p):p.sm().ms(v.handleSelectionChange,v),v.invalidateAll(!0),v.fp(ac,U,p),v.updateBackground())},getLayersInfo:function(){if(this._layersInfo===P){var y=this.getLayers();y?(this._layersInfo={},y.forEach(function(d){var h=Hh(d)?d.name:d;this._layersInfo[h]=d},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(V,E,l){var J,f,W,v,n=this;V instanceof h.Data?(v=n.getDataUI(V),W=qo(v)):(W=qo(null,arguments[0],arguments[1]),E=arguments[2],l=arguments[3]),2===E.length&&(E=new Vl(E[0],E[1]));var t=xf(E,function(j){return $r(W,100*j)},100,.001),r=$r(W,100*t);if(!l){var A=v?el(v):el(arguments[0],arguments[1]),Y=new Vl(r.x,r.y),N=49/(n._zoom*n._zoom);for(J=0,f=A.length;f>J;J++)if(Y.distanceToSquared(A[J])<N)return{index:J,point:A[J],distance:Math.sqrt((A[J].x-E.x)*(A[J].x-E.x)+(A[J].y-E.y)*(A[J].y-E.y))}}return{percent:t,point:r,distance:Math.sqrt((r.x-E.x)*(r.x-E.x)+(r.y-E.y)*(r.y-E.y))}},getPercentPositionOfPath:function(M,a){var Q;if(M instanceof h.Data){var K=this.getDataUI(M);Q=qo(K)}else Q=qo(null,arguments[0],arguments[1]),a=arguments[2];return $r(Q,a)},getNeareastPositionOfPath:function(){return this.calculateEdgePosition.apply(this,arguments)},getPointsOfPath:function(){function f(T,X,F,i,$,x){var S=new Vl(X.get(F)),d=x.apply(S);T.push({local:S,world:d,type:$,index:F,realIndex:i})}return function(i){var T,s;if(i instanceof h.Data){var G=this.getDataUI(i),I=Si(G);T=I.points,s=I.segments}else T=arguments[0],s=arguments[1];var v,g,m,M=i instanceof h.Shape?i.getPointsMatrix2d():new Uj.Matrix2d,L=[],r=-1,a=-1;for(g=0,m=s?s.length:T.length;m>g;g++)v=s?s.get(g):1,5!==v&&(a++,3===v?(f(L,T,r+1,a,"C",M),f(L,T,r+2,a,"M",M),r+=2):4===v?(f(L,T,r+1,a-1,"R",M),f(L,T,r+2,a,"L",M),f(L,T,r+3,a,"M",M),r+=3):(f(L,T,r+1,a,"M",M),r+=1));return L}}(),calculateAttachPoint:function(){var f=new Vl,x=new Vl,o=new Vl;return function(Z,$){var W=this.getAttachPoints(Z);if(!W||!W.length)return null;o.set($.x,$.y);for(var X,D,K,g,E,M=1/0,Y=0,T=W.length;T>Y;Y++)K=W[Y],x.x=K.x,x.y=K.y,f.x=K.offsetX||0,f.y=K.offsetY||0,g=Hb(this,Z,0,f.x,f.y,x.x,x.y),D=o.distanceToSquared(g),M>D&&(X=Y,M=D,E=g);M=Math.sqrt(M);var r=this.getAttachStyle(Z);if("close"===r){var N=Z.s("attach.close.threshold")/this._zoom;if(M>N)return null}return{index:X,distance:M,info:W[X],point:E}}}(),getAttachPoints:function(F){var A=F.s("attach.points");if(A)return A;var V=fl(F._image);return V?as(V.attachPoints,F,this)||null:void 0},getAttachStyle:function(K){var t=K.s("attach.style");if(t)return t;var m=fl(K._image);return m?as(m.attachStyle,K,this)||"close":void 0},updateLayers:function(){this._layersInfo=P,this.invalidateSelection(),this.redraw()},updateBackground:function(){var L=this.dm().a("width"),A=this.dm().a("height");this._canvas.style.background=L>0&&A>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(E){if("background"===E.property){var x=this._canvas.style.background,f=E.newValue||"";this.updateBackground(),this.fp("canvasBackground",x,f),this.redraw()}else"a:width"===E.property||"a:height"===E.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===E.property?this.updateLayers():"hierarchicalRendering"===E.property&&this.redraw()},handleDataPropertyChange:function(K){this.dm().isHierarchicalRendering()&&"parent"===K.property&&K.data.hasChildren()&&this.redraw(),this.invalidateData(K.data)},onPropertyChanged:function(U){var J=this,c=U.property;if(J.redraw(),"zoom"===c){var r=J.sm().getSelection();r.size()&&r.each(function(U){U.invalidate()})}else"dataModel"===c&&(J._83I=1);zs[c]?J.showScrollBar():c===Bs&&J.onCurrentSubGraphChanged(U)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(S){var D=this,w=S.kind,j=S.data;if(D._83I=1,"add"===w)D.invalidateData(j),bf(j)&&j.getEdgeGroup()&&j.getEdgeGroup().eachSiblingEdge(D.invalidateData,D),j.getHost&&j.getHost()&&j.getHost().updateLayoutAttaches();else if(w===Fk){D._21Q(j);var I=j._id,X=D._25I[I];if(X){if(D._56I[I]){var a=X._79o();a&&D.redraw(a)}X.dispose(),delete D._25I[I],delete D._24I[I],delete D._56I[I]}j===D._currentSubGraph&&D.setCurrentSubGraph(E)}else w===cl&&(D.invalidateAll(!0),D.setCurrentSubGraph(E))},_75O:function(d){this.invalidateData(d.data)},handleHierarchyChange:function(r){this.dm().isHierarchicalRendering()&&r.data.hasChildren()&&this.redraw(),this.invalidateData(r.data)},adjustIndex:function(o){var X=this;if(X.isVisible(o)){X.dm().beginTransaction();for(var T=o;T._parent&&X.isVisible(T._parent);)T=T._parent;T&&T!==o&&X._dataModel.adjustIndex(T),X._dataModel.adjustIndex(o),X.dm().endTransaction()}},getImage:function(R){return R.getImage?R.getImage():P},getSelectWidth:function(U){var K=fl(this.getImage(U));return K&&as(K.disableSelectedBorder,U,this)?0:U.s("select.width")},getSelectColor:function(j){return j.s("select.color")},isSelectable:function(d,Y){if(this.isSelected(d))return!0;if(!Y&&d.getParent()instanceof aq&&this.isSelectable(d.getParent(),!0)&&d.getParent().isSyncSize())return!1;var b=this.getLayersInfo();if(b){var L=b[d._layer];if(L&&L.selectable===!1)return!1}return d.s("2d.selectable")&&this.sm().isSelectable(d)},isMovable:function(T){var b=this;if(bf(T)&&T.getStyle(Ig)!==Qr)return!1;var n=this.getLayersInfo();if(n){var A=n[T._layer];if(A&&A.movable===!1)return!1}return T.s("2d.movable")?b._movableFunc?b._movableFunc(T):!0:!1},isEditable:function(Q){var y=this;if(h._uiSerializing)return y._uieditable;if(!y._editInteractor||!y.isSelected(Q))return!1;if(Kp(Q)){var k=y.getDataUI(Q);if(!k||k._88I)return!1}if(bf(Q)&&Q.getStyle(Ig)!==Qr)return!1;var w=this.getLayersInfo();if(w){var R=w[Q._layer];if(R&&R.editable===!1)return!1}return Q.s("2d.editable")?y._editableFunc?y._editableFunc(Q):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(e){return bk(e)&&0!==e.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(e):!0},isRectEditable:function(D){return this._rectEditableFunc?this._rectEditableFunc(D):!0},isAnchorEditable:function(K){return this._anchorEditableFunc?this._anchorEditableFunc(K):!0},isRotationEditable:function(j){return j.setRotation&&j.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(j):!0:!1},isSourceTargetEditable:function(){return!0},getRotationPoint:function(X){var R=X.getAnchor(),f=X.getScale(),e=this._zoom,Z=ic(X.getRotation(),0,-X.getHeight()*f.y*R.y-(f.y<0?-1:1)*(kd?32:16)/e),o=X.p();return Z.x+=o.x,Z.y+=o.y,Z},getLogicalPoint:function(A){var Z=this;return Fg(A,Z._canvas,Z.tx(),Z.ty(),Z._zoom,Z._zoom)},getScreenPoint:function(i,X){var $,o=this;return"object"==typeof i?i.x!==P?($=i.x,X=i.y):($=i[0],X=i[1]):$=i,fc($,X,o._canvas,o.tx(),o.ty(),o._zoom,o._zoom)},getSelectedDataAt:function(R){var b=this;return this.getDataAt(R,function(n){return b.isSelected(n)})},getDataInfoAt:function(C,T,s){var g,a=this.lp(C),w=this.getDataAt(a,T,s);if(w){var Q=this.getDataUI(w);g={data:w,ui:Q,point:a};var f=Q._38o;if(f){var K=f.icons;for(var v in K){var L=K[v],Y=f.rects[v];if(Y)for(var j=as(L.names,w,this),n=j?j.length:0,t=Y.rotation,F=n-1;F>=0;F--){var r=j[F],b=Y[F];if(mg(b,a,t))return g.part="icons",g.name=v,g.icon=r,g.rect=b,g.index=F,g.rotation=t,g}}}if(this.isNoteVisible(w)){if(Q.note2Info&&mg(Q.note2Info.clickRect,a,E,Q.note2Info.scale))return g.part="note2",g;if(Q.noteInfo&&mg(Q.noteInfo.clickRect,a,E,Q.noteInfo.scale))return g.part="note",g}if(this.isLabelVisible(w)){if(Q.label2Info&&mg(Q.label2Info.rect,a,Q.label2Info.rotation,Q.label2Info.scale))return g.part="label2",g;if(Q.labelInfo&&mg(Q.labelInfo.rect,a,Q.labelInfo.rotation,Q.labelInfo.scale))return g.part="label",g}if(w.isInRect&&w.isInRect(a))return g.part="body",g}return g},getDataAt:function(w,h,g){w.target&&(w=this.lp(w));var T,V=this._zoom;return this.reverseEach(function(d){return(h?h(d):this.isSelectable(d))&&this.rectIntersects(d,lr(w.x,w.y,g,V))?(T=d,!1):void 0},this),T},getIconInfoAt:function(h,g){var C=this;if(h.target&&(h=C.lp(h)),g||(g=C.getDataAt(h)),g){var e=C.getDataUI(g);if(e&&e._38o){var I,v=e._38o,i=new oc;for(I in v.icons)i.add(I);for(var t=i.size()-1;t>=0;t--){I=i.get(t);for(var A=v.rects[I],n=A.rotation,p=A.length-1;p>=0;p--){var G=A[p],S=G.width,c=G.height,Z={x:h.x-G.x-S/2,y:h.y-G.y-c/2};n!=E&&(Z=ic(-n,Z.x,Z.y));var G={x:-S/2,y:-c/2,width:S,height:c};if(mg(G,Z))return{key:I,index:p,name:v.icons[I].names[p],rect:A[p],point:h,rotation:n,relativeRect:G,relativePoint:Z,data:g}}}}}return E},getDatasInRect:function(G,j,K){K===P&&(K=1);var y=this,z=new oc;return y.reverseEach(function(k){K&&!y.isSelectable(k)||(j?y.rectIntersects(k,G):y.rectContains(k,G))&&z.add(k)}),z},moveSelection:function(j,E){var h=this;h.dm().beginTransaction(),kl(h.sm().toSelection(h.isMovable,h),j,E),h.dm().endTransaction()},moveDatas:function(i,p,x){var T=this;T.dm().beginTransaction(),i instanceof oc||(i=new oc(i)),kl(i,p,x),T.dm().endTransaction()},getDataUIBounds:function(L){var R=this.getDataUI(L);return R?R._79o():E},drawData:function(C,I,Q){var D=this.getDataUI(I);if(D){var T=D._79o();(!Q||mn(Q,T))&&(D._42(C),I instanceof h.Block&&I.eachChild(function(j){this.isVisible(j)&&this.drawData(C,j,Q)},this))}},getBoundsForGroup:function(v){return v.s(eb)?this.getDataUIBounds(v):E},isPixelPerfect:function(o){return o.s("pixelPerfect")},rectIntersects:function(k,f){this.validate();var s=E;if(this._56I[k._id]){var A=this._25I[k._id];if(A){var o=A._79o();if(ld(f,o))s=!0;else if((f=rd(f,o))&&(A.rectIntersects&&(s=A.rectIntersects(f)),s==E)){if(!this.isPixelPerfect(k))return!0;var O=f.x,B=f.y,L=f.width,e=f.height,R=this._zoom,G=K.hitMaxArea,P=L*e*R*R;if(P>G){var S=Math.sqrt(G/P);R*=S}L*=R,e*=R,2>L&&(L=2),2>e&&(e=2),O*=R,B*=R;var C=Le(L,e);xc(C,-O,-B),C.scale(R,R),this._drawForChecking=!0,this.drawData(C,k,f),this._drawForChecking=!1;try{for(var T=0,J=C.getImageData(0,0,L,e).data;T<J.length;T+=4)if(0!==J[T+3]){s=!0;break}C.restore()}catch(F){Ar=E,s=!1}}}}return s?!0:!1},rectContains:function(j,z){if(this._56I[j._id]){var B=this._25I[j._id];if(B)return ld(z,B._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(G){if(!K.isInput(G.target)){var c=this,U=c._focusData,s=U&&c._25I[U._id],Z=0,L=c._dataModel._datas;if(!(U&&U._enabled&&U._editable&&s&&s.onKeyDown&&s.onKeyDown(G)===!0))if(9===G.keyCode&&(U&&(Z=L.indexOf(U),um(G)?-1===--Z&&(Z=0):++Z===L.size()&&(Z=0)),c._focusData=U=L.get(Z),c.sm().setSelection(U)),Bd(G)?c.selectAll():Vo(G)&&c.isResettable()&&c.reset(),c.sm().isEmpty()){if(c._editing)return;var i=c.tx(),r=c.ty(),g=!1,x=um()?100:10;oj(G)&&(i-=x,g=!0),mp(G)&&(r-=x,g=!0),Lf(G)&&(i+=x,g=!0),Wq(G)&&(r+=x,g=!0),g&&c.setTranslate(i,r)}else{ho(G)&&c.handleDelete(G);var E=um()?10:1;oj(G)&&(c.moveSelection(-E,0),c.fi({kind:"moveLeft"})),mp(G)&&(c.moveSelection(0,-E),c.fi({kind:"moveUp"})),Lf(G)&&(c.moveSelection(E,0),c.fi({kind:"moveRight"})),Wq(G)&&(c.moveSelection(0,E),c.fi({kind:"moveDown"}))}}},handleScroll:function(T,$){if(up(T),this.isZoomable()){if(!this.getEditInteractor()){var P=this.getDataAt(T);if(P){var U=fl(this.getImage(P));if(U&&as(U.scrollable,P,this))return}}var t=this.getFullscreenDatas();for(var s in t)if(t[s].s("fullscreen.lock"))return;var W=this.lp(T);$>0?this.scrollZoomIn(W):0>$&&this.scrollZoomOut(W)}},handlePinch:function(k,l,u){this.isZoomable()&&(Math.abs(l-u)<K.pinchZoomThreshold||(l>u?this.pinchZoomIn(k):this.pinchZoomOut(k)))},checkDoubleClickOnNote:function(q,n){var R=this,w=R.lp(q),O=R.getDataUI(n),$=O.note2Info;return $&&n.s("note2.toggleable")&&mg($.clickRect,w)?(n.s(No,!n.s(No)),R.fi({kind:"toggleNote2",event:q,data:n}),!0):($=O.noteInfo,$&&n.s("note.toggleable")&&mg($.clickRect,w)?(n.s(uq,!n.s(uq)),R.fi({kind:"toggleNote",event:q,data:n}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(F,Q){var i=this,f=i.getAutoScrollZone(),J=f/i.getZoom(),H=f/4,u=i._29I,h=i.lp(F),v={x:i.tx(),y:i.ty()};return h&&f>0&&u&&(h.x-u.x<J?i.translate(H,0):u.x+u.width-h.x<J&&i.translate(-H,0),h.y-u.y<J?i.translate(0,H):u.y+u.height-h.y<J&&i.translate(0,-H)),v.x=i.tx()-v.x,v.y=i.ty()-v.y,Q&&(Q.x+=v.x,Q.y+=v.y),v},getMoveMode:function(W,Q){var r=Q.s("2d.move.mode");return r?r:zr["88"]?"x":zr["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(a,d,u){var n=this;return"currentSubGraph"===d?{__i:a.getId()}:u.serializeProperty(a,d,n)},deserializeProperty:function(f,Q,h){var B=this;if("currentSubGraph"===Q){var Z=B.dm(),l=Z.__idMap;return l[f.__i]}return h.deserializeProperty(f,Q,B)},setDefaultCursor:function(y,S){this._defaultCursor=y,S!==!1&&this.setCursor(y)},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(A){return A===E||K.getConnectAction(null,A)?(this._currentActionType=A,this.redraw(),!0):!1},getEditStyle:function(q){var u=this.getEditInteractor();return u?u.getStyle(q):P},setEditStyle:function(c,F,T){var b=this.getEditInteractor();return b?(b.setStyle(c,F,T),!0):!1},isConnectActionVisible:function(q){var z=K.getConnectAction(this);if(!z)return!1;var n=z.visible;return tj(n)&&(n=n(this,q)),n},isInteractive:function(B){if(this._drawForChecking)return!1;var R=fl(this.getImage(B));return R&&as(R.interactive,B,this)?!0:B.s("interactive")},getRenderingStyleIconName:function(){return sc},appendHTML:function($,Y){var p=this.getView();if(!(Y||$&&$.parentNode!==p))return!1;var u=$.getView&&$.getView(),g=$.beforeCanvas;if(!Y&&u&&u.parentNode===p)return!1;($.getView||$.isSelfViewEvent)&&($=$.getView());var a=this.getEditInteractor();return g?p.insertBefore($,this.getCanvas()):a&&a._canvas?p.insertBefore($,a._canvas):this.isScrollBarVisible()?p.insertBefore($,this.getView().lastChild):Ej(p,$),!0},_layoutHTMLImpl:function(G,r,V){if(arguments.length>1){var m,c=this,w=c._zoom;if(r.getView&&(m=r,r=r.getView()),r.style.position="absolute",V){var u=G.getRect();Xb(m||r,c.tx()+u.x*w,c.ty()+u.y*w,u.width*w,u.height*w)}else{var o=new Or,u=G.getAnchorRect(),O=G.getPosition(),k=G.getScale(),Y=r.style;Xb(m||r,u),o.appendTranslate(c.tx(),c.ty()),o.appendScale(w,w),o.append(new Or(G.getRotation(),O.x,O.y,k.x,k.y)),Qh(Y,"transform","matrix("+o.a.toFixed(5)+", "+o.b.toFixed(5)+", "+o.c.toFixed(5)+",\n    "+o.d.toFixed(5)+", "+o.tx.toFixed(5)+", "+o.ty.toFixed(5)+")"),Qh(Y,"transformOrigin",(-u.x).toFixed(5)+"px "+(-u.y).toFixed(5)+"px"),r.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(T){return T instanceof si?{name:"text",accessType:"s",font:T.s("text.font"),isMultiline:!0}:void 0},getState:function(B){var D="state",v=B.s(D);if(v)return v;var u=fl(B._image);return u?as(u[D],B,this)||null:void 0},getShape:function(L){return L.getStyle(Ph)}}),O.defineProperties(pj.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function($){this._layoutHTML=$}}});var Jo=function(g,f){var w=this;w.gv=g,w.s=function(b){return f.getStyle(b)},w._data=f,w._87I=new oc},sc=E;gd(Jo,O,{_6I:E,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var e=this,y=e.gv.isSelected(e._data);return!y||e.isShadowed()?0:e.gv.getSelectWidth(e._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(I){var d=this._data,n=this.gv.getBodyColor(d);return n?n:I?d.getStyle(I):E},_2Q:function(w){return this.s(w)},_1Q:function(w,o,H,b){var m=this.s,l=m("2d.gray"),W=m(o+".dash.color");if(l&&(W=K.toGrayColor(W)),w.strokeStyle=W,w.lineWidth=H,w.stroke(),m(o+".dash.3d")){var L=m(o+".dash.3d.color");Bc(w,W,l?K.toGrayColor(L):L,H,this.gv._zoom,m(o+".dash.3d.accuracy"))}ks(w,b)},invalidate:function(){this._6I=E},_79o:function(){var A=this;if(!A._6I){var $=A._data,O=A.gv;A.labelInfo=A.label2Info=A.noteInfo=A.note2Info=A._38o=E,A._87I.clear(),A.interactiveInfo=O.isInteractive($)?{}:E,A._3O(),A._55O=O.isEditable($)?{_42O:O.isRectEditable($),_43O:O.isPointEditable($),_56O:O.isRotationEditable($)}:E,A._6I=A._81o()}return A._6I},_3O:function(){},getPosition:function(){return Cm},_68o:function(x,I){x&&this._87I.add(mr(x,I))},_81o:function(){var c=this,h=c.s;c._24O(em,"getLabel"),c._24O(cd,"getLabel2"),c._26O(qh,"getNote"),c._26O(qk,"getNote2"),c._15O(),c._55O&&c._48O();var A;if(c._87I.each(function(S){A=jm(A,S)}),A&&h("shadow.interactable")){var p=c.isShadowed(),Z=h("shadow2"),s=fo(A);Z?(s.x+=h("shadow2.offset.x"),s.y+=h("shadow2.offset.y"),rk(s,h("shadow2.blur"))):p&&(s.x+=h("shadow.offset.x"),s.y+=h("shadow.offset.y"),rk(s,h("shadow.blur"))),A=jm(A,s)}return c._87I.clear(),A},_42:function(p){var n=this,f=n._data,t=n.gv,O=n.s,M=O("opacity"),X=this.isShadowed(),l=O("shadow2");if(X||l){var d=p.shadowOffsetX,I=p.shadowOffsetY,J=p.shadowBlur,F=p.shadowColor,G=t.getZoom()*K.devicePixelRatio,Z=X?"shadow":"shadow2";p.shadowOffsetX=O(Z+".offset.x")*G,p.shadowOffsetY=O(Z+".offset.y")*G,p.shadowBlur=O(Z+".blur")*G,p.shadowColor=X?n.getSelectColor():O(Z+".color")}if(M!=E){var U=p.globalAlpha;p.globalAlpha=M}n._80o(p),t.isLabelVisible(f)&&((!t._drawForChecking||O("label.selectable"))&&co(p,n.labelInfo),(!t._drawForChecking||O("label2.selectable"))&&co(p,n.label2Info)),t.isNoteVisible(f)&&(cp(p,n.noteInfo),cp(p,n.note2Info)),n._99O(p),M!=E&&(p.globalAlpha=U),(X||l)&&(p.shadowOffsetX=d,p.shadowOffsetY=I,p.shadowBlur=J,p.shadowColor=F)
},_80o:function(){},_47O:function(){},_24O:function(F,v){var J=this,q=J._data,K=J.gv,c=J.s,p=K[v](q);if(p!=E){var V=c(F+".scale"),D=c(F+".max"),k=c(F+".position"),M=J[F+"Info"]={label:p,scale:V,color:K[v+"Color"](q),font:c(F+".font"),opacity:c(F+".opacity"),align:c(F+".align"),decoration:c(F+".decoration"),rotation:J.getRotation(c(F+".rotation"),!1,k),background:K[v+"Background"](q)},e=Tq(M,p);D>0&&D<e.width&&(M.labelWidth=e.width,e.width=D),1!==V&&(e.width*=V,e.height*=V);var $=J.getPosition(k,c(F+".offset.x"),c(F+".offset.y"),e,c(F+".position.fixed"));if(e.x=$.x-e.width/2,e.y=$.y-e.height/2,J._68o(M.rect=e,M.rotation),1!==V){var i=e.width/V,N=e.height/V;M.rect={x:$.x-i/2,y:$.y-N/2,width:i,height:N}}}},_26O:function(P,I){var M=this,K=M.gv,n=M._data,u=M.s,l=K[I](n);if(l!=E){var A,D,d=u(P+".scale"),X=M[P+"Info"]={note:l,scale:d,data:n,view:K,expanded:u(P+".expanded"),font:u(P+".font"),color:u(P+".color"),opacity:u(P+".opacity"),align:u(P+".align"),icon:u(P+".icon"),backgroundImage:u(P+".backgroundImage"),borderWidth:u(P+".border.width"),borderColor:u(P+".border.color"),background:K[I+"Background"](n)},f=M.getPosition(u(P+".position"),u(P+".offset.x"),u(P+".offset.y")),W=f.x,r=f.y;if(X.expanded){var H,a=u(P+".max"),L=u(P+".backgroundImage");L?(L=fl(L),H={width:_r(L,n),height:wm(L,n)}):H=Tq(X,l),H.width+=6,H.height+=2,a>0&&a<H.width&&(X.labelWidth=H.width,H.width=a),A=H.width,D=H.height+8,X.clickRect={x:W-A*d/2,y:r-D*d,width:A*d,height:D*d*H.height/D}}else{var G=u(P+".icon");G?(G=fl(G),A=_r(G,n),D=wm(G,n)):(A=12,D=18),X.clickRect={x:W-A*d/2,y:r-D*d,width:A*d,height:D*d}}X.rect={x:W-A/2,y:r-D*d/2-D/2,width:A,height:D};var m=i(X.borderWidth/2)*d;M._68o({x:W-A*d/2-m,y:r-D*d-m,width:A*d+2*m,height:D*d+2*m})}},_48O:function(){},_99O:function(H){var G=this,v=G._38o;if(v){var K=G.gv,d=G._data,e=v.icons,l=G.interactiveInfo;l&&(l._38o={});for(var Q in e){var c=e[Q],m=v.rects[Q];if(m){l&&(l._38o[Q]=[]);var V=as(c.opacity,d,K),t=as(c.names,d,K),$=t?t.length:0,r=m.rotation;if(V!=E){var Y=H.globalAlpha;H.globalAlpha*=V}for(var O=0;$>O;O++){var B=t[O],C=fl(B),u=m[O];if(r){var S=u.x+u.width/2,D=u.y+u.height/2;H.save(),xc(H,S,D),pl(H,r),xc(H,-S,-D)}l&&l._38o[Q].push(H.interactiveInfo={compInfos:[],matrix:r?new Or(r,S,D).appendTranslate(-S,-D):new Or});var T=sc;sc=Q,_c(H,C,as(c.stretch,d,K),u.x,u.y,u.width,u.height,G._data,G.gv),sc=T,H.interactiveInfo=E,r&&H.restore()}V!=E&&(H.globalAlpha=Y)}}}}});var mk=function(l,i){cb(mk,this,[l,i])};gd(mk,Jo,{_checkEmptyRect:!0,_40O:function($,e){var I=this,i=I.s,a=$.rect;($.borderColor=I.gv.getBorderColor(I._data))&&($.borderType=i("border.type"),$.borderWidth=i("border.width"),$.borderPadding=i("border.padding"),e=_(e,$.borderPadding+$.borderWidth/2));var F=I._data.getScale(),l=_(1,_(B(F.x),B(F.y)));if($.selectWidth=I.getSelectWidth()){var T=I.gv._zoom;$.selectType=i("select.type"),$._97o=I.getSelectColor(),$.selectPadding=i("select.padding"),e=_(e,($.selectPadding+$.selectWidth/2/T)/l)}e>0&&(e*=l,a=fo(a),rk(a,e)),I._68o(a)},_39O:function(D,p){var T,Z=this,u=p.rect;if(p.borderWidth>0&&(T=p.borderPadding,D.strokeStyle=p.borderColor,D.lineWidth=p.borderWidth,ug(D,p.borderType,{x:u.x-T,y:u.y-T,width:u.width+2*T,height:u.height+2*T}),D.stroke()),p.selectWidth>0){var l=Z.gv._zoom;if(T=p.selectPadding,D.strokeStyle=p._97o,D.lineWidth=p.selectWidth/l,p.rotation!=E){D.save(),D.translate(p.position.x,p.position.y),D.rotate(p.rotation);var M=Z._data,P=M.getWidth(),h=M.getHeight(),F=p.scale,B=p.anchor;u={x:F.x*-P*B.x,y:F.y*-h*B.y,width:F.x*P,height:F.y*h}}ug(D,p.selectType,{x:u.x-T,y:u.y-T,width:u.width+2*T,height:u.height+2*T}),p.rotation!=E&&D.restore(),D.stroke()}},dispose:function(){var n=this,O=n._htmlView;mk.superClass.dispose.call(n),O&&(O.onHTMLRemoved&&O.onHTMLRemoved(),gl(O))},_3O:function(){var T,y=this,n=y.s,e=y._data,u=y.gv,f=u.getShape(e),b=y.getBodyColor(),h=n("shape.border.color"),w=y._83o=f?{shape:f,_53o:y.getBodyColor("shape.background"),_27Q:fl(n("shape.repeat.image"),b),shapeGradientPack:n("shape.gradient.pack"),shapeBorderGradientPack:n("shape.border.gradient.pack"),_54o:n("shape.border.width"),_55o:h,shapeBorderRepeatImage:fl(n("shape.border.repeat.image"),h),_56o:n("shape.border.3d"),_57o:n("shape.border.3d.color"),_58o:n("shape.border.3d.accuracy"),shapeGradient:n("shape.gradient"),_59o:n("shape.gradient.color"),_60o:n("shape.border.pattern"),_61o:n("shape.border.cap"),_62o:n("shape.border.join"),shapeForeground:n("shape.foreground"),bodyColor:b,gray:n("2d.gray")}:{img:fl(u.getImage(e),b),bodyColor:b,gray:n("2d.gray"),stretch:n("image.stretch")},z=w.img;z&&z.renderHTML?(y._htmlInfo&&y._htmlInfo.img!==z&&(y._htmlInfo=E),y._htmlInfo||(y._htmlInfo={img:z,cache:{}}),T=z.renderHTML(e,u,y._htmlInfo.cache)):y._htmlInfo=E,y._htmlView&&y._htmlView!==T&&(y._htmlView.onHTMLRemoved&&y._htmlView.onHTMLRemoved(),gl(y._htmlView.getView?y._htmlView.getView():y._htmlView)),(y._htmlView=T)&&u.appendHTML(T)&&(T.onHTMLAddedSync&&T.onHTMLAddedSync(),T.onHTMLAdded&&dd(T.onHTMLAdded)),w.rect=e.getRect(),w.position=e.p(),w.scale=e.getScale(),w.anchor=e.getAnchor(),w.rotation=e.getRotation(),f===Vd&&(w._63o=n("shape.depth"));var H=0;if(f)H=zd(E,w._54o/2,w._62o),y.s("shape.dash")&&(H=_(H,(y.s("shape.dash.width")||w._54o)/2));else if(z&&z.boundExtend)if(H=as(z.boundExtend,e,u),z.boundExtendAbsolute){var Z=e.getScale();H/=u._zoom*_(1,_(B(Z.x),B(Z.y)))}else if(!as(z.fitSize,e,u)){var Y=as(z.width,e,u),k=as(z.height,e,u);H*=_(e.getWidth()/Y,e.getHeight()/k)}y._40O(w,H);var j=n("clip.percentage");if(j!=P&&(w.clipRect=fg(e.getAnchorRect(),n("clip.direction"),j)),f){var K=n("shape.fill.clip.percentage");K!=P&&(w.shapeClipRect=fg(e.getAnchorRect(),n("shape.fill.clip.direction"),K));var Q=n("shape.foreground.clip.percentage");Q!=P&&(w.shapeForegroundClipRect=fg(e.getAnchorRect(),n("shape.foreground.clip.direction"),Q))}var R=n("clip.host");R&&e.getHost()&&(w.clipHost=!0)},getPosition:function(E,f,G,s){var _=Ac(E,this._83o.rect,s);return _.x+=f,_.y+=G,_},_80o:function(v){var H=this,U=H.s,z=H.gv,m=H._data,e=H._83o,T=e.rect,Q=e.position,g=e.rotation,V=e.anchor,P=e.scale,k=e.shape,t=e.clipHost,D=e.clipRect;if(!H._checkEmptyRect||T.width>0&&T.height>0){if(t){var q=m.getHost().getCorners();v.save(),v.beginPath(),q.forEach(function(k,g){g?v.lineTo(k.x,k.y):v.moveTo(k.x,k.y)}),v.clip()}var M=m.getSize();if(M.x=-M.width*V.x,M.y=-M.height*V.y,xk&&!bp&&xc(v,M.width,M.height),v.save(),xc(v,Q.x,Q.y),pl(v,g),Hl(v,P.x,P.y),D&&(v.beginPath(),v.rect(D.x,D.y,D.width,D.height),v.clip()),z._drawForChecking&&e.img&&as(e.img.pixelPerfect,m,z)===!1)cs(v,M.x,M.y,M.width,M.height,"#888888");else if(H.freeDraw)H.freeDraw(v,M,e);else if(k){var B,i,y,d,x=e._60o,h=Ii(v,x),W=e._27Q,j=e._54o,Y=e.shapeGradientPack,$=e.gray,R=v.lineJoin,S=v.lineCap,u=function(s){return $?K.toGrayColor(s):s};"roundRect"===k?B=U("shape.corner.radius"):"polygon"===k?(B=U("shape.polygon.side"),i=U("shape.corner.radius"),y=U("shape.regular")):"arc"===k&&(B=U("shape.arc.from"),i=U("shape.arc.to"),y=U("shape.arc.close"),d=U("shape.arc.oval")),v.lineJoin=e._62o,v.lineCap=e._61o;var r=u(e._53o);if(r||W||Y){var F=e.shapeClipRect;F&&(v.save(),v.beginPath(),v.rect(F.x,F.y,F.width,F.height),v.clip()),ug(v,k,M,B,i,y,d),Y?nn(v,Y,function(N){return tb(N,e.bodyColor)},!1,M):W?vb(v,W,u(e.bodyColor),null,m,z):ln(v,r,e.shapeGradient,u(e._59o),M),v.fill(),Y&&v.restore(),F&&v.restore(),v!==h&&ug(h,k,M,B,i,y,d)}else ug(h,k,M,B,i,y,d);var c=e.shapeForeground;if(c){v.save();var C=e.shapeForegroundClipRect;C&&(v.beginPath(),v.rect(C.x,C.y,C.width,C.height),v.clip()),ug(v,k,M,B,i,y,d),ln(v,c,U("shape.foreground.gradient"),u(U("shape.foreground.gradient.color")),M),v.fill(),v.restore()}if(j>0){var O=U("shape.border.width.absolute");O&&(v.save(),v.setTransform(1,0,0,1,0,0)),v.lineWidth=j;var L=u(e._55o),G=e.shapeBorderGradientPack;G?nn(v,G,u,!0,M):e.shapeBorderRepeatImage?rj(v,e.shapeBorderRepeatImage,L,null,m,z):v.strokeStyle=L,v.stroke(),G&&v.restore(),O&&v.restore(),e._56o&&Bc(v,L,u(e._57o),j,z._zoom,e._58o)}if(ks(v,x),U("shape.dash")){var J=U("shape.dash.width")||j;if(J>0){x=U("shape.dash.pattern");var h=Ii(v,x,H._2Q("shape.dash.offset"));h!==v&&ug(h,k,M,B,i,y,d),H._1Q(v,"shape",J,x)}}Pd(v,r,e._63o,M),v.lineJoin=R,v.lineCap=S}else{var p=H.interactiveInfo;p&&(v.interactiveInfo=p.bodyInfo={compInfos:[],matrix:new Or(g,Q.x,Q.y,P.x,P.y)}),e.gray&&(v.compGray=!0);var l=e.img;l&&l.cacheRule!=E&&(l=no(v,l,e.stretch,M.width,M.height,m,z,e.bodyColor)),_c(v,l,e.stretch,M.x,M.y,M.width,M.height,m,z,e.bodyColor),v.compGray=!1,v.interactiveInfo=E}v.restore(),t&&v.restore()}H._39O(v,e)},_48O:function(){},_47O:function(){}});var cc=function(O,e){cb(cc,this,[O,e])},ii=function(E,h,R,Z){var t=nk(E,h);return R=Z?I(R,t):Er(R,t),t?R/=t:R=0,{x:E.x+(h.x-E.x)*R,y:E.y+(h.y-E.y)*R}};gd(cc,Jo,{_3O:function(){var u,n=this,$=n._data,f=n.gv,c=n.s,Z=c(Ig),Q=$.isLooped(),G=c("edge.width"),w=n.getBodyColor("edge.color"),k=c("edge.center"),p=c("edge.offset"),B=f.getBorderColor($),h=B?c("border.width"):0,o=n.getSelectWidth(),i=$._40I,q=$._41I,U=n._78o=i&&q?{looped:Q,type:Z,width:G,center:k,color:w,repeatImage:fl(c("edge.repeat.image"),w),borderColor:B,borderWidth:h,_97o:o?n.getSelectColor():E,selectWidth:o,pattern:c("edge.pattern"),cap:c("edge.cap"),join:c("edge.join"),is3d:c("edge.3d"),_67o:c("edge.3d.color"),_66o:c("edge.3d.accuracy"),gray:c("2d.gray")}:E;if(U){var T=K.getEdgeType(Z);if(T){var l=T($,kr(n,f,$,Q,Z),f,n._19Q);l.points&&l.points.size()>1?(U.edgeTypeInfo=l,u=Nd(U.edgeTypeInfo.points)):l[hg]&&l.rect&&(U.edgeTypeInfo=l,u=l.rect)}else{var e=c("edge.source.anchor.x"),S=c("edge.source.anchor.y"),A=c("edge.target.anchor.x"),W=c("edge.target.anchor.y"),X=yg(f,$,"source"),M=yg(f,$,"target");if(Z===Qr){var y=U.points=c(rs)||Kd,C=y.size();U.segments=c("edge.segments");var v=e!==P||S!==P||bf(i),m=A!==P||W!==P||bf(q);if(!k)if(p)v||(X=ii(X,C?y.get(0):M,p,C)),m||(M=ii(M,C?y.get(C-1):X,p,C));else{var t;v||(t=Oj(X,C?y.get(0):M,ps(f,i)),t&&(X={x:t[0],y:t[1]})),m||(t=Oj(C?y.get(C-1):X,M,ps(f,q)),t&&(M={x:t[0],y:t[1]}))}u=jm(Nd(U.points),Nd(X,M))}else{var g=kr(n,f,$,Q,Z);if(n._19Q||(g=-g),Q)X=fo(X),X.x=f.getNodeRect(i).x,U.radius=g,u={x:X.x-g,y:X.y-g,width:2*g,height:2*g};else{var b=nk(X,M),Y=Er(p,b),N={x:Y,y:g},z={x:b-Y,y:g},d=Hr(M.y-X.y,M.x-X.x),R=U.mat=new Jh(d);if(U.orienAngle=d,U.angle=M.x<X.x?d+D:d,U.rect={x:N.x,y:N.y,width:z.x-N.x,height:0},U.origin=X,N=R.tf(N),N.x+=X.x,N.y+=X.y,z=R.tf(z),z.x+=X.x,z.y+=X.y,k){var I={x:b,y:0};I=R.tf(I),I.x+=X.x,I.y+=X.y,u=Nd([X,N,z,I]),U.c1=X,U.c2=I}else u=Nd(N,z);X=N,M=z}}U.sourcePoint=X,U.targetPoint=M,$._lastSourcePoint=X,$._lastTargetPoint=M}var s=0;c("edge.dash")&&(s=c("edge.dash.width")||G);var r="square"===U.cap?.71:.5;zd(u,_(s*r,G*r+h+o),U.join),n._68o(u)}},getRotation:function(l,t,Z){l=l||0;var T=this._78o;if(T){var S,H=T.angle,u=T.points,F=T.edgeTypeInfo;if(H!=E)return t?T.orienAngle+l:H+l;if(F&&F[hg])return F.getRotation?F.getRotation(this,l,t,Z):0;if(F&&F.points){var O=F.points;return S=O.size(),eg[Z]?S&&0===S%2?rn(O.get(S/2-1),O.get(S/2),t,l):l:On[Z]?rn(O.get(0),O.get(1),t,l):rn(O.get(S-2),O.get(S-1),t,l)}if(u)return S=u.size(),eg[Z]?S&&0===S%2?rn(u.get(S/2-1),u.get(S/2),t,l):0===S?rn(T.sourcePoint,T.targetPoint,t,l):l:On[Z]?rn(T.sourcePoint,S?u.get(0):T.targetPoint,t,l):rn(S?u.get(S-1):T.sourcePoint,T.targetPoint,t,l)}return l},getPosition:function(_,T,w,m,t){var D=this._78o;if(D){var $,n=D.type,X=D.points,F=D.edgeTypeInfo,U=D.sourcePoint,d=D.targetPoint;if(!n)return D.looped?{x:U.x-D.radius+T,y:U.y+w}:(t&&U&&d&&(U.x>d.x||U.x===d.x&&U.y>d.y)&&(_=so[_],w=-w),$=Ac(_,D.rect,m),$.x+=T,$.y+=w,$=D.mat.tf($),$.x+=D.origin.x,$.y+=D.origin.y,$);if(F&&F[hg])return F.getPosition?F.getPosition(this,_,T,w,m,t):{x:(U.x+d.x)/2,y:(U.y+d.y)/2};if(X){var $,h=X.size();if(eg[_]){if(h){var S=h%2;if(0===S)return Eg(X.get(h/2-1),X.get(h/2),_,T,w,m,t);$=X.get((h-S)/2)}else $={x:(U.x+d.x)/2,y:(U.y+d.y)/2};return $=Ac(_,{x:$.x,y:$.y,width:0,height:0},m),$.x+=T,$.y+=w,$}return On[_]?Eg(U,h?X.get(0):d,_,T,w,m,t):Eg(h?X.get(h-1):U,d,_,T,w,m,t)}if(F){var s=F.points,h=s.size();if(eg[_]){var S=h%2;return 0===S?Eg(s.get(h/2-1),s.get(h/2),_,T,w,m,t):($=s.get((h-S)/2),$=Ac(_,{x:$.x,y:$.y,width:0,height:0},m),$.x+=T,$.y+=w,$)}return On[_]?Eg(s.get(0),s.get(1),_,T,w,m,t):Eg(s.get(h-2),s.get(h-1),_,T,w,m,t)}}return Cm},_42:function(I){this._78o&&cc.superClass._42.call(this,I)},drawPath:function(j,v){j.beginPath();var U=v.type,H=v.points,g=v.segments,F=v.edgeTypeInfo;if(!U||H){var D=v.sourcePoint,I=D.x,C=D.y,K=v.targetPoint,k=K.x,c=K.y;if(U)if(g){var R=new oc({x:I,y:C});R.addAll(H),R.add({x:k,y:c}),xj(j,R,g)}else j.moveTo(I,C),H.each(function(g){j.lineTo(g.x,g.y)}),j.lineTo(k,c);else v.looped?j.arc(I,C,v.radius,0,a,!0):v.center?(j.moveTo(v.c1.x,v.c1.y),j.lineTo(I,C),j.lineTo(k,c),j.lineTo(v.c2.x,v.c2.y)):(j.moveTo(I,C),j.lineTo(k,c))}else F&&(F.points?xj(j,F.points,F.segments):F[hg]&&F[hg](j,F))},_80o:function(o){var T=this,v=T.s,J=T._78o,x=J.width,j=J.selectWidth,M=J.borderWidth,Y=J.repeatImage,z=o.lineJoin,w=o.lineCap,E=J.gray,H=J.pattern;o.lineJoin=J.join,o.lineCap=J.cap,T.drawPath(Ii(o,H),J);var P=v("edge.width.absolute");P&&(o.save(),o.setTransform(1,0,0,1,0,0)),j&&(o.strokeStyle=J._97o,o.lineWidth=x+2*(M+j),o.stroke()),M&&(o.strokeStyle=E?K.toGrayColor(J.borderColor):J.borderColor,o.lineWidth=x+2*M,o.stroke());var e=E?K.toGrayColor(J.color):J.color;if(Y?rj(o,Y,e,null,T._data,T.gv):o.strokeStyle=e,o.lineWidth=x,o.stroke(),J.is3d){var r=E?K.toGrayColor(J._67o):J._67o;Bc(o,e,r,x,T.gv._zoom,J._66o)}if(v("edge.dash")){H=v("edge.dash.pattern");var B=Ii(o,H,T._2Q("edge.dash.offset"));B!==o&&T.drawPath(B,J),T._1Q(o,"edge",v("edge.dash.width")||x,H)}P&&o.restore(),ks(o,H),o.lineJoin=z,o.lineCap=w},_48O:function(){},_47O:function(){}});var vi=function(V,x){cb(vi,this,[V,x])};gd(vi,mk,{_3O:function(){var Z,e,d=this,a=d.s,v=d._data,c=d.gv;if(d._88I=E,v.isExpanded()&&v.eachChild(function(z){if(bk(z)){var p=c.getBoundsForGroup(z);p&&(e||(e=[]),e.push(p),Z=jm(Z,p))}}),Z){var C=c.getLabel(v),K=a("group.type"),P=a("group.border.width")||0,y=a("group.border.width.absolute"),l=P/2;y&&(P/=c._zoom),Z=je(K,e,Z),hs(Z,v,"group.padding",1),rk(Z,P);var H=d._88I={type:K,rect:Z,_64o:Z};if(!K&&C!=E){var D,f=d.labelInfo={label:C,color:a("group.title.color"),font:a("group.title.font"),align:a("group.title.align")},Q=Tq(f,C),s=Q.width+P,o=Q.height+P,t=a("group.title.align"),q=a("group.title.orientation");if(q===Mo||q===de?(Z.height+=P,s>Z.width&&(Z.width=s)):(q===zi||q===es)&&(Z.width+=P,s>Z.height&&(Z.height=s)),D=t===zi?Z.x:t===es?Z.x+Z.width-s:Z.x+Z.width/2-s/2,q===de)H.titleRect={x:Z.x,y:Z.y+Z.height,width:Z.width,height:o},H.rect={x:Z.x,y:Z.y,width:Z.width,height:Z.height+o},f.rect={x:D,y:Z.y+Z.height,width:s,height:o};else if(q===zi){var r=H.titleRect={x:Z.x-o,y:Z.y,width:o,height:Z.height};H.rect={x:Z.x-o,y:Z.y,width:Z.width+o,height:Z.height},f.rect={x:r.x+o/2-Z.height/2,y:r.y+Z.height/2-o/2,width:Z.height,height:o},f.rotation=-Math.PI/2}else if(q===es){var r=H.titleRect={x:Z.x+Z.width,y:Z.y,width:o,height:Z.height};H.rect={x:Z.x,y:Z.y,width:Z.width+o,height:Z.height},f.rect={x:r.x+o/2-Z.height/2,y:r.y+Z.height/2-o/2,width:Z.height,height:o},f.rotation=Math.PI/2}else H.titleRect={x:Z.x,y:Z.y-o,width:Z.width,height:o},H.rect={x:Z.x,y:Z.y-o,width:Z.width,height:Z.height+o},f.rect={x:D,y:Z.y-o-l,width:s,height:o+P}}d._40O(H,a("group.border.width")/2)}else vi.superClass._3O.call(d)},getPosition:function(i,h,G,C){var $=this._88I;if($){var f=Ac(i,$.rect,C);return f.x+=h,f.y+=G,f}return vi.superClass.getPosition.apply(this,arguments)},_24O:function(v,r){var d=this._88I;(!d||d.type||"label2"===v)&&vi.superClass._24O.call(this,v,r)},_80o:function(P){var p=this,f=p._88I;if(f){var o=p._data,l=p.s,R=p.gv,$=f.type,K=f.rect,j=f._64o,e=f.titleRect,G=p.getBodyColor(),V=fl(l("group.image"),G),B=l("group.image.stretch"),a=p.getBodyColor("group.background"),Z=fl(l("group.repeat.image"),G),g=l("group.gradient.pack"),D=l("group.gradient"),x=l("group.gradient.color"),i=l("group.border.width"),S=l("group.border.color"),T=l("group.border.pattern"),h=l("group.title.orientation"),M=l("group.depth"),w=l("group.border.radius"),b=l("group.border.join"),H=l("group.border.cap"),u=l("group.border.width.absolute");u&&(i/=R._zoom);var A=S,k=l("group.border.repeat.image");if(k&&(k=fl(k,S))&&(A=Sq(P,k,S,null,o,R)),$){var X=P.lineJoin,m=P.lineCap;if(P.lineJoin=b,P.lineCap=H,V){if(P.save(),ug(P,$,K,w),P.clip(),_c(P,V,B,K.x,K.y,K.width,K.height,o,R,G),P.restore(),i>0){var z=Ii(P,T);ug(z,$,K,w),P.lineWidth=i,P.strokeStyle=A,P.stroke(),ks(P,T)}}else{var z=Ii(P,T);a||Z||g?(ug(P,$,K,w),g?nn(P,g,function(o){return tb(o,G)},!1,K):Z?vb(P,Z,G,null,o,R):ln(P,a,D,x,K),P.fill(),g&&P.restore(),P!==z&&ug(z,$,K,w)):ug(z,$,K,w),i>0&&(P.lineWidth=i,P.strokeStyle=A,P.stroke()),ks(P,T),$===Vd&&Pd(P,a,M,K)}P.lineJoin=X,P.lineCap=m}else{var I=l("group.title.background");if((!w||0>w)&&(w=0),V)_c(P,V,B,j.x,j.y,j.width,j.height,o,R,p.getBodyColor());else if(a||Z)if(Z?vb(P,Z,G,null,o,R):ln(P,a,D,x,j),0===i)ug(P,Vd,j),P.fill(),Pd(P,a,M,j);else{switch(P.beginPath(),h){case de:ok(P,j.x,j.y,j.width,j.height,w,w,0,0);break;case zi:ok(P,j.x,j.y,j.width,j.height,0,w,0,w);break;case es:ok(P,j.x,j.y,j.width,j.height,w,0,w,0);break;case Mo:ok(P,j.x,j.y,j.width,j.height,0,0,w,w)}P.fill()}if(e&&I)if(0===i)cs(P,e.x,e.y,e.width,e.height,I),Pd(P,I,M,e);else{switch(P.beginPath(),P.fillStyle=I,h){case de:ok(P,e.x,e.y,e.width,e.height,0,0,w,w);break;case zi:ok(P,e.x,e.y,e.width,e.height,w,0,w,0);break;case es:ok(P,e.x,e.y,e.width,e.height,0,w,0,w);break;case Mo:ok(P,e.x,e.y,e.width,e.height,w,w,0,0)}P.fill()}if(i>0){var z=Ii(P,T);if(ug(z,"roundRect",K,w),P.save(),P.lineWidth=i,P.strokeStyle=A,P.lineJoin=b,P.lineCap=H,P.closePath(),P.stroke(),e&&l("group.splitLine")){var Y=e.x,F=e.y,t=e.width,r=e.height;P.beginPath(),h===de?(P.moveTo(Y,F),P.lineTo(Y+t,F)):h===zi?(P.moveTo(Y+t,F),P.lineTo(Y+t,F+r)):h===es?(P.moveTo(Y,F),P.lineTo(Y,F+r)):(P.moveTo(Y,F+r),P.lineTo(Y+t,F+r))}P.stroke(),P.restore(),ks(z,T)}}p._39O(P,f)}else vi.superClass._80o.call(p,P)}});var Xm=function(T,n){cb(Xm,this,[T,n])};gd(Xm,mk,{_80o:function(I){this._39O(I,this._83o)}});var wl=function(l,Y){cb(wl,this,[l,Y])};gd(wl,mk,{_3O:function(){var j=this,S=j._data,r=j.s,K=j.gv,e=S.getPoints(),h=K.getBorderColor(S),N=h?r("border.width"):0,O=j.getSelectWidth(),X=r("shape.border.width"),w=S.getRect(),y=S.getAnchorRect(),R=K.getBodyColor(S),l=r("shape.border.color"),H=j._99o=e.isEmpty()?E:{rect:w,rotation:S.getRotation(),fillRule:r("shape.fill.rule"),scale:S.getScale(),position:S.p(),points:e,segments:S.getSegments(),bodyColor:R,borderColor:h,borderWidth:N,_94o:r("shape.border.3d"),_95o:r("shape.border.3d.color"),_96o:r("shape.border.3d.accuracy"),_97o:O?j.getSelectColor():E,selectWidth:O,_53o:r("shape.background"),_27Q:fl(r("shape.repeat.image"),R),shapeGradientPack:r("shape.gradient.pack"),shapeBorderGradientPack:r("shape.border.gradient.pack"),_54o:X,_55o:l,shapeBorderRepeatImage:fl(r("shape.border.repeat.image"),l),shapeGradient:r("shape.gradient"),_59o:r("shape.gradient.color"),_60o:r("shape.border.pattern"),_61o:r("shape.border.cap"),_62o:r("shape.border.join"),shapeForeground:r("shape.foreground"),gray:r("2d.gray")};if(H){y.x+=H.position.x,y.y+=H.position.y,H.gradientRect=y;var u=S.getScale(),q=_(1,_(B(u.x),B(u.y)));r("shape.dash")&&r("shape.dash.width")>X&&(X=r("shape.dash.width"));var t,U=r("shape.border.width.absolute");t=U?(X+N+O)/j.gv._zoom/q:X*("square"===H._61o?.71:.5)+N+O/j.gv._zoom/q,t&&(t*=q,w=fo(w),zd(w,t,H._62o)),j._68o(w);var g=r("clip.percentage");g!=P&&(H.clipRect=fg(S.getAnchorRect(),r("clip.direction"),g));var Q=r("shape.fill.clip.percentage");Q!=P&&(H.shapeClipRect=fg(S.getAnchorRect(),r("shape.fill.clip.direction"),Q));var k=r("shape.foreground.clip.percentage");k!=P&&(H.shapeForegroundClipRect=fg(S.getAnchorRect(),r("shape.foreground.clip.direction"),k))}},getPosition:function(z,q,p,P){var O=this._99o;if(O){var Q=Ac(z,O.rect,P);return Q.x+=q,Q.y+=p,Q}return Cm},_42:function(X){this._99o&&wl.superClass._42.call(this,X)},_80o:function(u){var f,B=this,p=B.s,$=B._99o,d=$.position,k=$.scale,V=$.rotation,w=$.borderWidth,Z=B.gv._zoom,a=$.selectWidth/Z,j=$._27Q,F=$.shapeGradientPack,e=$._54o,c=$.clipRect,W=$.shapeClipRect,x=$.points,S=$.segments,t=B._data.isClosePath(),D=$.fillRule,L=$.gray,O=function(y){return L?K.toGrayColor(y):y},U=O($._53o),n=U||j||F;u.save(),xc(u,d.x,d.y),pl(u,V),Hl(u,k.x,k.y),c&&(u.beginPath(),u.rect(c.x,c.y,c.width,c.height),u.clip()),n&&W&&(u.save(),u.beginPath(),u.rect(W.x,W.y,W.width,W.height),u.clip());var J=fo($.rect);h.Default.extractShapeTranslation?(x=fo(x),x.forEach(function(h){h.x-=d.x,h.y-=d.y}),J.x-=d.x,J.y-=d.y):xc(u,-d.x,-d.y);var q=p("shape.border.width.absolute"),Y=$._60o;q&&Y&&(Y=Y.map(function(L){return L*Z}));var M=Ii(u,Y),z=u.lineJoin,s=u.lineCap;u.lineJoin=$._62o,u.lineCap=$._61o;var I=O($.bodyColor);n?(xj(u,x,S,t),F?nn(u,F,function(p){return tb(p,$.bodyColor)},!1,J):j?vb(u,j,I,null,B._data,B.gv):(f=I?I:U,ln(u,f,$.shapeGradient,O($._59o),$.gradientRect)),u.fill(D),F&&u.restore(),W&&(u.restore(),xc(u,-d.x,-d.y)),M!==u&&xj(M,x,S,t)):xj(M,x,S,t);var G=$.shapeForeground;if(G){u.save();var A=$.shapeForegroundClipRect;A&&(xc(u,d.x,d.y),u.beginPath(),u.rect(A.x,A.y,A.width,A.height),u.clip(),xc(u,-d.x,-d.y)),xj(u,x,S,t),ln(u,G,p("shape.foreground.gradient"),O(p("shape.foreground.gradient.color")),$.gradientRect),u.fill(D),u.restore()}if(q&&(u.save(),u.setTransform(1,0,0,1,0,0)),a&&(u.strokeStyle=$._97o,u.lineWidth=e+2*(w+a),u.stroke()),w&&(u.strokeStyle=O($.borderColor),u.lineWidth=e+2*w,u.stroke()),e){f=O($._55o);var R=$.shapeBorderGradientPack;R?nn(u,R,O,!0,J):$.shapeBorderRepeatImage?rj(u,$.shapeBorderRepeatImage,f,null,B._data,B.gv):(!U&&I&&(f=I),u.strokeStyle=f),u.lineWidth=e,u.stroke(),R&&u.restore(),$._94o&&Bc(u,f,O($._95o),e,Z,$._96o)}if(ks(u,Y),p("shape.dash")){var g=p("shape.dash.width")||e;if(g>0){Y=p("shape.dash.pattern"),q&&(Y=Y.map(function(m){return m*Z}));var M=Ii(u,Y,B._2Q("shape.dash.offset"));M!==u&&xj(M,x,S,t),B._1Q(u,"shape",g,Y)}}q&&u.restore(),u.lineJoin=z,u.lineCap=s,u.restore()},_48O:function(){},_47O:function(){}});var gk=function(I,k){cb(gk,this,[I,k])};gd(gk,wl,{getRotation:function(){var V=new Vl,e=new Vl,R=new Or;return function(H,j,m){H=H||0;var n=this._data,S=n.getPoints(),L=S.size();if(L>1){var P,E,B=n.p(),O=n.getScale();if(R.identity().translate(-B.x,-B.y).scale(O.x,O.y).translate(B.x,B.y),eg[m]){var g=L%2,M=(L-g)/2;P=S.get(M-1),E=S.get(M)}else On[m]?(P=S.get(0),E=S.get(1)):(P=S.get(L-2),E=S.get(L-1));return R.apply(P,V),R.apply(E,e),rn(V,e,j,H)}return H}}(),getPosition:function(){var C=new Vl,N=new Vl,O=new Vl;return function(K,z,k,T,Z){var G=this._data,B=G.getPoints(),Q=B.size();if(Q>1){var J,F,D=G.getPointsMatrix2d();if(eg[K]){var P=Q%2,v=(Q-P)/2;if(J=B.get(v-1),F=B.get(v),0!==P){var a=Ac(K,Cm,T);return a.x+=z,a.y+=k,D.apply(J,C),D.apply(F,N),D.identity().rotate(O.copy(N).sub(C).angle()).apply(a,C).add(N)}}else On[K]?(J=B.get(0),F=B.get(1)):(J=B.get(Q-2),F=B.get(Q-1));return D.apply(J,C),D.apply(F,N),Eg(C,N,K,z,k,T,Z)}return Cm}}()});var Ad=function(l,w){cb(Ad,this,[l,w])};gd(Ad,mk,{_3O:function(){var d=this;Ad.superClass._3O.call(d);var b=d.s,p=d._83o;d._82o=p.img||p.shape?E:{background:d.getBodyColor("grid.background"),depth:b("grid.depth"),rect:p.rect,_88o:b("grid.cell.depth"),cellBorderColor:b("grid.cell.border.color"),_89o:b("grid.row.count"),_90o:b("grid.column.count"),block:b("grid.block"),_91o:b("grid.block.color"),_92o:b("grid.block.padding"),_93o:b("grid.block.width")}},_80o:function(T){var C=this,M=C._82o;if(!M)return Ad.superClass._80o.call(C,T),void 0;var u,V,o=C._data,Q=M.background,K=M.rect,A=M.block,_=M._91o,b=M._92o,G=M._93o,S=M._88o,B=M.cellBorderColor,k=M._89o,h=M._90o;if(Q)if(cs(T,K.x,K.y,K.width,K.height,Q),Pd(T,Q,M.depth,K),S)for(u=0;k>u;u++)for(V=0;h>V;V++)K=o.getCellRect(u,V),K&&Pd(T,Q,S,K);else if(B){for(T.beginPath(),u=0;k>u;u++)for(V=0;h>V;V++)K=o.getCellRect(u,V),K&&T.rect(K.x,K.y,K.width,K.height);T.strokeStyle=B,T.lineWidth=1,T.stroke()}if("h"===A)for(u=0;k>u;u++)K=jm(o.getCellRect(u,0),o.getCellRect(u,h-1)),rk(K,b),di(T,_,K.x,K.y,K.width,K.height,G);else if("v"===A)for(V=0;h>V;V++)K=jm(o.getCellRect(0,V),o.getCellRect(k-1,V)),rk(K,b),di(T,_,K.x,K.y,K.width,K.height,G);C._39O(T,C._83o)}});var Ko=function(O,L){cb(Ko,this,[O,L])},Hg=f?ej().getContext("2d"):E;gd(Ko,mk,{_checkEmptyRect:!1,_81o:function(){var m=this._data,o=Ko.superClass._81o.call(this),N=m.s("text");if(N!=E){N+="";var M,d=m.s("text.font"),Z=m.s("text.align"),A=m.s("text.vAlign"),U=m.s("text.wrap"),t=m.s("text.vertical"),T=m.s("text.vertical.gap"),y=m.s("text.letter.gap")||0,C=m.getWidth(),u=m.getHeight();if(null==T&&(T=1),t){var z;z=U?Vq(N,u,d,y,t,T):[N];var b=(z.length-1)*y,g=0;Hg.textBaseline=Mo,Hg.font=d,z.forEach(function(q){for(var W=q.length,O=0,X=(W-1)*T,h=0;W>h;h++){var R=Hg.measureText(q[h]);X+=R.fontBoundingBoxDescent||_p(d,q[h]).height,O=_(O,R.width)}b+=O,g=_(X,g)});var W=(z.length-1)*y;z.forEach(function(f){W+=f}),M={width:b,height:g}}else{var z=U?Vq(N,C,d,y,t,T):N.split("\n"),a=z.length;if(a>1){var X=_p(d,N).height,b=0,g=X*a+T*(a-1);z.forEach(function(Z){b=_(b,_p(d,Z).width)}),M={width:b,height:g}}else M=_p(d,N),y&&(M.width+=(N.length-1)*y)}var w,F,j=M.width,n=M.height,h=m.getAnchor();"left"===Z?w=-C*h.x:"center"===Z?w=-C*h.x+(C-j)/2:"right"===Z&&(w=C*(1-h.x)-M.width),"top"===A?F=-u*h.y:"middle"===A?F=-u*h.y+(u-n)/2:"bottom"===A&&(F=u*(1-h.y)-M.height);var p,s=m.getMatrix();if(p=Nd([s.tf(w,F),s.tf(w+j,F),s.tf(w+j,F+n),s.tf(w,F+n)]),o=jm(o,p),o&&m.s("text.shadow")){var G=fo(o);G.x+=m.s("text.shadow.offset.x"),G.y+=m.s("text.shadow.offset.y"),rk(G,m.s("text.shadow.blur")),o=jm(o,G)}}return o}});var kq=pj.Interactor=function(z){this.gv=this._graphView=z};jp("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(j){this.gv.fi(j)},setCursor:function(z){kd||this.gv.setCursor(z)},startDragging:function(N){var _=this;_._lastClientPoint=Tk(N),_._lastLogicalPoint=_.gv.lp(N),Mj(_,N)},clearDragging:function(){var Q=this;Q._lastClientPoint=Q._lastLogicalPoint=Q._logicalPoint=E},autoScroll:function(c){return this.gv.autoScroll(c,this._lastClientPoint)}});var vf=E,dl=function(y){vf.handleWindowTouchMove(y)},Ce=function(O){vf.handleWindowTouchEnd(O),J(Q,Nf,dl),J(Q,Jk,Ce),vf=E},ap=function(p){vf.handleWindowMouseMove(p)},Od=function(A){vf.handleWindowMouseUp(A),J(Q,vg,ap),J(Q,Fh,Od),vf=E},Sk=function(z,Y){if(z!==vf){var w=_n(Y);vf?w?vf.handleWindowTouchEnd(Y):vf.handleWindowMouseUp(Y):w?(F(Q,Nf,dl),F(Q,Jk,Ce)):(F(Q,vg,ap),F(Q,Fh,Od)),vf=z}},fr=function(x){var J=this;J.gv=x,J._is2d=x instanceof pj.GraphView,J._eventListeners={},["mousedown","mousemove","mouseleave","touchstart","touchmove",Gh,"wheel"].forEach(function(h){J.addListener(h)}),J.initImageResource()};gd(fr,kq,{enableVR:function(q){var z=this;!!z._vrEnable!==q&&(z._vrEnable=q,q?z.gv.vr.mp(z.onVRControllerChange,z):z.gv.vr.ump(z.onVRControllerChange,z))},onVRControllerChange:function(M){var S=this,j=M.property,r=M.newValue,Z=r.id,s=S.gv.vr.getController(Z),V=s.getRay();if(V){V.controllerId=Z;var v=S.gv.vr.getRayEventType(V,j,r[qp]);switch(v){case"down":S.handle_mousedown(V);break;case"up":vf&&Od(V);break;case"move":S.handle_mousemove(V),vf&&S.handleWindowMouseMove(V)}}},setPreventEventDefault:function(O,T){var b=this,Q=b._eventListeners[O];Q?Q._prevent=T:b._eventListeners[O]=Q={_removal:P,_prevent:T}},removeListener:function(H){var c=this,J=c._eventListeners[H];J&&J._removal&&(J._removal(),J._removal=P)},addListener:function(c){var r=this,U=r._eventListeners[c];if(U||(r._eventListeners[c]=U={_removal:P,_prevent:!0}),!U||!U._removal){var i=function(T){U._prevent&&K.preventDefault(T),r.disabled||r.gv._48Q||("wheel"===c?Op(r,T):r["handle_"+c](T))};F(r.gv.getView(),c,i),U._removal=function(){J(r.gv.getView(),c,i)}}},handleWindowTouchMove:function(w){this.handleWindowMouseMove(w)},handleWindowMouseMove:function(W){return!this.downInfo||_n(W)&&1!==sf(W)?(this.isDragging&&(this.handleDownInfo("onEndDrag",W),this.isDragging=!1),void 0):(this.isDragging?this.handleDownInfo("onDrag",W):(this.handleDownInfo("onBeginDrag",W),this.isDragging=!0),void 0)},handleWindowTouchEnd:function(g){this.handleWindowMouseUp(g)},handleWindowMouseUp:function(U){if(this.isDragging&&(this.handleDownInfo("onEndDrag",U),this.isDragging=!1),this.downInfo){var N=this.handle("onUp",U);if(N&&N.data===this.downInfo.data){this.handleMissingUp(U);var j=this,m=2===U.button?"onContextMenu":"onClick",V=N.data;if(V.s("disableDoubleClick")||!j._dbclickTimer)return j._dbclickTimer=Jn(function(){delete j._dbclickTimer,j.handleClick(U,m,N),this.downInfo=E},K.clickDelay),void 0;Lp(j._dbclickTimer),delete j._dbclickTimer,m="onDoubleClick",j.handleClick(U,m,N)}else this.handleDownInfo("onUp",U);this.downInfo=E,this.downComps=E}},handle_mouseleave:function(Q){var B=this,d=B.gv;B._hoverTimer&&(Lp(B._hoverTimer),delete B._hoverTimer);var t=B.currentInfo?B.currentInfo.data:E;if(t){t.s("onLeave")&&t.s("onLeave")(Q,t,d),B.fire("data","onLeave",Q,t);var A=B.currentInfo?B.currentInfo.hits:E;if(A)for(var e in A)B.handleLeave(Q,e);B.currentInfo=E}},handle_mousewheel:function(W){W.scrollDelta=W.wheelDelta/40,this.handle("onScroll",W)},handle_DOMMouseScroll:function(s){s.scrollDelta=2===s.axis?-s.detail:0,this.handle("onScroll",s)},handle_touchstart:function(J){this.handle_mousedown(J)},handle_touchmove:function(T){this.handle("onMove",T)},handle_mousedown:function(N){this.isDragging&&(this.handleDownInfo("onEndDrag",N),this.isDragging=!1),this.downComps=[],this.downInfo=this.handle("onDown",N),this.downInfo&&Sk(this,N)},handle_mousemove:function(a){var c=this,A=c.gv;if(c._hoverTimer&&(Lp(c._hoverTimer),delete c._hoverTimer),!A._panning&&!A._moving){var F,J,p,V=c.handle("onMove",a),g=this.currentInfo?this.currentInfo.data:E,T=this.currentInfo?this.currentInfo.hits:E;if(V&&(J=V.data,p=V.hits,c._hoverTimer=Jn(function(){Lp(c._hoverTimer),delete c._hoverTimer,c.handle("onHover",a,V)},A.getHoverDelay()||K.hoverDelay)),J!==g){if(g&&(g.s("onLeave")&&g.s("onLeave")(a,g,A),this.fire("data","onLeave",a,g)),J&&(J.s("onEnter")&&J.s("onEnter")(a,J,A),this.fire("data","onEnter",a,J)),T)for(F in T)this.handleLeave(a,F);if(p)for(F in p){var j=p[F],x=J._interactPrefix=j.prefix,W=x&&J.a(x+"onEnter")||j.target.onEnter;W&&W.call(j.target,a,J,A,j.point,j.width,j.height),this.fire(j.type,"onEnter",j.event,j.data,j.image,j.comp,j.point,j),J._interactPrefix=null}}else{if(T)for(F in T)p&&p[F]||this.handleLeave(a,F);if(p)for(F in p)if(!T||!T[F]){var j=p[F],x=J._interactPrefix=j.prefix,W=x&&J.a(x+"onEnter")||j.target.onEnter;W&&W.call(j.target,a,J,A,j.point,j.width,j.height),this.fire(j.type,"onEnter",j.event,j.data,j.image,j.comp,j.point,j),J._interactPrefix=null}}this.currentInfo=V}},handle:function(e,l,B){var X,E=this,A=E.gv;if(E._is2d){if(B=B||A.getDataInfoAt(l),!B||!A.isInteractive(B.data))return;if(X=B.ui.interactiveInfo){var z,y=B.data;if(y.s(e)&&y.s(e)(l,y,A),this.fire("data",e,l,y),"body"===B.part&&X.bodyInfo)z="body",B.hits=this.handleImage(z,A.getImage(y),e,l,y,B.point,X.bodyInfo);else if("icons"===B.part&&X._38o){var q=X._38o[B.name];q&&q[B.index]&&(z="icons|"+B.name+"|"+B.index,B.hits=this.handleImage(z,B.icon,e,l,y,B.point,q[B.index]))}}return B}var y,k;if(!B)if(l&&l instanceof h.Math.Ray&&A.isVREnabled()){var m=A.vr.intersectWorld(l);if(y=m.data,k=m.intersect,A.vr.renderRayDuringInteraction(l,y,k),!y)return;var s=A.getData3dUI(y);if(X=s.interactiveInfo,!X)return;B={data:y,part:k.part,ui:s}}else{if(B=this.getDataInfoAt(l),!B)return;B&&(B={data:B.data,part:B.part})}if(A.isInteractive(B.data)){if(!k){y=B.data;var s=A.getData3dUI(y);if(B.ui=s,X=s.interactiveInfo,!X)return B;if(k=A.intersectObject(l,y),!k)return B}y.s(e)&&y.s(e)(l,y,A),this.fire("data",e,l,y);var i,P=k.part;return"body"!==P&&(i=y.s(P+".image")||y.s("shape3d."+P+".image")),i||(i=y.s("all.image")||y.s("shape3d.image")),i?(X="object"==typeof i?X[i.uuid]:X[i],X&&X.bodyInfo?(B.part="body",B.interactiveInfo=X,B.point=this._convertUVToPoint(k.uv,X,y,P,i),B.image=i,B.hits=this.handleImage("body",i,e,l,y,B.point,X.bodyInfo),B):B):B
}},_handleLeaveOrMissing:function(Y,u,C){var B="leave"===Y?this.currentInfo:this.downInfo;if(B){var N=B.interactiveInfo||B.ui.interactiveInfo;if(N){var O,w,P=B.data;if(this._is2d){if(w=this.gv.lp(u),"body"===B.part&&N.bodyInfo)O="body","leave"===Y?this.handleLeaveImage(C,O,this.gv.getImage(P),u,P,w,N.bodyInfo):this.handleMissingUpImage(O,this.gv.getImage(P),u,P,w,N.bodyInfo);else if("icons"===B.part&&N._38o){var i=N._38o[B.name];i&&i[B.index]&&(O="icons|"+B.name+"|"+B.index,"leave"===Y?this.handleLeaveImage(C,O,B.icon,u,P,w,i[B.index]):this.handleMissingUpImage(O,B.icon,u,P,w,i[B.index]))}}else{if(!N.bodyInfo)return;var e=this.gv.intersectObject(u,P);w=e&&e.uv?this._convertUVToPoint(e.uv,N,P,e.part,B.image):{x:1/0,y:1/0},"leave"===Y?this.handleLeaveImage(C,"body",B.image,u,P,w,N.bodyInfo):this.handleMissingUpImage("body",B.image,u,P,w,N.bodyInfo)}}}},handleClick:function(W,V,A){var r=this,R=this.downInfo;if(R&&A){var K,x=A.interactiveInfo||A.ui.interactiveInfo,a=A.data,Z=this.gv;if(a.s(V)&&a.s(V)(W,a,Z),r.fire("data",V,W,a),x)if(this._is2d){if(R.part===A.part){var j=Z.lp(W);"body"===A.part&&x.bodyInfo&&(K="body",this.handleClickImage(K,Z.getImage(a),V,W,a,j,x.bodyInfo,A))}}else{if(!x.bodyInfo)return;var O=Z.intersectObject(W,a);if(!O)return;j=this._convertUVToPoint(O.uv,x,a,O.part,R.image),this.handleClickImage("body",R.image,V,W,a,j,x.bodyInfo,A)}}},handleDownInfo:function(B,U){if(this.downInfo){var S=this.downInfo,m=this.gv,z=S.interactiveInfo||S.ui.interactiveInfo;if(z){var L,u=S.data;if(u.s(B)&&u.s(B)(U,u,m),this.fire("data",B,U,u),this._is2d){var x=m.lp(U);if("body"===S.part&&z.bodyInfo)L="body",this.handleDownInfoImage(L,m.getImage(u),B,U,u,x,z.bodyInfo);else if("icons"===S.part&&z._38o){var o=z._38o[S.name];o&&o[S.index]&&(L="icons|"+S.name+"|"+S.index,this.handleDownInfoImage(L,S.icon,B,U,u,x,o[S.index]))}}else{if(!z.bodyInfo)return;var A;if("onBeginDrag"===B?(A=m._raycaster.intersectObjectAndRecordTriangle(U,u),A&&(z.beginDragIntersectInfo=A.triangleInfo)):A=m.intersectObject(U,u),!A&&("onDrag"!==B&&"onEndDrag"!==B||!z.beginDragIntersectInfo||(A=m._raycaster.intersectLastTriangle(U,z.beginDragIntersectInfo)),!A))return;x=this._convertUVToPoint(A.uv,z,u,A.part,S.image),this.handleDownInfoImage("body",S.image,B,U,u,x,z.bodyInfo)}}}},fire:function(N,Q,n,l,O,m,Y,d){this.gv.fi({kind:Q,type:N,event:n,data:l,image:O,comp:m,view:this.gv,point:Y,width:d?d.width:P,height:d?d.height:P})},handleImage:function(D,y,K,t,s,r,L){var Z={};if(y&&(y=fl(y))){var z=this.gv,A=L.rect,p=this.convertPoint(r,L);p.inRect&&(y[K]&&y[K](t,s,z,p,A.width,A.height),this.fire("image",K,t,s,y,P,p,A),Z[D+"|image"]={target:y,type:"image",image:y,data:s,event:t,point:p,width:A.width,height:A.height});for(var $,m=L.compInfos,a=y,g=m.length-1;g>=0;g--){var B=m[g],h=B.comp;if(p=this.convertPoint(r,B,a,h,z,s),p.inRect){A=B.rect;var Q=s._interactPrefix=B.prefix,e=Q&&s.a(Q+K)||h[K];if(e&&($=e.call(h,t,s,z,p,A.width,A.height)),this.fire("comp",K,t,s,y,h,p,A),$!==!0&&(y=A.image)&&(y[K]&&($=y[K](t,s,z,p,A.width,A.height)),this.fire("image",K,t,s,y,P,p,A)),s._interactPrefix=null,Z[D+"|"+g]={target:h,type:"comp",comp:h,image:y,data:s,event:t,point:p,width:A.width,height:A.height,prefix:Q},this.downComps&&this.downComps.push(h),y&&(Z[D+"|"+g+"|image"]={target:y,type:"image",image:y,data:s,event:t,point:p,width:A.width,height:A.height,prefix:Q}),$===!0)break}}}return Z},handleLeave:function(I,v){return this._handleLeaveOrMissing("leave",I,v)},handleMissingUp:function(P){return this._handleLeaveOrMissing("missing",P)},handleLeaveImage:function(N,u,w,C,T,D,Z){if(w&&(w=fl(w))){var v=this.gv,g=Z.rect,x=this.convertPoint(D,Z);N===u+"|image"&&(w.onLeave&&w.onLeave(C,T,v,x,g.width,g.height),this.fire("image","onLeave",C,T,w,P,x,g));for(var A,R=Z.compInfos,K=w,b=R.length-1;b>=0;b--){var z=R[b],i=z.comp;x=this.convertPoint(D,z,K,i,v,T),g=z.rect;var y=T._interactPrefix=z.prefix;if(N===u+"|"+b){var a=y&&T.a(y+"onLeave")||i.onLeave;a&&(A=a.call(i,C,T,v,x,g.width,g.height)),this.fire("comp","onLeave",C,T,w,i,x,g)}if(A!==!0&&(w=g.image)&&N===u+"|"+b+"|image"&&(w.onLeave&&(A=w.onLeave(C,T,v,x,g.width,g.height)),this.fire("image","onLeave",C,T,w,P,x,g)),T._interactPrefix=null,A===!0)break}}},handleMissingUpImage:function(A,C,t,_,p,Z){var J="onUp",f=this.downInfo.hits;if(f&&C&&(C=fl(C))){var D=this.gv,r=Z.rect,T=this.convertPoint(p,Z);!T.inRect&&f[A+"|image"]&&(C[J]&&C[J](t,_,D,T,r.width,r.height),this.fire("image",J,t,_,C,P,T,r));for(var M,i=Z.compInfos,z=C,$=i.length-1;$>=0;$--){var W=i[$],j=W.comp;if(T=this.convertPoint(p,W,z,j,D,_),!T.inRect){r=W.rect;var x=_._interactPrefix=W.prefix;if(f[A+"|"+$]){var X=x&&_.a(x+J)||j[J];X&&(M=X.call(j,t,_,D,T,r.width,r.height)),this.fire("comp",J,t,_,C,j,T,r)}if(M!==!0&&(C=r.image)&&f[A+"|"+$+"|image"]&&(C[J]&&(M=C[J](t,_,D,T,r.width,r.height)),this.fire("image",J,t,_,C,P,T,r)),_._interactPrefix=null,M===!0)break}}}},handleDownInfoImage:function(f,x,v,A,t,Y,s){var X=this.downInfo.hits;if(X&&x&&(x=fl(x))){var V=this.gv,S=s.rect,Z=this.convertPoint(Y,s);X[f+"|image"]&&(x[v]&&x[v](A,t,V,Z,S.width,S.height),this.fire("image",v,A,t,x,P,Z,S));for(var l,e=s.compInfos,F=x,k=e.length-1;k>=0;k--){var I=e[k],C=I.comp;Z=this.convertPoint(Y,I,F,C,V,t),S=I.rect;var h=t._interactPrefix=I.prefix,E=["onDrag","onEndDrag"].indexOf(v)>=0;if(!E&&X[f+"|"+k]||E&&this.downComps&&this.downComps.indexOf(C)>=0){var j=h&&t.a(h+v)||C[v];j&&(l=j.call(C,A,t,V,Z,S.width,S.height)),this.fire("comp",v,A,t,x,C,Z,S)}if(l!==!0&&(x=S.image)&&X[f+"|"+k+"|image"]&&(x[v]&&(l=x[v](A,t,V,Z,S.width,S.height)),this.fire("image",v,A,t,x,P,Z,S)),t._interactPrefix=null,l===!0)break}}},handleClickImage:function(r,X,J,C,T,U,K,x){var e=this.downInfo.hits,H=x.hits;if(e&&X&&(X=fl(X))){var R=this.gv,b=K.rect,n=this.convertPoint(U,K);e[r+"|image"]&&(X[J]&&X[J](C,T,R,n,b.width,b.height),this.fire("image",J,C,T,X,P,n,b));for(var $,i=K.compInfos,S=X,t=i.length-1;t>=0;t--){var F=i[t],D=F.comp;n=this.convertPoint(U,F,S,D,R,T),b=F.rect;var f=T._interactPrefix=F.prefix;if(e[r+"|"+t]&&H[r+"|"+t]){var G=f&&T.a(f+J)||D[J];G&&($=G.call(D,C,T,R,n,b.width,b.height)),this.fire("comp",J,C,T,X,D,n,b)}if($!==!0&&(X=b.image)&&e[r+"|"+t+"|image"]&&(X[J]&&($=X[J](C,T,R,n,b.width,b.height)),this.fire("image",J,C,T,X,P,n,b)),T._interactPrefix=null,$===!0)break}}},initImageResource:function(){K.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},_convertUVToPoint:function(f,X,u,v,x){if(!f)return{x:1/0,y:1/0};var j=X.bodyInfo.rect;if(u&&x){var O,h;if("body"===v?(h=u.s("shape3d.uv.scale"),O=u.s("shape3d.uv.offset")):(h=u.s(v+".uv.scale")||u.s("all.uv.scale"),O=u.s(v+".uv.offset")||u.s("all.uv.offset")),h||O){x=K.getImage(x);var s=Uj.isPOT(x.width)&&Uj.isPOT(x.height),w=f.x*(h?h[0]:1)+(O?O[0]:0),U=f.y*(h?h[1]:1)+(O?O[1]:0);s&&(w=w%1+(w>0?0:1),U=U%1+(U>0?0:1)),f.set(w,U)}}var T=f.clone(),z=f.multiply({x:j.width,y:j.height});return z.local=T,z},convertPoint:function(o,n,H,s,z,c){var S=n.rect,X=n.matrix.applyInverse(o).sub(S),O=X.x>=0&&X.y>=0&&X.x<=S.width&&X.y<=S.height;if(!O)return X;if(s&&as(s.pixelPerfect,c,z)){var S,U=1;this._is2d?(U=z.getZoom(),S=lr(o.x,o.y,P,U)):S=lr(o.x,o.y);var m=!1,Q=S.x,y=S.y,j=S.width,F=S.height,N=K.hitMaxArea,$=j*F*U*U;if($>N){var V=Math.sqrt(N/$);U*=V}j*=U,F*=U,2>j&&(j=2),2>F&&(F=2),Q*=U,y*=U;var r=Le(j,F),T=new Or(0,-Q,-y,U,U);T.append(n.matrix),z._drawForChecking=!0,s.transform=T;var G=H.fitSize;n.refRect&&n.refRect.fitSize?(s.refRect=n.refRect,H.fitSize=!0):H.fitSize=!1;var k=H.comps;H.comps=[s],Pp(r,H,0,0,j,F,c,self),H.comps=k,H.fitSize=G,delete s.refRect,delete s.unionRect,delete s.transform,z._drawForChecking=!1;try{for(var Y=0,A=r.getImageData(0,0,j,F).data;Y<A.length;Y+=4)if(0!==A[Y+3]){m=!0;break}r.restore()}catch(f){Ar=E,m=!1}X.inRect=m}else X.inRect=!0;return X},getDataInfoAt:function(t,w){return Qs.prototype.getDataInfoAt.call(this,t,w)}});var Vn=pj.DefaultInteractor=function(q){cb(Vn,this,[q])};jp("DefaultInteractor",kq,{handle_mousedown:function(i){up(i);var F=this,W=F.gv,h=W.getDataAt(i);if(W.setFocus(i)&&!W._editing&&!W._scrolling){dh(i)?W.handleDoubleClick(i,h):W.handleClick(i,h);var P=Ym(i);!Vo()&&!P&&h&&(W.isMovable(h)||W._39Q(h))||!W.isPannable()||!kp(i)&&!P||Bj(i)||(F._tx=W.tx(),F._ty=W.ty(),F.startDragging(i))}},handleWindowMouseUp:function(Z){var Q=this,G=Q.gv;G._panning&&(delete G._panning,G.onPanEnded(),Q.fi({kind:"endPan",event:Z})),delete Q._tx,delete Q._ty,Q.clearDragging()},handle_mousemove:function(d){var x=this,h=x.gv;x._hoverTimer&&(Lp(x._hoverTimer),delete x._hoverTimer),x._hoverTimer=Jn(function(){x.fi({kind:"hover",event:d}),Lp(x._hoverTimer),delete x._hoverTimer},h.getHoverDelay()||K.hoverDelay)},handle_mouseleave:function(){var i=this;i._hoverTimer&&(Lp(i._hoverTimer),delete i._hoverTimer)},handleWindowMouseMove:function(y){var J=this,_=J.gv;J.fi({kind:_._panning?"betweenPan":"beginPan",event:y}),_._panning=1;var o=ns(_,y,J._lastClientPoint);_.setTranslate(J._tx+o.x,J._ty+o.y)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta)},handle_DOMMouseScroll:function(y){2===y.axis&&this.gv.handleScroll(y,-y.detail)},handle_keydown:function(q){this.gv.handleKeyDown(q)}});var qb=pj.SelectInteractor=function(a){cb(qb,this,[a])};jp("SelectInteractor",kq,{_42:function(){var p=this,K=p.gv,Z=K.getZoom(),b=p.mark,N=p.div;N||(N=p.div=Xi(),Ej(p.getView(),N));var F={};F.x=b.x*Z+K.tx(),F.y=b.y*Z+K.ty(),F.width=b.width*Z,F.height=b.height*Z,Xb(N,F),this.intersects()?(N.style.border="",N.style.background=K.getRectSelectBackground()):(N.style.background="",N.style.border="1px solid "+K.getRectSelectBorderColor())},handle_mousedown:function(I){var y=this,G=y.gv;if(y._57I=E,y.pendingClickThrough=E,!(G._editing||G._scrolling||Vo()||Ym(I))){var p=G.getDataAt(I),t=G.sm();p?Bj(I)?t.co(p)?t.rs(p):t.as(p):t.co(p)?p instanceof aq&&p.isClickThroughEnabled()&&kp(I)&&(y.pendingClickThrough=Tk(I)):t.ss(p):Bj(I)||!G.isPannable()?kp(I)&&(Bj(I)||t.cs(),G.isRectSelectable()&&(y.startDragging(I),G._77O=1)):kp(I)&&(y._57I=Tk(I))}},handle_mouseup:function(O){var v=this,G=v.gv,W=v._57I;if(W&&(nk(W,Tk(O))<=1&&G.sm().cs(),v._57I=E),v.pendingClickThrough){if(nk(v.pendingClickThrough,Tk(O))<=1){var T=G.getDataAt(O);if(T instanceof aq&&T.isClickThroughEnabled()){var M=G.getDataAt(O,function(e){var F=e.getParent()===T&&G.isSelectable(e,!0);return F});M&&(O.clickThrough=!0,G.sm().ss(M))}}v.pendingClickThrough=E}},handleWindowMouseUp:function(t){this.clear(t)},handleWindowMouseMove:function(Q){var u=this,c=u.gv;u._logicalPoint=c.lp(Q),u.mark?(u.fi({kind:"betweenRectSelect",event:Q}),c.isPannable()&&u.autoScroll(Q),u.redraw()):u.fi({kind:"beginRectSelect",event:Q}),u.mark=Nd(u._lastLogicalPoint,u._logicalPoint),u.redraw()},intersects:function(){var U=this,x=U._lastLogicalPoint,n=U._logicalPoint;return x.x>n.x||x.y>n.y},clear:function(M){var D=this,G=D.gv,s=D.mark;if(D._57I=E,D.pendingClickThrough=E,D._lastLogicalPoint){if(s){if(0!==s.width&&0!==s.height){var k=G.getDatasInRect(s,D.intersects());if(!k.isEmpty()){var d=G.sm(),g=d.toSelection(),P=um(M),T=M.altKey;k.each(function(B){d.co(B)?(!P||P&&T)&&g.remove(B):(!T||P&&T)&&g.add(B)}),d.ss(g)}}gl(D.div),delete D.div,delete D.mark,D.redraw(),D.fi({kind:"endRectSelect",event:M}),G.onRectSelectEnded()}D.clearDragging(),delete G._77O}},redraw:function(){var P=this;P._draw||(P._draw=1,Jn(function(){P.mark&&P._42(),delete P._draw},16))}});var jd=pj.MoveInteractor=function(B){cb(jd,this,[B])};jp("MoveInteractor",kq,{handle_mousedown:function(O){var n=this,L=n.gv;if(kp(O)&&!L._editing&&!L._scrolling&&!Vo()){var b=L.getSelectedDataAt(O);!b||L._39Q(b)&&!L.isMovable(b)?L._focusData=E:(n._data=b,L.handleMouseDown&&L.handleMouseDown(O,b),n.startDragging(O),L.isMovable(b)&&(L._moving=1))}},handleWindowMouseUp:function(M){var h=this,L=h.gv;L.handleMouseUp&&L.handleMouseUp(M,h._data),h.clear(M)},handleWindowMouseMove:function(N){var R=this,b=R._data,W=R.gv;if((!W._93O||!W._93O(N,b))&&W._moving){R._logicalPoint||R.fi({kind:"prepareMove",event:N});var J=R._logicalPoint?"betweenMove":"beginMove",$={kind:J,event:N},i=R._logicalPoint=W.lp(N);"beginMove"!==J||R._alreadyBeginTransaction||(R._alreadyBeginTransaction=!0,W.getDataModel().beginTransaction());var _=R._calcShift(J,N),P=_.x,C=_.y,M=R.gv.getMoveMode(N,b);M&&("x"===M?C=0:"y"===M?P=0:"xy"!==M&&(P=C=0)),W.moveSelection(P,C),R._lastLogicalPoint=i,R.autoScroll(N),R.fi($)}},_calcShift:function(){var p=this,i=p._logicalPoint,b=p._lastLogicalPoint,Q=i.x-b.x,R=i.y-b.y;return{x:Q,y:R}},clear:function(J){var r=this,A=r.gv;r._lastLogicalPoint&&(r._lastLogicalPoint=r._data=A._moving=E,r._logicalPoint&&(r.fi({kind:"endMove",event:J}),A.onMoveEnded()),r.clearDragging()),r._alreadyBeginTransaction&&(r._alreadyBeginTransaction=!1,A.getDataModel().endTransaction())}});var bm=pj.TextEditInteractor=function(d){cb(bm,this,[d]),this.init()};jp("TextEditInteractor",kq,{setUp:function(){var K=this;bm.superClass.setUp.call(K),K.gv.mp(K.handleGvPropertyChange,K)},teatDown:function(){var Y=this;bm.superClass.teatDown.call(Y),Y.gv.ump(Y.handleGvPropertyChange,Y)},handleGvPropertyChange:function(){this._editTarget&&this.endTextEdit()},init:function(){var u=this,l=this.input=f.createElement("input"),a=l.style;l.text="text",a.border="1px solid #d8d8d8",a.position="absolute",a.padding="2px 3px",a.outline="none",a.marginLeft="-90px",a.marginTop="-16px",a.backgroundColor="rgba(255,255,255, 1)",a.fontSize="14px",a.width="180px",a.height="32px",a.boxShadow="0 0 13px rgba(16,142,233, 0.5)",a.textAlign="center",a.boxSizing="border-box",F(l,"keyup",function(T){return ol(T)&&u.endTextEdit(),xq(T)?(u.endTextEdit(!0),void 0):void 0}),F(l,"focus",function(){l.select()});var y=this.textarea=f.createElement("textarea"),z=this.wrap=f.createElement("div");z.appendChild(y),a=y.style,a.margin=0,a.padding="4px",a.overflow="hidden",a.boxSizing="border-box",a.position="absolute",a.outline="none",a.backgroundColor="transparent",a.resize="none",a.textAlign="center",a.fontSize="14px",a.borderWidth=0,a.width="100%",a=z.style,a.boxSizing="border-box",a.margin=0,a.padding=0,a.position="absolute",a.boxShadow="0 0 13px rgba(16,142,233, 0.5)",a.border="1px solid #d8d8d8",a.backgroundColor="rgba(255,255,255, 1)",a.zIndex="10",F(y,"keydown",function(_){return(um()||Bj())&&ol(_)?(u.endTextEdit(),void 0):xq(_)?(u.endTextEdit(!0),void 0):(u._editTarget instanceof si||u.calculateTextareaHeight(String.fromCharCode(_.keyCode)),void 0)}),F(y,"focus",function(){y.select()});var g=function(N){N.stopPropagation()};F(l,"mousedown",g),F(l,"touchstart",g),F(y,"mousedown",g),F(y,"touchstart",g),F(y,"click",g),u.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],u.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",u.handleWindowClick=function(r){var $=u._editingDOM;if($){var U=$.getBoundingClientRect(),A=Tk(r);mg(U,A)||u.endTextEdit()}}},handle_mousedown:function(z){var k=this,Q=k.gv;if(dh(z)&&!Q._editing){var A=Q.getDataAt(z);if(A){var _=Q.getTextEditInfo(A);_&&(this._editInfo=_,this._editTarget=A,Q._editing=!0,_.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var V=this,f=V.gv,H=V._editTarget,w=V.getTargetValue(),N=V.textarea,L=V.wrap,G=this._editInfo;this.hiddenTextarea||this.createHiddenTextarea(),(null===w||w===P)&&(w=""),N.value=w,G.font&&(N.style.font=G.font),V._editingDOM=N,f.appendHTML(L),this.layoutHTML(L,H),H instanceof si?N.style.height="100%":(N.style.height="auto",this.calculateTextareaHeight()),Jn(function(){N.focus(),F(Q,"mousedown",V.handleWindowClick),F(Q,"touchstart",V.handleWindowClick)},10)},handleTextEdit:function(){var _=this,w=_.gv,S=_._editTarget,I=_.getTargetValue(),A=_.input;(null===I||I===P)&&(I=""),A.value=I,_._editingDOM=A,w.getView().appendChild(A),this.layoutHTML(A,S),Jn(function(){A.focus(),F(Q,"mousedown",_.handleWindowClick),F(Q,"touchstart",_.handleWindowClick)},10)},layoutHTML:function(f,Q){var a=this.gv,J=a.getZoom();if(Q instanceof si){var w=a.getDataUI(Q),F=w._6I,X=Q.getScale(),t=f.style;f.style.left=F.x*J+a.tx()+"px",f.style.top=F.y*J+a.ty()+"px",f.style.width=w._6I.width+"px",f.style.height=w._6I.height+"px",Qh(t,"transform","scale("+J*X.x+","+J*X.y+")"),Qh(t,"transformOrigin","0px 0px")}else if(Q instanceof xi){var F=Q.getRect(),$=F.width*J;f.style.left=(F.x+F.width/2)*J+a.tx()+"px",f.style.top=(F.y+F.height/2)*J+a.ty()+"px",f.style.width=$+"px",f.style.marginLeft=-$/2+"px"}else if(Q instanceof h.Edge){var w=a.getDataUI(Q),F=w._6I;f.style.left=(F.x+F.width/2)*J+a.tx()+"px",f.style.top=(F.y+F.height/2)*J+a.ty()+"px"}},endTextEdit:function(G){var e=this,s=e._editInfo.isMultiline?e.wrap:e.input,y=e._editInfo.isMultiline?e.textarea:e.input;G||e.setTargetValue(y.value),e.gv.getView().removeChild(s),e.gv._editing=!1,delete e._editingDOM,delete e._editTarget,J(Q,"mousedown",e.handleWindowClick),J(Q,"touchstart",e.handleWindowClick)},setTargetValue:function(m){var I=this,j=I._editTarget,g=I._editInfo,r=g.accessType,s=g.name;if(s&&r||(r="p",s="name"),"p"===r){var U=h.Default.setter(s);j[U](m)}else"a"===r?j.a(s,m):j.s(s,m)},getTargetValue:function(){var Z=this,y=Z._editTarget,T=Z._editInfo,n=T.accessType,f=T.name;if(f&&n||(n="p",f="name"),"p"===n){var g=h.Default.getter(f);return y[g]()}return"a"===n?y.a(f):y.s(f)},createHiddenTextarea:function(){this.hiddenTextarea=f.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;pointer-events: none;opacity:0;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(P,t){if(t&&this.computedStyleCache)return this.computedStyleCache;var x=this,I=Q.getComputedStyle(P),f=I.getPropertyValue("box-sizing")||I.getPropertyValue("-moz-box-sizing")||I.getPropertyValue("-webkit-box-sizing"),C=parseFloat(I.getPropertyValue("padding-bottom"))+parseFloat(I.getPropertyValue("padding-top")),r=parseFloat(I.getPropertyValue("border-bottom-width"))+parseFloat(I.getPropertyValue("border-top-width")),a=x.SIZING_STYLE.map(function(d){return d+":"+I.getPropertyValue(d)}).join(";"),w={sizingStyle:a,paddingSize:C,borderSize:r,boxSizing:f};return t&&(this.computedStyleCache=w),w},calculateTextareaHeight:function(f){f=f||"";var o=this,V=o.textarea,F=o.hiddenTextarea,C=o.wrap,T=32,E=o.calculateHTMLStyle(V,!1),G=E.paddingSize,$=E.borderSize,O=E.boxSizing,n=E.sizingStyle;F.setAttribute("style",n+";"+o.HIDDEN_TEXTAREA_STYLE),F.value=V.value+f;var l=F.scrollHeight;"border-box"===O?l+=$:"content-box"===O&&(l-=G),V.style.height=l+"px",C.style.height=Math.max(l,T)+"px",C.style.marginTop=l*-.5+"px"}});var Yn=pj.ScrollBarInteractor=function(b){cb(Yn,this,[b])};jp("ScrollBarInteractor",kq,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(S){var q=this.gv.getViewRect();return this._41o()&&(q.x+q.width-this.gv.lp(S).x)*this.gv.getZoom()<hj},isH:function(D){var $=this.gv.getViewRect();return this._40o()&&($.y+$.height-this.gv.lp(D).y)*this.gv.getZoom()<hj},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(q){if(!Yb&&kp(q)&&this.gv.isScrollBarVisible()){var o=this,G=o.isV(q),N=o.isH(q);(G||N)&&o.gv.showScrollBar(),o.gv._scrolling=G||N}},handleWindowMouseUp:function(q){this.handleWindowTouchEnd(q)},handleWindowTouchEnd:function(z){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=E,this.fi({kind:"endScroll",event:z})},handle_mousedown:function(z){this.handle_touchstart(z)},handle_touchstart:function(K){var v=this;if(v.gv.setFocus(K),up(K),v.handle_touchmove(K),!(sf(K)>1)&&v.gv._scrolling&&v.gv.isScrollBarVisible()){v._cp=Tk(K),v._tx=v.gv.tx(),v._ty=v.gv.ty();var L=v.isV(K);v._state=L?"vScroll":"hScroll",Mj(v,K),v.fi({kind:"beginScroll",event:K})}},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(D){var Q=Tk(D),y=this.gv.getViewRect(),o=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-Q.y)*o.height/y.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-Q.x)*o.width/y.width),this.fi({kind:"betweenScroll",event:D})}});var mq=pj.TouchInteractor=function(F,i){i=i||{},i.selectable===P&&(i.selectable=!0),i.movable===P&&(i.movable=!0),i.pannable===P&&(i.pannable=!0),i.pinchable===P&&(i.pinchable=!0),i.editable===P&&(i.editable=!0),this.params=i,cb(mq,this,[F])};jp("TouchInteractor",kq,{ms_edit:1,setUp:function(){var v=this;mq.superClass.setUp.call(v),kd&&v.params.editable&&v.gv.setEditInteractor(v)},tearDown:function(){var F=this;mq.superClass.tearDown.call(F),kd&&F.params.editable&&F.gv.setEditInteractor(E)},clear:function(B){var L=this,r=L.gv;r._moving&&(L.fi({kind:"endMove",event:B}),delete r._moving,r.onMoveEnded(),r.dm().endTransaction()),r._panning&&(L.fi({kind:"endPan",event:B}),delete r._panning,r.onPanEnded()),r._pinching&&(L.fi({kind:"endPinch",event:B}),delete r._pinching,r.onPinchEnded()),r._editing&&(L._46O(B),L._77I=L._node=L._edge=L._shape=L._rect=L._89I=L._index=r._editing=E),L.pendingClickThrough=L._moving=L._panning=L._pinching=L._editing=L._57I=L._data=L._beginHistory=E,L.clearDragging()},handle_touchstart:function(F){var J=this;if(!J.gv._editing){up(F),J._57I=E,J.pendingClickThrough=E;var Q=J.params,n=J.gv,B=n.sm(),x=n.getDataAt(F),U=sf(F);if(1===U){if(dh(F))return n.handleDoubleClick(F,x),void 0;n.handleClick(F,x),x&&(n.handleMouseDown&&n.handleMouseDown(F,x),J._data=x),Q.selectable||(x=E),x&&(B.co(x)?x instanceof aq&&x.isClickThroughEnabled()&&(J.pendingClickThrough=Tk(F)):B.ss(x),Q.editable&&n.isEditable(x)&&J._79I(F,x,!0)?(J._editing=1,J.startDragging(F)):Q.movable&&n.isMovable(x)&&(J._moving=1,J.startDragging(F))),x&&(n.isMovable(x)||n._39Q(x))||(J._57I=Tk(F),Q.pannable&&n.isPannable()&&(J._panning=1,J.startDragging(F),J._translate={x:n.tx(),y:n.ty()}))}else if(Q.pinchable&&2===U){if(!n.getEditInteractor()&&x){var P=fl(n.getImage(x));if(P&&as(P.scrollable,x,this))return}J._pinching=1,J.startDragging(F);var D=n.getView(),Y=n.getZoom(),j=D.getBoundingClientRect(),M=F.touches[0],H=F.touches[1],s={x:(M.clientX+H.clientX)/2-j.left,y:(M.clientY+H.clientY)/2-j.top};s.x-=n.tx(),s.y-=n.ty(),s.x/=Y,s.y/=Y,J._p=s,J._d=ro(F)}}},handle_touchend:function(v){var q=this,B=q.gv,Q=q._57I,R=q._data;if(Q&&(nk(Q,Tk(v))<=1&&!B.getDataAt(v)&&B.sm().cs(),q._57I=E),R&&B.handleMouseUp&&B.handleMouseUp(v,R),q.pendingClickThrough){if(nk(q.pendingClickThrough,Tk(v))<=1){var R=B.getDataAt(v);if(R instanceof aq&&R.isClickThroughEnabled()){var o=B.getDataAt(v,function(f){var F=f.getParent()===R&&B.isSelectable(f,!0);return F});o&&(v.clickThrough=!0,B.sm().ss(o))}}q.pendingClickThrough=E}},handleWindowTouchEnd:function(Y){this.clear(Y)},handleWindowTouchMove:function(U){var x=this,v=x.gv,o=sf(U);if(1===o){var k=Tk(U),Y=ns(v,k,x._lastClientPoint),Z=nk({x:0,y:0},Y);if(x._editing&&(x._beginHistory||(x._beginHistory=1,v.dm().beginTransaction()),v._editing=1,x._78I(U)),x._moving){if(!v._moving&&Z<K.touchMoveThreshold)return;x._beginHistory||(x._beginHistory=1,v.dm().beginTransaction()),x.handleMove(U)}else if(x._panning){if(!v._panning&&Z<K.touchMoveThreshold)return;v.setTranslate(x._translate.x+Y.x,x._translate.y+Y.y),x.fi({kind:v._panning?"betweenPan":"beginPan",event:U}),v._panning=1}}else if(2===o&&x._pinching){var f=ro(U);v.handlePinch(x._p,f,x._d),x._d=f,x.fi({kind:v._pinching?"betweenPinch":"beginPinch",event:U}),v._pinching=1}},handleMove:function(C){var c=this,r=c.gv,U=r.lp(C);r._93O&&r._93O(C,c._data)||(r.moveSelection(U.x-c._lastLogicalPoint.x,U.y-c._lastLogicalPoint.y),c._lastLogicalPoint=U,c.autoScroll(C),c.fi({kind:r._moving?"betweenMove":"beginMove",event:C}),r._moving=1)}});var h=Q.ht,id=h.graph._editor={Math:h.Math,Guide:{}};id.getStyle=function(c){var q,v=id.StyleMap;return v&&(q=v[c],q!==P)?q:id.DefaultStyleMap[c]},id.setStyle=function(X,Q){var J=id.StyleMap;J||(J=id.StyleMap={}),J[X]=Q},id.inEdit=function(g){return g._inXEdit===!0},id.startEdit=function(R){R._inXEdit=!0,id.Inject.doInject(R)},id._46O=function(O){O._inXEdit=!1,id.Inject.undoInject(O)},id.toScreenPosition=function(B,f){var x=B.tx(),j=B.ty(),z=B._zoom;return new id.Math.Vector2(f.x*z+x,f.y*z+j)},id.checkHit=function($,Y,F){return $.distanceTo(Y)<F?!0:!1},id.toWorldPosition=function(G,K){var Z=G.tx(),J=G.ty(),f=G._zoom;return{x:(K.x-Z)/f,y:(K.y-J)/f}},id.setAntialias=function(W,f){for(var z,Q=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],a=0,n=Q.length;n>a&&(z=Q[a],!(z in W));a++);W[z],W[z]=f},id.getTargetCornersOnScreen=function(d,r){if(!r)return null;var V,H=[];if(Dl(r,d)){var p=ps(d,r);V=[{x:p.x,y:p.y},{x:p.x+p.width,y:p.y},{x:p.x+p.width,y:p.y+p.height},{x:p.x,y:p.y+p.height}]}else{if(!r.getCorners)return null;V=r.getCorners()}return V.forEach(function(Q){var p=id.toScreenPosition(d,Q);H.push(p.x,p.y)}),H},id.log=function(){};var Oc;id.updateTipInfo=function(H,u,I){if(I){var A=h.Default.getLogicalPoint(H,u._canvas);A.x+=id.Icons.TipShiftX,A.y+=id.Icons.TipShiftY,Oc={helperPos:A,text:I,size:I.length}}else Oc=E},id.drawTip=function(J,y){Oc&&id.Icons.DrawIcon(y,J,id.Icons.TipHelper,Oc)};var pk=id.Inject={_modules:[]};pk.registAsModule=function(p,r){var B={},W={};for(var z in p){var S=r.prototype[z];B[z]=S}p.getBackup=function(k){return B[k]},p.getBackups=function(){return B},W.doInject=function(){for(var G in p)"getBackup"!==G&&(r.prototype[G]=p[G])},W.undoInject=function(){for(var E in p)"getBackup"!==E&&(r.prototype[E]=B[E])},pk._modules.push(W)},pk.doInject=function(P){for(var o,j=pk._modules,r=0,g=j.length;g>r;r++)o=j[r],o.doInject(P)},pk.undoInject=function(k){for(var K,T=pk._modules,O=0,$=T.length;$>O;O++)K=T[O],K.undoInject(k)};var kq=h.graph.EditInteractor=function(C){var g=this,U=f.createElement("canvas");U.className="editCanvas",U.style.position="absolute",g._uuid=h.Math.generateUUID(),g._styleMap={},g._canvas=U,g._context=U.getContext("2d"),kq.superClass.constructor.call(g,C),this._editDetail=!1,id.setAntialias(g._context,!1),g._subModules=g.initSubModule(),g._gridGuide=new id.Guide.Grid(g),g._rectGuide=new id.Guide.Rect(g),g._hoverGuide=new id.Guide.Hover(g)},Mb=kq;h.Default.def(kq,h.graph.Interactor,{ms_edit:1,ms_fire:1}),O.defineProperties(kq.prototype,{editDetail:{get:function(){var y=!!this._editDetail;return y},set:function(d){var T=this,W=T._editDetail;W!==d&&(T._editDetail=d,T.gv._editing=d,T.fp("editDetail",W,d),T.fp("pointsEditingMode",W,d),T.fi({kind:d?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(F){(!this._editDetail||F)&&(this.gv._editing=F,F||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(h){this._editing=h,this.gvEditing=h}},editingModule:{get:function(){return this._editMod}},pointsEditingMode:{get:function(){return this.editDetail},set:function(X){var R=this;R.editDetail!==X&&(X?R._tryEnterEditDetailMode():R._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var S=this._gridEnabled;if(!S)return!1;var K=this.gv;return K?!0:!0},set:function(V){V!==this._gridEnabled&&(this._gridEnabled=V,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(J){J!==this._agEnabled&&(this._agEnabled=J,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),kq.prototype.initSubModule=function(){var q=this;return[new id.Anchor(q),new id.RotateX(q),new id.MoveDummy(q),new id.Rect(q),new id.Curve(q),new id.MoveHelper(q)]},kq.prototype.getSubModule=function(W){var c,$,R,y=this._subModules;for($=0,R=y.length;R>$;$++)if(c=y[$],c.catalog===W)return c},kq.prototype.invokeSubModule=function(X,p){for(var Z,t,S,g=this,I=g._subModules,V=Array.prototype.slice.call(arguments,2),D=0,w=I.length;w>D;D++)if(Z=I[D],t=Z[X],t&&(S=t.apply(Z,V),S!=P&&p))return Z},kq.prototype.invokeSubModuleInverse=function(G,l){var v=this,h=v._subModules;if(h)for(var T,H,B,C=Array.prototype.slice.call(arguments,2),c=h.length-1;c>=0;c--)if(T=h[c],H=T[G],H&&(B=H.apply(T,C),B!=P&&l))return T},kq.prototype.setUp=function(){id.log("setUp");var O=this,k=O.gv,b=k.getView(),x=O._canvas;kq.superClass.setUp.call(O),k.setEditInteractor(O),k._79O?b.insertBefore(x,k._79O):b.appendChild(x),id.startEdit(k),O.invokeSubModule("setUp"),k.dm().mm(O._onDataModelChanged,O),k.dm().md(O._onDataPropertyChanged,O)},kq.prototype.tearDown=function(){id.log("tearDown");var x=this,Q=x.gv,b=Q.getView();x._resetCustomCursorStyle(),kq.superClass.tearDown.call(x),Q.dm().umm(x._onDataModelChanged,x),Q.dm().umd(x._onDataPropertyChanged,x),Q.setEditInteractor(null),b.removeChild(x._canvas),x._drawTimer&&(Lp(x._drawTimer),x._drawTimer=null),id._46O(Q),x.invokeSubModule("tearDown")},kq.prototype._onDataModelChanged=function(P){var d=this;("clear"===P.kind||"remove"===P.kind&&d.editDetail&&P.data===d.getSubModule("Curve").target)&&(d.editDetail=!1,d._42())},kq.prototype._onDataPropertyChanged=function(r){var $=this;if($.editDetail){var c=$.getSubModule("Curve"),b=r.data;b===c.target&&(b._writing||c._handleDataChanged(r))}},kq.prototype.clear=function(){id.log("clear")},kq.prototype.redraw=function(){this._42()},kq.prototype._42=function(){var W=this;W._drawTimer||(W._drawTimer=Jn(function(){W._drawTimer=null,W.drawImpl()},0))},kq.prototype.drawImpl=function(){var V;for(V in{_42:!0})break;return function(){var x=this,X=x._canvas,P=x.gv,O=P.getWidth(),t=P.getHeight(),k=x._context,j=h.Default.getInternal(),E=K.devicePixelRatio;(X.width!==O||X.height!==t)&&j.setCanvas(X,O,t,E),k.clearRect(0,0,X.width,X.height);var A=x._getValidSelection();k.save(),k.scale(E,E),x._gridGuide._42(),x.invokeSubModuleInverse(V,!1,k,P,A),x._rectGuide._42(),x._hoverGuide._42(),k.restore()}}(),kq.prototype._getValidSelection=function(){var d=this,X=d.gv,Q=X.sm().getSelection(),N=[];return Q.each(function(a){X.isVisible(a)&&X.isEditable(a)&&N.push(a)}),N},kq.prototype.handle_touchmove=function(h){return this.handle_mousemove(h)},kq.prototype.handle_mousemove=function(z){if(!h.Default.isDragging()){var d=this;if((d.editDetail||!Vo()&&!Ym(z))&&!d.gv._externalEditing){if(d.gvEditing=!1,d._checkEdit(z))d.gvEditing=!0;else{if(!d.getStyle("hoverGuideVisible"))return;d.hoverData=d.gv.getDataAt(z)}d._42()}}},kq.prototype.handle_touchstart=function(o){return this.handle_mousedown(o)},kq.prototype.handle_mousedown=function(A){up(A);var E=this;if((E.editDetail||!Vo()&&!Ym(A))&&!E.gv._externalEditing){if(dh(A)&&!A.clickThrough){if(E.editDetail){if(E._tryQuitEditDetailMode(A))return}else if(E._tryEnterEditDetailMode())return;E.gv.dm().beginTransaction();var d=E.invokeSubModule("handleDoubleClick",!0,A);if(E.gv.dm().endTransaction(),d)return}var n=E._checkEdit(A);n&&(E._downPosition=E._getLogicalPoint(A),E.gv.dm().beginTransaction(),n.startEdit(E,A),E.editing=!0)}},kq.prototype._checkEdit=function(e){var Z=this,w=Z.gv,M=Z._getLogicalPoint(e),A=Z.invokeSubModule("check",!0,w,e,M)||null;return Z._editMod=A,A},kq.prototype.handleWindowTouchMove=function(j){return this.handleWindowMouseMove(j)},kq.prototype.handleWindowMouseMove=function(c){var o=this,f=o._downPosition;if(f){var K=o._getLogicalPoint(c);if(K.distanceTo(f)<o.getStyle("moveSensitivity"))return;delete o._downPosition}var t=o._editMod;
t&&t.handleEdit(o.gv,c),o.redraw()},kq.prototype._getLogicalPoint=function(v){var A=this,p=h.Default.getLogicalPoint(v,A._canvas);return new id.Math.Vector2(p)},kq.prototype.handleWindowTouchEnd=function(j){return this.handleWindowMouseUp(j)},kq.prototype.handleWindowMouseUp=function(){var p;for(p in{_46O:!0})break;return function(I){var n=this;n.editing=!1,n.setCursor("default"),n.invokeSubModule(p,!1,I),n._42(),n.gv.dm().endTransaction()}}(),kq.prototype.handle_mousewheel=function(x){var R=this;up(x),R.invokeSubModule("preHandleScroll",!0)||R.gv.handleScroll(x,x.wheelDelta)},kq.prototype.handleDelete=function(){var t=this;if(!t.editDetail){t.gv.dm().beginTransaction();var o=t.invokeSubModule("handleNormalStateDelete",!0);return t.gv.dm().endTransaction(),o||t.gv.removeSelection(),void 0}t.gv.dm().beginTransaction(),t.invokeSubModule("handleDelete",!0),t.gv.dm().endTransaction(),t._42()},kq.prototype.handle_keydown=function(P){var Q=this;if((P.metaKey||P.ctrlKey)&&Q._42(),Vo(P)&&!Q.editing)return Q.gvEditing=!1,Q.setCursor("default"),Q._42(),void 0;var _=ol(P);return Q.editDetail?((_||xq(P))&&(Q.editDetail=!1,Q._42()),Q.gv.dm().beginTransaction(),Q.invokeSubModule("handle_keydown",!0,P),Q.gv.dm().endTransaction(),void 0):(Q.gv.dm().beginTransaction(),Q.invokeSubModule("handleNormalStateKeyDown",!0,P),Q.gv.dm().endTransaction(),_&&Q._tryEnterEditDetailMode(),void 0)},kq.prototype.handle_keyup=function(r){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,r),this.gv.dm().endTransaction()},kq.prototype._tryEnterEditDetailMode=function(){var I=this;return!I.editDetail&&I.invokeSubModule("canEnterEditDetailMode",!0)&&1===I._getValidSelection().length?(I.editDetail=!0,I._42(),!0):void 0},kq.prototype._tryQuitEditDetailMode=function(t){var i=this;return i.editDetail?!t||i.invokeSubModule("canQuitEditDetailMode",!0,t)?(i.editDetail=!1,i._42(),!0):!1:!1},kq.prototype.setStyle=function(n,W,A){var p=this;A?id.setStyle(n,W):p._styleMap[n]=W,"baseColor"===n&&(Mf=W),p.fp("styleChanged",null,{key:n,value:W,base:A}),p._42()},kq.prototype.getStyle=function(h){var Z=this,I=Z._styleMap[h];return I!==P?I:id.getStyle(h)},kq.prototype.setCursor=function(P){this._resetCustomCursorStyle(),h.graph.EditInteractor.superClass.setCursor.call(this,P)},kq.prototype._drawHostGuide=function(F){var I=this,Z=I._context,$=I.gv;id.Icons.DrawIcon(I,Z,id.Icons.NodeHoverGuide,F.corners);var A=F.host;if(A){var O=$.getAttachPoints(A);if(O&&O.length)for(var u=0,E=O.length;E>u;u++){var p=O[u],c=Hb($,A,0,p.offsetX||0,p.offsetY||0,p.x,p.y);c=id.toScreenPosition($,c),c.isAttach=F.attach===u,id.Icons.DrawIcon(I,Z,id.Icons.AttachPoint,c)}}},kq.prototype._resetCustomCursorStyle=function(){var v=this;if(v._customStyle){var w=this.gv.getView();w.classList&&w.classList.remove&&w.classList.remove(v._customStyle),v._customStyle=null}},kq.prototype._setRotateCursor=function(z){var c=this,U=c._cursorFactory;U||(U=c._cursorFactory=new id.CursorFactory(c));var d=U.getRotateCursor(z),Q=c.gv.getView();c._resetCustomCursorStyle(),c._customStyle=d,Q.classList&&Q.classList.add&&Q.classList.add(d)};var ci=id.Group=function(p){var h=this;h._entities=p,h._64O=0,h._position={x:0,y:0},h._scale={x:1,y:1},h._anchor={x:.5,y:.5},h._anchor2={x:.5,y:.5}};ci.prototype={},ci.prototype.constructor=ci;var te=null,dn=null;ci.findOrCreateGroup=function(P,b){if(dn===b&&te&&te.checkIsMe(P))return te;dn=b;var o=new id.Group(P);return o.getKeyOb()?(te=o,o):void 0},ci.prototype.checkIsMe=function(Z){var V=this._entities;if(V.length!==Z.length)return!1;var w,U={},E=Z.length;for(w=0;E>w;w++)U[Z[w]._id]=!0;for(w=0;E>w;w++)if(!U[V[w]._id])return!1;return!0},ci.prototype.getRotation=function(){return this._64O},ci.prototype.getPosition=function(){return this._position},ci.prototype.getAnchor=function(){return this._anchor},ci.prototype.getWidth=function(){return this._width},ci.prototype.getScale=function(){return this._scale},ci.prototype.getSize=function(){return{width:this._width,height:this._height}},ci.prototype.getHeight=function(){return this._height},ci.prototype.getKeyOb=function(){for(var f=this._entities,w=f.length-1;w>=0;w--){var x=f[w];if(this.isNode(x))return x}},ci.prototype.getAnchor2=function(){var H=this,B=H.rotateCenter;if(B)return B;var d=H.getKeyOb();if(!d)return H._anchor;var e=H._anchor2,v=d.getMatrix();return v.tf({x:d.getWidth()*(e.x-d.getAnchor().x),y:d.getHeight()*(e.y-d.getAnchor().y)})},ci.prototype.setAnchor2=function(H,h){var R=this,N=R.getKeyOb();if(N){var v,u=N.getMatrix();v="number"==typeof H?{x:H,y:h}:H;var a=u.tfi(v);R._anchor2={x:N.getAnchor().x+a.x/N.getWidth(),y:N.getAnchor().y+a.y/N.getHeight()}}},ci.prototype.setRotation=function(){},ci.prototype.beginRotate=function(C){this.rotateCenter=C.pos,this.rotateMode=C.groupRotateMode},ci.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},ci.prototype.addRotation=function(N,k,h){return"batch"===k?this._addRotationInBatchMode(N,h):"block"===k?this._addRotationInBlockMode(N,h):void 0},ci.prototype._addRotationInBlockMode=function(H,K){var I=this,u=I.rotateCenter||I.getPosition();I._entities.forEach(function(E){if(I.isNode(E)&&(!K||K(E))){var M=E.getMatrix();M.translate(-u.x,-u.y),M.rotate(H),M.translate(u.x,u.y);var D=Math.sign(E.getScale().x);E.setRotation(Hr(M.b*D,M.a*D)),E.setPosition(M.tx,M.ty)}})},ci.prototype._addRotationInBatchMode=function(v,Q){var X=this,$=X._anchor2;X._entities.forEach(function(w){if(X.isNode(w)&&(!Q||Q(w))){var j=w.getAnchor(),_=w.getMatrix(),W=_.tf({x:w.getWidth()*($.x-j.x),y:w.getHeight()*($.y-j.y)}),d=new id.Math.Matrix2d;d.set(_.a,_.b,_.c,_.d,_.tx,_.ty),d.translate(-W.x,-W.y),d.rotate(v),d.translate(W.x,W.y);var Z=Math.sign(w.getScale().x);w.setRotation(Hr(d.b*Z,d.a*Z)),w.setPosition(d.tx,d.ty)}})},ci.prototype.setPosition=function(R){var L,K,O,B,S=this,w=S._position,D=R.x-w.x,z=R.y-w.y,P=S._entities;for(K=0,O=P.length;O>K;K++)L=P[K],bk(L)&&(B=L.getPosition(),L.setPosition(B.x+D,B.y+z));S._position=R},ci.prototype.setScale=function(V,H){var g=this,X=V/g._scale.x,R=H/g._scale.y;g._adjustChildScaleOrSize(X,R,"size"),g._scale={x:V,y:H}},ci.prototype.getRect=function(){var A=this,Z=A._position,z=A._width,R=A._height;return{x:Z.x-z/2,y:Z.y-R/2,width:z,height:R}},ci.prototype.setSize=function(q,h){var g=this,q=Math.max(1,q),h=Math.max(1,h),J=q/g._width,v=h/g._height;g._adjustChildScaleOrSize(J,v,"size"),g._width=q,g._height=h},ci.prototype._adjustChildScaleOrSize=function(_,s,S){var g,$,W,o,F,i,Z,G,u,C,x,Y,a,L,m=this,e=m._position,w=m._entities,b=new id.Math.Matrix2d;for($=0,W=w.length;W>$;$++)if(g=w[$],m.isNode(g)){if(o=g.getPosition(),F=g.getRotation(),i=g.getWidth(),Z=g.getHeight(),G=g.getScale(),x=G.x*i,Y=G.y*Z,b.identity().scale(x,Y).rotate(F).translate(o.x,o.y).translate(-e.x,-e.y).rotate(-m._64O),F=Hr(b.b*Math.sign(x),b.a*Math.sign(x)),b.scale(_,s),u=Math.cos(F),C=Math.sin(F),Math.abs(u)<.001?(a=b.b/C,L=-b.c/C):(a=b.a/u,L=b.d/u),"scale"===S)g.setScale(a/i,L/Z);else if("size"===S){var R=a/G.x,V=L/G.y;g.setScale(ji(a)*Math.abs(G.x),ji(L)*Math.abs(G.y)),g.setSize(Math.max(.1,Math.abs(R)),Math.max(.1,Math.abs(V)))}b.rotate(m._64O).translate(e.x,e.y),g.setPosition(b.tx,b.ty)}},ci.prototype.getMatrix=function(){var L=this,O=L._position,g=h.Default.getInternal(),F=L._scale;return new g.Mat(L._64O,O.x,O.y,F.x,F.y)},ci.prototype.toGlobal=function(_){return this.getMatrix().tf(_)},ci.prototype.getCorners=function(){var q=this,A=q._width,p=q._height,E=q._anchor,V=-A*E.x,H=-p*E.y,J=q.getMatrix();return[J.tf(V,H),J.tf(V,H+p),J.tf(V+A,H+p),J.tf(V+A,H)]},ci.prototype.calcInfo=function(){var Q,h,m,p,K,D,z=this,N=[],n=z._entities,A=z._64O;for(p=0,K=n.length;K>p;p++)D=n[p],z.isNode(D)&&D.getCorners&&N.push.apply(N,D.getCorners());if(N.length){var r=Math.cos(-A),u=Math.sin(-A),E=1/0,M=-1/0,i=1/0,_=-1/0;for(p=0,K=N.length;K>p;p++)m=N[p],Q=m.x,h=m.y,m.x=r*Q-u*h,m.y=u*Q+r*h,E=Math.min(E,m.x),M=Math.max(M,m.x),i=Math.min(i,m.y),_=Math.max(_,m.y);z._width=(M-E)/z._scale.x,z._height=(_-i)/z._scale.y,r=Math.cos(A),u=Math.sin(A);var Y=z._anchor;Q=E+(M-E)*Y.x,h=i+(_-i)*Y.y,z._position={x:r*Q-u*h,y:u*Q+r*h}}},ci.prototype.isNode=function(X){return bk(X)?Dl(X)?X.size()?!1:!0:!0:!1},ci.prototype._42=function(u,$,F){var S,f,o,G,H,p,n,k,I=this,R=I._entities,t=I.rotateMode;for("batch"===t&&(k=I.getKeyOb()),S=0,f=R.length;f>S;S++)o=R[S],I.isNode(o)&&(p=o.getRect(),G=id.toScreenPosition(F,{x:p.x,y:p.y}),H=id.toScreenPosition(F,{x:p.x+p.width,y:p.y+p.height}),n={min:G,max:H},o===k&&(n.isKeyOb=!0),id.Icons.DrawIcon(u,$,id.Icons.GroupSubEntityRect,n))};var _b=id.CurveActiving=function(m,d){this._curve=m,this._interactor=m._interactor,this.silent=!0;for(var i in d)this[i]=d[i];delete this.silent};_b.prototype={},_b.prototype.constructor=_b,O.defineProperties(_b.prototype,{point:{get:function(){return this._point},set:function(O){var R=this;R._point=O,R.editingCtrl||R.silent||R._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(z){var j=this;j._pairs=z,j.editingCtrl&&!j.silent&&j._firePointChange()}}}),_b.prototype._firePointChange=function(){var w=this,o=w.getCurrentEditingPoint(),W=w._interactor;if(!o)return W.fi({kind:"selectPoint"}),void 0;var H=this._curve.target;if(H){var y=id.getDataMatrix(H).invert(),l=o.e;o=y.apply(id.toWorldPosition(W.gv,o)),o.e=l;var R=w._lastFirePoint;R&&Math.abs(o.x-R.x)<1e-5&&Math.abs(o.y-R.y)<1e-5&&(o.e==P&&R.e==P||Math.abs(o.e-R.e)<1e-5)||(w._lastFirePoint=o,W.fi({kind:"selectPoint",x:o.x,y:o.y,e:o.e}))}},_b.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},_b.prototype.getCurrentEditingPoint=function(){var I=this,q=I.editingCtrl;if(q){var k=I.pairs;if(k){var J=k[q.pairId];if(J){var Q=J[q.type];if(Q)return Q}}}return I._point};var Jq=id.CursorFactory=function(H){var z=this;z._interactor=H,z._rotateCursorStyles={}};Jq.prototype={},Jq.prototype.constructor=Jq,Jq.prototype.getRotateCursor=function(d){var G=this;0>d&&(d+=2*Math.PI);var Y=G._interactor,g=Y.getStyle("rotateCursorSize"),h=Y.getStyle("rotateCursorRound"),_=Math.round(180*(d/Math.PI)/h);_*h>=360&&(_=0);var x=G._rotateCursorStyles,k="htCustomRotateStyle_"+g+"_"+h+"_"+_;return x[k]||(G._produceRotateCursor(k,g,h,_),x[k]=!0),k},Jq.prototype._produceRotateCursor=function(F,p,O,L){var z=this;z._interactor;var B=z._canvas;B||(B=z._canvas=f.createElement("canvas"));var N=K.devicePixelRatio;B.width=B.height=p*N,B.style.width=B.style.height=p+" px";var P=B.getContext("2d");id.setAntialias(P,!1),P.scale(N,N);var v,h,D,Z,I,e=Math.round(p/2),y=""+e+" "+e+",auto !important;",w=4;v=Math.PI/180*L*O,P.clearRect(0,0,p,p),P.save(),P.scale(p/32,p/32),P.translate(16,15),P.rotate(v+Math.PI/2),P.beginPath(),P.moveTo(-8,0),P.lineTo(-8,w),P.lineTo(-8+w,w),P.moveTo(8,0),P.lineTo(8,w),P.lineTo(8-w,w),P.moveTo(-8,w),P.quadraticCurveTo(0,-6,8,w),P.restore(),P.lineCap="round",P.lineJoin="miter",P.strokeStyle="white",P.lineWidth=4,P.stroke(),P.strokeStyle="black",P.lineWidth=2,P.stroke(),h=JSON.stringify(B.toDataURL()),Z="cursor:url("+h+")"+y,1!==N&&(D='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+p+'px" height="'+p+'px"><image xlink:href='+h+' width="'+p+'" height="'+p+'"/></svg>',Z+="cursor:url(data:image/svg+xml;base64,"+btoa(D)+")"+y,Z+="cursor:-webkit-image-set(url("+h+")"+N+"x,url("+h+")1x)"+y),I=f.createElement("style"),I.textContent="body."+F+" *, ."+F+"{"+Z+"}",f.head.appendChild(I)};var ze=id.Guide.Grid=function(K){var z=this;z._interactor=K,z._alignmentGuideId=0,z._xAlignmentGuide=[],z._yAlignmentGuide=[]};ze.prototype={},ze.prototype.constructor=ze,O.defineProperties(ze.prototype,{gridBlockSize:{get:function(){var A=this;return A._gridBlockSize||A._interactor.getStyle("gridBlockSize")},set:function(J){this._gridBlockSize=J,this._interactor._42()}},gridThickLinesEvery:{get:function(){var P=this;return P._gridThickLinesEvery||P._interactor.getStyle("gridThickLinesEvery")},set:function(T){this._gridThickLinesEvery=T,this._interactor._42()}},gridEnabled:{get:function(){var s=this,w=s._interactor;return w.gridEnabled&&s.isValidGrid()}}}),ze.prototype._42=function(){var g=this,i=g._interactor;g.gridEnabled&&g.drawGrid(),i.alignmentGuideEnabled&&g.drawAlignmentGuide()},ze.prototype.makeMatrix=function(){var j=this,e=j._interactor.getStyle("gridAngle"),v=j._interactor.getStyle("gridRotation"),k=new id.Math.Matrix2d,B=Math.sin(e),u=Math.cos(e);return k.set(1,0,u,B,0,0),k.rotate(v),k},ze.prototype.isValidGrid=function(){var C=this,N=Math.PI,n=C._interactor,G=n.gv;if(G._zoom<n.getStyle("gridZoomThreshold"))return!1;var j=n.getStyle("gridAngle"),Z=Math.abs(180*(j%N/N)),Q=1-1e-8;return Q>Z||Z>180-Q?!1:!0},ze.prototype.drawAlignmentGuide=function(){var H=this,m=H._interactor,e=m.gv,t=m._canvas,f=m._context,v=t.width,r=t.height,Q=e.tx(),F=e.ty(),Z=e._zoom;f.beginPath(),f.strokeStyle=m.getStyle("gridAlignmentGuideColor"),f.lineWidth=1,H._xAlignmentGuide.forEach(function(w){var c=w.p*Z+Q;f.moveTo(c,0),f.lineTo(c,r)}),H._yAlignmentGuide.forEach(function(c){var O=c.p*Z+F;f.moveTo(0,O),f.lineTo(v,O)}),f.stroke()},ze.prototype.drawGrid=function(){function j(k,$,u,P){var R=id.toScreenPosition(V,Q.apply({x:k,y:$})),l=id.toScreenPosition(V,Q.apply({x:u,y:P}));q.moveTo(R.x,R.y),q.lineTo(l.x,l.y)}var S=this,X=S._interactor,Z=S.gridBlockSize,Y=S.gridThickLinesEvery,r=X.getStyle("gridThickColor"),T=X.getStyle("gridLightColor"),V=X.gv,d=X._canvas,q=X._context,H=d.width,D=d.height,Q=S.makeMatrix(),y=Q.applyInverse(id.toWorldPosition(V,{x:0,y:0})),x=Q.applyInverse(id.toWorldPosition(V,{x:H,y:0})),l=Q.applyInverse(id.toWorldPosition(V,{x:0,y:D})),G=Q.applyInverse(id.toWorldPosition(V,{x:H,y:D})),L=Math.min(y.x,x.x,l.x,G.x),_=Math.max(y.x,x.x,l.x,G.x),v=Math.min(y.y,x.y,l.y,G.y),z=Math.max(y.y,x.y,l.y,G.y);H=_-L,D=z-v;var C=Math.ceil(L/Z),E=Math.floor(_/Z),R=Math.ceil(v/Z),m=Math.floor(z/Z);V.tx(),V.ty(),V._zoom;var I,k,B;for(q.save(),q.lineWidth=1,q.beginPath(),q.strokeStyle=r,B=Math.ceil(C/Y)*Y;E>=B;B+=Y)I=B*Z,j(I,v,I,z);for(B=Math.ceil(R/Y)*Y;m>=B;B+=Y)k=B*Z,j(L,k,_,k);for(q.stroke(),q.beginPath(),q.strokeStyle=T,B=C;E>=B;B++)0!==B%Y&&(I=B*Z,j(I,v,I,z));for(B=R;m>=B;B++)0!==B%Y&&(k=B*Z,j(L,k,_,k));q.stroke(),q.restore()},ze.prototype.getAlignmentGuides=function(){var k=this;return{x:k._xAlignmentGuide,y:k._yAlignmentGuide}},ze.prototype.addAlignmentGuide=function(_,h,q){var i=this,g="x"===_?i._xAlignmentGuide:i._yAlignmentGuide,q=q?q:++i._alignmentGuideId,W={p:h,id:q};if(g.length){var E=i._findClosestAlignmentGuide(W.p,g);E.dis<0?g.splice(E.index+1,0,W):g.splice(E.index,0,W)}else g.push(W);return i._interactor._42(),q},ze.prototype.findClosest=function(g,_,Q){var G=this,q=G._interactor,H=q.gv;Q&&(g=id.toWorldPosition(H,g));var B,b,V,F=1/0,f=1/0,v=g.x,x=g.y;if(G.gridEnabled){var o=G.gridBlockSize,C=G.makeMatrix(),a=C.applyInverse(g);a=C.apply({x:Math.round(a.x/o)*o,y:Math.round(a.y/o)*o}),F=a.x-v,f=a.y-x,V=!0}if(q.alignmentGuideEnabled&&(B=G._findClosestAlignmentGuide(v,G._xAlignmentGuide).dis,b=G._findClosestAlignmentGuide(x,G._yAlignmentGuide).dis,Math.abs(B)<Math.abs(F)&&(F=B,V=!0),Math.abs(b)<Math.abs(f)&&(f=b,V=!0)),V){V=!1;var P=H._zoom,y=q.getStyle("smartGuideThreshold")/P,j={};if(Math.abs(F)<y&&"y"!==_&&(j.x=Q?F*P:F,V=!0),Math.abs(f)<y&&"x"!==_&&(j.y=Q?f*P:f,V=!0),V)return j}},ze.prototype._findClosestAlignmentGuide=function(y,E){if(!E.length)return{dis:1/0};for(var r,F=0,K=E.length-1;K-F>1;)r=Math.floor((F+K)/2),E[r].p<y?F=r:K=r;var _=E[F].p-y,e=E[K].p-y;return Math.abs(_)<=Math.abs(e)?{line:E[F],dis:_,index:F}:{line:E[K],dis:e,index:K}},ze.prototype.removeAllAlignmentGuide=function(t){var h=this;"y"!==t&&(h._xAlignmentGuide=[]),"x"!==t&&(h._yAlignmentGuide=[]),h._interactor._42()},ze.prototype.removeAlignmentGuide=function(K){for(var v,O,R,Y=this,z=Y._xAlignmentGuide,a=0;2>a;a++)for(z=0===a?Y._xAlignmentGuide:Y._yAlignmentGuide,v=0,O=z.length;O>v;v++)if(R=z[v],R.id===K)return z.splice(v,1),Y._interactor._42(),{axis:0===a?"x":"y",position:R.p};return!1},ze.prototype.adjustAlignmentGuide=function(N,Q){var l=this,d=l.removeAlignmentGuide(N);return d?(l.addAlignmentGuide(d.axis,Q,N),!0):!1};var lp=id.Guide.Rect=function(F){var O=this;O._interactor=F};lp.prototype={},lp.prototype.constructor=lp,lp.prototype.gatherRects=function(){var D,P,x,V,Y=this,v=Y._interactor.gv,M=[],p=[],_={x:M,y:p},$={},R=v.getDataModel(),X=R.a("width"),e=R.a("height");X&&e&&(D=0,P=0,x=X,V=e,M.push({node:R,type:0,p:D},{node:R,type:1,p:D+x/2},{node:R,type:2,p:D+x}),p.push({node:R,type:0,p:P},{node:R,type:1,p:P+V/2},{node:R,type:2,p:P+V}),$[R._id||0]={x:D,y:P,width:x,height:V}),R.each(function(y){if(bk(y)&&!v.isSelected(y)&&v.isVisible(y)&&v.isValidGuideLineSource(y)){var X=!1;if(v.sm().getSelection().each(function(u){X||(y.isHostOn(u)?X=!0:y.isDescendantOf(u)&&(X=!0))}),!X){var A=y.getRect();D=A.x,P=A.y,x=A.width,V=A.height,M.push({node:y,type:0,p:D},{node:y,type:1,p:D+x/2},{node:y,type:2,p:D+x}),p.push({node:y,type:0,p:P},{node:y,type:1,p:P+V/2},{node:y,type:2,p:P+V}),$[y._id]=A}}}),M.sort(function(R,q){return R.p-q.p}),p.sort(function(g,e){return g.p-e.p}),Y._grid=_,Y._87I=$},lp.prototype.gatherLines=function(S,k,W){var t,n,e,B,o,h,V,m,M,v,K,E,b=this,p=[b.findClosest({x:S.x,y:S.y},k),b.findClosest({x:S.x+S.w/2,y:S.y+S.h/2},k),b.findClosest({x:S.x+S.w,y:S.y+S.h},k)],d={},l=b._87I;W=W||255;var J,_;for(b._guideLine=[],t=0;2>t;t++)for(d={},0===t?(B="y",m=S.x,M=m+S.w):(B="x",m=S.y,M=m+S.h),n=0;3>n;n++)o=p[n],o&&isFinite(o[B])&&(J=1<<3*t+n,W&J&&(h=o[B+"Line"],V=h.node,_=V._id||0,d[_]||(d[_]=!0,E=l[_],"y"===B?(v=E.x,K=E.x+E.width):(v=E.y,K=E.y+E.height),e=h.p,b._guideLine.push({type:B,a:m,b:M,c:v,d:K,p:e,center:1===h.type}))))},lp.prototype._binarySearchClosest=function(Z,B){if(!B.length)return{dis:1/0};for(var i,s=0,Y=B.length-1;Y-s>1;)i=Math.floor((s+Y)/2),B[i].p<Z?s=i:Y=i;var U=B[s].p-Z,h=B[Y].p-Z;return Math.abs(U)<=Math.abs(h)?{line:B[s],dis:U}:{line:B[Y],dis:h}},lp.prototype.findClosest=function(G,f,K){var x=this,C=x._interactor,Q=C.gv,J=x._grid;K&&(G=id.toWorldPosition(Q,G));var F,W=x._binarySearchClosest(G.x,J.x),u=x._binarySearchClosest(G.y,J.y),R=W.dis,O=u.dis,a=Q._zoom,g=C.getStyle("smartGuideThreshold")/a,t={};return Math.abs(R)<g&&"y"!==f&&(t.x=K?R*a:R,t.xLine=W.line,F=!0),Math.abs(O)<g&&"x"!==f&&(t.y=K?O*a:O,t.yLine=u.line,F=!0),F?t:void 0},lp.prototype._42=function(){var C=this,x=C._guideLine;if(x&&!h.Default.isCtrlDown()){var E=C._interactor;if(E.getStyle("guideLineVisible")){var Z,B,M,S,t,u,f,r,I,V,T,H,v,X,d,b,j,Y=E.gv,y=E._context,K=Y.tx(),m=Y.ty(),A=Y._zoom,s=E.getStyle("guideLineTextSpacing");for(Z=0,B=x.length;B>Z;Z++)M=x[Z],r=M.type,I=M.p,V=M.a,T=M.b,H=M.c,v=M.d,X=Math.min(V,H),d=Math.max(T,v),"x"===r?(S=I*A+K,t=X*A+m,u=S,f=d*A+m):(S=X*A+K,t=I*A+m,u=d*A+K,f=t),id.Icons.DrawIcon(E,y,id.Icons.MoveLineGuide,{rect:[S,t,u,f],center:M.center}),v>=V&&T>=H||(X=V>v?v:T,d=V>v?V:H,j=d-X,"x"===r?(M.center2center||(S-=s,u=S),t=X*A+m,f=d*A+m,b=id.Icons.MoveLineGuideDistanceV):"y"===r&&(M.center2center||(t-=s,f=t),S=X*A+K,u=d*A+K,b=id.Icons.MoveLineGuideDistanceH),id.Icons.DrawIcon(E,y,b,{x0:S,y0:t,x1:u,y1:f,dis:j}))}}},lp.prototype.clear=function(){this._guideLine=null};var bd=id.Guide.Hover=function(u){var n=this;n._interactor=u};bd.prototype={},bd.prototype.constructor=bd,O.defineProperties(bd.prototype,{}),bd.prototype._42=function(){var z=this._interactor;if(z.getStyle("hoverGuideVisible")&&!z.gvEditing){var N=z.hoverData,J=z.gv;if(!bk(N)||J.isSelected(N))return z.hoverData=null,void 0;var O=ps(J,N),T=id.toScreenPosition(J,{x:O.x,y:O.y}),q=id.toScreenPosition(J,{x:O.x+O.width,y:O.y+O.height});id.Icons.DrawIcon(z,z._context,id.Icons.HoverDataRect,{min:T,max:q,color:z.getStyle("hoverGuideColor")||z.getStyle("baseColor"),borderWidth:z.getStyle("hoverGuideBorderWidth")||1,borderPattern:z.getStyle("hoverGuideBorderPattern")||[1,4]})}},id.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,rotateTipVisible:!0,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,edgeElevationEditable:!1,attachThreshold:25,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],curveTipVisible:!0,connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Xc=id.Icons={},Cd=1e4,So=null,Mf=id.DefaultStyleMap.baseColor,zb="rgb(183,232,135)",ke="rgb(255,204,153)",be=6;h.Default.setImage("Icons.RectPoint",{width:be,height:be,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Mf}},rect:[0,0,be,be]}]}),Xc.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var Y=Xc.GroupSubEntityRect.data;if(!Y)return[];var U=Y.min,k=Y.max;return[U.x,U.y,U.x,k.y,k.x,k.y,k.x,U.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Xc.GroupSubEntityRect.data.isKeyOb?Mf:Mf}}}]};var Yg=4;Xc.HoverDataRect={comps:[{type:"shape",points:{func:function(){var G=Xc.HoverDataRect.data;if(!G)return[];var u=G.min,d=G.max,n=Yg;return u.x-=n,u.y-=n,d.x+=n,d.y+=n,[u.x,u.y,u.x,d.y,d.x,d.y,d.x,u.y]}},segments:[1,2,2,2,5],background:null,borderWidth:{func:function(){return Xc.HoverDataRect.data.borderWidth}},borderColor:{func:function(){return Xc.HoverDataRect.data.color}},borderCap:"butt",borderPattern:{func:function(){return Xc.HoverDataRect.data.borderPattern}}}]},Xc.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Xc.Line.data.P1.x,Xc.Line.data.P1.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Xc.Line.data.P2.x,Xc.Line.data.P2.y],be,be]}}}]},Xc.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Xc.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Xc.Rect={comps:[{type:"shape",points:{func:function(){var g=Xc.Rect.data;if(!g)return[];var R=g.LT,_=g.LB,s=g.RB,V=g.RT;return[R.x,R.y,_.x,_.y,s.x,s.y,V.x,V.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Mf}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},rect:{func:function(){return[[Xc.Rect.data.LT.x,Xc.Rect.data.LT.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},rect:{func:function(){return[[Xc.Rect.data.LB.x,Xc.Rect.data.LB.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},rect:{func:function(){return[[Xc.Rect.data.RB.x,Xc.Rect.data.RB.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},rect:{func:function(){return[[Xc.Rect.data.RT.x,Xc.Rect.data.RT.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},visible:{func:function(){return Xc.Rect.data.L?!0:!1}},rect:{func:function(){return[[Xc.Rect.data.L.x,Xc.Rect.data.L.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},visible:{func:function(){return Xc.Rect.data.R?!0:!1}},rect:{func:function(){return[[Xc.Rect.data.R.x,Xc.Rect.data.R.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},visible:{func:function(){return Xc.Rect.data.T?!0:!1}},rect:{func:function(){return[[Xc.Rect.data.T.x,Xc.Rect.data.T.y],be,be]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Xc.Rect.data.rotation}},visible:{func:function(){return Xc.Rect.data.B?!0:!1}},rect:{func:function(){return[[Xc.Rect.data.B.x,Xc.Rect.data.B.y],be,be]}}}]};var Lo=16;h.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Mf}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Mf}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Xc.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Xc.Anchor.data.POS.x,Xc.Anchor.data.POS.y],Lo,Lo]}}}]},Xc.TipShiftX=12,Xc.TipShiftY=12;var ae=[8,28];Xc.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Xc.TipHelper.data.helperPos.x,Xc.TipHelper.data.helperPos.y,ae[0]*Xc.TipHelper.data.size,ae[1]]}},background:{func:function(){return So.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Xc.TipHelper.data.text}},rect:{func:function(){return[Xc.TipHelper.data.helperPos.x,Xc.TipHelper.data.helperPos.y,ae[0]*Xc.TipHelper.data.size,ae[1]]}},color:{func:function(){return So.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var ni=7;Xc.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Xc.ShapePoint.data.dynamicVisible}},rect:{func:function(){var E=Xc.ShapePoint.data.point,A=Xc.ShapePoint.data.size||ni;return[E,A+10,A+10]}},background:{func:function(){var o=Date.now(),a=Xc.ShapePoint.data.dynamicPeriod||1500,G=Math.sin(o%a/a*Math.PI);return"rgba(27,124,22,"+.5*G+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var d=Xc.ShapePoint.data.point,o=Xc.ShapePoint.data.size||ni;return[d,o,o]}},background:{func:function(){var J=Xc.ShapePoint.data.isEnd;return J?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Xc.ShapePoint.data.color||Mf}}},{type:"rect",visible:{func:function(){return!!Xc.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Mf}},rect:{func:function(){var H=5;return[Xc.ShapePoint.data.point,H,H]}}}]},Xc.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Xc.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Xc.ShapeBgCurve.data.P}},segments:{func:function(){return Xc.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var K=Date.now(),n=Xc.ShapeBgCurve.data.dynamicPeriod||1500,X=Math.sin(K%n/n*Math.PI);return"rgba(27,124,22,"+.3*X+")"}}},{type:"shape",points:{func:function(){return Xc.ShapeBgCurve.data.P}},segments:{func:function(){return Xc.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Xc.ShapeBgCurve.data.color||Mf}}}]};var gc=8;Xc.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var $=Xc.ShapeHighlighPoint.data;return[[$.x,$.y],gc,gc]}},background:{func:function(){return So.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var vn=10;Xc.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var c=Xc.ShapeHighlighRealPoint.data;return[[c.x,c.y],vn,vn]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Mf}}}]};var Hj=8;Xc.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var L=Xc.ShapeHighlighCtrlPoint.data,S=L.x,_=L.y,Z=Hj/2;return[S-Z,_-Z,S-Z,_+Z,S+Z,_+Z,S+Z,_-Z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return So.getStyle("shapeCtrlPointBorderColor")||Mf}}}]};var Bo=3;Xc.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Xc.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Bo,borderColor:{func:function(){return So.getStyle("curveHighlightColor")}}}]},Xc.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Xc.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Xc.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Xc.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Xc.MoveLineGuide.data.center?zb:ke}}}]};var xe=5;Xc.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var J=Xc.MoveLineGuideDistanceH.data,I=J.x0,S=J.y0;return[I,S-xe,I,S+xe]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ke},{type:"shape",points:{func:function(){var S=Xc.MoveLineGuideDistanceH.data,h=S.x1,Q=S.y1;return[h,Q-xe,h,Q+xe]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ke},{type:"text",text:{func:function(){return Math.round(Xc.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var E=Xc.MoveLineGuideDistanceH.data;return[[(E.x0+E.x1)/2,E.y0-10],20,20]}},color:ke,font:"12px Arial",align:"center"}]},Xc.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var V=Xc.MoveLineGuideDistanceV.data,L=V.x0,c=V.y0;return[L-xe,c,L+xe,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ke},{type:"shape",points:{func:function(){var a=Xc.MoveLineGuideDistanceV.data,T=a.x1,d=a.y1;return[T-xe,d,T+xe,d]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:ke},{type:"text",text:{func:function(){return Math.round(Xc.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var M=Xc.MoveLineGuideDistanceV.data;return[[M.x0-10,(M.y0+M.y1)/2],20,20]}},color:ke,font:"12px Arial",align:"center"}]},h.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Xc.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var Y=Xc.EdgeElevationGuide.data,X=Y.x,T=Y.y,K=So.getStyle("curveElevationIntersectSize"),t=So.getStyle("curveElevationGuideShift");return X+=t[0],T+=t[1],[X-K,T-K,2*K,2*K]}}}]},h.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),h.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Xc.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Xc.ConnectGuide.data.rotation}},rect:{func:function(){var X=Xc.ConnectGuide.data.connect;X.x,X.y;var F=So.getStyle("connectGuideIntersectSize");return[[X.x,X.y],2*F,2*F]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var E=Xc.ConnectGuide.data.cursorPos||Xc.ConnectGuide.data.connect,q=So.getStyle("connectGuideIntersectSize");
return[[E.x,E.y],2*q-2,2*q-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var g=Xc.ConnectGuide.data.connect,F=Xc.ConnectGuide.data.cursorPos||g;return[g.x,g.y,g.x+.5*(F.x-g.x),g.y,F.x+.5*(g.x-F.x),F.y,F.x,F.y]}}}]},h.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),h.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Xc.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var i=Xc.ConnectGuideGarbage.data.hover;return i?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var k=Xc.ConnectGuideGarbage.data,N=So.getStyle("connectGuideGarbageIntersectsize");return k.hover&&(N+=5),[[k.x,k.y],2*N,2*N]}}}]};var sq=6;Xc.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Xc.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var H=Xc.ShapeActivingCtrl.data;return[H.point.x,H.point.y,H.c1.x,H.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Mf}}},{type:"shape",visible:{func:function(){return Xc.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var x=Xc.ShapeActivingCtrl.data;return[x.point.x,x.point.y,x.c2.x,x.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Mf}}},{type:"shape",visible:{func:function(){return Xc.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var g=Xc.ShapeActivingCtrl.data.c1,z=g.x,P=g.y,k=sq/2;return"c1"===Xc.ShapeActivingCtrl.data.hl&&(k+=.5),[z-k,P-k,z-k,P+k,z+k,P+k,z+k,P-k]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Xc.ShapeActivingCtrl.data.hl?So.getStyle("shapeCtrlPointHighlightBorder")||Mf:So.getStyle("shapeCtrlPointBorderColor")||Mf}}},{type:"shape",visible:{func:function(){return Xc.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var A=Xc.ShapeActivingCtrl.data.c2,b=A.x,r=A.y,S=sq/2;return"c2"===Xc.ShapeActivingCtrl.data.hl&&(S+=.5),[b-S,r-S,b-S,r+S,b+S,r+S,b+S,r-S]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return So.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Xc.ShapeActivingCtrl.data.hl?So.getStyle("shapeCtrlPointHighlightBorder")||Mf:So.getStyle("shapeCtrlPointBorderColor")||Mf}}}]},Xc.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Mf}},rect:{func:function(){return[[Xc.RoundPoint.data.x,Xc.RoundPoint.data.y],be,be]}}}]},Xc.AttachPoint={comps:[{type:"rect",background:{func:function(){return Xc.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Mf}},rect:{func:function(){var V=Xc.AttachPoint.data.isAttach?be+4:be;return[[Xc.AttachPoint.data.x,Xc.AttachPoint.data.y],V,V]}}}]},Xc.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Xc.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Xc.SimpleRect.data.color||Mf}},rect:{func:function(){var L=Xc.SimpleRect.data;return[L.x,L.y,L.width,L.height]}}}]},h.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Xc.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var F=Xc.MoveDummy.data;return[[F.pos.x,F.pos.y],2*F.size,2*F.size]}}}]},id.Icons.DrawIcon=function(F,p,l,z){l.width=l.height=Cd,l.data=z,So=F,h.Default.drawImage(p,l,0,0,Cd,Cd),So=P},id.Icons.MapPoints=function(t,F){for(var T=0,h=t.length;h>T;T++)t[T]/=F},id.roundTo=function(I,U,y){var q=Math.abs(I%U);return y>q||y>U-q?U*Math.round(I/U):I},id.toFixed=function(m){return Math.round(100*m)/100},id.getDataMatrix=function(z){if(z instanceof h.Shape){var e=new h.Math.Matrix2d,D=z.getPosition();return e.translate(-D.x,-D.y).scale(z.getScale().x,z.getScale().y).rotate(z.getRotation()).translate(D.x,D.y),e}return z.getMatrix?z.getMatrix():new h.Math.Matrix2d};var zp=id.Math.Curve=function(){this._curves=[]};zp.prototype={},zp.prototype.constructor=zp,zp.prototype.createFromHtShape=function(m,o,J){o instanceof h.List&&(o=o.toArray());var Q,_,V,I,u,F,q,Z=this,e=null,k=null,f=0,j=id.Math.Vector2,i=id.Math.CubicBezier,G=function(y){return new j(m[y],m[y+1],J?J[y/2]:P)};for(_=0,V=o.length;V>_;_++){switch(I=o[_],u=null,I){case 1:k=G(f),e=k,f+=2;break;case 2:Q=G(f),f+=2,u=new i(k,k.clone(),Q.clone(),Q),k=Q;break;case 3:F=G(f),Q=G(f+2),f+=4,u=new i(k,F.clone().sub(k).multiplyScalar(2/3).add(k),F.clone().sub(Q).multiplyScalar(2/3).add(Q),Q),k=Q;break;case 4:F=G(f),q=G(f+2),Q=G(f+4),f+=6,u=new i(k,F,q,Q),k=Q;break;case 5:if(!e)break;u=new i(k,k.clone(),e.clone(),e),k=null,e=null}u&&(u._index=Z._curves.length,Z._curves.push(u))}},zp.prototype.checkPoint=function(S,k){var T,e,q,t,D,p=this,A=p._curves;for(T=0,e=A.length;e>T;T++)if(t=A[T],D=t.intersectRect(S,k,k),D.length)return q=0,D.forEach(function(L){q+=L.t}),q/=D.length,S=t.getPointAt(q),S.t=q,{bezier:t,intersection:S}},zp.prototype.insertKnot=function(b,e){var V=b.insertKnot(e),M=this,C=M._curves;C.splice(b._index,1,V[0],V[1])},zp.prototype._isCloseEnough=function(h,j){return Math.abs(h.x-j.x)<1e-6&&Math.abs(h.y-j.y)<1e-6},zp.prototype._isSamePoint=function(L,q){return L===q},zp.prototype.moveRealPoint=function(O,o){var D=this,A=D._curves,_=o.clone().sub(O);A.forEach(function(M){var B=M._p1;M._p2,M._p3;var Z=M._p4;D._isSamePoint(B,O)&&(M._p2.add(_),M._p1=o),D._isSamePoint(Z,O)&&(M._p3.add(_),M._p4=o)})},zp.prototype.moveCtrlDueToRealPointMovement=function(G,I){var s=this,a=s._curves,o=function(y){y.add(I),y.e&&I.e&&(y.e+=I.e)};a.forEach(function(h){var O=h._p1;h._p2,h._p3;var y=h._p4;s._isSamePoint(O,G)&&o(h._p2),s._isSamePoint(y,G)&&o(h._p3)})},zp.prototype.moveCtrlPoint=function(O,E,u){var i=O[u];if(i){i.e!==P&&(E.e=i.e);var $=this,F=$._curves;E.clone().sub(i),F.forEach(function(U){var t;"c2"===u?t="_p2":"c1"===u&&(t="_p3"),$._isSamePoint(U[t],i)&&(U[t]=E)}),O[u]=E}},zp.prototype.deleteRealPoint=function(J,T){var p,Z,A,Q,n,C,B,v=this,H=v._curves,b={},L=[],o=id.Math.CubicBezier;for(Z=0,A=H.length;A>Z;Z++)p=H[Z],Q=p._p1,n=p._p2,C=p._p3,B=p._p4,(b[Z]||!v._isSamePoint(Q,J))&&(v._isSamePoint(B,J)?A>Z+1&&v._isSamePoint(H[Z+1]._p1,J)&&(T||L.push(new o(Q,n,H[Z+1]._p3,H[Z+1]._p4))):L.push(p));v._curves=L},zp.prototype.findPairs=function(t,S){var n,C,m,f,e,Z,a,H,I=this,F=I._curves,J={},l=[];for(C=0,m=F.length;m>C;C++)n=F[C],f=n._p1,e=n._p2,Z=n._p3,a=n._p4,!J[C]&&I._isSamePoint(f,t)&&(S?l.push({point:f,r2:a}):l.push({point:f,c2:e})),I._isSamePoint(a,t)&&(H=S?{point:a,r1:f}:{point:a,c1:Z},m>C+1&&I._isSamePoint(F[C+1]._p1,t)&&(S?H.r2=F[C+1]._p4:H.c2=F[C+1]._p2,J[C+1]=!0),l.push(H));return l},zp.prototype.toHtShape=function(){var i=this,q=i._curves,o=[],l=[],c={x:1/0,y:1/0};return q.forEach(function(k){var C=k._p1,A=k._p2,t=k._p3,B=k._p4;return i._isCloseEnough(C,c)||(o.push(1),l.push(C.clone())),c=B,i._isCloseEnough(C,A)&&i._isCloseEnough(t,B)?(o.push(2),l.push(B.clone()),void 0):(o.push(4),l.push(A.clone(),t.clone(),B.clone()),void 0)}),{segments:o,points:l}};var rr=id.Math.CubicBezier=function(J,Y,B,l){var u=this;u._id=id.Math.CubicBezier._globalId++,u._p1=J,u._p2=Y,u._p3=B,u._p4=l};rr._globalId=1,rr.prototype={},rr.prototype.constructor=rr,rr.prototype.toString=function(){return this._id},rr.prototype.intersectRect=function(m,l,O){var Z=l/2,r=O/2,e=m.x,t=m.y,E=id.Math.Vector2,c=new E(-Z+e,-r+t),A=new E(Z+e,r+t),H=new E(A.x,c.y),S=new E(c.x,A.y),P=this,M=P.intersectLine(c,H),u=P.intersectLine(H,A),w=P.intersectLine(A,S),v=P.intersectLine(S,c),V=M.concat(u).concat(w).concat(v);return V},rr.prototype.intersectLine=function(m,k){var s,V,z,n,L,w,J,v,u,e,U,B,W,E=this,j=m.clone().min(k),D=m.clone().max(k);n=E._p1,L=E._p2,w=E._p3,J=E._p4,s=n.clone().multiplyScalar(-1),V=L.clone().multiplyScalar(3),z=w.clone().multiplyScalar(-3),U=s.add(V).add(z).add(J),s=n.clone().multiplyScalar(3),V=L.clone().multiplyScalar(-6),z=w.clone().multiplyScalar(3),e=s.add(V).add(z),s=n.clone().multiplyScalar(-3),V=L.clone().multiplyScalar(3),u=s.add(V),v=n.clone(),W=new id.Math.Vector2(m.y-k.y,k.x-m.x),B=m.x*k.y-k.x*m.y;for(var N=E.getRoots(W.dot(U),W.dot(e),W.dot(u),W.dot(v)+B),Q=new Array,l=0,a=N.length;a>l;l++){var A=N[l];if(!(0>A||A>1)){var C=E.getPointAt(A);C.t=A,m.x==k.x?j.y<=C.y&&C.y<=D.y&&Q.push(C):m.y==k.y?j.x<=C.x&&C.x<=D.x&&Q.push(C):C.x>=j.x&&C.y>=j.y&&C.x<=D.x&&C.y<=D.y&&Q.push(C)}}return Q},rr.prototype.solveTForPoint=function(L){var n,K,Y,m,C=this;n=C._p1.x-L.x,K=C._p2.x-L.x,Y=C._p3.x-L.x,m=C._p4.x-L.x;for(var X=C.getRoots(m-3*Y+3*K-n,3*Y-6*K+3*n,3*K-3*n,n),D=P,y=1/0,J=0,Q=X.length;Q>J;J++){var O=X[J];if(!(0>O||O>1)){var b=C.getPointAt(O);b.t=O;var p=Math.abs(b.y-L.y);y>p&&(y=p,D=b)}}return D},rr.prototype.getPointAt=function(C){var h=this,L=h._p1,c=h._p2,P=h._p3,j=h._p4,m=L.clone().lerp(c,C),a=c.clone().lerp(P,C),J=P.clone().lerp(j,C),w=m.lerp(a,C),e=a.lerp(J,C);return w.lerp(e,C)},rr.prototype.getPointByPercentage=function(M){var p=this.length*M,S=this._cacheLength,L=S.length;if(0===p)return S[0].point;if(M>=1)return S[L-1].point;for(var m=0;L>m;m++){var T=S[m];if(!(T.len<p)){var X=S[m-1];return T.point.clone().sub(X.point).setLength(p-X.len).add(X.point)}}},rr.prototype.getTByPercentage=function(Z){var O=this.length*Z,r=this._cacheLength,G=r.length;if(0===O||0>=Z)return r[0].t;if(Z>=1)return r[G-1].t;for(var U=0;G>U;U++){var H=r[U];if(!(H.len<O)){var j=r[U-1];return(O-j.len)/(H.len-j.len)*(H.t-j.t)+j.t}}},rr.prototype.getRoots=function(F,h,c,j){var n,b,k,z,S,C=new Array;if(Math.abs(F)<1e-6){var n=h,b=c/n,k=j/n,z=b*b-4*k;if(z>0){var S=Math.sqrt(z);C.push(.5*(-b+S)),C.push(.5*(-b-S))}else 0==z&&C.push(.5*-b)}h/=F,c/=F,j/=F,n=(3*c-h*h)/3,b=(2*h*h*h-9*c*h+27*j)/27;var E=h/3,o=b*b/4+n*n*n/27,Z=b/2;if(Math.abs(o)<=1e-6&&(o=0),o>0){var X,A,S=Math.sqrt(o);X=-Z+S,A=X>=0?Math.pow(X,1/3):-Math.pow(-X,1/3),X=-Z-S,X>=0?A+=Math.pow(X,1/3):A-=Math.pow(-X,1/3),C.push(A-E)}else if(0>o){var I=Math.sqrt(-n/3),V=Math.atan2(Math.sqrt(-o),-Z)/3,$=Math.cos(V),M=Math.sin(V),B=Math.sqrt(3);C.push(2*I*$-E),C.push(-I*($+B*M)-E),C.push(-I*($-B*M)-E)}else{var X;X=Z>=0?-Math.pow(Z,1/3):Math.pow(-Z,1/3),C.push(2*X-E),C.push(-X-E)}return C},rr.prototype._70I=function(){var K=this;return K._p1.distanceToSquared(K._p2)<1e-10&&K._p3.distanceToSquared(K._p4)<1e-10},rr.prototype.insertKnot=function(H){var d=this,t=d._p1,h=d._p2,D=d._p3,o=d._p4,a=t.clone().lerp(h,H),J=h.clone().lerp(D,H),s=D.clone().lerp(o,H),g=a.clone().lerp(J,H),W=J.clone().lerp(s,H),i=g.clone().lerp(W,H);return d._70I()?(t.clone().lerp(o,H),[new id.Math.CubicBezier(t,t.clone(),i.clone(),i),new id.Math.CubicBezier(i,i.clone(),o.clone(),o)]):[new id.Math.CubicBezier(t,a,g,i),new id.Math.CubicBezier(i,W,s,o)]},O.defineProperties(rr.prototype,{length:{get:function(){var u=this._cacheLength;if(!u){u=this._cacheLength=[];for(var t=this._p1,z=0,V=0;1>=z;){var H=this.getPointAt(z+=.001);V+=H.clone().sub(t).length(),t=H,u.push({len:V,t:z,point:H.clone()})}}return u[u.length-1].len}},p1:{get:function(){return this._p1},set:function(M){this._p1=M,this._cacheLength=P}},p2:{get:function(){return this._p2},set:function(E){this._p2=E,this._cacheLength=P}},p3:{get:function(){return this._p3},set:function(N){this._p3=N,this._cacheLength=P}},p4:{get:function(){return this._p4},set:function(M){this._p4=M,this._cacheLength=P}}});var cc=h.Default.getInternal().ui().EdgeUI,mm={_47O:function(g){var T=this,G=mm.getBackups()._47O;id.inEdit(T.gv)||G.call(T,g)}};id.Inject.registAsModule(mm,cc);var mk=h.Default.getInternal().ui().NodeUI,Hd={_47O:function(s){var r=this,D=Hd.getBackups()._47O;id.inEdit(r.gv)||D.call(r,s)},getSelectWidth:function(){var p=this,h=p.gv,X=p._data;if(h.isEditable(X)&&id.inEdit(h))return 0;var Z=Hd.getBackup("getSelectWidth");return Z.call(p)}};id.Inject.registAsModule(Hd,mk);var Nq=h.graph.GraphView,Xl={_editPointSize:function(){var k=h.Default.isTouchable,j=id.getStyle("pointSize");return j[k?0:1]}(),isPointEditable:function(i){var m=this;if(id.inEdit(m))return m._pointEditableFunc?m._pointEditableFunc(i):!0;var V=Xl.getBackup("isPointEditable");V.call(m,i)},isEditable:function(C){var H,L=this,R=Xl.getBackup("isEditable");if(H=C instanceof id.Group?!0:R.call(L,C),!id.inEdit(L))return H;if(!(C instanceof h.Edge))return H;if(!C.s("2d.editable"))return!1;var E=L.getEditableFunc();return E?E(C):!0},_42:function(I,B){var W=this,j=Xl.getBackups()._42;if(j.call(W,I,B),id.inEdit(W)){var g=W.getEditInteractor();g.drawImpl()}}};id.Inject.registAsModule(Xl,Nq);var wl=h.Default.getInternal().ui().ShapeUI,$b={_47O:function(Q){var $=this,A=$b.getBackups()._47O;id.inEdit($.gv)||A.call($,Q)}};id.Inject.registAsModule($b,wl);var Vn=h.graph.DefaultInteractor,Tf={handle_mousewheel:function(G){var Z=this,W=Tf.getBackup("handle_mousewheel");id.inEdit(Z.gv)||W.call(Z,G)}};id.Inject.registAsModule(Tf,Vn);var jd=h.graph.MoveInteractor,yl={_calcShift:function($,w){var t=this,W=yl.getBackup("_calcShift"),M=t.gv;if(!id.inEdit(M))return W.call(t,$,w);var B=M.getEditInteractor(),D=B.getSubModule("Move").calcShift($,w,t);return D||W.call(t,$,w)},clear:function(U){var w=this,u=yl.getBackup("clear");u.call(w,U);var b=w.gv;if(id.inEdit(b)){var x=b.getEditInteractor();x.getSubModule("Move").clear(U)}}};id.Inject.registAsModule(yl,jd);var lp=id.Rect=function(m){this.catalog="Rect",this._interactor=m};lp.prototype={},lp.prototype.constructor=lp,lp.prototype.gatherInfo=function(V,$){var a=this;if(1===$.length){var Z=$[0];return Z instanceof h.Shape&&Z._70I()?a.gatherLine(V,Z):Dl(Z,V)?!1:a.gatherSingleTarget(V,Z)}return $.length>1?a.gatherMultiTargets(V,$):!1},lp.prototype.gatherSingleTarget=function(q,E){if(E.getCorners){var T,z=this,V=z.info;z.target=E,T=z.screenInfo={};var w=E.getCorners();V.LT=new id.Math.Vector2(w[0]),V.LB=new id.Math.Vector2(w[1]),V.RB=new id.Math.Vector2(w[2]),V.RT=new id.Math.Vector2(w[3]),V.T=V.LT.clone().add(V.RT).divideScalar(2),V.B=V.LB.clone().add(V.RB).divideScalar(2),V.L=V.LT.clone().add(V.LB).divideScalar(2),V.R=V.RT.clone().add(V.RB).divideScalar(2);for(var v in V)T[v]=id.toScreenPosition(q,V[v]);var t=z._interactor,Y=t.getStyle("checkSize"),x=function(F,A,D){var e=A.clone().sub(F).setLength(-Y),r=D.clone().sub(F).setLength(-Y),u=e.add(r).add(F);return u};return T.rotLT=x(T.LT,T.RT,T.LB),T.rotLB=x(T.LB,T.LT,T.RB),T.rotRB=x(T.RB,T.LB,T.RT),T.rotRT=x(T.RT,T.LT,T.RB),T.rotT=T.rotLT.clone().add(T.rotRT).divideScalar(2),T.rotB=T.rotLB.clone().add(T.rotRB).divideScalar(2),T.rotL=T.rotLT.clone().add(T.rotLB).divideScalar(2),T.rotR=T.rotRT.clone().add(T.rotRB).divideScalar(2),T.rotation=E.getRotation(),z.gatherConnectInfo(),!0}},lp.prototype.gatherConnectInfo=function(){var B=this,v=B.target,J=B._interactor,w=B.screenInfo,T=J.gv;if(T.isConnectActionVisible(v)&&J.getStyle("connectGuideVisible")){var s;v.s&&(s=v.s("connectGuideShift")),s||(s=J.getStyle("connectGuideShift"));var Z=v.getAnchor(),m=v.getSize(),C=v.toGlobal({x:m.width*(s[0]-Z.x),y:m.height*(s[1]-Z.y)});C=id.toScreenPosition(T,C),w.P1?C.add(w.P2.clone().sub(w.P1).setLength(s[2])):(C.add(w.RT.clone().sub(w.LT).setLength(s[2])),C.add(w.LB.clone().sub(w.LT).setLength(s[3]))),w.connect=C}},lp.prototype.gatherMultiTargets=function(m,k){var z=id.Group.findOrCreateGroup(k,this._interactor._uuid);if(!z)return!1;var p=this;return p.editing&&"rotate"!==p.editing.mode||z.calcInfo(),p.gatherSingleTarget(m,z)},lp.prototype.gatherLine=function(B,O){this.target=O;var v=this.screenInfo={},s=O.getPoints(),H=id.getDataMatrix(O);return v.P1=id.toScreenPosition(B,H.apply(s.get(0))),v.P2=id.toScreenPosition(B,H.apply(s.get(1))),this.gatherConnectInfo(),!0},lp.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],lp.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],lp.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],lp.prototype.check=function(R,e,w){if(h.Default.isLeftButton(e)){var y=this;if(y.editing=null,y.tipInfo=null,y.screenInfo){var G=y.target,A=R.isEditable(G),q=y.screenInfo;if(A&&q.connect){var f=y._checkConnect(w);if(f)return f}if(q.P1)return y._checkLine(w);var F,M,r,D=null,N=y._interactor,I=N.getStyle("checkSize");if(A&&R.isRectEditable(G))for(M=0;M<id.Rect.ResizeKeys.length;M++)if(r=id.Rect.ResizeKeys[M],id.checkHit(w,q[r],I)){D=r,F="resize";break}if(!D&&A&&R.isRotationEditable(G)&&!N.getStyle("rotateAsClock")){var j=N.getStyle("rotateCheckSize");for(M=0;M<id.Rect.RotateKeys.length;M++)if(r=id.Rect.RotateKeys[M],id.checkHit(w,q[r],j)){D=r,F="rotate";break}}if(!D)return N.setCursor("default"),void 0;if("rotate"===F){var m,s=R.lp(e);if(G instanceof id.Group){var o=N.getStyle("groupRotateModeKey");"string"==typeof o&&(o=[o]);for(var x=!1,C=0,$=o.length;$>C;C++)if(e[o[C]]){x=!0;break}var O=N.getStyle("groupRotateModeDefault");m=x?"batch"===O?"block":"batch":O}var i="batch"===m?G.getAnchor2():G.getPosition(),z=Math.atan2(s.y-i.y,s.x-i.x);N._setRotateCursor(z),y.editing={mode:F,key:D,pos:i,flipY:G.getScale().y<0,rotation:G.getRotation(),hitRot:z},m&&(y.editing.groupRotateMode=m)}else{var c=id.Rect.ResizeKeys.indexOf(D),Y=id.Rect.ResizeDirection[c],S=Math.cos(G.getRotation()),v=Math.sin(G.getRotation()),n=Y.x*Math.sign(G.getScale().x),b=Y.y*Math.sign(G.getScale().y),X=Math.atan2(-v*n-S*b,S*n-v*b),k=(Math.round(X/(Math.PI/4))+8)%8,U=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][k];this._interactor.setCursor(U);var T=G.getWidth(),d=G.getHeight(),V=G.getAnchor();y.editing={mode:F,key:D,rect:{x:-T*V.x,y:-d*V.y,width:T,height:d},anchor:V,matrix:G.getMatrix()}}return D}}},lp.prototype._checkLine=function(j){var F=this;F.screenInfo;var c,L=F._interactor.getStyle("checkSize");if(id.checkHit(j,F.screenInfo.P1,L))c="P1";else{if(!id.checkHit(j,F.screenInfo.P2,L))return this._interactor.setCursor("default"),void 0;c="P2"}return F.editing={mode:"line",key:c},c},lp.prototype._checkConnect=function(T){var q=this,N=q.screenInfo,s=q._interactor,Y=s.getStyle("connectGuideIntersectSize"),b=N.connect,p=T.x,$=b.x;if($>p&&Y>$-p&&Math.abs(b.y-T.y)<Y||p>=$&&id.checkHit(T,b,Y)){var E="connect",F=K.getConnectAction(s.gv);if(q.editing={mode:E},F&&F.delete)if(q.target instanceof id.Group){var A=!0;s.gv.sm().getSelection().each(function(v){F.delete.visible.call(null,s.gv,v)||(A=!1)}),q.editing.hasDeleteAction=A}else F.delete.visible.call(null,s.gv,q.target)&&(q.editing.hasDeleteAction=!0);return s.setCursor("default"),E}},lp.prototype._fireEditEvent=function(K,N){var V=this._interactor,z=this.editing;if(z){var g=z.mode;g="rotate"===g?"Rotation":"connect"===g?"Connection":"resize"===g?"Rect":g[0].toUpperCase()+g.slice(1),V.fi({kind:K+"Edit"+g,event:N})}},lp.prototype.startEdit=function(l,B){l.startDragging(B);var P=this;P._interactor.fi({kind:"prepareEdit",event:B});var m=P.editing,E=P.target;if(m){if(P._fireEditEvent("begin",B),m.started=!0,"rotate"===m.mode)return m.groupRotateMode&&E.beginRotate(m),l._42(),void 0;if("connect"!==m.mode)("line"===m.mode||E&&0===E.getRotation())&&(P._inSmartGuide=!0,P._interactor.rectGuide.gatherRects());else if(m.hasDeleteAction){var J=l.gv,n=P._interactor.getStyle("connectGuideGarbageShift");m.garbageInfo={x:J.getWidth()*n[0]+n[2],y:J.getHeight()*n[1]+n[3],size:P._interactor.getStyle("connectGuideGarbageIntersectsize")},l._42()}}},lp.prototype._46O=function(G){var U,t,B=this,x=B.editing,S=B.target;if(x){if("connect"===x.mode&&!x.canceled&&!x.deleted)try{x.garbageInfo&&x.garbageInfo.hover?K.doDeleteConnectionAction(B._interactor.gv,S):K.doConnectAction(B._interactor.gv,S,x.target)}catch(N){console.error(N)}t=x.freezeFlag,U=B.editing.groupRotateMode,B._fireEditEvent("end",G),B.editing=null}B.tipInfo=null,B._inSmartGuide&&(B._interactor.rectGuide.clear(),B._inSmartGuide=!1),U&&S&&S.endRotate(),S instanceof h.Block&&(t===P?delete S._freezeSyncFromChildren:S._freezeSyncFromChildren=t,S.updateFromChildren())},lp.prototype.handleNormalStateDelete=function(){var j=this,y=j.editing;if(y&&"connect"===y.mode&&!y.canceled&&!y.deleted){if(y.garbageInfo){try{K.doDeleteConnectionAction(j._interactor.gv,j.target)}catch(L){console.error(L)}y.garbageInfo=null}return y.cursorPos=null,y.targetCorners=null,y.deleted=!0,j._interactor._42(),!0}},lp.prototype.handleNormalStateKeyDown=function(m){var $=this,i=$.editing;return!i||"connect"!==i.mode||i.canceled||i.deleted?void 0:h.Default.isEsc(m)?(i.cursorPos=null,i.targetCorners=null,i.canceled=!0,$._interactor._42(),!0):void 0},lp.prototype.handleEdit=function(B,o){var V=this,I=V.editing;if(I){var M,m,e,G,C,a=V.target,U=I.key,p=I.mode,j=B.lp(o),J=V._interactor;if("connect"===p){if(I.canceled)return;if(I.deleted)return;I.cursorPos=J._getLogicalPoint(o);var z=I.garbageInfo;return z&&id.checkHit(I.cursorPos,z,z.size)?(z.hover=!0,I.target=null,I.targetCorners=null):(z&&(z.hover=!1),I.target=B.getDataAt(j,function(j){return B.isSelectable(j)?bk(j)?!0:!1:!1})||null,I.targetCorners=id.getTargetCornersOnScreen(B,I.target)),J._42(),void 0}if("rotate"===p){var g,t,w=I.pos,A=Math.atan2(j.y-w.y,j.x-w.x);if(I.groupRotateMode?t=A-I.hitRot:(g=A-I.hitRot,t=I.rotation+g),t%=2*Math.PI,0>t&&(t+=2*Math.PI),!h.Default.isCtrlDown(o)){var y,r;um(o)?(y=J.getStyle("shiftRotateRound"),r=y/2):(y=J.getStyle("rotateRound"),r=J.getStyle("rotateSensitivity")),t=id.roundTo(t,y,r)}I.groupRotateMode?(g=t-(I.lastRotation||0),0!==g&&(a.addRotation(g,I.groupRotateMode,function(S){return B.isRotationEditable(S)}),I.lastRotation=t)):a.setRotation(t),J._setRotateCursor(A),t>Math.PI&&(t-=2*Math.PI);var S=180*(t/Math.PI);S=S.toFixed(2),M=""+S+""}else if("resize"===p){var P=I.rect;e=P.x,G=P.y;var c,D=P.width,i=P.height,q=I.anchor,F=I.matrix,x=a.s&&a.s("keepAspectRatio")||J.getStyle("keepAspectRatio");um(o)&&(x=!x);var f=V._unionPointMode1,n=V._unionPointMode2;if(V._inSmartGuide&&!h.Default.isCtrlDown(o)&&!x){var v;"L"===U||"R"===U?v="x":("T"===U||"B"===U)&&(v="y"),V._adsorbedToClosest(j,v),C=!0}c=F.tfi(j);var X;"LT"===U?(P=f(c,{x:e+D,y:G+i},D,i,x),X=9):"T"===U?(P=n({x:e,y:c.y},{x:e+D,y:G+i},D,i,x,"v"),X=1):"RT"===U?(P=f(c,{x:e,y:G+i},D,i,x),X=33):"L"===U?(P=n({x:c.x,y:G},{x:e+D,y:G+i},D,i,x,"h"),X=8):"R"===U?(P=n({x:e,y:G},{x:c.x,y:G+i},D,i,x,"h"),X=32):"LB"===U?(P=f(c,{x:e+D,y:G},D,i,x),X=12):"B"===U?(P=n({x:e,y:G},{x:e+D,y:c.y},D,i,x,"v"),X=4):"RB"===U&&(P=f(c,{x:e,y:G},D,i,x),X=36);var L=F.tf(P.x+P.width*q.x,P.y+P.height*q.y);a instanceof h.Block&&(I.hasOwnProperty("freezeFlag")||(I.freezeFlag=a._freezeSyncFromChildren,a._freezeSyncFromChildren=!0)),a.setPosition(L),a.setSize(P.width,P.height),C&&(m=a.getRect(),J.rectGuide.gatherLines({node:a,x:m.x,y:m.y,w:m.width,h:m.height},v,X)),M=""+Math.round(P.width)+" * "+Math.round(P.height)}else if("line"===p){if(um(o)){var K=a.getPoints(),R="P1"===U?K.get(1):K.get(0),u={x:j.x-R.x,y:j.y-R.y},$=J.getStyle("shiftLineRotateRound"),s=V._shiftDirList;if(!s||V._shiftRotateRound!==$){V._shiftRotateRound=$,V._shiftDirList=s=[];for(var N=0;N<Math.PI;N+=$)s.push({x:l(N),y:W(N)})}for(var T,d=0,k=0,O=s.length;O>k;k++){var E=s[k],Y=E.x*u.x+E.y*u.y;Math.abs(Y)>Math.abs(d)&&(d=Y,T=E)}j={x:R.x+T.x*d,y:R.y+T.y*d},J.rectGuide.clear()}else V._inSmartGuide&&!h.Default.isCtrlDown(o)&&(V._adsorbedToClosest(j),C=!0);var Z=id.getDataMatrix(a).applyInverse(j);a.setPoint("P1"===U?0:1,Z,!0);var H=a.getPoints(),b=H.get(0),_=H.get(1);e=b.x-_.x,G=b.y-_.y,M=" "+Math.round(Math.sqrt(e*e+G*G))+" ",C&&(m=a.getRect(),J.rectGuide.gatherLines({node:a,x:m.x,y:m.y,w:m.width,h:m.height}))}if(M){var Q=h.Default.getLogicalPoint(o,J._canvas);Q.x+=id.Icons.TipShiftX,Q.y+=id.Icons.TipShiftY,V.tipInfo={helperPos:Q,text:M,size:M.length}}V._fireEditEvent("between",o)}},lp.prototype._unionPointMode1=function(l,b,C,e,w){if(w&&C&&e){var I=l.x-b.x,c=l.y-b.y;Math.abs(I*e)<Math.abs(c*C)?(c=Math.sign(c)*Math.abs(I*e/C),l.y=b.y+c):(I=Math.sign(I)*Math.abs(c*C/e),l.x=b.x+I)}return h.Default.unionPoint(l,b)},lp.prototype._unionPointMode2=function(M,x,N,F,T,l){var g=h.Default.unionPoint(M,x);if(T&&N&&F){var _;"v"===l?(_=g.x+g.width/2,g.width=N*g.height/F,g.x=_-g.width/2):(_=g.y+g.height/2,g.height=F*g.width/N,g.y=_-g.height/2)}return g},lp.prototype._adsorbedToClosest=function(X,b){var Q=this,a=Q._interactor,T=a.rectGuide.findClosest(X,b),t=a.gridGuide.findClosest(X,b),R=1/0,I=1/0;T&&(isFinite(T.x)&&(R=T.x),isFinite(T.y)&&(I=T.y)),t&&(isFinite(t.x)&&Math.abs(t.x)<Math.abs(R)&&(R=t.x),isFinite(t.y)&&Math.abs(t.y)<Math.abs(I)&&(I=t.y)),isFinite(R)&&(X.x+=R),isFinite(I)&&(X.y+=I)},lp.prototype._42=function(k,y,v){var t=this;t.info={},t.screenInfo=null;var E=t._interactor;if(!E.editDetail&&t.gatherInfo(y,v)){var D=t.editing,B=D?D.groupRotateMode:null,r=t.screenInfo;if("block"!==B||!D||!D.started){if(r.P1?id.Icons.DrawIcon(E,k,id.Icons.Line,r):id.Icons.DrawIcon(E,k,id.Icons.Rect,r),r.connect&&(id.Icons.DrawIcon(E,k,id.Icons.ConnectGuide,{rotation:r.rotation,connect:r.connect,cursorPos:D?D.cursorPos:null}),D)){if(D.targetCorners){for(var w={x:1/0,y:1/0},s={x:-1/0,y:-1/0},P=0,F=D.targetCorners.length;F>P;P+=2)w.x=Math.min(w.x,D.targetCorners[P]),s.x=Math.max(s.x,D.targetCorners[P]),w.y=Math.min(w.y,D.targetCorners[P+1]),s.y=Math.max(s.y,D.targetCorners[P+1]);id.Icons.DrawIcon(E,k,id.Icons.HoverDataRect,{min:w,max:s,color:E.getStyle("hoverGuideColor")||E.getStyle("baseColor")})}D.garbageInfo&&id.Icons.DrawIcon(E,k,id.Icons.ConnectGuideGarbage,D.garbageInfo)}E.getStyle("rotateTipVisible")&&t.tipInfo&&id.Icons.DrawIcon(E,k,id.Icons.TipHelper,t.tipInfo)}t.target instanceof id.Group&&t.target._42(E,k,y)}};var Cb=id.Anchor=function(y){this.catalog="Anchor",this._interactor=y};Cb.prototype={},Cb.prototype.constructor=Cb,Cb.prototype.gatherInfo=function(M,$){var d=this;if(1===$.length){var l=$[0];if(!l.getAnchor)return;if(l instanceof h.Shape&&l._70I())return;if(Dl(l,M))return;return d.gatherSingleTarget(M,$[0])}return $.length>1?d.gatherMultiTargets(M,$):!1},Cb.prototype.gatherSingleTarget=function(a,Y){var J=this;return J.info.POS=Y.getPosition(),J.screenInfo.POS=id.toScreenPosition(a,J.info.POS),J.target=Y,!0},Cb.prototype.gatherMultiTargets=function(s,h){var A=this,C=id.Group.findOrCreateGroup(h,this._interactor._uuid);return C?(A.screenInfo.POS=id.toScreenPosition(s,C.getAnchor2()),A.target=C,!0):!1},Cb.prototype.isVisible=function(){var z=this,l=z._interactor;if(l.getStyle("anchorVisible")===!1)return!1;var S=z.target;if(S){if(this.editing)return!0;var j=S.getAnchor(),H=l.getStyle("anchorOutsideVisibleThreshold");if(j.x<-H||j.x>1+H||j.y<-H||j.y>1+H)return!0;var P=S.getSize(),i=S.getScale(),_=Math.min(Math.abs(P.width*i.x),Math.abs(P.height*i.y));if(_*l.gv._zoom<l.getStyle("anchorHideThreshold"))return!1}return!0},Cb.prototype.check=function(v,$,W){if(h.Default.isLeftButton($)){var P=this,C=P._interactor;if(P.isVisible()&&C.getStyle("anchorMovable")!==!1){P.editing=null,P.tipInfo=null;var M=P.target;if(M&&v.isAnchorEditable(M)&&v.isEditable(M)){var e;if(P.screenInfo&&(e=P.screenInfo.POS)&&id.checkHit(W,new id.Math.Vector2(e),C.getStyle("checkSize"))){if(M instanceof id.Group)return P.editing={},!0;var D=M.getWidth(),x=M.getHeight(),E=M.getAnchor();return P.editing={rect:{x:-D*E.x,y:-x*E.y,width:D,height:x},anchor:E,matrix:M.getMatrix()},!0}}}}},Cb.prototype.startEdit=function(c,L){c.startDragging(L),c.fi({kind:"beginEditAnchor",event:L})},Cb.prototype._46O=function(q){var $=this;$.editing&&($.editing=null,$._interactor.fi({kind:"endEditAnchor",event:q})),$.tipInfo=null},Cb.prototype.handleEdit=function(i,u){var z=this,k=z.target;if(k){var E=z.editing;if(E){var T=i.lp(u),F=z._interactor;if(k instanceof id.Group)return k.setAnchor2(T),F._42(),void 0;
var p=E.matrix,M=p.tfi(T),K=E.rect,V=(M.x-K.x)/K.width,c=(M.y-K.y)/K.height;if(!h.Default.isCtrlDown(u)){var D=F.getStyle("anchorRound"),a=F.getStyle("anchorSensitivity");V=id.roundTo(V,D,a),c=id.roundTo(c,D,a)}k.setAnchor(V,c,!0);var W=h.Default.getLogicalPoint(u,F._canvas);W.x+=id.Icons.TipShiftX,W.y+=id.Icons.TipShiftY;var X=""+V.toFixed(2)+", "+c.toFixed(2);z.tipInfo={helperPos:W,text:X,size:X.length},F.fi({kind:"betweenEditAnchor",event:u})}}},Cb.prototype._42=function(Y,z,R){var V=this;V.info={},V.screenInfo={};var B=V._interactor;B.editDetail||V.gatherInfo(z,R)&&V.isVisible()&&(id.Icons.DrawIcon(B,Y,id.Icons.Anchor,V.screenInfo),V.tipInfo&&id.Icons.DrawIcon(B,Y,id.Icons.TipHelper,V.tipInfo))};var Br=id.MoveDummy=function(T){this.catalog="MoveDummy",this._interactor=T};Br.prototype={},Br.prototype.constructor=Br,Br.prototype.gatherInfo=function(){var d=this,Z=this._interactor.getSubModule("Rect");if(Z){var O=Z.screenInfo;if(O){var r=d._interactor,b=d.getMovableTarget(Z.target);if(b){var y=r.getStyle("moveDummyThreshold");if(y!==!1){var M=O.LT||O.P1,V=O.RT||O.P2,a=O.LB||M;if(M){var G=O.P1,K=Math.min(M.distanceTo(a),M.distanceTo(V));if(!(y!==!0&&K>y)){var U=r.getStyle("moveDummyPosition"),q=V.clone().sub(M),t=a.clone().sub(M),F=U[2],L=U[3];if(G){var J=r.getStyle("moveDummyLineExtraShift");J&&(F+=J[0],L+=J[1])}var S=M.clone().add(q.clone().multiplyScalar(U[0])).add(q.setLength(F)).add(t.clone().multiplyScalar(U[1])).add(t.setLength(L));return d.screenInfo.pos=S,d.screenInfo.size=r.getStyle("moveDummySensitivity"),!0}}}}}}},Br.prototype.getMovableTarget=function(S){var X=this._interactor.gv;if(bk(S)){if(X.isMovable(S))return S}else if(S instanceof id.Group)for(var y=S._entities,m=y.length-1;m>=0;m--){var E=y[m];if(bk(E)&&X.isMovable(E))return E}return null},Br.prototype.getMoveInteractor=function(){for(var $,X,n,U=this._interactor.gv,x=U.getInteractors(),$=0,X=x.length;X>$;$++)if(n=x.get($),n instanceof jd)return n},Br.prototype.startEdit=function(N,F){N.startDragging(F);var v=this.getMoveInteractor();if(v){var q=this.selectedTarget,j=N.gv;j._moving=1,v._data=q,j.handleMouseDown&&j.handleMouseDown(F,q)}},Br.prototype._46O=function(i){var v=this,x=v.getMoveInteractor();x&&(x.handleWindowMouseUp(i),v.selectedTarget=null)},Br.prototype.handleEdit=function(D,t){var T=this.getMoveInteractor();T&&T.handleWindowMouseMove(t)},Br.prototype.check=function(D,B,a){if(this.selectedTarget=null,h.Default.isLeftButton(B)&&!D._scrolling&&!Vo()){var p=this;if(p.screenInfo){var O=p.screenInfo.pos;if(O&&!(a.distanceTo(O)>p.screenInfo.size)){var Y=p._interactor;return p.selectedTarget=p.getMovableTarget(Y.getSubModule("Rect").target),Y.setCursor("default"),!0}}}},Br.prototype._42=function(d,T,a){var c=this;c.screenInfo={};var Q=c._interactor;Q.editDetail||c.gatherInfo(T,a)&&(!Q.editing||c.selectedTarget)&&id.Icons.DrawIcon(Q,d,id.Icons.MoveDummy,c.screenInfo)};var hc=id.RotateX=function(s){this.catalog="RotateX",this._interactor=s};hc.prototype={},hc.prototype.constructor=hc,hc.prototype.gatherInfo=function(g,v){var k=this;if(1===v.length){var N=v[0];return N instanceof h.Shape&&N._70I()||Dl(N,g)?!1:k.gatherSingleTarget(g,N)}return v.length>1?k.gatherMultiTargets(g,v):!1},hc.prototype.gatherSingleTarget=function(){var X=new h.Math.Vector2,H=new h.Math.Vector2,j=new h.Math.Vector2,i=new h.Math.Vector2,n=function(X,u){var g=X.x-u.x,c=X.y-u.y;return g*g+c*c};return function(E,w){if(w.getCorners){var C=this,I=w.getCorners(),$=15,l=w.getPosition();X.copy(I[0]),j.copy(I[1]),i.copy(I[3]),H.copy(X).add(i).divideScalar(2).add(X.sub(j).setLength($/E.getZoom()));var u=Math.max(n(l,I[0]),n(l,I[1]),n(l,I[2]),n(l,I[3]));return C.info.POS=H.clone(),C.screenInfo.POS=id.toScreenPosition(E,C.info.POS),C.screenInfo.LEN=Math.sqrt(u)*E.getZoom()+$,C.screenInfo.CENTER=id.toScreenPosition(E,l),C.target=w,!0}}}(),hc.prototype.gatherMultiTargets=function(G,u){var N=this,e=id.Group.findOrCreateGroup(u,this._interactor._uuid);if(!e)return!1;var N=this;return N.gatherSingleTarget(G,e)},hc.prototype.isVisible=function(){var G=this._interactor;if(!G.getStyle("rotateAsClock"))return!1;var W=this.target;if(!W)return!0;var o=G.gv;return o.isEditable(W)&&o.isRotationEditable(W)?!0:!1},hc.prototype.check=function(I,H,W){var j=this,h=j._checkImpl(I,H,W);return(h||j._clockPainted)&&j._interactor._42(),h},hc.prototype._checkImpl=function(f,y,F){if(h.Default.isLeftButton(y)){var W=this;W.editing=null,W.tipInfo=null;var A;if(W.screenInfo&&(A=W.screenInfo.POS)&&W.isVisible()){var _=W._interactor;if(id.checkHit(F,A,_.getStyle("checkSize"))){var c=W.target,K=f.lp(y),k=c.getPosition(),i=Math.atan2(K.y-k.y,K.x-k.x);return _._setRotateCursor(i),W.editing={pos:k,rotation:c.getRotation(),hitRot:i,groupRotateMode:"block",screenInfo:{CENTER:W.screenInfo.CENTER,LEN:W.screenInfo.LEN}},!0}}}},hc.prototype.startEdit=function(o,S){o.startDragging(S),o.fi({kind:"beginEditRotation",event:S}),this.target instanceof id.Group&&this.target.beginRotate(this.editing)},hc.prototype._46O=function(u){var J=this;J.editing&&(J.editing=null,J._interactor.fi({kind:"endEditRotation",event:u})),J.target instanceof id.Group&&J.target.endRotate(),J.tipInfo=null},hc.prototype.handleEdit=function(s,f){var c=this,L=c.editing;if(L){var d,Y,y=c.target,w=s.lp(f),t=c._interactor,b=L.pos,C=Math.atan2(w.y-b.y,w.x-b.x),A=y instanceof id.Group;if(A?Y=C-L.hitRot:(d=C-L.hitRot,Y=L.rotation+d),Y%=2*Math.PI,0>Y&&(Y+=2*Math.PI),!h.Default.isCtrlDown(f)){var V,a;um(f)?(V=t.getStyle("shiftRotateRound"),a=V/2):(V=t.getStyle("rotateRound"),a=t.getStyle("rotateSensitivity")),Y=id.roundTo(Y,V,a)}A?(d=Y-(L.lastRotation||0),0!==d&&(y.addRotation(d,L.groupRotateMode,function(m){return s.isRotationEditable(m)}),L.lastRotation=Y)):y.setRotation(Y),t._setRotateCursor(C),Y>Math.PI&&(Y-=2*Math.PI);var P=180*(Y/Math.PI),x=""+P.toFixed(2)+"",J=h.Default.getLogicalPoint(f,t._canvas);J.x+=id.Icons.TipShiftX,J.y+=id.Icons.TipShiftY,c.tipInfo={helperPos:J,text:x,size:x.length},t.fi({kind:"betweenEditRotation",event:f})}},hc.prototype._42=function(y,Q,k){var j=this;j._clockPainted=!1,j.info={},j.screenInfo={};var R=j._interactor;R.editDetail||j.gatherInfo(Q,k)&&j.isVisible()&&(id.Icons.DrawIcon(R,y,id.Icons.RoundPoint,j.screenInfo.POS),R.getStyle("rotateTipVisible")&&j.tipInfo&&id.Icons.DrawIcon(R,y,id.Icons.TipHelper,j.tipInfo),j.editing&&j.drawClock(y))},hc.prototype.drawClock=function(E){E.save();var H=this;H._clockPainted=!0;var a=H.editing||{},t=a.screenInfo||H.screenInfo,n=t.LEN,U=n+8,c=n+18;E.save(),E.translate(t.CENTER.x,t.CENTER.y),E.beginPath(),E.strokeStyle="rgb(150, 150, 150)";for(var y,f,z,q,I,v=0;360>v;v++)y=v*Math.PI/180,0===v%5&&(f=W(y)*n,z=l(y)*n,q=W(y)*U,I=l(y)*U,E.moveTo(f,z),E.lineTo(q,I)),0===v%45&&(f=W(y)*n,z=l(y)*n,q=W(y)*c,I=l(y)*c,E.moveTo(f,z),E.lineTo(q,I));E.stroke(),E.rotate(-ss);var m=a.lastRotation||H.target.getRotation();E.beginPath(),E.fillStyle="rgba(255, 0, 0, 0.1)",E.strokeStyle="rgb(157, 157, 157)",E.moveTo(0,0),E.arc(0,0,c,0,m,!1),E.fill(),E.beginPath(),E.moveTo(0+c,0),E.arc(0,0,c,0,m,!1),E.stroke(),E.restore()};var zp=id.Curve=function(z){this.catalog="Curve",this._interactor=z};zp.prototype={},zp.prototype.constructor=zp,O.defineProperties(zp.prototype,{activing:{get:function(){return this._activing},set:function(l){var b=this;if(l)b._activing=new id.CurveActiving(this,l),b.gatherSingleTarget(b._interactor.gv,b.target);else{var z=b._activing;z&&z.dispose(),b._activing=null}}}}),zp.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},zp.prototype.setUp=function(){var V=this,u=V._interactor;u&&u.gv.mp(V._onGraphviewPropertyChanged,V)},zp.prototype._onGraphviewPropertyChanged=function(I){("zoom"===I.property||"translateX"===I.property||"translateY"===I.property)&&this._handleDataChanged()},zp.prototype.tearDown=function(){var d=this,c=d._interactor;c&&c.gv.ump(d._onGraphviewPropertyChanged,d)},zp.prototype.canEnterEditDetailMode=function(){var y=Fo(this._interactor);return y?this.target=y:void 0},zp.prototype.canQuitEditDetailMode=function(r){var l=this,x=l._interactor._getLogicalPoint(r);return l._checkEditRealPoint(x)?void 0:l._interactor.gv.getDataAt(r)!==l.target?!0:void 0},zp.prototype.preHandleScroll=function(){var q=this.editing;return q&&q.inEdit?!0:void 0},zp.prototype.getCurrentSelectintStatus=function(){var J=this;if(J.activing&&!J.activing.selections){if(J.activing.status!=P)return J.activing.status;var a=function(h){var z=J.activing.status;J.activing.status=h,J._interactor.fp("shapePointStatus",z,h)},c=id.Curve.PointType,S=J.activing.point,y=J.activing.pairs;if(!y||1!==y.length)return a(c.Mirrored);var u=y[0],K=u.c1&&u.c1.isNearEnough(S),O=u.c2&&u.c2.isNearEnough(S);if(!u.c1||!u.c2)return K||O?a(c.Straight):a(c.Disconnected);if(K&&O)return a(c.Straight);if(K||O)return a(c.Asymmetric);var R=u.c1.clone().sub(S),s=u.c2.clone().sub(S);return Math.abs(R.x*s.y-R.y*s.x)>1e-5||R.x*s.x>0?a(c.Disconnected):Math.abs(R.length()-s.length())>1e-5?a(c.Asymmetric):a(c.Mirrored)}},zp.prototype.handle_keydown=function(_){var O=this;if(O._interactor.editDetail){var S=id.Curve.PointType;"1"===_.key?O._setCurrentSelectionStatus(S.Straight):"2"===_.key?O._setCurrentSelectionStatus(S.Mirrored):"3"===_.key?O._setCurrentSelectionStatus(S.Disconnected):"4"===_.key&&O._setCurrentSelectionStatus(S.Asymmetric)}},zp.prototype.setCurrentSelectionStatus=function(Q){var _=this,C=_._interactor;if(C){var Z=C.gv;Z.dm().beginTransaction(),this._setCurrentSelectionStatus(Q),Z.dm().endTransaction()}},zp.prototype._setCurrentSelectionStatus=function(N){var a=this,T=a.activing;if(T){var s=a.getCurrentSelectintStatus();if(null!==s&&s!==N){T.status=N;var X=a.activing.point,d=a.activing.pairs;if(d&&1===d.length){var R=d[0],Q=a.screenInfo.curve,y=id.Curve.PointType,G=a._interactor,B=function(){a._writeToHt(),G.fp("shapePointStatus",s,N),a.check(G.gv,null,new id.Math.Vector2(G._lastLogicalPoint))};if(N===y.Straight)return Q.moveCtrlPoint(R,X,"c1"),Q.moveCtrlPoint(R,X,"c2"),B(),void 0;if(s===y.Straight){var u=Q.findPairs(X,!0),D=u[0],p=D.r1||X,v=D.r2||X,x=v.clone().sub(p).multiplyScalar(.25);return Q.moveCtrlPoint(R,X.clone().sub(x),"c1"),Q.moveCtrlPoint(R,X.clone().add(x),"c2"),B(),void 0}var c=R.c1,z=R.c2;if(c&&z){if(N===y.Mirrored)return Q.moveCtrlPoint(R,X.clone().multiplyScalar(2).sub(z),"c1"),B(),void 0;if(N===y.Asymmetric&&s===y.Disconnected){var m=c.clone().sub(X).length(),x=X.clone().sub(z).setLength(m).add(X);return Q.moveCtrlPoint(R,x,"c1"),B(),void 0}}T._firePointChange(),G.fp("shapePointStatus",s,N),a.check(G.gv,null,new id.Math.Vector2(G._lastLogicalPoint))}}}},zp.prototype._handleDataChanged=function(){var T="s:edge.points,s:edge.segments,points,segments,shape,position,rotation,scale".split(",");return function(j){var X=this;if(X.screenInfo&&X.target){if(j&&T.indexOf(j.property)<0)return;var M=X._interactor;X.gatherSingleTarget(M.gv,X.target,!0),X.check(M.gv,null,new id.Math.Vector2(M._lastLogicalPoint)),M._42()}}}(),zp.prototype.gatherSingleTarget=function(E,M,W){var p,s,D=this;D.screenInfo&&D.screenInfo.curve&&(s=D.screenInfo.curve._curves);var d=D.editing;p=d?D.screenInfo:D.screenInfo={};var q,U,K=M instanceof h.Edge;K?(q=M.s("edge.segments"),U=M.s("edge.points")||new h.List):(q=M._58O,U=M._59O),p.S=q;var H,i=p.P=[],n=id.getDataMatrix(M);if(M instanceof h.Polyline||M instanceof h.Edge&&D._interactor.getStyle("edgeElevationEditable"))H=M.getElevation&&M.getElevation()||0,p.E=[];else{var _=!1;U.each(function(f){f.e!==P&&(_=!0)}),_&&(p.E=[])}if(U.each(function(x){p.E&&p.E.push(x.e!=P?x.e:H),x=n.apply(x);var b=id.toScreenPosition(E,x);i.push(b.x,b.y)}),K){var I=i.length,m=id.toScreenPosition(E,M._lastSourcePoint||(I?{x:i[0],y:i[1]}:{x:0,y:0})),j=id.toScreenPosition(E,M._lastTargetPoint||(I?{x:i[I-2],y:i[I-1]}:{x:0,y:0}));if(i.splice(0,0,m.x,m.y),i.push(j.x,j.y),p.E){var y=M.getSourceAgent();y instanceof h.Edge?p.E.splice(0,0,M.s("edge.source.offset.elevation")):p.E.splice(0,0,((M.s("edge.source.anchor.elevation")||.5)-.5)*y.getTall()*y.getScaleTall()+y.getElevation()+M.s("edge.source.offset.elevation"));var T=M.getTargetAgent();T instanceof h.Edge?p.E.push(M.s("edge.target.offset.elevation")):p.E.push(((M.s("edge.target.anchor.elevation")||.5)-.5)*T.getTall()*T.getScaleTall()+T.getElevation()+M.s("edge.target.offset.elevation"))}}if(!p.S||!p.S.size()){p.S=new h.List,p.S.add(1);for(var V=0;V<i.length/2-1;V++)p.S.add(2)}if((!d||W)&&D.convertToCubicBezier(s),D.activing&&(W||!D.editing||"realPoint"===D.editing.type)){var x=p.curve.findPairs(D.activing.point);D.activing.pairs=x}},zp.prototype._convertToNewPoint=function(w,l,Y,J){var t,a,v;for(t=0,a=l.length;a>t;t++){if(v=l[t],v._p1.isNearEnough(w)&&(!J||J.indexOf(v._p1)<0))return v._p1;if(v._p4.isNearEnough(w)&&(!J||J.indexOf(v._p4)<0))return v._p4}if(Y)for(t=0,a=Math.min(Y.length,a);a>t;t++){if(v=Y[t],v._p1===w&&(!J||J.indexOf(l[t]._p1)<0))return l[t]._p1;if(v._p4===w&&(!J||J.indexOf(l[t]._p4)<0))return l[t]._p4}},zp.prototype.convertToCubicBezier=function(u){var T,w,_=this,Y=new id.Math.Curve,J=_.screenInfo;if(Y.createFromHtShape(J.P,J.S,J.E),J.curve=Y,_.activing){var b=Y._curves;T=_.activing.point,w=_._convertToNewPoint(T,b,u);var l=[];if(w&&(_.activing.point=w,l.push(w)),_.activing.selections){var W=-1,g=_.activing.selections;g.forEach(function(S){W++,w=_._convertToNewPoint(S,b,u,l),w&&(g[W]=w,l.push(w))})}}},zp.prototype.check=function(o,k,F){if(!k||kp(k)||Ym(k)){var h=this;if(h._interactor.setCursor("default"),h.editing=null,h.highlight=null,h.tipInfo=null,h.edgeEditResult=null,h.screenInfo){if(Vo()||k&&Ym(k))return h._interactor._42(),!0;if(h._checkEditCtrlPoint(F))return h._interactor._42(),!0;if(h._checkEditRealPoint(F))return h._interactor._42(),!0;if(h._checkEditElevation(F))return h._interactor._42(),!0;var u=h.screenInfo.curve,m=u.checkPoint(F,h._interactor.getStyle("curveIntersectSize"));if(m){var Q=h.highlight={};Q.type="insertKnot",Q.bezier=m.bezier,Q.point=m.intersection}return h._interactor._42(),!0}}},zp.prototype.getAdjacentBeziers=function(L){var e=this.screenInfo;if(e){var C,w,H,B=e.curve._curves,f=[],p=P;for(C=0,w=B.length;w>C;C++)if(H=B[C],p===P){if(H._p4.isNearEnough(L)){f.push(H),p=C;continue}}else{if(H._p1.isNearEnough(L))return f.push(H),f;if(H._p4.isNearEnough(L)){f[0]=H,p=C;continue}}}},zp.prototype.roundCorner=function(I){if(this.activing&&this.screenInfo){var Z=this.screenInfo.curve,h=Z._curves,M=this.getAdjacentBeziers(this.activing.point),w=M[1],z=w._index;w=w.insertKnot(w.getTByPercentage(I/w.length))[1],h[z]=w;var j=w.p1,W=M[0],i=W._index;W=W.insertKnot(W.getTByPercentage(1-I/W.length))[0],h[i]=W;var $=W.p4,V=this.activing.point,d=new id.Math.CubicBezier($,V.clone().sub($).multiplyScalar(2/3).add($),V.clone().sub(j).multiplyScalar(2/3).add(j),j);h.splice(z,0,d),this._writeToHt(),this.activing=null,this._interactor._42()}},zp.prototype._checkEditRealPoint=function(A){var N,k,U,I,i,h,S=this,P=S.screenInfo.curve._curves,H=S._interactor.getStyle("curvePointIntersectSize"),s=1/0;for(H*=H,U=0,I=P.length;I>U;U++)N=P[U],i=N._p1,h=A.distanceToSquared(i),s>h&&(s=h,k=i),i=N._p4,h=A.distanceToSquared(i),s>h&&(s=h,k=i);if(s>H)return!1;var f=S.highlight={};return f.type="changeRealPoint",f.point=k,S.editing={type:"realPoint",point:k,shiftGuide:{point:k.clone(),dir:"x",limit:0}},S._interactor.setCursor("crosshair"),!0},zp.prototype._checkEditElevation=function(B){var M=this;if(!M._interactor.getStyle("curveElevationVisible"))return!1;var N=M.target;if(N instanceof h.Edge&&!M._interactor.getStyle("edgeElevationEditable"))return!1;var f=M.activing;if(!f)return!1;var O=f.getCurrentEditingPoint();if(!O)return!1;var E=M._interactor,W=E.getStyle("curveElevationGuideShift"),D=E.getStyle("curveElevationIntersectSize"),J=B.distanceToSquared({x:O.x+W[0],y:O.y+W[1]});if(!(J>D*D)){var c=M.highlight={};c.type="elevation";var z=new id.Math.Vector2(B.x,B.y,O.e);return M.editing={type:"elevation",startPoint:z},M._interactor.setCursor("crosshair"),!0}},zp.prototype._checkEditCtrlPoint=function(q){var X=this;if(X.activing&&!X.activing.selections){var N=X.getCurrentSelectintStatus();if(N!==id.Curve.PointType.Straight){var c=X.activing.pairs;if(c){var V=X._interactor.getStyle("curvePointIntersectSize");V*=V;var i,n,M,z,y,J,H,Q,P,s=1/0;for(H=0,P=c.length;P>H;H++)for(z=c[H],Q=0;2>Q;Q++)y=0===Q?"c1":"c2",z[y]&&(J=q.distanceToSquared(z[y]),s>J&&(s=J,i=z,n=H,M=y));if(s>V)return!1;X.activing.hlpair=i,X.activing.hltype=M;var I=X.highlight={};return I.type="changeCtrlPoint",I.point=i[M],X.editing={type:"ctrlPoint",pair:i,pairId:n,ctrlType:M,direction:i[M].clone().sub(X.activing.point).normalize()},X._interactor.setCursor("crosshair"),!0}}}},zp.prototype.startEdit=function(O,c){O.startDragging(c);var $=this;$.highlight&&"insertKnot"===$.highlight.type&&($.insertKnot(),$.gatherSingleTarget($._interactor.gv,$.target),$.activing=null,$._checkEditRealPoint($._interactor._getLogicalPoint(c)));var z=$._activing;if(z){var w=$.editing?$.editing.type:null;"ctrlPoint"===w?z.editingCtrl={pairId:$.editing.pairId,type:z.hltype}:"realPoint"===w&&(z.editingCtrl=!1)}var J=$.highlight,G=h.Default.isCtrlDown(c);if(!J||Vo()||Ym(c)){var x=$._interactor.gv;if(!x.setFocus(c)||x._scrolling)return;return G?$._multiSelect={startPoint:x.lp(c)}:x.isPannable()&&(kp(c)||Ym(c))&&($._pan={tx:x.tx(),ty:x.ty()},O.fi({kind:"beginPan",event:c})),void 0}if("changeRealPoint"===J.type){var i,C=$.activing?$.activing.point:null,I=$.activing?$.activing.selections:null;if(G&&$.activing)C===J.point?(I?($.activing={point:I[0]},I.length>1&&(I.splice(0,1),$.activing.selections=I)):$.activing=null,$.editing=null):I&&(i=I.indexOf(J.point))>=0?(I.length>1?I.splice(i,1):delete $.activing.selections,$.editing=null):I?(I.push(C),$.activing={point:J.point,selections:I}):$.activing={point:J.point,selections:[C]};else if(I)C===J.point||((i=I.indexOf(J.point))>=0?(I.splice(i,1,C),$.activing={point:J.point,selections:I}):$.activing={point:J.point});else{var f;C===J.point&&(f=$.activing.status),$.activing={point:J.point},f&&($.activing.status=f)}O.fi({kind:"beginEditPoint",event:c})}},zp.prototype.insertKnot=function(){var U=this,t=U.highlight,l=U.screenInfo.curve;l.insertKnot(t.bezier,t.point.t),U._writeToHt()},zp.prototype._writeToHt=function(){var n,k,i=this,U=i.screenInfo.curve,x=U.toHtShape(),P=x.points,I=[],C=x.segments,L=i._interactor.gv;L.dm().beginTransaction();var f,Z,p=i.target,r=p instanceof h.Edge,K=id.getDataMatrix(p).invert();Z=p instanceof h.Polyline||r&&i._interactor.getStyle("edgeElevationEditable"),Z&&(f=p.getElevation&&p.getElevation()||0);for(var E=0,z=P.length;z>E;E++)n=P[E],k=id.toWorldPosition(L,n),k=K.apply(k),isFinite(n.e)&&n.e!==f&&(k.e=n.e),I.push(k);if(p._writing=!0,r){p.s("edge.type","points"),p.setStyle("edge.segments",C),p.setStyle("edge.points",I.slice(1,I.length-1)),p.setStyle("edge.source.offset.x",0),p.setStyle("edge.source.offset.y",0),p.setStyle("edge.target.offset.x",0),p.setStyle("edge.target.offset.y",0);var s=i._nextChangeEdgeHost;delete i._nextChangeEdgeHost,s&&("source"===s.type?p.setSource(s.host):p.setTarget(s.host)),i._writeEdgeHostAnchor("source",I[0]),i._writeEdgeHostAnchor("target",I[I.length-1])}else I.length?(p.setSegments(C),p.setPoints(I,!0)):p.removeFromDataModel();L.dm().endTransaction(),delete p._writing},zp.prototype._writeEdgeHostAnchor=function(g,t){var i=this,W=i.target,F=i._calcHostAnchor(W,g,t);F.index!==P?(W.setStyle("edge."+g+".index",F.index),W.setStyle("edge."+g+".percent",P),W.setStyle("edge."+g+".anchor.x",P),W.setStyle("edge."+g+".anchor.y",P),W.setStyle("edge."+g+".anchor.elevation",P),W.setStyle("edge."+g+".offset.elevation",t.e)):F.percent!==P?(W.setStyle("edge."+g+".percent",F.percent),W.setStyle("edge."+g+".index",P),W.setStyle("edge."+g+".anchor.x",P),W.setStyle("edge."+g+".anchor.y",P),W.setStyle("edge."+g+".anchor.elevation",P),W.setStyle("edge."+g+".offset.elevation",t.e)):(W.s("edge."+g+".anchor.x",F.x),W.s("edge."+g+".anchor.y",F.y),W.s("edge."+g+".anchor.elevation",F.e),F.offsetX||F.offsetY||F.offsetElevation?(W.s("edge."+g+".offset.x",F.offsetX),W.s("edge."+g+".offset.y",F.offsetY),W.s("edge."+g+".offset.elevation",F.offsetElevation)):(W.s("edge."+g+".offset.x",0),W.s("edge."+g+".offset.y",0),W.s("edge."+g+".offset.elevation",0)))},zp.prototype._calcHostAnchor=function(W,A,v,j){j||(j="source"===A?W.getSource():W.getTarget());var X=this._interactor.gv,k=X.calculateAttachPoint(j,v);if(k)return k.info;if(bf(j)){var V=X.calculateEdgePosition(j,v);return V}var f=j.getRotation(),c=j.getAnchor();Dl(j,X)&&(f=0);var O=j.getElevation(),p=j.getTall()*j.getScaleTall();O=((v.e||0)-W.s("edge."+A+".offset.elevation")-O)/p+.5;var q=j.getScale();if(f||q.x<0||q.y<0){var Q=j.getMatrix(),Y=Q.tfi(v),r=j.getSize();return{x:Y.x/r.width+c.x,y:Y.y/r.height+c.y,e:O}}var U=ps(X,j),R={x:(v.x-U.x)/U.width,y:(v.y-U.y)/U.height,e:O};return R},zp.prototype._handlePanning=function(m){var R=this,S=R._pan;if(S){S.started=!0;var $=R._interactor,j=$.gv,Q=$._lastClientPoint,d=Tk(m),G=ns(j,d,Q);j.setTranslate(S.tx+G.x,S.ty+G.y),R.gatherSingleTarget($.gv,R.target),$._42(),$.fi({kind:"betweenPan",event:m})}},zp.prototype.handleEdit=function(Q,k){var u=this,H=u.editing;if(u._pan)return u._handlePanning(k),void 0;if(u._multiSelect)return u._multiSelect.endPoint=Q.lp(k),u._interactor.redraw(),void 0;if(H){H.inEdit=!0;var z,K,A,W=u._interactor._getLogicalPoint(k),c=h.Default.isCtrlDown(k),O=h.Default.isShiftDown(k),B=H.type,S=u.activing;if(u._guideInfo=null,"ctrlPoint"===B&&O){var N=u.editing.direction.clone();z=S.point;var Y=N.dot(W.clone().sub(z));W=N.setLength(Y).add(z)}else if("ctrlPoint"===B||"realPoint"===B){var N;if("realPoint"===B&&O){var g=u.editing.shiftGuide;K=g.point;var $=Math.abs(W.x-K.x),o=Math.abs(W.y-K.y);$>o&&$>g.limit&&"y"===g.dir&&(g.dir="x"),o>$&&o>g.limit&&"x"===g.dir&&(g.dir="y"),N=g.dir,"x"===N?(W.y=K.y,g.limit=Math.max(g.limit,$)):"y"===N&&(W.x=K.x,g.limit=Math.max(g.limit,o))}if(!c){var J,G=u._isEditEdgeSourceTarget();G&&(J=W.clone());var s=u._guidingToEdit(W,N),D="realPoint"===B?u._interactor.gridGuide.findClosest(W,N,!0):null,f=1/0,M=1/0;D&&(D.x&&(f=D.x),D.y&&(M=D.y));var n=!1;if(s&&(s.xList&&(Math.abs(s.x)<=Math.abs(f)?(n=!0,f=s.x):delete s.xList),s.yList&&(Math.abs(s.y)<=Math.abs(M)?(n=!0,M=s.y):delete s.yList),n&&(u._guideInfo=s)),isFinite(f)&&(W.x+=f),isFinite(M)&&(W.y+=M),n&&(s.v=W),G){var r=n?W.clone():null;W.copy(J);var L=u._editEdgeSourceTarget(G,W,c,r);L&&(u.edgeEditResult=L,A=L.tipText,L.isFixed&&(u._guideInfo=null))}}}var U=u.screenInfo.curve;if("realPoint"===H.type){z=H.point,z.e!==P&&(W.e=z.e),U.moveRealPoint(z,W),H.point=W,u.highlight.point=W;var C=S.status,X=S.selections;if(u.activing={point:W,status:C},X){var y=W.clone().sub(z),Z=0;X.forEach(function(_){var C=_.clone().add(y);U.moveRealPoint(_,C),X[Z++]=C}),u.activing.selections=X}}else if("ctrlPoint"===H.type){var x=S.pairs,m=x[H.pairId];U.moveCtrlPoint(m,W,H.ctrlType);var t=S.status,v=id.Curve.PointType;if((t===v.Mirrored||t===v.Asymmetric)&&m.c1&&m.c2){var z=new id.Math.Vector2(S.point),l="c1"===H.ctrlType?"c2":"c1";if(t===id.Curve.PointType.Mirrored)U.moveCtrlPoint(m,z.clone().multiplyScalar(2).sub(W),l);else if(t===v.Asymmetric){var Y=m[l].clone().sub(z).length(),j=z.clone().sub(m[H.ctrlType]).setLength(Y).add(z);isNaN(j.x)||U.moveCtrlPoint(m,j,l)}}S._firePointChange()}else if("elevation"===H.type){K=H.startPoint;var F=K.e+(K.y-W.y)/Q._zoom;u._setCurrentPointImpl("e",F),S._firePointChange(),A="E: "+id.toFixed(F)}var w=h.Default.getLogicalPoint(k,u._interactor._canvas);if(w.x+=id.Icons.TipShiftX,w.y+=id.Icons.TipShiftY,!A){var e=id.toWorldPosition(Q,W);A=""+id.toFixed(e.x)+", "+id.toFixed(e.y)}u.tipInfo={helperPos:w,text:A,size:A.length},u._writeToHt(),u._interactor.fi({kind:"betweenEditPoint",event:k})}},zp.prototype._setCurrentPointImpl=function(C,j){var h=this,$=h._activing;if(!$)return!1;var a=h.target;if(!a)return!1;var c=$.getCurrentEditingPoint();if(!c)return!1;var g=$.editingCtrl;if(!g)var R=c.clone();if("e"===C)c.e=j;else{var M;if("x"===C||"y"===C){var G=$._lastFirePoint;M="x"===C?{x:j,y:G?G.y:0}:{x:G?G.x:0,y:j}}else"object"==typeof C?(M=C,C.e!==P&&(c.e=C.e)):(M={x:arguments[0],y:arguments[1]},arguments[2]!==P&&(c.e=arguments[2]));var L=id.getDataMatrix(a);M=id.toScreenPosition(h._interactor.gv,L.apply(M)),c.x=M.x,c.y=M.y}if(!g){var S=R.multiplyScalar(-1).add(c);Kg(c.e)&&Kg(R.e)&&(S.e=c.e-R.e);var K=h.screenInfo.curve;K.moveCtrlDueToRealPointMovement(c,S);var k=$.selections;if(k){var e=0;k.forEach(function(m){var j=m.clone().add(S);isFinite(S.e)&&(j.e=(isFinite(m.e)?m.e:a.getElevation()||0)+S.e),K.moveRealPoint(m,j),k[e++]=j}),$.selections=k}}return!0},zp.prototype.setCurrentPoint=function(G,o){return this._setCurrentPointImpl(G,o)?(this._writeToHt(),!0):!1},zp.prototype._isEditEdgeSourceTarget=function(){var Y=this,z=Y.target;if(!(z instanceof h.Edge))return!1;var w=Y.editing.point,b=Y.screenInfo.curve._curves;return w===b[0]._p1?"source":w===b[b.length-1]._p4?"target":!1},zp.prototype._editEdgeSourceTarget=function(J,q,C,V){var R,x=this,b=x.target;if(R="source"===J?b.getSource():b.getTarget()){var v,r=x._interactor.gv,M=id.toWorldPosition(r,q),A=x._calcHostAnchor(b,J,M,R);if(v=A.index!==P||A.percent!==P?A.distance*r.getZoom()>x._interactor.getStyle("edgeHostEdgeMaxDistance"):x._interactor.getStyle("edgeHostDetectPerFrame")?!0:A.x<0||A.x>1||A.y<0||A.y>1?!0:!1){var k=r.getDataAt(M,function(A){return r.isSelectable(A)?r.isSourceTargetEditable(b,A,J)?b.canSetSourceTarget(A,J)?!0:!1:!1:!1});if(k){var z=x._calcHostAnchor(b,J,M,k);R=k,x._nextChangeEdgeHost={type:J,host:k},A=z}}var f,E,T,U=!1;if(C||A.x===P)(A.percent!==P||A.index!==P)&&(U=!0,E=A.point);else{var g=x._interactor.getStyle("anchorRound"),h=x._interactor.getStyle("anchorSensitivity");f=r.calculateAttachPoint(R,M),f?(A=f.info,U=!0):(V&&(A=x._calcHostAnchor(b,J,id.toWorldPosition(r,V),R)),A.x=id.roundTo(A.x,g,h),A.y=id.roundTo(A.y,g,h)),E=Hb(r,R,0,A.offsetX||0,A.offsetY||0,A.x,A.y)}E&&(T=id.toScreenPosition(r,E),q.x=T.x,q.y=T.y),x._edgeHostGuideInfo={corners:id.getTargetCornersOnScreen(r,R),attach:f?f.index:-1,host:R};var w;return A.percent!==P?w="percent: "+A.percent.toFixed(2):A.index!==P?w="index: "+A.index:(w=""+A.x.toFixed(2)+", "+A.y.toFixed(2),(A.offsetX||A.offsetY)&&(w+=" offset: "+A.offsetX.toFixed(2)+", "+A.offsetY.toFixed(2))),{host:R,anchor:A,tipText:w,isFixed:U}}},zp.prototype._guidingToEdit=function(f,r){var G,D,z=this;if(G=z.screenInfo.curve){D=G._curves;var E,U,g,h,S,R,k,P,K=1/0,I=1/0,Q=[];for(z.editing&&"realPoint"===z.editing.type&&(P=z.editing.point),S=0,R=2*D.length;R>S;S++)k=D[Math.floor(S/2)][S%2?"_p4":"_p1"],Q.indexOf(k)>=0||(Q.push(k),P&&P===k||(g=k.x-f.x,h=k.y-f.y,Math.abs(g)<Math.abs(K)?(K=g,E=[k]):g===K&&E.push(k),Math.abs(h)<Math.abs(I)?(I=h,U=[k]):h===I&&U.push(k)));var d=z._interactor.getStyle("smartGuideThreshold");if((Math.abs(K)>d||"y"===r)&&(E=null),(Math.abs(I)>d||"x"===r)&&(U=null),E||U){var p=!1,y={};if(E&&(p=!0,y.xList=E,y.x=K),U&&(p=!0,y.yList=U,y.y=I),p)return y}}},zp.prototype._46O=function(T){var I=this;I.editing&&(I.editing=null,I._interactor.fi({kind:"endEditPoint",event:T})),I._guideInfo=null,I._edgeHostGuideInfo=null,I._pan&&(I._pan=null,I._interactor.fi({kind:"endPan",event:T})),I._multiSelect&&(I._handleMultiSelect(I._multiSelect,T),I._multiSelect=null),I.tipInfo=null,I.edgeEditResult=null},zp.prototype._handleMultiSelect=function(B,Q){if(B.startPoint&&B.endPoint){var e,y,a,Y,c,O,N=this,S=N._interactor,W=S.gv,A=id.toScreenPosition(W,B.startPoint),r=id.toScreenPosition(W,B.endPoint),K=h.Default.unionPoint(A,r),m=N.screenInfo.curve._curves,E=[],X=function(o){o.x>=K.x&&o.y>=K.y&&o.x<=K.x+K.width&&o.y<=K.y+K.height&&E.indexOf(o)<0&&E.push(o)};for(e=0,y=m.length;y>e;e++)c=m[e],X(c._p1),X(c._p4);if(E.length){var z=N.activing||{},u=z.selections||[];z.point&&u.push(z.point);var $=h.Default.isShiftDown(Q),C=Q.altKey;if(C&&!$)for(O=E,E=[],e=0,y=O.length;y>e;e++)a=O[e],Y=u.indexOf(a),Y>=0&&E.push(a);for(e=0,y=u.length;y>e;e++)a=u[e],Y=E.indexOf(a),Y>=0?(!$||$&&C)&&(E[Y]=P):E.push(a);for(O=E,E=[],e=0,y=O.length;y>e;e++)O[e]&&E.push(O[e]);y=E.length,0===y?N.activing=null:1===y?N.activing={point:E[0]}:(a=E[y-1],N.activing={point:a,selections:E.splice(0,y-1)}),S.redraw()}}},zp.prototype._canDeletePoint=function(W,A){var z=this.target;if(!(z instanceof h.Edge))return!0;var n=W._curves[0],g=W._curves[W._curves.length-1];return n._p1===A||g._p4===A?!1:!0},zp.prototype.handleDelete=function(){var p=this;if(p.activing&&p.screenInfo){var a=h.Default.isShiftDown(),S=p.screenInfo.curve;p._canDeletePoint(S,p.activing.point)&&S.deleteRealPoint(p.activing.point,a),p.activing.selections&&p.activing.selections.forEach(function(E){p._canDeletePoint(S,E)&&S.deleteRealPoint(E,a)}),p.activing=null,delete p.editing,delete p.tipInfo,delete p.edgeEditResult,delete p._pan,delete p._multiSelect,p._writeToHt(),p._interactor.fp("deleteShapePoint",!1,!0)}},zp.prototype.handleDoubleClick=function(o){var f=this,w=f._interactor._getLogicalPoint(o);if(f.screenInfo&&f._checkEditRealPoint(w)){var Z=f.getCurrentSelectintStatus(),J=id.Curve.PointType;return Z=Z===J.Mirrored?J.Straight:J.Mirrored,f._setCurrentSelectionStatus(Z),f._interactor._42(),!0}},zp.prototype._drawHighlight=function(f){var e=this,B=e.highlight;if(B){var g=B.bezier,D=e._interactor;g&&id.Icons.DrawIcon(D,f,id.Icons.ShapeHighlightCurve,[g._p1.x,g._p1.y,g._p2.x,g._p2.y,g._p3.x,g._p3.y,g._p4.x,g._p4.y]);var C=B.point;C&&"insertKnot"===B.type&&id.Icons.DrawIcon(D,f,id.Icons.ShapeHighlighPoint,C)}},zp.prototype._drawGuide=function(N){var u=this,t=u._guideInfo;if(t){var G,B,b,Y,R=t.v;for(G=0;2>G;G++)if(Y=0===G?t.xList:t.yList)for(B=0,b=Y.length;b>B;B++)id.Icons.DrawIcon(u._interactor,N,id.Icons.ShapeGuideLine,[R.x,R.y,Y[B].x,Y[B].y])}},zp.prototype._drawCurrentPoint=function(S){var D=this;if(D.activing){var v=D.activing,f=D.getCurrentSelectintStatus(),$=D._interactor;if(f!==id.Curve.PointType.Straight){var l=v.pairs;v.hlpair,v.hltype;var T=v.selections,y=v.editingCtrl;if(l&&!T){var K,k,g;for(k=0,g=l.length;g>k;k++)K=l[k],y&&k===y.pairId&&K[y.type]?id.Icons.DrawIcon($,S,id.Icons.ShapeActivingCtrl,{point:K.point,c1:K.c1,c2:K.c2,hl:y.type}):id.Icons.DrawIcon($,S,id.Icons.ShapeActivingCtrl,K)}}id.Icons.DrawIcon($,S,id.Icons.ShapeHighlighRealPoint,D.activing.point),T&&T.forEach(function(J){id.Icons.DrawIcon($,S,id.Icons.ShapeHighlighRealPoint,J)})}},zp.prototype.clear=function(){var r=this;r.editing=null,r._guideInfo=null,r.activing=null,r.highlight=null},zp.prototype._42=function(n){var d=this;d.info={},d.editing||(d.screenInfo=null);var U=d._interactor;if(!U.editDetail)return d.clear(),void 0;var S=U.gv;if(!d.target||!S.isSelected(d.target)||!S.isVisible(d.target))return U.editDetail=!1,d.clear(),void 0;if(d.gatherSingleTarget(S,d.target),id.Icons.DrawIcon(U,n,id.Icons.ShapeBgCurve,d.screenInfo),d._interactor.getStyle("curveElevationVisible")&&(d.target instanceof h.Polyline||d.target instanceof h.Edge&&d._interactor.getStyle("edgeElevationEditable"))&&d.activing){var B=d.activing.getCurrentEditingPoint();B&&"string"!=typeof B.e&&id.Icons.DrawIcon(U,n,id.Icons.EdgeElevationGuide,B)}if(d._drawHighlight(n),d._drawCurrentPoint(n),d._getRealPoint().forEach(function(Y){id.Icons.DrawIcon(U,n,id.Icons.ShapePoint,Y)}),d._drawGuide(n),d.tipInfo&&d._interactor.getStyle("curveTipVisible")&&id.Icons.DrawIcon(U,n,id.Icons.TipHelper,d.tipInfo),d._edgeHostGuideInfo&&U._drawHostGuide(d._edgeHostGuideInfo),d.edgeEditResult&&d._drawEdgeHostHighlight(n,d.edgeEditResult.host,d.edgeEditResult.anchor),d._multiSelect&&d._multiSelect.endPoint){var G=h.Default.unionPoint(id.toScreenPosition(S,d._multiSelect.startPoint),id.toScreenPosition(S,d._multiSelect.endPoint));G.color=S.getRectSelectBorderColor(),n.save(),n.setTransform(1,0,0,1,0,0);var c=K.devicePixelRatio,L=G.borderWidth=Math.round(c);L/=2,G.x=Math.round(G.x*c)+L,G.y=Math.round(G.y*c)+L,G.width=Math.round(G.width*c),G.height=Math.round(G.height*c),id.Icons.DrawIcon(U,n,id.Icons.SimpleRect,G),n.restore()}},zp.prototype._drawEdgeHostHighlight=function(P,Y,Z){this.drawEdgeHostHighlight(P,Y,Z),this._interactor.redraw()
},zp.prototype.drawEdgeHostHighlight=function(C,K,X){if(bf(K)){var S,Y,G,T,_=this,i=_._interactor,R=i.gv,O=R.getDataUI(K),r=Si(O),B=[];for(G=0,T=r.points.length;T>G;G++)Y=id.toScreenPosition(R,r.points.get(G)),B.push(Y.x,Y.y);r.segments&&(S=r.segments.toArray());var m=i.getStyle("edgeHostHighlighPeriod"),x=i.getStyle("edgeHostEdgeHighlighColor");id.Icons.DrawIcon(i,C,id.Icons.ShapeBgCurve,{P:B,S:S,color:x,dynamicVisible:X.index===P,dynamicPeriod:m}),x=i.getStyle("edgeHostPointHighlighColor");var d=el(O);for(G=0,T=d.length;T>G;G++){var y=d[G],u=id.toScreenPosition(R,y);id.Icons.DrawIcon(i,C,id.Icons.ShapePoint,{point:{x:u.x,y:u.y},color:x,size:12,dynamicVisible:G===X.index,dynamicPeriod:m})}}},zp.prototype._getRealPoint=function(){var O,h=this.screenInfo,T=h.P,v=h.S,S=-1,R=[],Q=-1,z=v.length;return v.each(function(X){Q++;var M=1;if(3===X)M=2;else if(4===X)M=3;else if(5===X)return;S+=M,O=Q+1>=z?!0:1===v.get(Q+1)?!0:!1,R.push({point:{x:T[2*S],y:T[2*S+1]},segmentIndex:Q,pointIndex:S,isEnd:O})}),R},zp.prototype.getEditingPointsInfo=function(R){var Y=this,m=Y.activing;if(!m)return!1;var I=m.point;if(!I)return!1;var i=this._getRealPoint(),O=[{screen:I}];m.selections&&m.selections.forEach(function(o){O.push({screen:o})});var X,Z,o=i.length;return O.forEach(function(Q){for(X=0;o>X;X++)if(Z=i[X],Q.screen.isNearEnough(Z.point)){Q.segmentIndex=Z.segmentIndex,Q.pointIndex=Z.pointIndex,Q.point=Y.target.getPoints().get(Z.pointIndex);break}}),R&&O.sort(function(l,e){return l.segmentIndex-e.segmentIndex}),O};var aj=id.MoveHelper=function(M){var F=this;F.catalog="Move",F._interactor=M};aj.prototype={},aj.prototype.constructor=aj,aj.prototype.calcShift=function(n,I,_){var g,v,S=this,z=S._interactor.gv,E=z.lp(I);if("beginMove"===n&&S._gatherGridInfo(_._lastLogicalPoint||E),g=S._target){var N=g.downPosition;if(N){var t=S._interactor.getStyle("moveSensitivity")/z._zoom;if(N.distanceTo(E)<t)return{x:0,y:0};delete g.downPosition}var M;v=h.Default.isShiftDown(I),v&&(E=S._dealShiftDown(E),M=g.shiftGuide.dir);var W,J=g.rawPos={x:g.pos.x+E.x-g.lp.x,y:g.pos.y+E.y-g.lp.y};if(h.Default.isCtrlDown(I)){if(W=S._calcShiftByAddon(),S._target.node instanceof id.Group){var l=S._target.node;l._position.x+=W.x,l._position.y+=W.y}return W}var X=S._interactor.rectGuide;if(g.node instanceof h.Data&&g.node.s("2d.attachable")){var o=S._calcAttachNodeShift(g.node,J);if(X.clear(),o)return o}for(var U,j=g.x+J.x,L=g.y+J.y,i={x:j,y:L},B={x:j+g.w/2,y:L+g.h/2},R={x:j+g.w,y:L+g.h},e=S._interactor.gridGuide,D=[X.findClosest(i,M),X.findClosest(B,M),X.findClosest(R,M),e.findClosest(i,M),e.findClosest(B,M),e.findClosest(R,M)],C=1/0,p=1/0,Y=0,P=D.length;P>Y;Y++)U=D[Y],U&&(j=U.x,L=U.y,isFinite(j)&&Math.abs(j)<Math.abs(C)&&(C=j),isFinite(L)&&Math.abs(L)<Math.abs(p)&&(p=L));if(isFinite(C)||(C=0),isFinite(p)||(p=0),W=S._calcShiftByAddon(C,p),S._target.node instanceof id.Group){var l=S._target.node;l._position.x+=W.x,l._position.y+=W.y}var G=g.node;if(!Dl(G,z)){var s=J.x+C,K=J.y+p;S._interactor.rectGuide.gatherLines({node:G,x:g.x+s,y:g.y+K,w:g.w,h:g.h},M)}return W}},aj.prototype._calcShiftByAddon=function(B,g){var Z=this._target,j=Z.rawPos,v=Z.node.getPosition();return B=B||0,g=g||0,{x:j.x-v.x+B,y:j.y-v.y+g}},aj.prototype._dealShiftDown=function(Y){var N=this,w=N._target.shiftGuide,c=N._target.lp,s=Math.abs(Y.x-c.x),Q=Math.abs(Y.y-c.y);s>Q&&s>w.limit&&"y"===w.dir&&(w.dir="x"),Q>s&&Q>w.limit&&"x"===w.dir&&(w.dir="y");var l=w.dir;return"x"===l?(Y.y=c.y,w.limit=Math.max(w.limit,s)):"y"===l&&(Y.x=c.x,w.limit=Math.max(w.limit,Q)),Y},aj.prototype._isAttachableLineShape=function(o){if(!o.getSegments)return!1;var $=o.getSegments();if(!$)return!0;$ instanceof h.List&&($=$.getArray());for(var l=1,q=$.length;q>l;l++)if(2!==$[l])return!1;return!0},aj.prototype._calcAttachNodeShift=function(){var I=new Vl,L=new Vl,W=new Vl,R=new Vl;return function(O,g){var Z=this._interactor.gv,X=O.getHost(),p=Z.getDataAt(g,function(D){return D.s("2d.hostable")?!0:!1});if(p&&X!==p&&O.setHost(p),!p)return this._edgeHostGuideInfo=null,O.setHost(null);var x=this._edgeHostGuideInfo={corners:id.getTargetCornersOnScreen(Z,p),host:p,attach:-1};if(this._isAttachableLineShape(p)){for(var A,F,Y,J,T,k,u=p.getPoints(),B=u.size(),b=p.getPointsMatrix2d(),N=1/0,v=0;B>v&&(v!==B-1||p.isClosePath());v++)0!==v?L.copy(W):b.apply(u.get(v),L),b.apply(v===B-1?u.get(0):u.get(v+1),W),I.copy(g).sub(L),R.copy(W).sub(L),A=R.length(),R.divideScalar(A),F=I.dot(R),0>F?F=0:F>A&&(F=A),R.multiplyScalar(F).add(L),Y=I.copy(g).sub(R).lengthSq(),N>Y&&(N=Y,k=v,J=F,T=A);return Math.sqrt(N)*Z.getZoom()>this._interactor.getStyle("attachThreshold")?(O.s({"attach.index":-1}),O.setHost(null),void 0):(O.s("attach.offset.opposite")&&(J=T-J),O.s({"attach.index":k,"attach.offset":O.s("attach.offset.relative")?J/T:J}),{x:0,y:0})}var o=Z.calculateAttachPoint(p,g);if(o){var i=o.point;return x.attach=o.index,this._calcShiftByAddon(i.x-g.x,i.y-g.y)}}}(),aj.prototype._gatherGridInfo=function(n){var p,G=this,l=G._interactor,N=l._getValidSelection();if(N.length){if(1===N.length){if(p=N[0],!p.getRect)return G._target=null,void 0}else if(p=id.Group.findOrCreateGroup(N,l._uuid),!p)return G._target=null,void 0}else{var N=l.gv.sm().getSelection();if(N.length&&(p=N.get(0),!p.getRect))return G._target=null,void 0}if(p){var H=p.getPosition(),b=p.getRect();G._target={node:p,x:b.x-H.x,y:b.y-H.y,w:b.width,h:b.height,lp:{x:n.x,y:n.y},pos:{x:H.x,y:H.y},shiftGuide:{dir:"x",limit:0},downPosition:new id.Math.Vector2(n)},l.rectGuide.gatherRects()}},aj.prototype.clear=function(){var e=this;e._edgeHostGuideInfo=null,e._interactor.rectGuide.clear(),e._interactor._42()},aj.prototype._42=function(){var O=this._edgeHostGuideInfo;O&&this._interactor._drawHostGuide(O)};var Um=O.freeze({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),_l=function(){function S(_,J){var G=P;return function(){return G||(G=_.getExtension(J)),G}}function M(e,F){F==P&&(F={}),F.version=A&&(e instanceof WebGL2RenderingContext||O.prototype.toString.call(e)===H)?2:1,F.extensions=function(){for(var W={},r=e.getSupportedExtensions(),h=r.length;h--;)W[r[h]]=S(e,r[h]);return W}();for(var n=O.keys(j),c=0,x=n.length;x>c;++c){var Z=n[c];F[Z]=e.getParameter(j[Z])}if(F.version>1){n=O.keys(y);for(var c=0,x=n.length;x>c;++c){var Z=n[c];F[Z]=e.getParameter(y[Z])}}return F}var A="undefined"!=typeof WebGL2RenderingContext,H="[object WebGL2RenderingContext]",j={aliasedLineWidthRange:Um.ALIASED_LINE_WIDTH_RANGE,aliasedPointSizeRange:Um.ALIASED_POINT_SIZE_RANGE,maxCombinedTextureImageUnits:Um.MAX_COMBINED_TEXTURE_IMAGE_UNITS,maxCubeMapTextureSize:Um.MAX_CUBE_MAP_TEXTURE_SIZE,maxFragmentUniformVectors:Um.MAX_FRAGMENT_UNIFORM_VECTORS,maxRenderBufferSize:Um.MAX_RENDERBUFFER_SIZE,maxTextureImageUnits:Um.MAX_TEXTURE_IMAGE_UNITS,maxTextureSize:Um.MAX_TEXTURE_SIZE,maxVaryingVectors:Um.MAX_VARYING_VECTORS,maxVertexAttribs:Um.MAX_VERTEX_ATTRIBS,maxVertexTextureImageUnits:Um.MAX_VERTEX_TEXTURE_IMAGE_UNITS,maxVertexUniformVectors:Um.MAX_VERTEX_UNIFORM_VECTORS,maxViewportDIMs:Um.MAX_VIEWPORT_DIMS},y={max3DTextureSize:Um.MAX_3D_TEXTURE_SIZE,maxArrayTextureLayers:Um.MAX_ARRAY_TEXTURE_LAYERS,maxColorAttachments:Um.MAX_COLOR_ATTACHMENTS,maxCombinedFragmentUniformComponents:Um.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS,maxCombinedUniformBlocks:Um.MAX_COMBINED_UNIFORM_BLOCKS,maxCombinedVertexUniformComponents:Um.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS,maxDrawBuffers:Um.MAX_DRAW_BUFFERS,maxElementIndex:Um.MAX_ELEMENT_INDEX,maxElementsIndices:Um.MAX_ELEMENTS_INDICES,maxElementsVertices:Um.MAX_ELEMENTS_VERTICES,maxFragmentInpuComponents:Um.MAX_FRAGMENT_INPUT_COMPONENTS,maxFragmentUniformBlocks:Um.MAX_FRAGMENT_UNIFORM_BLOCKS,maxFragmentUniformComponents:Um.MAX_FRAGMENT_UNIFORM_COMPONENTS,maxProgramTexelOffset:Um.MAX_PROGRAM_TEXEL_OFFSET,maxSamples:Um.MAX_SAMPLES,maxTextureLODBias:Um.MAX_TEXTURE_LOD_BIAS,maxTransformFeedbackInterleavedComponents:Um.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS,maxTransformFeedbackSeparateAttribs:Um.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS,maxTransformFeedbackSeparateComponents:Um.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS,maxUniformBlockSize:Um.MAX_UNIFORM_BLOCK_SIZE,maxUniformBufferBindings:Um.MAX_UNIFORM_BUFFER_BINDINGS,maxVaryingComponents:Um.MAX_VARYING_COMPONENTS,maxVertexOutputComponents:Um.MAX_VERTEX_OUTPUT_COMPONENTS,maxVertexUniformBlocks:Um.MAX_VERTEX_UNIFORM_BLOCKS,maxVertexUniformComponents:Um.MAX_VERTEX_UNIFORM_COMPONENTS,minProgramTexelOffset:Um.MIN_PROGRAM_TEXEL_OFFSET};return{"for":function(J){var L=J._info;return L||(J._info=L=M(J,L)),L}}}(),ek=function(){function g(H,g,d){return{def:H,getter:d?function(A){var k=_l.for(A);return k.version>1?A.getParameter(g):H}:function(z){return z.getParameter(g)},setter:d?function(x,j){var C=_l.for(x);C.version>1&&x.pixelStorei(g,j)}:function(X,j){X.pixelStorei(g,j)}}}function z(O){return"string"==typeof O?Ql(O):O.r!==P?(G[0]=O.r,G[1]=O.g,G[2]=O.b,G[3]=O.a,G):O.red!==P?(G[0]=O.red,G[1]=O.green,G[2]=O.blue,G[3]=O.alpha,G):O}function E(m){return V(m)?Array.prototype.slice.call(m,0):m}function q(H,J,L){this.gl=J,this._record=L||{},this._branches={},this._leafSync={},this._struct=H;for(var _=H.children,A=_.length;A--;){var d=_[A],k=d.name;d.isLeaf?(this._leafSync[k]=!1,this._record[k]=E(d.desc.def)):this._record[k]={}}}function A(K){function c(v,C){q.call(this,K,v,C);for(var l=Y.length;l--;){var P=Y[l];this._branches[P._name]=new P._type(v,this._record[P._name])}}function I(W,x){function t(K,_){for(var G=B,D=!1;G--;)K[G]!==_[G]&&(K[G]=_[G],D=!0);return D}var g=W.name,p=V(W.desc.def),B=p&&W.desc.def.length;if(W.isLeaf){var N=W.desc.setter,Q=W.desc.parse;O.defineProperty(x,g,{configurable:!1,enumerable:!0,get:function(){return this._record[g]},set:p?function(Y){Q&&(Y=Q(Y)),(t(this._record[g],Y)||!this._leafSync[g])&&(N(this.gl,this._record[g]),this._leafSync[g]=!0)}:function(A){this._record[g]===A&&this._leafSync[g]||(N(this.gl,A),this._record[g]=A,this._leafSync[g]=!0)}})}else Y.push({_name:g,_type:A(W)}),O.defineProperty(x,g,{configurable:!1,enumerable:!0,get:function(){return this._branches[g]},set:function(B){this._branches[g].apply(B)}})}var Y=[];return b(c,q),K.forEach(I,c.prototype),c}var G="undefined"!=typeof Float32Array&&new Float32Array(4),d={viewport:{def:[0,0,0/0,0/0],getter:function(l){return l.getParameter(l.VIEWPORT)},setter:function(l,B){var e=B[2]!==B[2]?l.drawingBufferWidth-B[0]:B[2],K=B[3]!==B[3]?l.drawingBufferHeight-B[1]:B[3];l.viewport(B[0],B[1],e,K)}},dither:{def:!1,getter:function(M){return M.isEnabled(M.DITHER)},setter:function(R,_){_?R.enable(R.DITHER):R.disable(R.DITHER)}},rasterizerDiscard:{def:!1,getter:function(_){var V=_l.for(_);return V.version>1&&_.isEnabled(_.RASTERIZER_DISCARD)},setter:function(m,l){var p=_l.for(m);1!==p.version&&(l?m.enable(m.RASTERIZER_DISCARD):m.disable(m.RASTERIZER_DISCARD))}},lineWidth:{def:1,getter:function(Y){return Y.lineWidth?Y.getParameter(Y.LINE_WIDTH):1},setter:function(J,F){J.lineWidth&&J.lineWidth(F)}},color:{clear:{def:[0,0,0,0],getter:function(X){return X.getParameter(X.COLOR_CLEAR_VALUE)},setter:function(D,L){D.clearColor(L[0],L[1],L[2],L[3])},parse:z},mask:{def:[!0,!0,!0,!0],getter:function(d){return d.getParameter(d.COLOR_WRITEMASK)},setter:function(s,g){s.colorMask(g[0],g[1],g[2],g[3])}}},blend:{enabled:{def:!1,getter:function(N){return N.isEnabled(N.BLEND)},setter:function(j,v){v?j.enable(j.BLEND):j.disable(j.BLEND)}},color:{def:[0,0,0,0],getter:function(O){return O.getParameter(O.BLEND_COLOR)},setter:function(b,S){b.blendColor(S[0],S[1],S[2],S[3])},parse:z},equation:{def:[Um.FUNC_ADD,Um.FUNC_ADD],getter:function(E){return[E.getParameter(E.BLEND_EQUATION_RGB),E.getParameter(E.BLEND_EQUATION_ALPHA)]},setter:function(q,f){q.blendEquationSeparate(f[0],f[1])},parse:function(B){var P=B.length;return P>1?B:1===P?(G[1]=G[0]=B[0],G):(G[1]=G[0]=B,G)}},func:{def:[Um.ONE,Um.ZERO,Um.ONE,Um.ZERO],getter:function(w){return[w.getParameter(w.BLEND_SRC_RGB),w.getParameter(w.BLEND_DST_RGB),w.getParameter(w.BLEND_SRC_ALPHA),w.getParameter(w.BLEND_DST_ALPHA)]},setter:function(e,g){e.blendFuncSeparate(g[0],g[1],g[2],g[3])},parse:function(q){var H=q.length;return H>3?q:(G[2]=G[0]=q[0],G[3]=G[1]=q[1],G)}}},cullFace:{enabled:{def:!1,getter:function(q){return q.isEnabled(q.CULL_FACE)},setter:function(q,n){n?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE)}},mode:{def:Um.BACK,getter:function(y){return y.getParameter(y.CULL_FACE_MODE)},setter:function(X,T){X.cullFace(T)}},frontFace:{def:Um.CCW,getter:function(x){return x.getParameter(x.FRONT_FACE)},setter:function(P,e){P.frontFace(e)}}},scissor:{enabled:{def:!1,getter:function(D){return D.isEnabled(D.SCISSOR_TEST)},setter:function(A,R){R?A.enable(A.SCISSOR_TEST):A.disable(A.SCISSOR_TEST)}},box:{def:[0,0,0/0,0/0],getter:function(v){return v.getParameter(v.SCISSOR_BOX)},setter:function(i,t){var r=t[2]!==t[2]?i.drawingBufferWidth-t[0]:t[2],m=t[3]!==t[3]?i.drawingBufferHeight-t[1]:t[3];i.scissor(t[0],t[1],r,m)}}},depth:{enabled:{def:!1,getter:function(S){return S.isEnabled(S.DEPTH_TEST)},setter:function(q,O){O?q.enable(q.DEPTH_TEST):q.disable(q.DEPTH_TEST)}},clear:{def:1,getter:function(N){return N.getParameter(N.DEPTH_CLEAR_VALUE)},setter:function(m,H){m.clearDepth(H)}},mask:{def:!0,getter:function(E){return E.getParameter(E.DEPTH_WRITEMASK)},setter:function(Z,V){Z.depthMask(V)}},range:{def:[-1,1],getter:function(w){return w.getParameter(w.DEPTH_RANGE)},setter:function(C,p){C.depthRange(p[0],p[1])}},func:{def:Um.LESS,getter:function(f){return f.getParameter(f.DEPTH_FUNC)},setter:function(k,A){k.depthFunc(A)}}},stencil:{enabled:{def:!1,getter:function($){return $.isEnabled($.STENCIL_TEST)},setter:function(o,R){R?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST)}},clear:{def:0,getter:function(x){return x.getParameter(x.STENCIL_CLEAR_VALUE)},setter:function(o,g){o.clearStencil(g)}},frontMask:{def:255,getter:function(z){return z.getParameter(z.STENCIL_WRITEMASK)},setter:function(j,k){j.stencilMaskSeparate(j.FRONT,k)}},frontOp:{def:[Um.KEEP,Um.KEEP,Um.KEEP],getter:function(P){return[P.getParameter(P.STENCIL_FAIL),P.getParameter(P.STENCIL_PASS_DEPTH_FAIL),P.getParameter(P.STENCIL_PASS_DEPTH_PASS)]},setter:function(J,e){J.stencilOpSeparate(J.FRONT,e[0],e[1],e[2])}},frontFunc:{def:[Um.ALWAYS,0,255],getter:function(n){return[n.getParameter(n.STENCIL_FUNC),n.getParameter(n.STENCIL_REF),n.getParameter(n.STENCIL_VALUE_MASK)]},setter:function(P,e){P.stencilFuncSeparate(P.FRONT,e[0],e[1],e[2])}},backMask:{def:255,getter:function(D){return D.getParameter(D.STENCIL_BACK_WRITEMASK)},setter:function(x,j){x.stencilMaskSeparate(x.BACK,j)}},backOp:{def:[Um.KEEP,Um.KEEP,Um.KEEP],getter:function(i){return[i.getParameter(i.STENCIL_BACK_FAIL),i.getParameter(i.STENCIL_BACK_PASS_DEPTH_FAIL),i.getParameter(i.STENCIL_BACK_PASS_DEPTH_PASS)]},setter:function(M,f){M.stencilOpSeparate(M.BACK,f[0],f[1],f[2])}},backFunc:{def:[Um.ALWAYS,0,255],getter:function(X){return[X.getParameter(X.STENCIL_BACK_FUNC),X.getParameter(X.STENCIL_BACK_REF),X.getParameter(X.STENCIL_BACK_VALUE_MASK)]},setter:function(S,Q){S.stencilFuncSeparate(S.BACK,Q[0],Q[1],Q[2])}}},hint:{generateMipmap:{def:Um.DONT_CARE,getter:function(r){return r.getParameter(r.GENERATE_MIPMAP_HINT)},setter:function(g,h){g.hint(g.GENERATE_MIPMAP_HINT,h)}},fragmentShaderDerivative:{def:Um.DONT_CARE,getter:function(O){var Y=_l.for(O);return 1!==Y.version||Y.extensions.OES_standard_derivatives?O.getParameter(Um.FRAGMENT_SHADER_DERIVATIVE_HINT):Um.DONT_CARE},setter:function(Q,M){var r=_l.for(Q);return r.version>1||r.extensions.OES_standard_derivatives?(Q.hint(Um.FRAGMENT_SHADER_DERIVATIVE_HINT,M),void 0):void 0}}},pixelStore:{packAlignment:g(4,Um.PACK_ALIGNMENT,!1),unpackAlignment:g(4,Um.UNPACK_ALIGNMENT,!1),unpackFlipY:g(!1,Um.UNPACK_FLIP_Y_WEBGL,!1),unpackPremultiplyAlpha:g(!1,Um.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),unpackColorspaceConversion:g(Um.BROWSER_DEFAULT_WEBGL,Um.UNPACK_COLORSPACE_CONVERSION_WEBGL,!1),packRowLength:g(0,Um.PACK_ROW_LENGTH,!0),packSkipPixels:g(0,Um.PACK_SKIP_PIXELS,!0),packSkipRows:g(0,Um.PACK_SKIP_ROWS,!0),unpackRowLength:g(0,Um.UNPACK_ROW_LENGTH,!0),unpackImageHeight:g(0,Um.UNPACK_IMAGE_HEIGHT,!0),unpackSkipPixels:g(0,Um.UNPACK_SKIP_PIXELS,!0),unpackSkipRows:g(0,Um.UNPACK_SKIP_ROWS,!0),unpackSkipImages:g(0,Um.UNPACK_SKIP_IMAGES,!0)},polygonOffset:{enabled:{def:!1,getter:function(v){return v.isEnabled(v.POLYGON_OFFSET_FILL)},setter:function(_,V){V?_.enable(_.POLYGON_OFFSET_FILL):_.disable(_.POLYGON_OFFSET_FILL)}},value:{def:[0,0],getter:function(H){return[H.getParameter(H.POLYGON_OFFSET_FACTOR),H.getParameter(H.POLYGON_OFFSET_UNITS)]},setter:function(g,B){g.polygonOffset(B[0],B[1])}}},sampleCoverage:{enabled:{def:!1,getter:function(W){return W.isEnabled(W.SAMPLE_COVERAGE)},setter:function(u,z){z?u.enable(u.SAMPLE_COVERAGE):u.disable(u.SAMPLE_COVERAGE)}},alpha:{def:!1,getter:function(G){return G.isEnabled(G.SAMPLE_ALPHA_TO_COVERAGE)},setter:function(f,d){d?f.enable(f.SAMPLE_ALPHA_TO_COVERAGE):f.disable(f.SAMPLE_ALPHA_TO_COVERAGE)}},value:{def:[1,!1],getter:function(C){return[C.getParameter(C.SAMPLE_COVERAGE_VALUE),C.getParameter(C.SAMPLE_COVERAGE_INVERT)]},setter:function(i,X){i.sampleCoverage(X[0],X[1])}}}},n=oh.create(d,function(z){return"def"in z});q.prototype.reset=function(){for(var S=this._struct.children,n=S.length;n--;){var u=S[n],f=u.name;u.isLeaf?this[f]=u.desc.def:this._branches[f].reset()}},q.prototype.save=function(S){S==P&&(S={});for(var z=this._struct.children,I=z.length;I--;){var j=z[I],m=j.name;if(j.isLeaf)S[m]=E(this._record[m]);else{var V=S[m];V==P&&(S[m]=V={}),this._branches[m].save(V)}}return S},q.prototype.sync=function(I,Z){for(var E=this._struct.children,c=E.length;c--;){var N=E[c],M=N.name;N.isLeaf?(Z||!this._leafSync[M])&&(I?(this._record[M]=N.desc.getter(this.gl),this._leafSync[M]=!0):(N.desc.setter(this.gl,this._record[M]),this._leafSync[M]=!0)):this._branches[M].sync(I,Z)}},q.prototype.syncLoss=function(){for(var v=this._struct.children,K=v.length;K--;){var J=v[K];J.isLeaf?this._leafSync[J.name]=!1:this._branches[J.name].syncLoss()}},q.prototype.apply=function(g){for(var m=this._struct.children,X=m.length;X--;){var c=m[X],R=c.name;R in g&&(c.isLeaf?this[R]=g[R]:this._branches[R].apply(g[R]))}},q.prototype.append=function(e){var K=this._struct.childMap;for(var s in e){var S=K[s];S&&(S.isLeaf?this[s]=e[s]:this._branches[s].append(e[s]))}};var T=A(n);return function(E){var M=E._state;return M||(E._state=M=new T(E)),M}}(),vo=function(){function W(M,t,U,o){if(M){var Y=M.length;if(Y!=P)for(var u=0;o>u;++u)t[U+u]=M[u];else M.toArray&&M.toArray(t,U)}else for(var u=0;o>u;++u)t[U+u]=0}function l(m,t,S){var T=m[0];if(0>=T||T>0)return m;var J=t*S,H=a[J];if(H==P&&(a[J]=H=new Float32Array(J)),0!==t){W(T,H,0,S);for(var C=1,g=0;C!==t;++C)g+=S,W(m[C],H,g,S)}return H}function K(W,p){W.uniform1f(this.addr,p)}function G(F,p){F.uniform1fv(this.addr,p)
}function V(A,T){if(T.x!=P)A.uniform2f(this.addr,T.x,T.y);else{var n=a[2];n.set(T,0),A.uniform2fv(this.addr,n)}}function o(N,p){N.uniform2fv(this.addr,l(p,this.size,2))}function f(F,O){if(O.x!=P)F.uniform3f(this.addr,O.x,O.y,O.z);else if(O.r!=P)F.uniform3f(this.addr,O.r,O.g,O.b);else if(O.red!=P)F.uniform3f(this.addr,O.red,O.green,O.blue);else{var l=a[3];l.set(O,0),F.uniform3fv(this.addr,l)}}function j(B,R){B.uniform3fv(this.addr,l(R,this.size,3))}function A(I,h){if("string"==typeof h&&(h=Ql(h)),h.x!=P)I.uniform4f(this.addr,h.x,h.y,h.z,h.w);else if(h.r!=P)I.uniform4f(this.addr,h.r,h.g,h.b,h.a);else if(h.red!=P)I.uniform4f(this.addr,h.red,h.green,h.blue,h.alpha);else{var E=a[4];E.set(h,0),I.uniform4fv(this.addr,E)}}function J(Q,I){Q.uniform4fv(this.addr,l(I,this.size,4))}function H(S,M){S.uniform1i(this.addr,M)}function B(h,q){h.uniform1iv(this.addr,q)}function n(u,D){u.uniform2iv(this.addr,D)}function m(w,B){w.uniform3iv(this.addr,B)}function u(V,G){V.uniform4iv(this.addr,G)}function S(w,T){w.uniform1i(this.addr,d[T?1:0])}function I(m,f){var H=a[4];H.set(f,0),m.uniformMatrix2fv(this.addr,!1,H)}function N(j,r){j.uniformMatrix2fv(this.addr,!1,l(r,this.size,4))}function h(c,o){var B=a[9];B.set(o,0),c.uniformMatrix3fv(this.addr,!1,B)}function q(c,A){c.uniformMatrix3fv(this.addr,!1,l(A,this.size,9))}function _(M,u){var o=a[16];o.set(u,0),M.uniformMatrix4fv(this.addr,!1,o)}function F(Y,J){Y.uniformMatrix4fv(this.addr,!1,l(J,this.size,16))}function w(C,K){C.uniform1i(this.addr,this.slots[0]),C.activeTexture(C.TEXTURE0+this.slots[0]),C.bindTexture(C.TEXTURE_2D,K||C._emptyTexture)}function X(e,j){e.uniform1iv(this.addr,this.slots);for(var C=this.slots.length;C--;)e.activeTexture(e.TEXTURE0+this.slots[C]),e.bindTexture(e.TEXTURE_2D,j[C]||e._emptyTexture)}function s(G,P){G.uniform1i(this.addr,this.slots[0]),G.activeTexture(G.TEXTURE0+this.slots[0]),G.bindTexture(G.TEXTURE_CUBE_MAP,P||G._emptyCubeTexture)}function y(Y,g){Y.uniform1iv(this.addr,this.slots);for(var z=this.slots.length;z--;)Y.activeTexture(Y.TEXTURE0+this.slots[z]),Y.bindTexture(Y.TEXTURE_CUBE_MAP,g[z]||Y._emptyCubeTexture)}function g(T,q,M){x[T]=[q,M]}function R(N,d,C){switch(N.type){case 35678:case 35680:if("uSampler"===C)return[0];if("uBlendSampler"===C)return[1];for(var r=N.size,m=new Int32Array(r),U=0;r>U;++U)m[U]=d.usedTextureSlot++;return m}return P}function v($,g,J,r,o){this.name=$,this.addr=g,this.size=r?J.size:0,this.activeInfo=J,this.setter=x[J.type][r?1:0],this.slots=R(J,o,$),Ze(this)}function Q(m,H,k,_){var D=m.name,g=D.length;for(T.lastIndex=0;;){var F=T.exec(D),f=T.lastIndex,q=F[1],V="]"===F[2],i=F[3];if(V&&(q=0|q),i===P||"["===i&&f+2===g){k[q]=new v(q,H,m,i!==P,_);break}var Y=k[q];Y==P&&(k[q]=Y={}),k=Y}}function L(X,f,G){this.gl=f,this._program=G,this._leaves={},this._branches={},this._struct=X}function C(z){function n(R,K){L.call(this,z,R,K);for(var i=w.length;i--;){var J=w[i];this._branches[J._name]=new J._type(R,K)}this.uuid=Uj.generateUUID()}function W(N,Z){var U=N.name;if(N.isLeaf){var o=p("d.setter(this.gl, v);",["v"],["d"],[N.desc]);O.defineProperty(Z,U,{configurable:!1,enumerable:!0,get:function(){return o},set:o})}else w.push({_name:U,_type:C(N)}),O.defineProperty(Z,U,{configurable:!1,enumerable:!0,get:function(){return this._branches[U]},set:function(p){this._branches[U].apply(p)}})}var w=[];return b(n,L),z.forEach(W,n.prototype),n}function t(S,A){for(var q=S.getProgramParameter(A,S.ACTIVE_UNIFORMS),L={},y={usedTextureSlot:2};q--;){var $=S.getActiveUniform(A,q),I=$.name,j=S.getUniformLocation(A,I);Q($,j,L,y)}var M=oh.create(L,function(F){return"addr"in F}),k=C(M);return O.defineProperty(k.prototype,"textureCount",{configurable:!1,enumerable:!1,writable:!1,value:y.usedTextureSlot}),new k(S,A)}var a=[];if("function"==typeof Float32Array)for(var i=1;17>i;++i)a[i]=new Float32Array(i);var d=[0,1],x=[];g(Um.FLOAT,K,G),g(Um.FLOAT_VEC2,V,o),g(Um.FLOAT_VEC3,f,j),g(Um.FLOAT_VEC4,A,J),g(Um.INT,H,B),g(Um.INT_VEC2,n,n),g(Um.INT_VEC3,m,m),g(Um.INT_VEC4,u,u),g(Um.BOOL,S,B),g(Um.BOOL_VEC2,n,n),g(Um.BOOL_VEC3,m,m),g(Um.BOOL_VEC4,u,u),g(Um.FLOAT_MAT2,I,N),g(Um.FLOAT_MAT3,h,q),g(Um.FLOAT_MAT4,_,F),g(Um.SAMPLER_2D,w,X),g(Um.SAMPLER_CUBE,s,y);var T=/([\w\d_]+)(\])?(\[|\.)?/g;return L.prototype.apply=function(F){for(var w=this._struct.children,k=w.length;k--;){var d=w[k],i=d.name;i in F&&(d.isLeaf?this[i]=F[i]:this._branches[i].apply(F[i]))}},L.prototype.append=function(N){var t=this._struct.childMap;for(var l in N){var G=t[l];G&&(G.isLeaf?this[l]=N[l]:this._branches[l].append(N[l]))}},function(u,D){var s=D._uniforms;return s||(D._uniforms=s=t(u,D)),s}}(),We=function(){function D(s,y,k){y.vertexAttrib1f(s.addr,k)}function r(m,t,W){if(W.x!=P)t.vertexAttrib2f(m.addr,W.x,W.y);else{var L=J[2];L.set(W,0),t.vertexAttrib2fv(m.addr,L)}}function K(R,U,t){if(t.x!=P)U.vertexAttrib3f(R.addr,t.x,t.y,t.z);else if(t.r!=P)U.vertexAttrib3f(R.addr,t.r,t.g,t.b);else if(t.red!=P)U.vertexAttrib3f(R.addr,t.red,t.green,t.blue);else{var j=J[3];j.set(t,0),U.vertexAttrib3fv(R.addr,j)}}function o(T,V,N){if("string"==typeof N&&(N=Ql(N)),N.x!=P)V.vertexAttrib4f(T.addr,N.x,N.y,N.z,N.w);else if(N.r!=P)V.vertexAttrib4f(T.addr,N.r,N.g,N.b,N.a);else if(N.red!=P)V.vertexAttrib4f(T.addr,N.red,N.green,N.blue,N.alpha);else{var x=J[4];x.set(N,0),V.vertexAttrib4fv(T.addr,x)}}function A(o,S,h){h=h.el||h;for(var I=0,z=0;2>I;++I)S.vertexAttrib2f(o.addr,h[z++],h[z++])}function B(b,u,t){t=t.el||t;for(var Y=0,N=0;3>Y;++Y)u.vertexAttrib3f(b.addr,t[N++],t[N++],t[N++])}function y(R,d,S){S=S.el||S;for(var D=0,Y=0;4>D;++D)d.vertexAttrib4f(R.addr,S[Y++],S[Y++],S[Y++],S[Y++])}function l(v,O,C,y){for(var I,m=C?1:0,Q=O.addr,s=v._divisorState,L=0;y>L;L++)I=s[Q+L]||0,I!==m&&(s[Q+L]=m,v.vertexAttribDivisor(Q+L,m))}function u(C,A,n,H,a,$,t){A.bindBuffer(A.ARRAY_BUFFER,n);var O=C.addr;A.enableVertexAttribArray(O),l(A,C,n.instanced,1),A.vertexAttribPointer(O,1,H||A.FLOAT,!!a,$||0,t||0),A.bindBuffer(A.ARRAY_BUFFER,null)}function X(i,F,X,e,u,L,H){F.bindBuffer(F.ARRAY_BUFFER,X);var c=i.addr;F.enableVertexAttribArray(c),l(F,i,X.instanced,1),F.vertexAttribPointer(c,2,e||F.FLOAT,!!u,L||0,H||0),F.bindBuffer(F.ARRAY_BUFFER,null)}function v(Q,D,L,h,E,z,X){D.bindBuffer(D.ARRAY_BUFFER,L);var g=Q.addr;D.enableVertexAttribArray(g),l(D,Q,L.instanced,1),D.vertexAttribPointer(g,3,h||D.FLOAT,!!E,z||0,X||0),D.bindBuffer(D.ARRAY_BUFFER,null)}function k(I,X,k,x,J,F,P){X.bindBuffer(X.ARRAY_BUFFER,k);var B=I.addr;X.enableVertexAttribArray(B),l(X,I,k.instanced,1),X.vertexAttribPointer(B,4,x||X.FLOAT,!!J,F||0,P||0),X.bindBuffer(X.ARRAY_BUFFER,null)}function L(v,m,V,n,k,J,h){var J=J||16,h=h||0,P=v.addr;m.bindBuffer(m.ARRAY_BUFFER,V),m.enableVertexAttribArray(P),m.vertexAttribPointer(P,2,n||m.FLOAT,!!k,J,h),m.enableVertexAttribArray(P+1),m.vertexAttribPointer(P+1,2,n||m.FLOAT,!!k,J,h+8),l(m,v,V.instanced,2),m.bindBuffer(m.ARRAY_BUFFER,null)}function R(e,C,S,d,M,_,h){var _=_||36,h=h||0,g=e.addr;C.bindBuffer(C.ARRAY_BUFFER,S);for(var P=0;3>P;P++)C.enableVertexAttribArray(g+P),C.vertexAttribPointer(g+P,3,d||C.FLOAT,!!M,_,h+12*P);l(C,e,S.instanced,3),C.bindBuffer(C.ARRAY_BUFFER,null)}function h(n,L,U,D,i,Z,c){var Z=Z||64,c=c||0,R=n.addr;L.bindBuffer(L.ARRAY_BUFFER,U);for(var V=0;4>V;V++)L.enableVertexAttribArray(R+V),L.vertexAttribPointer(R+V,4,D||L.FLOAT,!!i,Z,c+16*V);l(L,n,U.instanced,4),L.bindBuffer(L.ARRAY_BUFFER,null)}function _(M,E,J,X){V[M]=function(m,I,l,G,h,u){this.addr==P||this.addr<0||(I==P||I===!1?X(m,this.addr):Ld(I)===e?J(this,m,I,l,G,h,u):(X(m,this.addr),E(this,m,I)))}}function W(E,r){E.disableVertexAttribArray(r)}function j(_,f){_.disableVertexAttribArray(f),_.disableVertexAttribArray(f+1)}function G(d,L){d.disableVertexAttribArray(L),d.disableVertexAttribArray(L+1),d.disableVertexAttribArray(L+2)}function z(R,m){R.disableVertexAttribArray(m),R.disableVertexAttribArray(m+1),R.disableVertexAttribArray(m+2),R.disableVertexAttribArray(m+3)}function U(z,G,L){this.name=z,this.addr=G,this.activeInfo=L,this.setter=V[L.type],Ze(this)}function x(y,c,s){this.gl=c,this.program=s,this._branches={},this._struct=y}function T(B){function g(U,A){x.call(this,B,U,A);for(var e=Z.length;e--;){var $=Z[e];this._branches[$._name]=new $._type(U,A)}}function j(D,R){var K=D.name;if(D.isLeaf){var G=p("d.setter(this.gl, v);",["v"],["d"],[D.desc]);O.defineProperty(R,K,{configurable:!1,enumerable:!0,get:function(){return G},set:G})}else Z.push({_name:K,_type:T(D)}),O.defineProperty(R,K,{configurable:!1,enumerable:!0,get:function(){return this._branches[K]},set:function(m){this._branches[K].apply(m)}})}var Z=[];return b(g,x),B.forEach(j,g.prototype),g}function q(M,x){for(var s=M.getProgramParameter(x,M.ACTIVE_ATTRIBUTES),r={};s--;){var c=M.getActiveAttrib(x,s),p=c.name,W=M.getAttribLocation(x,p);r[p]=new U(p,W,c)}var V=oh.create(r,function(k){return"addr"in k}),J=T(V);return new J(M,x)}for(var J=[],C=1;17>C;++C)J[C]=new Ui(C);var V=[],e="undefined"!=typeof WebGLBuffer&&WebGLBuffer.prototype;return _(Um.FLOAT,D,u,W),_(Um.FLOAT_VEC2,r,X,W),_(Um.FLOAT_VEC3,K,v,W),_(Um.FLOAT_VEC4,o,k,W),_(Um.FLOAT_MAT2,A,L,j),_(Um.FLOAT_MAT3,B,R,G),_(Um.FLOAT_MAT4,y,h,z),x.prototype.disable=function(){for(var F=this._struct.children,E=F.length;E--;){var M=F[E],i=M.name;M.isLeaf?this[i]=P:this._branches[i].disable()}},x.prototype.apply=function(s){for(var U=this._struct.children,S=U.length;S--;){var J=U[S],q=J.name;q in s&&(J.isLeaf?this[q]=s[q]:this._branches[q].apply(s[q]))}},x.prototype.append=function(k){var j=this._struct.childMap;for(var l in k){var D=j[l];D&&(D.isLeaf?this[l]=k[l]:this._branches[l].append(k[l]))}},function(f,v){var n=v._attribs;return n||(v._attribs=n=q(f,v)),n}}(),Zq=function(t){var x=this;O.defineProperties(this,{gl:{configurable:!1,enumerable:!1,value:t,writable:!1},glState:{configurable:!1,enumerable:!1,value:ek(t),writable:!1}}),x._currProgram=P,x._currUniforms=P,x._currAttribs=P,x._sync=!0};O.defineProperties(Zq.prototype,{program:{configurable:!1,enumerable:!1,get:function(){return this._currProgram},set:function(E){var c=this;c._sync&&E===c._currProgram||(c.gl.useProgram(E),c._currProgram=E,c._currUniforms=vo(c.gl,E),c._currAttribs=We(c.gl,E),c._sync=!0)}},uniforms:{configurable:!1,enumerable:!1,get:function(){var S=this;return S._currProgram&&!S._sync&&(S.gl.useProgram(S._currProgram),S._sync=!0),S._currUniforms},set:function(n){var D=this;D._currUniforms&&(D._currProgram&&!D._sync&&(D.gl.useProgram(D._currProgram),this._sync=!0),D._currUniforms.apply(n))}},attribs:{configurable:!1,enumerable:!1,get:function(){var X=this;return X._currProgram&&!X._sync&&(X.gl.useProgram(X._currProgram),X._sync=!0),X._currAttribs},set:function(I){var T=this;T._currUniforms&&(T._currProgram&&!T._sync&&(T.gl.useProgram(T._currProgram),this._sync=!0),T._currAttribs.apply(I))}}}),Zq.prototype.useProgram=function(U){var A=this;A._sync&&U===A._currProgram||(A.gl.useProgram(U),A._currProgram=U,A._currUniforms=vo(A.gl,U),A._currAttribs=We(A.gl,U),A._sync=!0)},Zq.prototype.directState=function(){return this.glState},Zq.prototype.directUniforms=function(){return this._currUniforms},Zq.prototype.directAttribs=function(){return this._currAttribs},Zq.prototype.syncLoss=function(){this._sync=!1,this.glState.syncLoss()},Zq.for=function(d){var u=d._renderState;return u||(d._renderState=u=new Zq(d)),u};var wf="directional",pe="point",Wr="spot",us="light.color",zf=4294967295,yi=0,rl={},Dq=[],ig=0,jb=function(j,o){Om(o)&&fp.test(o)?_o(j,o):Hh(o)&&o.modelType?Yh(j,o):o===P?delete Gp[j]:Gp[j]=o},an=function(W){return W},sg=function(V){V=K.convertShape3dModelName(V);var c;if(Hh(V)){if(V.modelType){if(V.uuid){if(c=Gp[V.uuid])return c}else V.uuid=h.Math.generateUUID();return c===P&&(xd&&xd[V.uuid]||Yh(V.uuid,V)),P}return V}return c=Gp[V],V&&c===P&&fp.test(V)&&(xd&&xd[V]||_o(V,V)),c},bg=function(Q,P){Q.frameStack?Q.frameStack.push(P):Q.frameStack=[P],Q.bindFramebuffer(Q.FRAMEBUFFER,P)},Pk=function(w){var a=w.frameStack;if(a){if(a.pop(),a.length)return w.bindFramebuffer(w.FRAMEBUFFER,a[a.length-1]),void 0;w.frameStack=null}w.bindFramebuffer(w.FRAMEBUFFER,null)};Sn(K,{graph3dViewAttributes:E,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:D/60,graph3dViewSortable:!1,graph3dViewBlockSelectable:!0,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:nm,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewRotateMaxPhi:D,graph3dViewRotateMinPhi:0,graph3dViewShadowDisabled:!0,graph3dViewShadowQuality:"high",graph3dViewShadowIntensity:.3,graph3dViewShadowBias:-.005,graph3dViewShadowRadius:.1,graph3dViewShadowType:"hard",graph3dViewShadowDegreeX:30,graph3dViewShadowDegreeZ:-10,graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewSyncEyeWithOrthoWidth:!1,graph3dViewFovy:D/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewDataNumWarningLine:1e4,graph3dViewHeadlightDirection:"camera",graph3dViewHeadlightRange:0,graph3dViewHeadlightGroup:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewHeadlightAmbientIntensity:.7,graph3dViewFogDisabled:!0,graph3dViewFogMode:"linear",graph3dViewFogDensity:5e-4,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewPickerResolution:.5,graph3dViewDashDisabled:!0,graph3dViewUvClipEnabled:!1,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dViewBatchInstancedDisabled:!0,graph3dViewFlowBlendMode:"addRGB",graph3dViewEnvmapType:"legacy",graph3dMaxVectorCacheTime:50,graph3dEnvmapCapabilityRequire:8,setShape3dModel:jb,getShape3dModel:sg,convertShape3dModelName:an,getShape3dModelMap:function(){return Gp},getCachedShape3dModelMap:function(){return mi},createMatrix:function(E,z){bs(E)||(E=[E]);for(var L=E.length-1;L>=0;L--){var s=E[L];z=Gg(s.mat,s.s3,s.r3,s.rotationMode,s.t3,z)}return z},transformVec:function(y,l){return kc(y,l)},glBindFrame:bg,glUnbindFrame:Pk,createBoxModel:function(){return{vs:Qo,ns:xn,uv:Ag,is:kn}},createRoundRectModel:function(j,s){return er.roundRect(j,s)},createStarModel:function(V,R){return er.star(V,R)},createRectModel:function(H,z){return er.rect(H,z)},createTriangleModel:function(Q,L){return er.triangle(Q,L)},createRightTriangleModel:function(L,Z){return er.rightTriangle(L,Z)},createParallelogramModel:function(t,K){return er.parallelogram(t,K)},createTrapezoidModel:function(Q,O){return er.trapezoid(Q,O)},createSmoothSphereModel:function(Z,D,K,N,m,C,Q){return Gj(new Rj(Z,D,K,N,m,C,Q))},createSphereModel:function($,k,w,G,x,B,r){return $?Eh($,k,w,G,x,B,r):K.createSmoothSphereModel()},createSmoothConeModel:function(O,f,Y,Q,q){return Vp(O,f,Y,Q,q)},createConeModel:function(d,c,t,g,L,V,I,M){return d?Xe(d,c,t,g,L,V,I,M):Vp(V)},createSmoothCylinderModel:function(e,E,G,y,H,C,o,x){return Gj(new Iq(e,E,G,y,H,C,o,x))},createCylinderModel:function(x,e,U,V,a,O,K,E){return x?hq(x,e,U,V,a,O,K,E):Kf(O,K)},createSmoothTorusModel:function(K,V,Q,_,G,r){return Gj(new uk(K,V,Q,_,G,r))},createTorusModel:function(r,U,I,N,S,x,H,B){return r?Uk(r,U,I,N,S,x,H,B):Tn(x,H)},createExtrusionModel:function(X,B,p,W,q,D,w,c){return Pc(X,B,p,W,q,D,w,c)},createSmoothRingModel:function(u,j,A,t,T,I){for(var n=[],X=0;X<u.length-1;X+=2)n.push({x:u[X],y:u[X+1]});for(u=_h(n,j,A)[0],n=[],X=0;X<u.length;X++){var _=u[X];n.push(new ll(_.x,0,_.y))}return Gj(new Db(n,I,t,T))},createTextGeometry:function(S,b){var G=Gj(new Cs(S,b));if(b.cube)for(var V=zn(G),l=V.min,e=V.max,T=l.x,H=l.y,i=l.z,c=e.x-T||1,t=e.y-H||1,A=e.z-i||1,J=["vs","top_vs","bottom_vs"],R=0,r=J.length;r>R;R++){var k=G[J[R]];if(k)for(var D=0,x=k.length;x>D;D+=3)k[D]=(k[D]-T)/c-.5,k[D+1]=(k[D+1]-H)/t-.5,k[D+2]=(k[D+2]-i)/A-.5}return G},loadFontFace:function(R,s){K.xhrLoad(R,function(l){if(!l)return s();var U;try{U=JSON.parse(l)}catch(i){U=JSON.parse(l.substring(65,l.length-2))}Nk.loadFace(U),s&&s(U.familyName.toLowerCase())},s?null:{sync:!0})},getShaderErrorLog:function(){return Dq.join("\n")},createRingModel:function(z,o,p,d,c,I,N,M,y,H){for(var t=[],B=0;B<z.length-1;B+=2)t.push({x:z[B],y:z[B+1]});I=I||K.shapeSide,N=N||0,M=M||I;var f,b,j,$,u,A,g,Q,e,x,B,R,V,X,s,Y,m,P,J=[],i=[],n=y?[]:E,S=y?[]:E,_=H?[]:E,h=H?[]:E,r=d?[]:E,L=d?[]:E,Z=c?[]:E,k=c?[]:E,z=_h(t,o,p),v=Dc(z),T=0,U=2*Math.PI/I;return z.forEach(function(z){if(j=z.length,j>1){if($=z[0],d)for(A=$.x,Q=$.y,B=N;M>B;B++)R=B+1,V=B*U,X=R*U,s=W(V),Y=l(V),m=W(X),P=l(X),r.push(s*A,Q,-Y*A,m*A,Q,-P*A,0,Q,0),L.push(.5-.5*s,.5-.5*Y,.5-.5*m,.5-.5*P,.5,.5);for(x=0;j>x;x++){for(u=z[x],A=$.x,g=u.x,Q=$.y,e=u.y,f=T/v,T+=nk($,u),b=T/v,B=N;M>B;B++)R=B+1,V=B*U,X=R*U,s=W(V),Y=l(V),m=W(X),P=l(X),J.push(s*g,e,-Y*g,m*g,e,-P*g,s*A,Q,-Y*A,m*g,e,-P*g,m*A,Q,-P*A,s*A,Q,-Y*A),i.push(B/I,b,R/I,b,B/I,f,R/I,b,R/I,f,B/I,f),y&&B===N&&(n.push(0,Q,0,0,e,0,s*g,e,-Y*g,s*g,e,-Y*g,s*A,Q,-Y*A,0,Q,0),S.push(0,.5-Q,0,.5-e,2*g,.5-e,2*g,.5-e,2*A,.5-Q,0,.5-Q)),H&&R===M&&(_.push(0,Q,0,m*g,e,-P*g,0,e,0,m*g,e,-P*g,0,Q,0,m*A,Q,-P*A),h.push(1,.5-Q,1-2*g,.5-e,1,.5-e,1-2*g,.5-e,1,.5-Q,1-2*A,.5-Q));$=u}if(c)for(A=$.x,Q=$.y,B=N;M>B;B++)R=B+1,V=B*U,X=R*U,s=W(V),Y=l(V),m=W(X),P=l(X),Z.push(m*A,Q,-P*A,s*A,Q,-Y*A,0,Q,0),k.push(.5-.5*m,.5+.5*P,.5-.5*s,.5+.5*Y,.5,.5)}}),{vs:J,uv:i,bottom_vs:Z,bottom_uv:k,top_vs:r,top_uv:L,from_vs:n,from_uv:S,to_vs:_,to_uv:h}}},!0),Sn(N,{"3d.move.mode":P,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"3d.clip.direction":null,"3d.clip.percentage":1,"3d.reflectable":!0,"shape.border.gradient.color":P,"edge.gradient.color":P,"edge.source.t3":P,"edge.target.t3":P,"light.type":pe,"light.group":0,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":D/4,"light.range":0,"light.exponent":1,"light.intensity":1,"light.mask":zf,"headlight.ambientIntensity":P,"wf.visible":!1,"wf.width":1,"wf.fog":!0,"wf.color":Yc,"wf.short":!1,"wf.mat":P,"wf.boundingBox":!1,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:P,"transparent.mask":!1,brightness:P,"select.brightness":.7,"repeat.uv.length":P,"shadow.cast":!0,"shadow.receive":!0,"3d.clipbox":P,"3d.clipbox.mask":zf,"3d.clipbox.group":0,"3d.clipbox.shape":"cube","effect.flow":!1,"effect.flow.gradient":"spread.horizontal","effect.flow.uvshape":"rect","effect.flow.size":512,"effect.flow.group":0,"effect.flow.intensity":1,"effect.flow.blend":P,"effect.flow.mask":zf,bloom:!1,envmap:0,"envmap.probe":0,roughness:0,renderTextureSamples:4,alphaTest:.4,autorotate:!1,fixSizeOnScreen:!1,"texture.cache":!1,"hide.overlapping.group":P,"vector.dynamic":!1,"vector.dynamic.maxsize":2048,"texture.scale":1,"geometry.cache":!1,"highlight.mode":!1,"highlight.type":"hard","highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","highlight.glow":.8,"highlight.strength":2,"color.empty":[0,0,0,0],"label.face":Yp,"label.t3":P,"label.r3":P,"label.texture.scale":2,"label.rotationMode":gj,"label.light":!1,"label.blend":P,"label.reverse.flip":!1,"label.reverse.color":pd,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Yp,"label2.t3":P,"label2.r3":P,"label2.texture.scale":2,"label2.rotationMode":gj,"label2.light":!1,"label2.blend":P,"label2.reverse.flip":!1,"label2.reverse.color":pd,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Yp,"note.t3":P,"note.r3":P,"note.texture.scale":2,"note.rotationMode":gj,"note.light":!1,"note.blend":P,"note.reverse.flip":!1,"note.reverse.color":pd,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Yp,"note2.t3":P,"note2.r3":P,"note2.texture.scale":2,"note2.rotationMode":gj,"note2.light":!1,"note2.blend":P,"note2.reverse.flip":!1,"note2.reverse.color":pd,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,"part.boundingBox":!1,shape3d:P,"shape3d.color":hk,"shape3d.top.color":P,"shape3d.bottom.color":P,"shape3d.from.color":P,"shape3d.to.color":P,"shape3d.image":P,"shape3d.image.projection":P,"shape3d.top.image":P,"shape3d.bottom.image":P,"shape3d.from.image":P,"shape3d.to.image":P,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":P,"shape3d.side.to":P,"shape3d.smooth":P,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":P,"shape3d.opacity":P,"shape3d.reverse.flip":!1,"shape3d.reverse.color":pd,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":P,"shape3d.uv.scale":P,"shape3d.uv.rotation":P,"shape3d.uv.anchor":P,"shape3d.uv.union":P,"shape3d.top.uv.offset":P,"shape3d.top.uv.scale":P,"shape3d.top.uv.rotation":P,"shape3d.top.uv.anchor":P,"shape3d.bottom.uv.offset":P,"shape3d.bottom.uv.scale":P,"shape3d.bottom.uv.rotation":P,"shape3d.bottom.uv.anchor":P,"shape3d.from.uv.offset":P,"shape3d.from.uv.scale":P,"shape3d.from.uv.rotation":P,"shape3d.from.uv.anchor":P,"shape3d.to.uv.offset":P,"shape3d.to.uv.scale":P,"shape3d.to.uv.rotation":P,"shape3d.to.uv.anchor":P,"shape3d.top.cap":P,"shape3d.bottom.cap":P,"shape3d.start.angle":0,"shape3d.sweep.angle":a,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.reflector":!1,"shape3d.reflector.color":"rgb(128,128,128)","shape3d.reflector.blur":0,"shape3d.reflector.blur.iterations":1,"shape3d.reflector.background":null,"shape3d.reflector.clip":.003,"shape3d.reflector.shadow":"scene","camera.type":"perspective","camera.aspect":1,"camera.fovy":P,"camera.ortho.width":P,"camera.near":P,"camera.far":P,"camera.background":0,"camera.renderSky":!0,"camera.renderAxis":!1,"camera.renderGrid":!1,"camera.renderEdit":!1,"camera.onlySky":!1,"texture.mipmap.max":P,"texture.filter":P,"texture.filter.min":P,"texture.filter.mag":P,"texture.wrap":P,"points.image":"rect","points.color":"white","points.transparent":!1,"points.size":20,"points.opacity":1,"points.uv.scale":[1,1],"points.uv.offset":[0,0],"points.discard.selectable":!1,"all.light":!0,"all.visible":!0,"all.color":hk,"all.image":P,"all.blend":P,"all.opacity":P,"all.reverse.flip":!1,"all.reverse.color":pd,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":P,"all.uv.offset":P,"all.uv.scale":P,"all.uv.rotation":P,"all.uv.anchor":P,"all.uv.union":P,"all.discard.selectable":!0,mat:P,"left.mat":P,"right.mat":P,"top.mat":P,"bottom.mat":P,"front.mat":P,"back.mat":P,"edge.source.anchor.elevation":P,"edge.target.anchor.elevation":P,"edge.source.offset.elevation":0,"edge.target.offset.elevation":0},!0);var Fi,Gr=!1,fs=[0,0,0,0],fe=function(s){return s instanceof Es},Ai=function(U){return[U.x,U.e||0,U.y]},Ml=function(v,D,o){for(var D=Ql(D||0),e=D[0],H=D[1],c=D[2];o--;)v.push(e,H,c)},Xo=function(I,o,L){for(var o=Ql(o||0),N=o[0],_=o[1],v=o[2],n=o[3];L--;)I.push(N,_,v,n)},Df=function(D,r,W){if(r)for(var E,V,$,y=r[0],i=r[1],c=r[2],Q=r[4],d=r[5],F=r[6],O=r[8],J=r[9],z=r[10],I=r[12],A=r[13],R=r[14],a=W.length,l=0,l=0;a>l;l+=3)E=W[l],V=W[l+1],$=W[l+2],D.push(y*E+Q*V+O*$+I,i*E+d*V+J*$+A,c*E+F*V+z*$+R);else Zn(D,W);return D},Sm=function(k,d,Q){var B=d.s("light.intensity"),s=Ql(d.s(us)),A=s[0],C=s[1],l=s[2];1!==B&&(A*=B,C*=B,l*=B);var x=d.s("light.disabled");k.push(A,C,l,x?1:0),Q.c.push(A,C,l),Q.g.push(x?-1:d.s("light.group")),Q.e.push(x?1:0)},wb=function(e,v){var h,U=Zq.for(v),G=U.directUniforms(),j=e._lastLightUploadInfo={c:[],g:[],e:[]},x=e._headlightDirection;x&&3===x.length?h=x:"shadow"===x&&(h=e.shadowMap.getDirection()),h=h?Ab.normalizeArray(e._transformDirectionToViewSpace(null,h)):[0,0,0],G.uHeadlightDirection=h,G.uHeadlightRange=e._headlightRange;var I=G.uHeadlightAmbientIntensity=e._headlightAmbientIntensity,d=e._headlightIntensity,b=Ql(e._headlightColor);1!==d&&(b=[b[0]*d,b[1]*d,b[2]*d]);var E;G.uHeadlightColor=[b[0],b[1],b[2],(E=e._headlightDisabled)?1:0],j.c.push(b[0],b[1],b[2]),j.g.push(E?-1:e._headlightGroup),j.e.push(E?1:0);var w=e._59O,A=e._spots,u=e._dirs;if(w.length){var p=[],k=[],a=[];w.forEach(function(h){Sm(p,h,j),Zn(k,e._transformPointToViewSpace(h.p3())),a.push(h.s("light.range"))}),G.uPointColor=p,G.uPointRange=a,G.uPointPosition=k}if(A.length){var B=[],i=[],V=[],L=[],c=[],P=[];A.forEach(function(l){Sm(B,l,j),Zn(i,e._transformPointToViewSpace(l.p3())),Zn(c,e._transformDirectionToViewSpace(l.p3(),l.s("light.center"))),V.push(l.s("light.range")),L.push(W(l.s("light.angle")/2)),P.push(l.s("light.exponent"))}),G.uSpotColor=B,G.uSpotRange=V,G.uSpotAngle=L,G.uSpotExponent=P,G.uSpotPosition=i,G.uSpotDirection=c}if(u.length){var Y=[],y=[];u.forEach(function(m){Sm(Y,m,j),Zn(y,e._transformDirectionToViewSpace(m.p3()))}),G.uDirColor=Y,G.uDirDirection=y}e._lastLightMask=zf,e._lastHeadlightAmbientIntensity=I},ib=function(N,A,X,r){if(r===P&&(r=N._headlightAmbientIntensity),r!==N._lastHeadlightAmbientIntensity&&(A.uHeadlightAmbientIntensity=N._lastHeadlightAmbientIntensity=r),X!==N._lastLightMask){N._lastLightMask=X;var s=N._lastLightUploadInfo;if(s){var Z,x,k,n=s.g,e=s.e,l=n.length,Y=new Array(l),p=!1;for(x=0;l>x;x++)Z=n[x],k=0>Z||Z>=32?1:X&1<<Z?0:1,Y[x]=k,k!==e[x]&&(p=!0);if(p){s.e=e=Y;var h=s.c;A.uHeadlightColor=[h[0],h[1],h[2],e[0]];var G,i=N._59O,E=N._spots,I=N._dirs,J=3,U=1;if(l=i.length){for(x=0,G=[];l>x;x++)G.push(h[J++],h[J++],h[J++],e[U++]);A.uPointColor=G}if(l=E.length){for(x=0,G=[];l>x;x++)G.push(h[J++],h[J++],h[J++],e[U++]);A.uSpotColor=G}if(l=I.length){for(x=0,G=[];l>x;x++)G.push(h[J++],h[J++],h[J++],e[U++]);A.uDirColor=G}}}}},ei=function(o,L){return Math.max(o.getRotateMinPhi()+pq,Math.min(o.getRotateMaxPhi()-pq,L))},Rd=function(){return.05+Cn()/2},Af=function(O,$,F,H){var g,s=O.getEye();return O.isOrtho()?(g=tf(O.getCenter(),s),g[0]+=H[0],g[1]+=H[1],g[2]+=H[2]):g=s,Qm($,F,H,g)},Qm=function(h,J,Z,g){var P=tc(h,J),j=tf(g,Z,!0),C=tc(j,J);if(B(C)<pq)return E;var T=(P-tc(Z,J))/C;return[Z[0]+j[0]*T,Z[1]+j[1]*T,Z[2]+j[2]*T]},Nl=function(N,J){return{x:2*N.x-J.x,y:2*N.y-J.y}},Mc=function(C,t,r,h){var i,S;if(!C)return i=Hr(t.y-r.y,r.x-t.x),{x:t.x+h*l(i),y:t.y+h*W(i)};if(!r)return i=Hr(C.y-t.y,t.x-C.x),{x:t.x+h*l(i),y:t.y+h*W(i)};var U=tf([C.x,C.y,0],[t.x,t.y,0],!0),s=tf([r.x,r.y,0],[t.x,t.y,0],!0),B=-(U[0]+s[0])/2,V=-(U[1]+s[1])/2,R=A(B*B+V*V);if(pq>R)return i=Hr(C.y-t.y,t.x-C.x),{x:t.x+h*l(i),y:t.y+h*W(i)};var j=C.x-t.x,c=C.y-t.y,w=r.x-t.x,x=r.y-t.y,u=A(j*j+c*c),d=A(w*w+x*x);i=e(tc(U,s))/2,S=U[1]*s[0]-U[0]*s[1]>0?-1:1,B/=R,V/=R;var I=h/l(i),Q=_(u,d)/W(i);R=Math.min(I,Q);var b={x:t.x+S*R*B,y:t.y+S*R*V};return r.b&&I>d/W(i)&&(b.adjust=!0),b},Dn=function(n){var t=n[1],C=n[2],p=n[3],X=n[6],z=n[7],f=n[11];n[1]=n[4],n[2]=n[8],n[3]=n[12],n[4]=t,n[6]=n[9],n[7]=n[13],n[8]=C,n[9]=X,n[11]=n[14],n[12]=p,n[13]=z,n[14]=f},Bf=function(G){var L=G[0],Y=G[1],r=G[2],x=G[3],o=G[4],_=G[5],p=G[6],a=G[7],S=G[8],w=G[9],P=G[10],J=G[11],W=G[12],y=G[13],$=G[14],M=G[15],A=L*_-Y*o,T=L*p-r*o,V=L*a-x*o,N=Y*p-r*_,c=Y*a-x*_,d=r*a-x*p,I=S*y-w*W,Z=S*$-P*W,i=S*M-J*W,D=w*$-P*y,n=w*M-J*y,h=P*M-J*$,s=A*h-T*n+V*D+N*i-c*Z+d*I;return s?(s=1/s,G[0]=(_*h-p*n+a*D)*s,G[1]=(r*n-Y*h-x*D)*s,G[2]=(y*d-$*c+M*N)*s,G[3]=(P*c-w*d-J*N)*s,G[4]=(p*i-o*h-a*Z)*s,G[5]=(L*h-r*i+x*Z)*s,G[6]=($*V-W*d-M*T)*s,G[7]=(S*d-P*V+J*T)*s,G[8]=(o*n-_*i+a*I)*s,G[9]=(Y*i-L*n-x*I)*s,G[10]=(W*c-y*V+M*A)*s,G[11]=(w*V-S*c-J*A)*s,G[12]=(_*Z-o*D-p*I)*s,G[13]=(L*D-Y*Z+r*I)*s,G[14]=(y*T-W*N-$*A)*s,G[15]=(S*N-w*T+P*A)*s,void 0):E},sp=function(h,H){if(H){var p=H[0],c=H[1],t=H[2];h[12]=h[0]*p+h[4]*c+h[8]*t+h[12],h[13]=h[1]*p+h[5]*c+h[9]*t+h[13],h[14]=h[2]*p+h[6]*c+h[10]*t+h[14],h[15]=h[3]*p+h[7]*c+h[11]*t+h[15]}},vc=function(n,P){if(P){var r=P[0],y=P[1],d=P[2];n[0]=n[0]*r,n[1]=n[1]*r,n[2]=n[2]*r,n[3]=n[3]*r,n[4]=n[4]*y,n[5]=n[5]*y,n[6]=n[6]*y,n[7]=n[7]*y,n[8]=n[8]*d,n[9]=n[9]*d,n[10]=n[10]*d,n[11]=n[11]*d}},Cq=function(U,L,V){var t=L[0],a=L[1],r=L[2],N=L[3],n=L[4],w=L[5],B=L[6],P=L[7],K=L[8],m=L[9],s=L[10],I=L[11],v=L[12],S=L[13],Z=L[14],M=L[15],q=V[0],Y=V[1],o=V[2],H=V[3];return U[0]=q*t+Y*n+o*K+H*v,U[1]=q*a+Y*w+o*m+H*S,U[2]=q*r+Y*B+o*s+H*Z,U[3]=q*N+Y*P+o*I+H*M,q=V[4],Y=V[5],o=V[6],H=V[7],U[4]=q*t+Y*n+o*K+H*v,U[5]=q*a+Y*w+o*m+H*S,U[6]=q*r+Y*B+o*s+H*Z,U[7]=q*N+Y*P+o*I+H*M,q=V[8],Y=V[9],o=V[10],H=V[11],U[8]=q*t+Y*n+o*K+H*v,U[9]=q*a+Y*w+o*m+H*S,U[10]=q*r+Y*B+o*s+H*Z,U[11]=q*N+Y*P+o*I+H*M,q=V[12],Y=V[13],o=V[14],H=V[15],U[12]=q*t+Y*n+o*K+H*v,U[13]=q*a+Y*w+o*m+H*S,U[14]=q*r+Y*B+o*s+H*Z,U[15]=q*N+Y*P+o*I+H*M,U},xm=function(j,Q,m,P){var O,C,y,F,r,x,l,$,u,b,o=Q[0],_=Q[1],n=Q[2],I=P[0],p=P[1],T=P[2],q=m[0],W=m[1],g=m[2];return B(o-q)<pq&&B(_-W)<pq&&B(n-g)<pq?db(j):(l=o-q,$=_-W,u=n-g,b=1/A(l*l+$*$+u*u),l*=b,$*=b,u*=b,O=p*u-T*$,C=T*l-I*u,y=I*$-p*l,b=A(O*O+C*C+y*y),b?(b=1/b,O*=b,C*=b,y*=b):(O=0,C=0,y=0),F=$*y-u*C,r=u*O-l*y,x=l*C-$*O,b=A(F*F+r*r+x*x),b?(b=1/b,F*=b,r*=b,x*=b):(F=0,r=0,x=0),j[0]=O,j[1]=F,j[2]=l,j[3]=0,j[4]=C,j[5]=r,j[6]=$,j[7]=0,j[8]=y,j[9]=x,j[10]=u,j[11]=0,j[12]=-(O*o+C*_+y*n),j[13]=-(F*o+r*_+x*n),j[14]=-(l*o+$*_+u*n),j[15]=1,j)},xl=function(F,U,V,S,u){var y=1/bj(U/2),X=1/(S-u);return F[0]=y/V,F[1]=0,F[2]=0,F[3]=0,F[4]=0,F[5]=y,F[6]=0,F[7]=0,F[8]=0,F[9]=0,F[10]=(u+S)*X,F[11]=-1,F[12]=0,F[13]=0,F[14]=2*u*S*X,F[15]=0,F},Pb=function(_,h,d,X,e,p,a){var R=1/(h-d),v=1/(X-e),w=1/(p-a);return _[0]=-2*R,_[1]=0,_[2]=0,_[3]=0,_[4]=0,_[5]=-2*v,_[6]=0,_[7]=0,_[8]=0,_[9]=0,_[10]=2*w,_[11]=0,_[12]=(h+d)*R,_[13]=(e+X)*v,_[14]=(a+p)*w,_[15]=1,_},vs=function(N,B){var Q=B[0],x=B[1],D=B[2],R=B[3],T=Q*Q+x*x+D*D+R*R,C=T?1/T:0;return N[0]=-Q*C,N[1]=-x*C,N[2]=-D*C,N[3]=R*C,N},qd=function(o,h){var K=h[0]+h[5]+h[10],z=0;return K>0?(z=2*Math.sqrt(K+1),o[3]=.25*z,o[0]=(h[6]-h[9])/z,o[1]=(h[8]-h[2])/z,o[2]=(h[1]-h[4])/z):h[0]>h[5]&h[0]>h[10]?(z=2*Math.sqrt(1+h[0]-h[5]-h[10]),o[3]=(h[6]-h[9])/z,o[0]=.25*z,o[1]=(h[1]+h[4])/z,o[2]=(h[8]+h[2])/z):h[5]>h[10]?(z=2*Math.sqrt(1+h[5]-h[0]-h[10]),o[3]=(h[8]-h[2])/z,o[0]=(h[1]+h[4])/z,o[1]=.25*z,o[2]=(h[6]+h[9])/z):(z=2*Math.sqrt(1+h[10]-h[0]-h[5]),o[3]=(h[1]-h[4])/z,o[0]=(h[8]+h[2])/z,o[1]=(h[6]+h[9])/z,o[2]=.25*z),o},Dd=function(d,q,V){var _=q[0],H=q[1],a=q[2],Z=q[3],B=_+_,p=H+H,T=a+a,z=_*B,j=_*p,f=_*T,s=H*p,E=H*T,i=a*T,t=Z*B,M=Z*p,I=Z*T;return d[0]=1-(s+i),d[1]=j+I,d[2]=f-M,d[3]=0,d[4]=j-I,d[5]=1-(z+i),d[6]=E+t,d[7]=0,d[8]=f+M,d[9]=E-t,d[10]=1-(z+s),d[11]=0,d[12]=V[0],d[13]=V[1],d[14]=V[2],d[15]=1,d},Bm=function(q,A){if(q.isVREnabled()){var K=q.vr.getViewMatrix(A);if(K)return K}return q._camera?q._camera.getViewMatrix(A):xm(A?A:Tc(),q._eye,q._center,q._up)},Am=function(x,d){if(x.isVREnabled()){var C=x.vr.getProjectMatrix();if(C)return C}if(x._camera)return x._camera.getProjectMatrix();if(!d&&x._computedProjectMatrix)return mf(x._computedProjectMatrix);var A=x.getAspect(),$=x._near,q=x._far,O=Tc();if(x._ortho){var l=x._orthoWidth/2,H=l/A;Pb(O,-l,l,-H,H,$,q)}else xl(O,x._fovy,A,$,q);return O},Gd=function(D,I){if(!D)return E;var V=0,w=1,P=2,q=[],H=0,O=D.length,Z=O/3;if(I){for(;O>H;H++)q[H]=0;for(H=0;H<I.length;H+=3){var z=[],x=[],n=[];z[V]=D[3*I[H+1]+V]-D[3*I[H]+V],z[w]=D[3*I[H+1]+w]-D[3*I[H]+w],z[P]=D[3*I[H+1]+P]-D[3*I[H]+P],x[V]=D[3*I[H+2]+V]-D[3*I[H+1]+V],x[w]=D[3*I[H+2]+w]-D[3*I[H+1]+w],x[P]=D[3*I[H+2]+P]-D[3*I[H+1]+P],n[V]=z[w]*x[P]-z[P]*x[w],n[w]=z[P]*x[V]-z[V]*x[P],n[P]=z[V]*x[w]-z[w]*x[V];for(var t=0;3>t;t++)q[3*I[H+t]+V]+=n[V],q[3*I[H+t]+w]+=n[w],q[3*I[H+t]+P]+=n[P]}}else for(H=0;Z>H;H+=3){var z=[],x=[],n=[];z[V]=D[3*(H+1)+V]-D[3*H+V],z[w]=D[3*(H+1)+w]-D[3*H+w],z[P]=D[3*(H+1)+P]-D[3*H+P],x[V]=D[3*(H+2)+V]-D[3*(H+1)+V],x[w]=D[3*(H+2)+w]-D[3*(H+1)+w],x[P]=D[3*(H+2)+P]-D[3*(H+1)+P],n[V]=z[w]*x[P]-z[P]*x[w],n[w]=z[P]*x[V]-z[V]*x[P],n[P]=z[V]*x[w]-z[w]*x[V];for(var t=0;3>t;t++)q[3*(H+t)+V]=n[V],q[3*(H+t)+w]=n[w],q[3*(H+t)+P]=n[P]}for(H=0;O>H;H+=3){var f=[];f[V]=q[H+V],f[w]=q[H+w],f[P]=q[H+P];var u=A(f[V]*f[V]+f[w]*f[w]+f[P]*f[P]);
0===u&&(u=pq),f[V]=f[V]/u,f[w]=f[w]/u,f[P]=f[P]/u,q[H+V]=f[V],q[H+w]=f[w],q[H+P]=f[P]}return new Ui(q)},De=function(n,S,W,K){if(W||(W=n.createTexture()),S){var U=n.TEXTURE_2D,$=n.REPEAT,H=n.CLAMP_TO_EDGE,X=n.TEXTURE_MIN_FILTER;K=K||gg;var Q=K.minFilter||K.filter||n.LINEAR,D=K.magFilter||K.filter||n.LINEAR;n.activeTexture(n.TEXTURE0),ef(n,W),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texImage2D(U,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,S),pi(n,n.TEXTURE_MAG_FILTER,D);var L=S.naturalWidth||S.width,w=S.naturalHeight||S.height;Uj.isPOT(L)&&Uj.isPOT(w)&&!K.clampToEdge&&!S.clampToEdge?(pi(n,n.TEXTURE_WRAP_S,$),pi(n,n.TEXTURE_WRAP_T,$),pi(n,X,Q===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_LINEAR),K.mipmapMaxLevel!==P&&pi(n,n.TEXTURE_MAX_LEVEL,K.mipmapMaxLevel),n.generateMipmap(U)):(pi(n,n.TEXTURE_WRAP_S,H),pi(n,n.TEXTURE_WRAP_T,H),pi(n,X,Q)),ef(n,E)}return W},Bh=function(G,t,i){var d=new Uint8Array(i||4);return t=t||G.createTexture(),G.activeTexture(G.TEXTURE0),ef(G,t),pi(G,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,1,1,0,G.RGBA,G.UNSIGNED_BYTE,d),t},gn=function(j,K,Y){var $=new Uint8Array(Y||4);return K=K||j.createTexture(),j.activeTexture(j.TEXTURE0),j.bindTexture(j.TEXTURE_CUBE_MAP,K),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MAG_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,j.RGBA,1,1,0,j.RGBA,j.UNSIGNED_BYTE,$),K},Zi=function(S){S._26I&&S._prg&&(S._26I.deleteProgram(S._prg),S._prg=E)},Xk=function(){function E(e){if(e.match(v))return sr(e);var I=c[e];if(I)return I;var A=new RegExp("#define\\s+"+e+"\\s+(\\d+)"),U=F.match(A);return c[e]=U?sr(U[1]):0}function i(t){c={},F=t;var G=t.replace(Q,T).replace(z,b);return F=null,c=null,G}function T(F,K,e){e=E(e);for(var c="",S=0;e>S;S++)c+=K+S+";";return c}function b(r,N,m,B){for(var e="",c=E(N);c<E(m);c++)e+=B.replace(/\[\s*i\s*\]/g,"["+c+"]").replace(/\[\s*I\s*\]/g,c);return e}var c,F,Q=/(uniform\s+sampler2D\s+\w+)\[([\S\d]+)\];/g,z=/#UNROLL_LOOP_START\s+for\s*\(\s*int\s+i\s*=\s*([\S\d]+)\s*;\s*i\s*<\s*([\S\d]+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#UNROLL_LOOP_END/g,v=/^\d+$/;return function(h){return i(h)}}(),dq=function(Z,R,S,_){var H=Z.createShader(S);return Z.shaderSource(H,Xk(_)),Z.compileShader(H),Z.attachShader(R,H),H},Ke=function(v){return v.createBuffer()},ef=function(y,a){y.bindTexture(y.TEXTURE_2D,a||y._emptyTexture)},pi=function(J,t,M){J.texParameteri(J.TEXTURE_2D,t,M)},ue=function(X,T){var V=Zq.for(X).directState();V.polygonOffset.enabled=!0,V.polygonOffset.value=T},Vf=function(H){var h=Zq.for(H).directState();h.polygonOffset.enabled=!1},Wf=function(x,c){if(c){var P=Zq.for(x).directState();P.color.clear=Ql(c)}},Kb=function(O,b,V){if(V!==b._lastClipboxEnabled){var T=O._boxClipperGroups,z=O._boxClipperShape,X=T?T.length:0,Y=new Array(X);if(V)for(var g=0;X>g;g++)Y[g]=V&1<<T[g]?z[g]:0;b._lastClipboxEnabled=V,b.uClipperShape=Y}},Jf=Kb,or=function(F){var G=Zq.for(F),t=G.directUniforms(),J=G.directAttribs();t.uFix=!0,J.aNormal=!1},Dp=function(v){var h=Zq.for(v),D=h.directUniforms();D.uFix=!1},Yk=function(g,U,n,P,c,z,y,C){var N=Zq.for(g),A=N.directState(),k=N.directUniforms();g._picking||(n?(k.uBlend=!0,k.uBlendColor=n):k.uBlend=!1,k.uLight=k.uFog=P==E?!0:P,Kg(c)&&1!==c&&(k.uPartOpacity=c),k.uReverseFlip=z==E?!1:z,k.uFixPickReverseColor=y||pd),A.cullFace.enabled=C?!0:!1},jf=function(v){if(!v._picking){var K=Zq.for(v),B=K.directUniforms();B.uPartOpacity=1}},tg=function(){var D=new h.Math.Matrix2d,t=[1,0,0,0,1,0,0,0,0];return function(m,p,g,O,M,Y,I,R,l,L,y){var d=Zq.for(m),J=d.directUniforms(),j=d.directAttribs();return g?(J.uTexture=!0,J.uDiscardSelectable=mh(O)?O:!0,j.aUv=Mk(m,M,Y,E,2),y?(J.uBlendTexture=!0,J.uBlendSampler=y):(J.uBlendTexture=!1,J.uBlendSampler=m._emptyBlendTexture),J.uSampler=g,J.uUvMatrix=I||R||l||L?$n(l,I,R,L,D).toArray9():t,void 0):(J.uSampler=m._emptyTexture,J.uBlendSampler=m._emptyBlendTexture,void 0)}}(),ph=function(l,U,c){var d=Zq.for(l),C=d.directUniforms(),m=d.directAttribs();l.activeTexture(l.TEXTURE0),ef(l,E),l.activeTexture(l.TEXTURE1),ef(l,E),c&&(m.aUv=!1,C.uTexture=!1,C.uSampler=l._emptyTexture,C.uBlendTexture=!1,C.uBlendSampler=l._emptyBlendTexture)},hh=function(f,D,p,r,C,k){var z=Zq.for(f),R=z.directUniforms(),u=z.directAttribs();!p||Wm||$l||f.lineWidth(p),r&&!f._picking&&(R.uFixPickReverseColor=r),C&&(u.aPosition=Mk(f,C,k,E))},Mp=function(X,F,r,K,_){Fi&&(K=X[Fi]),_?X.drawArraysInstanced(K==E?X.TRIANGLES:K,F,r,_):X.drawArrays(K==E?X.TRIANGLES:K,F,r);var c=X._renderInfo;c&&(c.calls++,_&&(r*=_),c.vertices+=r,(K==E||K===X.TRIANGLES)&&(c.faces+=r/3),K===X.LINES&&(c.lines+=r/2),K===X.POINTS&&(c.points+=r))},Dg=function(S,r,G,y,U,k){Fi&&(y=S[Fi]),k?S.drawElementsInstanced(y==E?S.TRIANGLES:y,G,U==E?S.UNSIGNED_SHORT:U,r==E?0:2*r,k):S.drawElements(y==E?S.TRIANGLES:y,G,U==E?S.UNSIGNED_SHORT:U,r==E?0:2*r);var V=S._renderInfo;V&&(V.calls++,k&&(G*=k),V.vertices+=G,(y==E||y===S.TRIANGLES)&&(V.faces+=G/3),y===S.LINES&&(V.lines+=G/2),y===S.POINTS&&(V.points+=G))},jh=function(n,N,U){var j=n.ARRAY_BUFFER;return n.bindBuffer(j,N),U&&n.bufferData(j,U,n.STATIC_DRAW),N},Ge=function(Y,S,O,Z,I){var S=Mk(Y,S,O,Z,I);return S.instanced=!0,S},Mk=function(S,n,$,z,x){return $?zm(S,S.ARRAY_BUFFER,n,$):jh(S,n,$,z,x)},Zm=function(W,T,C){var Y=W.ELEMENT_ARRAY_BUFFER;W.bindBuffer(Y,T),C&&W.bufferData(Y,C,W.STATIC_DRAW)},Vj=function(d,J,n){zm(d,d.ELEMENT_ARRAY_BUFFER,J,n)},zm=function(D,H,a,e){var m=e._bufId;m||(m=e._bufId=h.Math.generateIncreasingID());var a,I=D._bufPool;return(a=I[m])&&a._buf?D.bindBuffer(H,a._buf):(a=I[m]={_buf:Ke(D)},D.bindBuffer(H,a._buf),D.bufferData(H,e,D.STATIC_DRAW)),a._fid=D._renderInfo.frame,a._buf},lk=function(P,j){j!=E&&j>=0&&P.enableVertexAttribArray(j)},sk=function(O,N){N!=E&&N>=0&&O.disableVertexAttribArray(N)},Vh=function(l,i){var W=l.getGL(),Y=Zq.for(W),o=Y.directUniforms();l._7O=l._8O.pop(),i&&(o.uMVMatrix=l._7O,l._6O=i,o.uNMatrix=i)},Em=function(e,o){return o||(o=Tc()),Oe(o,e),Bf(o),Dn(o),o},qs=function(X,O){var I=X.getGL(),r=X._7O,p=Zq.for(I),R=p.directUniforms();O?(X._8O.push(mf(r)),R.uMMatrix=O,Cq(r,r,O),X._7O=r):R.uMMatrix=Jm,R.uMVMatrix=r,R.uNMatrix=Em(r,X._6O)},Vm={body:0,label:1,label2:2,note:3,note2:4,symbol:5},uh=10,Ul=function(T,j,J,d,P,h){var y;if(J){var x=d._pickId;x||(x=d._pickId=j._pickIdUsed,j._pickIdUsed+=uh);var p,H=Vm[P];if(null!=H)p=x+H;else{var k=d._pickExtraPartMap;k||(k=d._pickExtraPartMap={}),(p=k[P])||(p=k[P]=j._pickIdUsed++)}j[p]||(j[p]={data:d.data,part:P}),y=Ws(p)}else y=fs;if(!h){var w=Zq.for(T),X=w.directUniforms();X.uFixPickReverseColor=y}return y},Cf=Ul,Mr=function(A,f,X){"target"!==X&&(X="source");var h="target"===X?f.getTargetAgent():f.getSourceAgent(),H="edge."+X+".";if(bk(h)){var N=f.s(H+"anchor.x"),E=f.s(H+"anchor.elevation"),i=f.s(H+"anchor.y"),M=$f(h,A.getMat(h)),V=h.getAnchor3d(),l=kc([(N===P?.5:N)-V.x,(E===P?.5:E)-V.y,(i===P?.5:i)-V.z],M);return l[1]+=f.s(H+"offset.elevation"),l}var j=f.s(H+"index"),e=A.getData3dUI(h);if(!e.info||!e.info.list)return!1;if(j>=0){var C,Q,q,Y,_,W=e.info._lastPointsSegments,U=W.points,z=W.segments,F=-1,x=-1;for(q=0,Y=z?z.length:U.length;Y>q;q++){if(Q=z?z.get(q):1,3===Q)_=2;else if(4===Q)_=3;else{if(5===Q)continue;_=1}if(F+=_,x++,x===j){C=U.get(F);break}}return C||(C=U.get(U.length-1)),[C.x,(C.e||0)+f.s(H+"offset.elevation"),C.y]}var J=f.s(H+"percent")||.5;if(J=Math.max(0,Math.min(J,1)),!e||!e.getCache)return!1;var s=e.getCache(),Y=s[s.length-1].length,W=A.getLineOffset(h,J*Y),l=W.point;return[l.x,l.y+f.s(H+"offset.elevation"),l.z]},dk=function(){var z={center:function(B,G,g,p,T){var u=-G[1]/2,M={x:-G[0]/2,y:u,width:G[0],height:G[1]},w=Ac(B,M,g);return[w.x+p,-w.y-T,K.getPosition3dGap()]},front:function(F,J,w,h,U){var m=-J[1]/2,Q={x:-J[0]/2,y:m,width:J[0],height:J[1]},s=Ac(F,Q,w);return[s.x+h,-s.y-U,J[2]/2+K.getPosition3dGap()]},back:function(n,v,o,F,B){var c=-v[0]/2,u=-v[1]/2,N={x:c,y:u,width:v[0],height:v[1]},x=Ac(n,N,o);return[-x.x-F,-x.y-B,-v[2]/2-K.getPosition3dGap()]},left:function(Q,M,B,C,g){var Z=-M[1]/2,j={x:-M[2]/2,y:Z,width:M[2],height:M[1]},f=Ac(Q,j,B);return[-M[0]/2-K.getPosition3dGap(),-f.y-g,f.x+C]},right:function(J,S,_,p,y){var b=-S[2]/2,I=-S[1]/2,e={x:b,y:I,width:S[2],height:S[1]},z=Ac(J,e,_);return[S[0]/2+K.getPosition3dGap(),-z.y-y,-z.x-p]},top:function(J,E,L,i,x){var h={x:-E[0]/2,y:-E[2]/2,width:E[0],height:E[2]},$=Ac(J,h,L);return[$.x+i,E[1]/2+K.getPosition3dGap(),$.y+x]},bottom:function(m,O,H,x,I){var p=-O[2]/2,j={x:-O[0]/2,y:p,width:O[0],height:O[2]},z=Ac(m,j,H);return[z.x+x,-O[1]/2-K.getPosition3dGap(),-z.y-I]}};return function(l,S,D,_,T,u){return z[_](l,S,D,T||0,u||0)}}(),Yj=function(n,H,x,K,B,P,d,v,Q,_){if(B&&(H[0]+=B[0],H[1]+=B[1],H[2]+=B[2]),sp(n,x),v){var G=Tc();if(Qc(G,Q,_),kc(H,G),sp(n,H),n.auto=v,n.pos=kc([0,0,0],n),P){var E=n.mat2=Tc();Qc(E,P,d)}}else Qc(n,Q,_),sp(n,H),K===zi?rh(n,-ss):K===es?rh(n,ss):K===Mo?uo(n,-ss):K===de?uo(n,ss):K===mc&&rh(n,D),Qc(n,P,d);return n},qj=function(U,d){var A=d.auto,C=d.mat2,$=U.gv;if(A){var q,X=Tc(),b=[0,0,0,0];q="string"==typeof A?[A.indexOf("x")<0?$._eye[0]:$._center[0],A.indexOf("y")<0?$._eye[1]:$._center[1],A.indexOf("z")<0?$._eye[2]:$._center[2]]:$._eye,qd(b,xm(Tc(),q,$._center,$._up)),Dd(X,vs(b,b),d.pos),C&&Cq(X,X,C),qs($,X)}else qs($,d)},Mi=function(c,e,d,O,N){var S=c.s,Q=c.gv,q=Q.getGL(),R=Q._prg,Z=Q._buffer,D=Q._1O,h=Zq.for(q),g=h.directAttribs();De(q,Ar,D),qj(c,d),Yk(q,R,S(e+".blend"),S(e+".light"),S(e+".opacity"),S(e+".reverse.flip"),S(e+".reverse.color"),S(e+".reverse.cull")),tg(q,R,D,N,Z.uv,Rr),g.aPosition=Mk(q,Z.vs,O,E),g.aNormal=Mk(q,Z.ns,nj,E),Vj(q,Z.is,Hk),Dg(q,0,Hk.length),ph(q,R,D),jf(q,R),Vh(Q)},qc=function(u,R,x){var K=u.gv,o=u.data,U=u[R]={blend:K.getBodyColor(o)||K.getFaceBlend(o,R),light:K.getFaceLight(o,R),color:K.getFaceColor(o,R),opacity:K.getFaceOpacity(o,R),transparent:K.getFaceTransparent(o,R),reverseFlip:K.getFaceReverseFlip(o,R),reverseColor:K.getFaceReverseColor(o,R),reverseCull:K.getFaceReverseCull(o,R),texture:K.getFaceImage(o,R),blendTexture:K.getFaceBlendImage(o,R),discardSelectable:K.getFaceDiscardSelectable(o,R)};if("csg"!==R){U.uv=K.getFaceUv(o,R)||x&&x[R+"Uv"],U.uvScale=K.getFaceUvScale(o,R)||x&&x[R+"UvScale"],U.uvOffset=K.getFaceUvOffset(o,R)||x&&x[R+"UvOffset"],U.uvRotation=K.getFaceUvRotation(o,R)||x&&x[R+"uvRotation"],U.uvAnchor=K.getFaceUvAnchor(o,R)||x&&x[R+"uvAnchor"];var r=K.getFaceMat(o,R);if(r){var m=$f(o,r);o.appendAnchorMatrix3d(m),U.mat=m}}return U},In=function(k,Z,z,m,r){var h=k[m];if(h){if(!r(h.transparent))return;var u=k.data,v=k.gv,O=v._buffer,M=v.getTexture(h.texture,u,m),d=v.getTexture(h.blendTexture,u),T=Zq.for(Z),C=T.directUniforms(),o=T.directAttribs();tg(Z,z,M,h.discardSelectable,O.uv,h.tuv,h.uvOffset,h.uvScale,h.uvRotation,h.uvAnchor,d),Yk(Z,z,h.blend,h.light,h.opacity,h.reverseFlip,h.reverseColor,h.reverseCull),h.cs&&!v._batchColorDisabled?(C.uBatchColor=!0,o.aBatchColor=Mk(Z,O.batchColor,h.cs,z.aBatchColor,4)):C.uDiffuse=h.color||N["color.empty"],o.aPosition=Mk(Z,O.vs,h.vs,E),o.aNormal=Mk(Z,O.ns,h.ns,E),Mp(Z,0,h.vs.length/3),h.cs&&!v._batchColorDisabled&&(C.uBatchColor=!1,sk(Z,z.aBatchColor)),jf(Z,z),ph(Z,z,M)}},Hf=function(t,r,p){bs(t)?t.forEach(function(Q){Hf(Q,r,p)}):Om(t)?Hf(wq(r,t),r,p):Hh(t)?t.shape3d?Hf(t.shape3d,r,p):p.push(t):p.push(t)},Tj=function(){for(var b=50,X=arguments.length,u=[],v=0;X>v;v++)u[v]=arguments[v];Dq[ig]="Time : "+(new Date).toLocaleString()+", Info :"+u.join(", "),ig=(ig+1)%b,console.error("Failed to create shader.")},$n=function(){var J=new Uj.Matrix2d;return function(C,D,y,A,z){return z||(z=J),z.identity(),A&&z.translate(-A[0],-A[1]),y&&z.scale(y[0],y[1]),C&&z.rotate(C),A&&z.translate(A[0],A[1]),D&&z.translate(D[0],D[1]),z}}(),oe=function(j,O,M,T,u,X){var C,Q,U,Y,c,p,E,V,t,x,d,n=[T-O,u-M],P=j?j.length:0;for(U=0;P>U;U++){for(Y=2,C=j[U],c=C[0],p=C[1];Y+1<C.length;){if(E=C[Y],V=C[Y+1],Q=qi(O,M,T,u,c,p,E,V,!0)){t=[E-c,V-p],x=nk(t),t[0]/=x,t[1]/=x,x=tc(n,t),x=x>0?X:-X,d=[t[0]*x,t[1]*x];break}c=E,p=V,Y+=2}if(d)break}if(d)for(T=O+d[0],u=M+d[1],U=0;P>U;U++)for(Y=2,C=j[U],c=C[0],p=C[1];Y+1<C.length;){if(E=C[Y],V=C[Y+1],Q=qi(O,M,T,u,c,p,E,V,!0))return[0,0];c=E,p=V,Y+=2}return d?d:[T-O,u-M]},km=function(M){return"nearest"===M?Um.NEAREST:"linear"===M?Um.LINEAR:M},ag=h.graph3d={WebGLConstants:Um},cj=function(j,l,p){gd(M+".graph3d."+j,l,p)},jk="!~!<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~!<6/1!,!*{/mbdpMwVxpmg!,!z/mbdpMwVxpmg!-y/mbdpMwVxpmg)3dfw!>!^j]wVxpmg!<{zy/*enspgtobsu!+!yjsubNNv!+!^j]yjsubNxpmg)!>!mbdpMwVxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMwVxpmg!4dfw!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<enspgtobsu!+!yjsubNNv!+!yjsubNxpebit!>!esppDxpebit!QBNXPEBIT`FTV!gfegj$!gjeof$!~!<fdobutjEfojMb!>!fdobutjEfojMw!|!*itbEv)!gj!ITBE!gfegj$!gjeof$!~!<ttfouihjsCidubCb!>!ttfouihjsCidubCw!|!*ttfouihjsCidubCv)!gj!TTFOUIHJSCIDUBC!gfegj$!gjeof$!~!<eofmCidubCb!>!eofmCidubCw!|!*eofmCidubCv)!gj!EOFMCIDUBC!gfegj$!gjeof$!~!<spmpDidubCb!>!spmpDidubCw!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!gjeof$!~!<**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw!>!wVw!|!*fsvuyfUv)!gj!ftmf$!<*y/wVb!-**1/2!-wVb)4dfw!+!yjsubNwVv)3dfw)4dfw!>!wVw!QJMD`WV!gfegj$!<*enspgtobsu)4dfw!>!opjujtpQw!gjeof$!~!1!>>!SFQQJMD`YPC`YBN!gj$!<*enspgtobsu!+!yjsubNNv)4dfw!>!emspXw!<*yfusfw)4dfw!>!yfusfWw!gjeof$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf$!<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!ftmf!~!<**1/2!-mbnspOw!+!n)5dfw!+!yjsubNOv)4dfw!>!mbnspOw!<**^3]n!-^3]n)upe!-*^2]n!-^2]n)upe!-*^1]n!-^1]n)upe)4dfw!0!mbnspOb!>!mbnspOw!<*!efdobutoJyjsubNb!)4ubn!>!n!4ubn!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!gjeof$!|!*ldjQva)!gj!1!>>!SFQQJMD`YPC`YBN!gj$!<enspgtobsu!+!yjsubNWNv!>!yfusfw!5dfw!gjeof$!~!<enspgtobsu!+!efdobutoJyjsubNb!>!enspgtobsu!|!*fdobutoJftVv)!gj!FDOBUTOJIDUBC!gfegj$!<*1/2!-opjujtpQb)5dfw!>!enspgtobsu!5dfw!|!*ejpw)ojbn!ejpw!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]yjsubNxpmg!5ubn!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!<esppDxpebit!5dfw!hojzsbw!<yjsubNxpebit!5ubn!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEfojMb!ubpmg!fuvcjsuub!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCb!4dfw!fuvcjsuub!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCb!ubpmg!fuvcjsuub!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCb!5dfw!fuvcjsuub!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjujtpQw!4dfw!hojzsbw!<emspXw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<yjGv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!<yjsubNOv!5ubn!nspgjov!<yjsubNQv!5ubn!nspgjov!<yjsubNNv!5ubn!nspgjov!<yjsubNWNv!5ubn!nspgjov!<opjujtpQb!4dfw!fuvcjsuub!gjeof$!~!<*{zy/**1/1!-sje)5dfw!+!yjsubn))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsu!4dfw!<efdobutoJyjsubNb!5ubn!fuvcjsuub!<fdobutoJftVv!mppc!nspgjov!FDOBUTOJIDUBC!gfegj$!<mbnspOb!4dfw!fuvcjsuub!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<wVb!3dfw!fuvcjsuub!<yjsubNwVv!4ubn!nspgjov!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!YJGFSQ$!^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Je="!~!~!<eJ!>!spmpDhbsG`mh!~!<spmpDsfmqnbTwv!>+!eJ!<*zy/wVw!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw!|!*fsvuyfUeofmCv)!gj!gjeof$!~!<ttfouihjsCidubCw!>+!chs/eJ!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~!<ttfouihjsCv!>+!chs/eJ!|*1/2!>a!ttfouihjsCv)gj!gjeof$!~!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ!gjeof$!<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg!ftmf$!<*iuqfe!+!iuqfe!+!zujtofEhpGv!+!zujtofEhpGv!.)qyf!.!1/2!>!spudbGhpg!ubpmg!3QYF`HPG!gfegj$!<{/yfusfWw.!>!iuqfe!ubpmg!|!*hpGv)!gj!HPG!gfegj$!~!~!<zujdbqPusbQv!>+!b/eJ!|*1/2!>a!zujdbqPusbQv)gj!~!gjeof$!~!<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ!gjeof$!<*spmpDwof)sbfojMpUmfyfUqbNwof!>!spmpDwof!<**{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv)fcvDfsvuyfu!>!spmpDwof!5dfw!ftmf$!<**ttfoihvps!-*{z/dfWudfmgfs!-y/dfWudfmgfs.)4dfw!-qbNwoFv)WVfcvDfsvuyfu)CHStpUsbfojM!>!spmpDwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!<*mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!>!dfWudfmgfs!4dfw!ftmf$!<***mbnspOemspx!-yfusfWpUbsfnbd)udfmgfs!-ubvRqbnwoFv)spudfWfubups)f{jmbnspo!>!dfWudfmgfs!4dfw!FUBUPS`QBNWOF!gfegj$!<*yjsubNxfjWv!-O)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw!<*opjujtpQbsfnbDv!.!emspXw)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw!|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!gjeof$!~!~!~!~!<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ!<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt!|*^j]fmhoBupqTv!?!udfggFupqt)gj!<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg!<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSupqTv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDupqTv)gj!|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!gjeof$!~!~!~!<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!?!fhobSm)!gj!~!<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm!|*1/1!?!^j]fhobSuojpQv)!gj!<1/2!>!fhobSm!ubpmg!<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw!|*1/1!>>!x/^j]spmpDuojpQv)gj!|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!gjeof$!~!~!<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ!|*1/1!>>!x/^j]spmpDsjEv)gj!|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~!<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ!gjeof$!~!<fvmbWxpebit!+!zujtofuoJxpebit!.!1/2!>+!nsfUusfcnbm!~!<osvufs!<esbdtje!|!*1/1!>>!fvmbWxpebit!%%!mmvDxpebit)!gj!<*esppDxpebit!-tvjebSxpebit!-tbjCxpebit!-f{jTxpebit!-qbNxpebit)xpebiTufh!.!1/2!>!fvmbWxpebit!ubpmg!|!*fwjfdfSxpebit)!gj!QBNXPEBIT`FTV!gfegj$!~!<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!>+!nsfUusfcnbm!|*1/1!?!fhobSuihjmebfIv)gj!<*1/1!-zujtofuoJuofjcnBuihjmebfIv!,!*zujtofuoJuofjcnBuihjmebfIv!.!1/2)!+!nsfUusfcnbm)ybn!>!nsfUusfcnbm!<*opjudfsjEuihjmebfIv.!-O)upe!>!nsfUusfcnbm!ftmf!<*M.!-O)upe!>!nsfUusfcnbm!*1/1!>>!{/opjudfsjEuihjmebfIv!%%!1/1!>>!z/opjudfsjEuihjmebfIv!%%!1/1!>>!y/opjudfsjEuihjmebfIv)!gj!<nsfUusfcnbm!ubpmg!|*1/1!>>!x/spmpDuihjmebfIv)gj!gjeof$!EOF`QPPM`MMPSOV$!~!gjeof$!<chs/mfyfUxpmg!>,!chs/eJ!ftmf$!<bchs/mfyfUxpmg!>,!bchs/eJ!*!BCHS`EEB`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>!bchs/eJ!*!BCHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<b/mfyfUxpmg!>!b/eJ!*!B`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>!chs/eJ!*!CHS`FEJSSFWP`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<bchs/mfyfUxpmg!>+!bchs/eJ!*!BCHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gjmf$!<chs/mfyfUxpmg!>+!chs/eJ!*!CHS`ZMQJUMVN`FEPN`EOFMC`XPMG!)efojgfe!gj$!****1/1)3dfw!-^j]wVxpmg)obiUsfubfsh)mmb!%%!***1/2)3dfw!-^j]wVxpmg)obiUttfm)mmb!%%!^j]efmcboFxpmg)!gj!<*^j]wVxpmg!-^J]fsvuyfUxpmg)E3fsvuyfu!>!mfyfUxpmg!|!*,,j!<UDFKCP`XPMG`YBN!=!j!<1>j!uoj)!spg!USBUT`QPPM`MMPSOV$!<mfyfUxpmg!5dfw!1!?!UDFKCP`XPMG`YBN!gj$!|!*uihjMv)!gj!~!gjeof$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf$!~!<spmpDeofmCv!>+!eJ!|*eofmCv)gj!ftmf!~!<eofmCidubCw!>+!chs/eJ!|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~!~!<esbdtje!|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~!<ftvggjEv!>!eJ!|ftmf~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!ftmf!~!<spmpDwv!>!eJ!|*fsvuyfUv)gj!|!ftmf!~!<spmpDftsfwfSldjQyjGv!>!eJ!|*qjmGftsfwfSva!%%!ldbCtj)gj!~!<fvsu!>!ldbCtj!<O.!>!O!|*1/1!=!*O!-F)upe)gj!<ftmbg!>!ldbCtj!mppc!<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw!|!ftmf!~!gjeof$!~!~!<ftvggjEv!>!eJ!|ftmf!~!<esbdtje!|*1/1!>>!x/ftvggjEv)gj!|!*fdobutjEitbEv!?!*fdobutjEqbHitbEv!-fdobutjEfojMw)epn!%%!itbEv)!gj!ITBE!gfegj$!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!eJ!|!ftmf!~!<spmpDidubCw!>!eJ!|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|!*yjGv)!gj!<eJ!5dfw!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!|!ftmf!~!<spmpDidubCw!>!spmpDhbsG`mh!|!*spmpDidubCv)!gj!SPMPDIDUBC!gfegj$!|!*ldjQv)!gj!~!<osvufs!<*1/2!-1/1!-1/1!-1/1)5dfw!>!spmpDhbsG`mh!|!*uvpldbmc)!gj!gjeof$!~!~!<osvufs!<esbdtje!|!**6/1!=!*mbdpMw)iuhofm)!>a!^j]sfooJqjmDsfqqjmDv!%%!3!>>!^j]fqbiTsfqqjmDv!}}!***ojNqjmd!-mbdpMw)obiUsfubfsh)mmb!%%!**ybNqjmd!-mbdpMw)obiUttfm)mmb)!>a!^j]sfooJqjmDsfqqjmDv!%%!2!>>!^j]fqbiTsfqqjmDv)!gj!<**1/2!-emspXw)5dfw!+!^j]yjsubNsfqqjmDv)4dfw!>!mbdpMw!|!*,,j!<SFQQJMD`YPC`YBN!=!j!<1!>!j!uoj)!spg!<mbdpMw!4dfw!1!?!SFQQJMD`YPC`YBN!gj$!~!gjeof$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQw!-sje)upe)!gj!ftmf$!~!<esbdtje!|!**sje!-*uofdsfQqjmDv)4dfw)upe!?!*opjujtpQqjmd!-sje)upe)!gj!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2.!>!y/sje!|!*:!=!opjudfsjEqjmDv)!gj!ftmf!~!<*1/1!-1/1!-{/wVw)4dfw!>!opjujtpQqjmd!<1/2!>!y/sje!|!*9!=!opjudfsjEqjmDv)!gj!ftmf!QJMD`WV!gfegj$!~!<1/2.!>!{/sje!|!*8!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!{/sje!|!*7!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!z/sje!|!*6!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!z/sje!|!*5!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2.!>!y/sje!|!*4!=!opjudfsjEqjmDv)!gj!ftmf!~!<1/2!>!y/sje!|!*3!=!opjudfsjEqjmDv)!gj!gjeof$!<opjujtpQw!>!opjujtpQqjmd!4dfw!QJMD`WV!gfegj$!<*1/1!-1/1!-1/1)4dfw!>!sje!4dfw!|!*1!?!opjudfsjEqjmDv)!gj!~!~!~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!|!ftmf!~!~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!|!*uofsbqtobsUv)!gj!gjeof$!<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!ftmf$!<*zy/wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv!QJMD`WV!gfegj$!|!**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)!gj!<spmpDwv!5dfw!|!*ejpw)ojbn!ejpw!<uvpldbmc!mppc!nspgjov!gjeof$!<^UDFKCP`XPMG`YBN]wVxpmg!3dfw!hojzsbw!<^UDFKCP`XPMG`YBN]efmcboFxpmg!mppc!nspgjov!<^UDFKCP`XPMG`YBN]fsvuyfUxpmg!E3sfmqnbt!nspgjov!1!?!UDFKCP`XPMG`YBN!gj$!gjeof$!gjeof$!~!~!<*1/2!-*Gqjn!-2spmpd!-1spmpd)yjn)5dfw!osvufs!<*1/2!,!uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!2spmpd!4dfw!|!ftmf!~!<*1/2!-1spmpd)5dfw!osvufs!|!*1/1!>>!Gqjn)!gj!<*uoJqjn!-sjEfmqnbt!-qbNwof)WVfcvDsbfojmjc!>!1spmpd!4dfw!<*qjn)sppmg!>!uoJqjn!ubpmg!<*qjn)udbsg!>!Gqjn!ubpmg!<*mfwfMqjNybn`WVfcvd!-1n!-*ttfoihvps)qjNpUttfoihvps)qnbmd!>!qjn!ubpmg!|!*ttfoihvps!ubpmg!-sjEfmqnbt!4dfw!-qbNwof!E3sfmqnbt)WVfcvDfsvuyfu!5dfw!~!<qjn!osvufs!~!<*ttfoihvps!+!72/2)3hpm!+!1/3!.!>!qjn!|!ftmf!~!<6n!,!*7s!.!6s)!0!*6n!.!7n)!+!*ttfoihvps!.!6s)!>!qjn!|!*7s!>?!ttfoihvps)!gj!ftmf!~!<5n!,!*6s!.!5s)!0!*5n!.!6n)!+!*ttfoihvps!.!5s)!>!qjn!|!*6s!>?!ttfoihvps)!gj!ftmf!~!<2n!,!*5s!.!2s)!0!*2n!.!5n)!+!*ttfoihvps!.!2s)!>!qjn!|!*5s!>?!ttfoihvps)!gj!ftmf!~!<1n!,!*2s!.!1s)!0!*1n!.!2n)!+!*ttfoihvps!.!1s)!>!qjn!|!*2s!>?!ttfoihvps)!gj!<1/1!>!qjn!ubpmg!|!*ttfoihvps!ubpmg)qjNpUttfoihvps!ubpmg!1/5!7n!fojgfe$!9411/1!7w!fojgfe$!23/1!7s!fojgfe$!1/4!6n!fojgfe$!721/1!6w!fojgfe$!614/1!6s!fojgfe$!1/3!5n!fojgfe$!751/1!5w!fojgfe$!5/1!5s!fojgfe$!1/2!.!2n!fojgfe$!783/1!2w!fojgfe$!9/1!2s!fojgfe$!1/3!.!1n!fojgfe$!:44/1!1w!fojgfe$!1/2!1s!fojgfe$!~!<*z/g!-nc!-nu)yjn!osvufs!<*y/g!-sc!-mc)yjn!>!nc!4dfw!<*y/g!-su!-mu)yjn!>!nu!4dfw!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mc!4dfw!<f{jTmfyfu!>.!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!sc!4dfw!<f{jTmfyfu!>,!z/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!su!4dfw!<f{jTmfyfu!>,!y/wv!<chs/**wv!-qbNwof)E3fsvuyfu)sbfojMpUmfyfUqbNwof!>!mu!4dfw!<f{jTmfyfu!>+!wv!<*f{jTfdbg!+!1/3!.!f{jTfmjUybn`WVfcvd!-1/1)ybn!+!1/4!>,!y/wv!<f{jTfmjUojn`WVfcvd!+!1/3!+!uoJsfumjg!>,!z/wv!~!<f{jTfmjUybn`WVfcvd!+!1/3!>,!z/wv!|!*mfwfMqjNybn`WVfcvd!=!uoJqjn)!gj!<f{jTfdbg!+!fdbg!>,!y/wv!~!<1/4!>.!fdbg!<f{jTfdbg!>,!z/wv!|!*1/3!?!fdbg)!gj!<g!.!6/1!>,!wv!<*wv)udbsg!>!g!3dfw!<*1/2!.!f{jTfdbg)!+!*fdbg!-opjudfsje)WVufh!>!wv!3dfw!<*f{jTfmjUybn`WVfcvd!+!1/4)!0!1/2!>!f{jTmfyfu!ubpmg!<*uoJqjn)3qyf!>!f{jTfdbg!ubpmg!<*mfwfMqjNojn`WVfcvd!-uoJqjn)ybn!>!uoJqjn!<*1/1!-uoJqjn!.!mfwfMqjNojn`WVfcvd)ybn!>!uoJsfumjg!ubpmg!<*opjudfsje)fdbGufh!>!fdbg!ubpmg!|!*uoJqjn!ubpmg!-opjudfsje!4dfw!-qbNwof!E3sfmqnbt)WVfcvDsbfojmjc!4dfw!~!<*1/2!,!wv)!+!6/1!osvufs!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje)3dfw!>!wv!|!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/5!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje!.)3dfw!>!wv!|!*1/4!>>!fdbg)!gj!ftmf!~!<*{/opjudfsje)tcb!0!*z/opjudfsje!-y/opjudfsje!.)3dfw!>!wv!|!*1/3!>>!fdbg)!gj!ftmf!~!<*z/opjudfsje)tcb!0!*{/opjudfsje!.!-y/opjudfsje!.)3dfw!>!wv!|!*1/2!>>!fdbg)!gj!ftmf!~!<*y/opjudfsje)tcb!0!*z/opjudfsje!-{/opjudfsje)3dfw!>!wv!|!*1/1!>>!fdbg)!gj!<wv!3dfw!|!*fdbg!ubpmg!-opjudfsje!4dfw)WVufh!3dfw!~!<fdbg!osvufs!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/6!;!1/3!@!1/1!?!{/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!{/opjudfsjEtcb)!gj!|!ftmf!~!<1/5!;!1/2!@!1/1!?!z/opjudfsje!>!fdbg!ftmf!<1/4!;!1/1!@!1/1!?!y/opjudfsje!>!fdbg!*z/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!|!*{/opjudfsjEtcb!?!y/opjudfsjEtcb)!gj!<1/2!.!>!fdbg!ubpmg!<*opjudfsje)tcb!>!opjudfsjEtcb!4dfw!|!*opjudfsje!4dfw)fdbGufh!ubpmg!1/72!f{jTfmjUojn`WVfcvd!fojgfe$!1/763!f{jTfmjUybn`WVfcvd!fojgfe$!1/5!mfwfMqjNojn`WVfcvd!fojgfe$!1/9!mfwfMqjNybn`WVfcvd!fojgfe$!WV`FCVD`FQZU`QBNWOF!gfegj$!~!<*{zy/*yjsubn!+!*1/1!-sje)5dfw))f{jmbnspo!osvufs!|!*yjsubn!5ubn!oj!-sje!4dfw!oj)opjudfsjEnspgtobsUftsfwoj!4dfw!gjeof$!~!<*x/fvmbw!-**SPUDBG`BNNBH)4dfw!-{zy/fvmbw)xpq)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!ftmf$!~<*!b/fvmbw!-*!*!*!*!9142411/1!)4dfw!-chs/fvmbw!)mbvrFobiUttfm!)4dfw!-3:/32!+!chs/fvmbw!-*!661/1!)4dfw!.!661/2!+!*!*!77725/1!)4dfw!-chs/fvmbw!)xpq!)yjn!)5dfw!osvufs!|!*!fvmbw!5dfw!oj!)CHStpUsbfojM!5dfw!~!<*b/fvmbw!-****65151/1)4dfw!-chs/fvmbw)mbvrFobiUttfm)4dfw!-9194::4881/1!+!chs/fvmbw!-**5/3)4dfw!-*5218342361/1)4dfw!,!79:387985:/1!+!chs/fvmbw)xpq)yjn)5dfw!osvufs!|!*fvmbw!5dfw)sbfojMpUmfyfUqbNwof!5dfw!WV`FCVD`FQZU`QBNWOF!gfegj$!gjeof$!~!<{zy/*!*x/ubvr!-{/ubvr.!-z/ubvr.!-y/ubvr.)5dfw!-wr!)ubvRumvn!osvufs!<*!*1/1!-dfw)5dfw!-ubvr!)ubvRumvn!>!wr!5dfw!|!*!dfw!4dfw!-ubvr!5dfw!)spudfWfubups!4dfw!~!<*!{/3r!+!{/2r!.!z/3r!+!z/2r!.!y/3r!+!y/2r!.!x/3r!+!x/2r!-z/3r!+!y/2r!.!y/3r!+!z/2r!,!x/3r!+!{/2r!,!{/3r!+!x/2r!-y/3r!+!{/2r!.!{/3r!+!y/2r!,!x/3r!+!z/2r!,!z/3r!+!x/2r!-{/3r!+!z/2r!.!z/3r!+!{/2r!,!x/3r!+!y/2r!,!y/3r!+!x/2r)5dfw!osvufs!|!*3r!5dfw!-2r!5dfw)ubvRumvn!5dfw!<ubvRqbnwoFv!5dfw!nspgjov!FUBUPS`QBNWOF!gfegj$!<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!QBNWOF`FTV!gfegj$!gjeof$!~!gjeof$!<*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!osvufs!ftmf$!<*1/:!0!1/2)!+!*!*qe!-*z/f{jTmfyfu!-yyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zyy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-yzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzz/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*qe!-*z/f{jTmfyfu!-zzy/uftggp!,!E4ec)WVpUfcvd!-qbNxpebit)fsbqnpDE3fsvuyfu!)!osvufs!<z/f{jTmfyfu!+!tvjebSxpebit!+!*2!-2!.)3dfw!>!uftggp!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!}}!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!<*opjujtpQpUuihjm)f{jmbnspo!>!E4ec!4dfw!<tbjCxpebit!>,!qe!<*sbfObsfnbDxpebit!.!sbGbsfnbDxpebit)!0!*sbfObsfnbDxpebit!.!*opjujtpQpUuihjm)iuhofm)!>!qe!ubpmg!<{zy/esppDxpebit!>!opjujtpQpUuihjm!4dfw!<**1/3!-1/5)3dfw!+!f{jTqbNxpebit)!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!|!*sbGbsfnbDxpebit!ubpmg!-sbfObsfnbDxpebit!ubpmg!-esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTuojpQufh!ubpmg!~!<*68/1!-684/1)3dfw!,!sbobmq!+!*63/1!-632/1)3dfw!osvufs!~!<1/3!.!Zohjt!+!{/w!>!z/sbobmq!<1/3!,!Zohjt!+!1/3!,!y/w!>!y/sbobmq!<*z/w)ohjt!>!Zohjt!ubpmg!|!*foPutpnmb!>?!z/Wtcb)!gj!ftmf!~!<Yohjt!+!1/3!,!Yohjt!+!{/w!>!y/sbobmq!<*y/w)ohjt!>!Yohjt!ubpmg!|!*foPutpnmb!>?!y/Wtcb)!gj!ftmf!~!<y/w!.!1/5!>!y/sbobmq!*1/1!?!{/w)!gj!|!*foPutpnmb!>?!{/Wtcb)!gj!<mfyfUButpnmb!.!1/2!>!foPutpnmb!ubpmg!<Zf{jTmfyfu!+!6/2!>!mfyfUButpnmb!ubpmg!<zy/w!>!sbobmq!3dfw!<*Zf{jTmfyfu!+!1/3!.!1/2)!+!fcvDpUfmbdt!>+!w!<fcvDpUfmbdt!>+!Wtcb!<**{/Wtcb!-z/Wtcb)ybn!-y/Wtcb)ybn!0!1/2!>!fcvDpUfmbdt!ubpmg!<*w)tcb!>!Wtcb!4dfw!|!*Zf{jTmfyfu!ubpmg!-w!4dfw)WVpUfcvd!3dfw!~!<xpebit!osvufs!~!gjeof$!<*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!>!xpebit!ftmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-f{jTqbNxpebit!-qbNxpebit)qsfMxpebiTE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*UGPT`GDQ`FQZU`QBNXPEBIT)efojgfe!gjmf$!<*1/:!0!1/2)!+!*!*{/esppDxpebit!-*2ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*2ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1/1!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-2ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1/1)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!,!*{/esppDxpebit!-*1ze!-1ye)3dfw!,!zy/esppDxpebit!-qbNxpebit)fsbqnpDE3fsvuyfu!)!>!xpebit!<tvjebSxpebit!+!z/f{jTmfyfu!,!>!2ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!,!>!2ye!ubpmg!<tvjebSxpebit!+!z/f{jTmfyfu!.!>!1ze!ubpmg!<tvjebSxpebit!+!y/f{jTmfyfu!.!>!1ye!ubpmg!<f{jTqbNxpebit!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!*GDQ`FQZU`QBNXPEBIT)efojgfe!gj$!|!*utfUnvutvsg)!gj!<*dfWutfUnvutvsg)mmb!>!utfUnvutvsg!mppc!<*1/2!>=!{/esppDxpebit!-nvutvsGoj)3dfwc!>!dfWutfUnvutvsg!3dfwc!<*dfWnvutvsGoj)mmb!>!nvutvsGoj!mppc!<*1/2!>=!z/esppDxpebit!-1/1!>?!z/esppDxpebit!-1/2!>=!y/esppDxpebit!-1/1!>?!y/esppDxpebit)!5dfwc!>!dfWnvutvsGoj!5dfwc!<*::::::/1!-{/esppDxpebit)ojn!>!{/esppDxpebit!<tbjCxpebit!>,!{/esppDxpebit!<x/esppDxpebit!>0!{zy/esppDxpebit!<1/2!>!xpebit!ubpmg!|!*esppDxpebit!5dfw!-tvjebSxpebit!ubpmg!-tbjCxpebit!ubpmg!-f{jTqbNxpebit!3dfw!-qbNxpebit!E3sfmqnbt)xpebiTufh!ubpmg!~!<d!osvufs!<*y/g!-c!-b)yjn!>!d!ubpmg!<*z/g!-us!-cs)yjn!>!c!ubpmg!<*z/g!-um!-cm)yjn!>!b!ubpmg!<*6/1!,!f{jt!+!wv)udbsg!>!g!3dfw!<*fsbqnpd!-zz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!us!ubpmg!<*fsbqnpd!-yz/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cs!ubpmg!<*fsbqnpd!-zy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!um!ubpmg!<*fsbqnpd!-yy/uftggp!+!f{jTmfyfu!,!WVejpsuofd!-tiuqfe)fsbqnpDE3fsvuyfu!>!cm!ubpmg!<f{jt!0!*6/1!,!f{jt!+!wv)sppmg!>!WVejpsuofd!3dfw!<f{jt!0!*1/2)3dfw!>!f{jTmfyfu!3dfw!<*1/2!-1/1)3dfw!>!uftggp!3dfw!utopd!|!*fsbqnpd!ubpmg!-wv!3dfw!-f{jt!3dfw!-tiuqfe!E3sfmqnbt)qsfMxpebiTE3fsvuyfu!ubpmg!~!<***wv!-tiuqfe)E3fsvuyfu)iuqfEpUBCHSldbqov!-fsbqnpd)qfut!osvufs!|!*fsbqnpd!ubpmg!-wv!3dfw!-tiuqfe!E3sfmqnbt)fsbqnpDE3fsvuyfu!ubpmg!~!<*tspudbGldbqoV!-w)upe!osvufs!|!*w!5dfw!oj!utopd)iuqfEpUBCHSldbqov!ubpmg!<*/2!-tspudbGldbQ)5dfw!0!fmbdtoxpEldbqoV!>!tspudbGldbqoV!5dfw!utopd!<*/763!-/763!+!/763!-/763!+!/763!+!/763)4dfw!>!tspudbGldbQ!4dfw!utopd!</763!0!/663!>!fmbdtoxpEldbqoV!ubpmg!utopd!</663!0!/763!>!fmbdtqVldbQ!ubpmg!utopd!<esppDxpebit!5dfw!hojzsbw!<fwjfdfSxpebit!mppc!nspgjov!<tvjebSxpebit!ubpmg!nspgjov!<tbjCxpebit!ubpmg!nspgjov!<zujtofuoJxpebit!ubpmg!nspgjov!<f{jTxpebit!3dfw!nspgjov!<qbNxpebit!E3sfmqnbt!nspgjov!<mmvDxpebit!mppc!nspgjov!QBNXPEBIT`FTV!gfegj$!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw!<fdobutjEqbHitbEv!ubpmg!nspgjov!<fdobutjEitbEv!ubpmg!nspgjov!<itbEv!mppc!nspgjov!ITBE!gfegj$!gjeof$!gjeof$!<sbGhpGv!ubpmg!nspgjov!<sbfOhpGv!ubpmg!nspgjov!ftmf$!<zujtofEhpGv!ubpmg!nspgjov!3QYF`HPG!gfegj$!<hpGv!mppc!nspgjov!<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!gjeof$!<*6/1!-6/1!-6/1)4dfw!>!ybNqjmd!4dfw!utopd!<*6/1.!-6/1.!-6/1.)4dfw!>!ojNqjmd!4dfw!utopd!<^SFQQJMD`YPC`YBN]yjsubNsfqqjmDv!5ubn!nspgjov!<^SFQQJMD`YPC`YBN]sfooJqjmDsfqqjmDv!mppc!nspgjov!<^SFQQJMD`YPC`YBN]fqbiTsfqqjmDv!uoj!nspgjov!1!?!SFQQJMD`YPC`YBN!gj$!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov!<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov!<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov!<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov!<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov!<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov!<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov!<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov!<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!gjeof$!<eofmCidubCw!4dfw!hojzsbw!<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw!<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!gjeof$!<spmpDidubCw!5dfw!hojzsbw!<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<opjudfsjEuihjmebfIv!4dfw!nspgjov!<spmpDuihjmebfIv!5dfw!nspgjov!<zujtofuoJuofjcnBuihjmebfIv!ubpmg!nspgjov!<fhobSuihjmebfIv!ubpmg!nspgjov!<emspXw!4dfw!hojzsbw!<opjujtpQbsfnbDv!4dfw!nspgjov!<yjsubNxfjWv!5ubn!nspgjov!gjeof$!gjeof$!<qbNwoFv!fcvDsfmqnbt!nspgjov!ftmf$!<ttfoihvps!ubpmg!nspgjov!<qbNwoFv!E3sfmqnbt!nspgjov!WV`FCVD`FQZU`QBNWOF!gfegj$!<zujwjudfmgfSv!ubpmg!nspgjov!<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<opjujtpQw!4dfw!hojzsbw!<yfusfWw!4dfw!hojzsbw!<mbnspOw!4dfw!hojzsbw!<ftvggjEv!5dfw!nspgjov!<zujdbqPusbQv!ubpmg!nspgjov!<ttfouihjsCv!ubpmg!nspgjov!<uihjMv!mppc!nspgjov!<spmpDeofmCv!5dfw!nspgjov!<eofmCv!mppc!nspgjov!<uofdsfQqjmDv!ubpmg!nspgjov!<opjudfsjEqjmDv!uoj!nspgjov!<sfmqnbTeofmCv!E3sfmqnbt!nspgjov!<sfmqnbTv!E3sfmqnbt!nspgjov!gjeof$!<wVw!3dfw!hojzsbw!ftmf$!<wVw!4dfw!hojzsbw!QJMD`WV!gfegj$!<fsvuyfUeofmCv!mppc!nspgjov!<fsvuyfUv!mppc!nspgjov!<uofsbqtobsUv!mppc!nspgjov!<utfUbiqmBv!ubpmg!nspgjov!<spmpDftsfwfSldjQyjGv!5dfw!nspgjov!<qjmGftsfwfSv!mppc!nspgjov!<ldjQv!mppc!nspgjov!<yjGv!mppc!nspgjov!<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ$!gjeof$!gjeof$!<ubpmg!qnvjefn!opjtjdfsq!ftmf$!<ubpmg!qihji!opjtjdfsq!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!TF`MH!gfegj$!";
Sn(K,{setBatchInfo:function(V,D){Wp[V]=D},getBatchInfo:function(j){return Wp[j]},getBatchInfoMap:function(){return Wp},setBatchInfoMap:function(t){Wp=t}},!0);var eq=[1,1,1],$i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Ok=[1,0,0,0,0,1,0,1,1,1,1,0],df=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Qp=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Ln=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Ec=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Gn=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Bi=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Wo=function(o,T){var d=o._40Q;d.each(function(G){G.ivBatch(T)})},Kn=function(I,u,$){var M=$._id,Q=u[M];if(Q){var s=Q.batch,K=I[s],A=K.ds,x=Q.index;if(K.invalidate=!0,delete u[M],A.splice(x,1),Ug(A))return delete I[s],void 0;for(var N=x,g=Q.begin,E=Q.size;x<A.length;x++)Q=u[A[x]._id],Q.index--,Q.begin-=E;if(K.ms&&K.ms.length)return K.ms.splice(16*N,16),K.ics&&K.ics.splice(4*N,4),K.ps&&K.ps.splice(4*N,4),void 0;var i=3*g,q=3*E,V=4*g,B=4*E,D=K.vs,J=K.ps,k=K.uv,c=K.cs,F=K.bs,z=K.rs,m=K.ns,r=K.ls;D.splice(i,q),J.splice(V,B),k&&k.splice(2*g,2*E),c&&c.splice(V,B),F&&F.splice(i,q),z&&z.splice(g,E),m&&m.splice(i,q),r&&r.splice(g,E)}},$m=function(m,p,q,z,N){if(!z)return E;var i=p[z];if(!i){var b=N.getBatchInfo(z)||gg,x=b.image?[]:E;i=p[z]={vs:[],ns:[],uv:x,cs:x?E:b.color?E:[],bs:b.blend?[]:E,ps:[],rs:b.brightness?[]:E,ds:[],ms:b.instanced?[]:E,ics:x?E:b.color||!b.instanced?E:[]}}return i.invalidate=!0,m[q._id]={index:i.ds.length,begin:i.vs.length/3,batch:z},i.ds.push(q),i},Lc=function(n,I){return I!=E&&1!==I?[n[0]*I,n[1]*I,n[2]*I,n[3]]:n},bl=function(r){var S=r.shapeModel;S||(S=wq(r)),S&&(S._ctlineModel=[],S._lineModel=P)},Ch=function(){var N;return function(o,H){var k,f=o.data,_=f.s("wf.combineTriangle");if(!H&&(f instanceof h.Node&&!(f instanceof h.Shape)?(N||(N={vs:Qo,is:kn,uv:Ag}),H=N):H=[o.left,o.front,o.right,o.back,o.top,o.bottom],!H))return P;if(_){var R=f.s("wf.normEpsilon");isNaN(R)&&(R=2),_=0|Math.min(3,Math.max(1,isNaN(_)?1:_)),k=ck[_-1](H,o,180/(Math.PI*R))}else k=Dm(H,o);return k}}(),yq=function(){return function(o,n,_){var F=o.getData3dUI(n),e=F.shapeModel;if(e||(e=wq(F)),e||!F.shapeName){var G,s;if(_.geometry){if(F.wfGeometry?(s=F.wfMatrix,G=F.wfGeometry,F.wfGeometry=P):G=Ch(F,e),!G||0===G.length)return}else if(G=_.short?Rl:Kq,n.s("wf.boundingBox")){var d=F.getBoundingBox(!0);if(d){var N=(new jo).scale(d.max.clone().sub(d.min)).setPosition(d.max.clone().add(d.min).divideScalar(2)).toArray();G=Df([],N,G)}}var X,y,w,W=o.getBrightness(n),v=n.s("bloom"),a=n.s("3d.reflectable"),z=Ql(_.color||"white"),c=z[3]<1,M=Math.ceil(_.width)||1,t=n.s("3d.clipbox")?yi:n.s("3d.clipbox.mask"),U=n.s("wf.fog"),x=n.getRenderLayer(),T=o._40Q.get(x),B=T.wireframeIndexMap,A=T.wireframeModelMap,H=n.s("batch"),O=n.s("3d.clip.direction");if(O){if(y=n.s("3d.clip.percentage"),0===y)return;X="_"+n._id,w=F._formatClipUniforms(O,y,n)}else X=H?(c?"T":"O")+H:(c?"T":"O")+(v?"_1":"_0")+(a?"1_":"0_")+t+"_"+M+(U?"1_":"0_");var Q=A[X];Q||(Q=A[X]={vs:[],cs:[],ps:[],ds:[],T:c,B:v,clipboxMask:t,reflectable:!!a,W:M,batch:H,fog:U}),Q.invalidate=!0;var k=Q.vs,Y=Q.cs,S=Q.ds,C=B[n._id]={index:S.length,begin:k.length/3,batch:X};S.push(n);var j,p=s||F.mat;_.geometry&&n instanceof h.Shape&&(K.extractShapeTranslation||K.extractPolylineTranslation||K.extractVerticesTranslation)&&(j=F._vsTranslation)&&p&&(p=(new Uj.Matrix4).fromArray(p).multiply(j).toArray()),n instanceof h.Edge||!(!p||!_.geometry&&n instanceof h.Shape)||(p=$f(n,_.mat),n.appendAnchorMatrix3d(p)),w?(Q.mat=mf(p),Q.clipDirection=w[0],Q.clipPercent=w[1],Df(k,null,G)):Df(k,p,G);var f=C.size=k.length/3-C.begin;Xo(Y,Lc(z,W),f)}}}(),Fc=function(d,i,m,k,b,J,U,q,y){var T=d.getBrightness(i);T==E&&(T=1);var I=Lc(Ql(k),T),j=I[3]<1;J=Math.ceil(J)||1;var Y=i.s("3d.clipbox")?yi:i.s("3d.clipbox.mask"),R=(j?"T":"O")+J+"_"+Y;if(U){var n=U[0],r=(U[1]||n)+n;R+="-"+n+"-"+r,y&&(R+="-"+yo(y)+"-"+T,y=Lc(Ql(y),T))}var o=i.getRenderLayer(),z=d._40Q.get(o),_=z.polylineIndexMap,A=z.polylineModelMap,p=A[R];p||(p=A[R]={vs:[],cs:[],ps:[],ds:[],ls:U?[]:E,T:j,clipboxMask:Y,W:J},U&&(p.D=n,p.G=r,p.A=y)),p.invalidate=!0;var B,L=p.vs,Q=p.cs,t=p.ds,X=p.ls,u=_[i._id]={index:t.length,begin:L.length/3,batch:R};t.push(i);var v;!(v=d.getData3dUI(i).mat)&&i instanceof h.Polyline&&(v=$f(i),i.appendAnchorMatrix3d(v)),Df(L,v,m);var M,H=u.size=L.length/3-u.begin,w=m.length,F=0,$=[];if(U||b)for(B=0;w>B;B+=6)M=nk([m[B],m[B+1],m[B+2]],[m[B+3],m[B+4],m[B+5]]),$.push(M),F+=M;if(F&&b){var c,l=Lc(Ql(b),T),O=[l[0]-I[0],l[1]-I[1],l[2]-I[2],l[3]-I[3]],e=0;for(B=0;w>B;B+=6)c=e/F,Xo(Q,[I[0]+O[0]*c,I[1]+O[1]*c,I[2]+O[2]*c,I[3]+O[3]*c],1),e+=$[B/6],c=e/F,Xo(Q,[I[0]+O[0]*c,I[1]+O[1]*c,I[2]+O[2]*c,I[3]+O[3]*c],1)}else Xo(Q,I,H);if(U)for(e=q||0,B=0;w>B;B+=6)X.push(e),e+=$[B/6],X.push(e)},Oo=function(p,b,I){if(b){var a=I[b.batch],E=a.ps,n=a.ms&&a.ms.length,U=n?4*b.index:4*b.begin,G=n?1:b.size;if(E[U]!==p[0]||E[U+1]!==p[1]||E[U+2]!==p[2]||E[U+3]!==p[3]){for(var y=0;G>y;y++)E[U++]=p[0],E[U++]=p[1],E[U++]=p[2],E[U++]=p[3];E._invalidateThisFrame=!0}}},Bl=function(){var W=new h.Math.Vector3,i=new h.Math.Vector3;return function(Y,$){var e=$+["32"],N=Y[$],X=Y[e];if(N){if((K.extractBatchTranslation||K.extractVerticesTranslation)&&"vs"===$){i.set(0,0,0);for(var l=N.length,k=0;l>k;k+=3)i.add(W.fromArray(N,k));i.divideScalar(l/3);for(var a=i.x,V=i.y,U=i.z,G=new Array(l),k=0;l>k;k+=3)G[k]=N[k]-a,G[k+1]=N[k+1]-V,G[k+2]=N[k+2]-U;N=G,Y.translate=[a,V,U]}X&&X.length===N.length?(X.set(N),X._bufId=null):Y[e]=new Ui(N)}else delete Y[e]}}(),Pf=function(y,A,Z,u,b,g,I,c){var Q=A instanceof h.Shape,X=g[0],s=g.length;if(s>1){X=mf(X);for(var H=1;s>H;H++)Cq(X,X,g[H])}if(Q){var U=A.p3();sp(X,U)}Zn(I.ms,X);var G;if(I.ics&&(G=A.s("shape3d.color"))&&Xo(I.ics,G,1),!I.vs.length){var j=mf($i);Q&&sp(j,uf(U)),Oi(y,A,Z,u,b,[j],I,c)}},Oi=function(n,L,r,T,z,J,m,$){if(bs(r))r.forEach(function(l){Oi(n,L,l,T,z,J,m,$)});else if(Om(r))Oi(n,L,wq(T,r),T,z,J,m,$);else if(Hh(r)){var l,w=as(r.mat,L,n),C=as(r.s3,L,n),p=as(r.t3,L,n),G=as(r.r3,L,n);if((C||G||p||w)&&(l=Gg(w,C,G,as(r.rotationMode,L,n),p),J.push(l)),r.shape3d)Oi(n,L,r.shape3d,T,z,J,m,r);else{var c=T.s;$=$||gg;var H=J[0],X=J.length,j=c("shape3d.color",r.color,$.color);if(z||(z=c("shape3d.blend",r.blend,$.blend)),X>1){H=mf(H);for(var I=1;X>I;I++)Cq(H,H,J[I])}var N=H?Em(H):E;r.vs&&c(Bg,r.visible,$.visible)&&Zd(H,m,r.vs,r.uv,r.is,r.ns,N,z,j),r.top_vs&&c(_g,r.topVisible,$.topVisible)&&Zd(H,m,r.top_vs,r.top_uv,r.top_is,r.top_ns,N,z,c("shape3d.top.color",r.topColor,$.topColor)||j),r.bottom_vs&&c(pm,r.bottomVisible,$.bottomVisible)&&Zd(H,m,r.bottom_vs,r.bottom_uv,r.bottom_is,r.bottom_ns,N,z,c("shape3d.bottom.color",r.bottomColor,$.bottomColor)||j),r.from_vs&&c(wn,r.fromVisible,$.fromVisible)&&Zd(H,m,r.from_vs,r.from_uv,r.from_is,r.from_ns,N,z,c("shape3d.from.color",r.fromColor,$.fromColor)||j),r.to_vs&&c(An,r.toVisible,$.toVisible)&&Zd(H,m,r.to_vs,r.to_uv,r.to_is,r.to_ns,N,z,c("shape3d.to.color",r.toColor,$.toColor)||j)}l&&J.pop()}},Zd=function(r,l,D,P,H,F,X,n,O){var f,R=l.cs,t=l.uv,T=l.bs,G=l.ns,g=l.vs;if(F&&0!==F.length||(F=Gd(D,H)),H){f=H.length;for(var p=0;f>p;p++){var j=H[p],c=3*j;Df(g,r,[D[c],D[c+1],D[c+2]]),Df(G,X,[F[c],F[c+1],F[c+2]]),t&&Zn(t,[P[2*j],P[2*j+1]])}}else f=D.length/3,Df(g,r,D),Df(G,X,F),t&&Zn(t,P);R&&Xo(R,O,f),T&&(n?Ml(T,n,f):Zn(T,eq,f))},Zg=function(u,A,o){var E=u.data.p3();if(A=mf(A),sp(A,E),Zn(o.ms,A),!o.vs.length){var D=mf($i);sp(D,uf(E)),Zf(u,D,o)}},Zf=function(H,u,c){rc(H,zi,u,c),rc(H,es,u,c),rc(H,Yp,u,c),rc(H,mc,u,c),rc(H,Mo,u,c),rc(H,de,u,c),rc(H,"csg",u,c)},ch=function(y,_,o,P,t,b){Zn(o.ms,t);var g;o.ics&&(g=_.s("all.color"))&&Xo(o.ics,g,1),o.vs.length||ur(y,_,o,P,mf($i),b)},ur=function($,m,h,G,F,k){bi($,m,h,G,F,k,zi,df),bi($,m,h,G,F,k,es,Qp),bi($,m,h,G,F,k,Mo,Ln),bi($,m,h,G,F,k,de,Ec),bi($,m,h,G,F,k,Yp,Gn),bi($,m,h,G,F,k,mc,Bi)},ys=function(j,q,W,k,t){k?t.instanced?j.gv.batchInstancedModel(j.data,k,j,j.getBodyColor(),[q],W):Oi(j.gv,j.data,k,j,j.getBodyColor(),[q],W):t.instanced?j.gv.batchInstancedShapeFace(j,q,W):Zf(j,q,W)},rc=function(_,G,z,T){var M=_[G];if(M){var S=M.tuv;if(S){var i=M.uvScale,v=M.uvOffset,d=M.uvRotation,u=M.uvAnchor;if(i||v||d){var N,q,b,L=$n(d,v,i,u),Q=L.a,A=L.b,Y=L.c,W=L.d,l=L.tx,Z=L.ty,X=S.length;for(b=0;X>b;b+=2)N=S[b],q=S[b+1],S[b]=Q*N+Y*q+l,S[b+1]=A*N+W*q+Z}}Zd(z,T,M.vs,S,E,E,z?Em(z):E,M.blend,M.color)}},bi=function(Z,h,y,R,d,N,C,j){var Q,W=y.cs,Y=y.uv,b=y.bs,v=y.vs,V=y.ns,F=Gd(j);if(Z.getFaceVisible(h,C)){var E=Z.getFaceMat(h,C);if(E&&(d=$f(h,E),N=Em(d)),Df(v,d,j),Df(V,N,F),W&&Xo(W,Z.getFaceColor(h,C),6),Y){var J=Z.getFaceUv(h,C)||R[C+"Uv"],$=Z.getFaceUvScale(h,C)||R[C+"UvScale"],q=Z.getFaceUvOffset(h,C)||R[C+"UvOffset"],L=Z.getFaceUvRotation(h,C)||R[C+"UvRotation"],z=Z.getFaceUvAnchor(h,C)||R[C+"UvAnchor"];J=J?[J[6],J[7],J[0],J[1],J[2],J[3],J[2],J[3],J[4],J[5],J[6],J[7]]:Ok;var I=J[0],c=J[1],M=J[2],i=J[3],l=J[4],p=J[5],X=J[6],u=J[7],k=J[8],S=J[9],e=J[10],o=J[11];if($||q||L||z){var n=$n(L,q,$,z),A=n.a,w=n.b,t=n.c,G=n.d,m=n.tx,O=n.ty;I=A*I+t*c+m,c=w*I+G*c+O,M=A*M+t*i+m,i=w*M+G*i+O,l=A*l+t*p+m,p=w*l+G*p+O,X=A*X+t*u+m,u=w*X+G*u+O,k=A*k+t*S+m,S=w*k+G*S+O,e=A*e+t*o+m,o=w*e+G*o+O}Y.push(I,c,M,i,l,p,X,u,k,S,e,o)}b&&(Q=Z.getBodyColor(h)||Z.getFaceBlend(h,C),Q?Ml(b,Q,6):Zn(b,eq,6))}},Yq=function(v,q,x,u){var x=v._picking?v.pickColorMap:null,Y=v.getGL(),I=v._prg,L=v._buffer;if(!Cp(q)){qs(v,$i),or(Y);var X,_,W,Q;for(var i in q){var b,U,o,G,g=q[i];if(g.batch){var J=v.getBatchInfo(g.batch)||gg;b=J.wfBloom===P?J.bloom:J.wfBloom,U=J.wfReflectable===P?J.reflectable:J.wfReflectable,o=J.wfClipboxMask===P?J.clipboxMask:J.wfClipboxMask,G=J.width}else b=g.B,U=g.reflectable,o=g.clipboxMask,G=g.W;if(!(u&&!g.T||!u&&g.T||v.isReflecting(Y)&&U===!1)){g.invalidate?(g.invalidate=!1,Bl(g,"vs"),Bl(g,"cs"),Bl(g,"ls"),Bl(g,"ps")):x&&g.ps&&g.ps._invalidateThisFrame&&(g.ps._invalidateThisFrame=!1,Bl(g,"ps")),X=g.translate,_=g.clipDirection,X||_?(W=_?mf(g.mat):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X&&sp(W,X),Q=mf(v._6O),qs(v,W)):W=null;var w=g.vs32,p=x?g.ps32:g.cs32;hh(Y,I,G,E,L.vs,w);var R=Zq.for(Y),F=R.directUniforms(),C=R.directAttribs(),n=g.D,H=!v._dashDisabled&&n;F.uAlphaTest=N.alphaTest,Y._blooming&&!b&&(F.blackout=!0),_&&(F.uClipPercent=g.clipPercent,F.uClipDirection=_),Jf(v,F,o===P?zf:o),H&&(F.uDash=!0,F.uDashDistance=n,F.uDashGapDistance=g.G,F.uDiffuse=g.A||N["color.empty"],C.aLineDistance=Mk(Y,L.lineDistance,g.ls32,E,1));var k=!v._batchColorDisabled;k&&p.length?(F.uBatchColor=!0,C.aBatchColor=Mk(Y,L.batchColor,p,E,4)):(F.uBatchColor=!1,C.aBatchColor=!1);var s=g.fog!==!1;s||(F.uFog=!1),tg(Y),Mp(Y,0,w.length/3,Y.LINES),ph(Y),s||(F.uFog=!0),k&&(F.uBatchColor=!1,C.aBatchColor=!1),H&&(F.uDash=!1,C.aLineDistance=!1),Y._blooming&&!b&&(F.blackout=!1),W&&(_&&(F.uClipDirection=0),Vh(v,Q),F.uMMatrix=Jm)}}Dp(Y),Vh(v)}},zq=function(V){V.invalidate=!1,Bl(V,"vs"),Bl(V,"ns"),Bl(V,"cs"),Bl(V,"rs"),Bl(V,"ps"),Bl(V,"bs"),Bl(V,"uv"),Bl(V,"ms"),Bl(V,"ics")},Eq=function(i,o,e,D,M){var O,j,Y,S,k,Q,W,c,U,F,s,L,x,e=i._picking?i.pickColorMap:null,u=i.getGL(),f=i._prg,q=Zq.for(u),G=q.directUniforms(),w=q.directAttribs(),h=i._buffer;if(!Cp(o)){var H,B,R=i._flowObjects.length?i.flowMap:null,X=i.drawFilter;qs(i,$i);for(j in o)if(Y=i.getBatchInfo(j)||gg,Y.visible!==!1&&!(D&&!Y.transparent||!D&&Y.transparent||i.isReflecting(u)&&Y.reflectable===!1)){var r=Y.renderLayerMask;if(r==E&&(r=ql),M==E&&(M=ql),Sh(M,r)&&(S=o[j],e||!Y.transparentMask)){if(X){if(Y.highlight!==!0)continue;if(H=S.ds){B=!1;for(var I=0,K=H.length;K>I;I++)if(!X(H[I])){B=!0;break}if(!B)continue}}var d=D&&Y.autoSort===!0&&(i._33Q||S.invalidate);S.invalidate?zq(S):e&&S.ps&&S.ps._invalidateThisFrame&&(S.ps._invalidateThisFrame=!1,Bl(S,"ps"));var a=S.ms32,Z=a&&a.length;if(Q=S.vs32,W=e?S.ps32:Z?S.ics32:S.cs32,F=S.uv32,c=S.bs32,U=S.rs32,L=Q.length/3,d){var v=Cc(Q,i.getEye(),i);v?(S.is=v.is,S.elementTypeUint=v.useUint32):(S.is=null,S.elementTypeUint=null)}if(L){x=S.translate,x&&qs(i,[1,0,0,0,0,1,0,0,0,0,1,0,x[0],x[1],x[2],1]),k=Y.light,s=i.getTexture(Y.image),Yk(u,f,E,Y.light,Y.opacity,Y.reverseFlip,Y.reverseColor,Y.reverseCull),O=Y.polygonOffset,O&&ue(u,O),W?i._batchColorDisabled?(G.uBatchColor=!1,w.aBatchColor=!1):(G.uBatchColor=!0,w.aBatchColor=Z?Ge(u,h.instancedBatchColor,W,E,4):Mk(u,h.batchColor,W,E,4)):(G.uBatchColor=!1,G.uDiffuse=Y.color||N["color.empty"]);var V=Y.alphaTest;G.uAlphaTest=V===P?N.alphaTest:V,G.shadowReceive=!e&&Y.shadowReceive!==!1,Jf(i,G,Y.clipboxMask===P?zf:Y.clipboxMask),ib(i,G,Y.lightMask===P?zf:Y.lightMask,Y.headlightAmbientIntensity),R&&R.resetFlowUniform(Y.effectFlowMask===P?zf:Y.effectFlowMask,G),u._blooming&&!Y.bloom&&(G.blackout=!0),Y.envmap!==P?(G.uUseEnvMap=!0,G.uReflectivity=Y.envmap,G.roughness=Y.roughness||0,i._setEnvmapByProbeId(G,Y.envmapProbe||0)):(G.uUseEnvMap=!1,G.uReflectivity=0);var y=c&&!i._batchBlendDisabled;y&&(G.uBatchBlend=!0,w.aBatchBlend=Mk(u,h.batchBlend,c,E));var $=U&&!i._batchBrightnessDisabled;$&&(G.uBatchBrightness=!0,w.aBatchBrightness=Mk(u,h.batchBrightness,U,E,1)),F?tg(u,f,s,Y.discardSelectable,h.uv,F,Y.uvOffset,Y.uvScale,Y.uvRotation,Y.uvAnchor):tg(u),w.aPosition=Mk(u,h.vs,Q,E),w.aNormal=Mk(u,h.ns,S.ns32,E),Z&&(G.uUseInstance=!0,w.aMatrixInstanced=Ge(u,h.ms,a,E)),S.is?(Zm(u,h.is,S.is),Dg(u,0,L,null,S.elementTypeUint?u.UNSIGNED_INT:null,null,Z?S.ms32.length/16:0)):Mp(u,0,L,null,Z?S.ms32.length/16:0),F?ph(u,f,s):ph(u),W&&!i._batchColorDisabled&&(G.uBatchColor=!1,w.aBatchColor=!1),y&&(G.uBatchBlend=!1,w.aBatchBlend=!1),$&&(G.uBatchBrightness=!1,w.aBatchBrightness=!1),u._blooming&&!Y.bloom&&(G.blackout=!1),Z&&(G.uUseInstance=!1,w.aMatrixInstanced=P),O&&Vf(u),jf(u,f),x&&(Vh(i),G.uMMatrix=Jm)}}}Vh(i)}},Cc=function(u,Z,C){var _=u.length/3,E=_>65535,i=C._glCapabilities.elementTypeUint&&E;if(!i&&E)return null;for(var p=new Array(_),R=_/3,M=new Array(R),n=0;R>n;n++)M[n]=n;M.sort(function(O,k){var $=9*O,X=[(u[$]+u[$+3]+2*u[$+6])/4,(u[$+1]+u[$+4]+2*u[$+7])/4,(u[$+2]+u[$+5]+2*u[$+8])/4];$=9*k;var s=[(u[$]+u[$+3]+2*u[$+6])/4,(u[$+1]+u[$+4]+2*u[$+7])/4,(u[$+2]+u[$+5]+2*u[$+8])/4],w=nk(Z,X)-nk(Z,s);return w>0?-1:0>w?1:0});for(var n=0;R>n;n++){var h=3*n,W=3*M[n];p[h]=W,p[h+1]=W+1,p[h+2]=W+2}return{useUint32:i,is:i?new Uint32Array(p):new hi(p)}},rp={obj:function(H,g){var J={mat:H.mat,s3:H.s3,r3:H.r3,rotationMode:H.rotationMode,t3:H.t3,cube:H.cube==E?!0:H.cube,center:H.center==E?!0:H.center,ignoreMtls:H.ignoreMtls,ignoreTransparent:H.ignoreTransparent,ignoreColor:H.ignoreColor,ignoreImage:H.ignoreImage,ignoreNormal:H.ignoreNormal,prefix:H.prefix,flipY:H.flipY,flipFace:H.flipFace,reverseFlipMtls:H.reverseFlipMtls,finishFunc:function(P,h){if(P){var h=[];for(var B in P){var U=P[B];h.rawS3=U.rawS3,U.center&&(h.center=U.center),h.push(U),H.eachModel&&H.eachModel(B,U)}h.json=H,g(h)}else g()}};K.loadObj(H.obj,H.mtl,J)},bin:function(b,I){var w={finishFunc:function(E){E?I(E):I()}};K.loadBin(b.url,w)}};K.getModelTypeHandlers=function(){return rp},K.setModelTypeHandler=function(l,w){rp[l]=w},K.getModelTypeHandler=function(X){return rp[X]},K.handleModelLoaded=function(){},K.handleUnfoundModel=function(){};var xd=E,po=E,Ak=function(Z){xd&&!Z._loadingModelView_&&(po||(po={}),po[Z._loadingModelView_=jc()]=Z)},_o=function(M,p){xd||(xd={});var G=xd[M];if(G){if(G.url===p)return;G.request.onload=Aj,G.request.onerror=Aj}if(p.indexOf(".bin")===p.length-4)return Yh(M,{modelType:"bin",url:p},p);if(p=K.beforeLoadURL(p),p.data){var f=K.parse(p.data);Yh(M,f,p)}else{var T=new rb;xd[M]={request:T,url:p},T.onload=function(){if(200===this.status||0===this.status){delete xd[M];var i=K.parse(T.getResponseText());Yh(M,i,p)}else kh(M,K.handleUnfoundModel(M,p)||E)},T.onerror=function(){kh(M,K.handleUnfoundModel(M,p)||E)};var C={};C.url=encodeURI(p),C.sync=!1,T.send(C)}},Yh=function(u,B,W){var b=B.modelType;if(!b)return kh(u,B),K.handleModelLoaded(u,B),void 0;var U=K.getModelTypeHandler(b);if(U){if(xd||(xd={}),xd[u])return;xd[u]=!0;var w=function(G){G?(kh(u,G),K.handleModelLoaded(u,G)):kh(u,K.handleUnfoundModel(u,W,B)||E)};U(B,w)}else kh(u,K.handleUnfoundModel(u,W,B)||E)},kh=function(L,F){if(delete xd[L],Om(F)&&fp.test(F))return _o(L,F),void 0;if(Gp[L]=F,Cp(xd)&&(xd=E,po)){for(var s in po){var W=po[s];W.invalidateAll&&W.invalidateAll(P,"modelLoaded",L),W.redraw&&W.redraw(),W.iv(),delete W._loadingModelView_}po=E}if(F&&po)for(var s in po){var W=po[s];W.invalidateAll&&W.invalidateAll(P,"modelLoading",L),W.redraw&&W.redraw(),W.iv()}},Rr=new Ui([0,0,0,1,1,1,1,0]),nj=new Ui([0,0,1,0,0,1,0,0,1,0,0,1]),Hk=new hi([0,1,2,2,3,0]),Qo=new Ui([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),kn=new hi([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ag=new Ui([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),xn=Gd(Qo,kn),_i=(new Ui([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new hi([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[zi,Yp,es,mc,Mo,de]),Kq=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Rl=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Eh=function(h,v,g,N,s,d,t){d=d||16,h=h||16,v=v||0,g=g||h;var X,B,H,S,n,R,L,y,w,Y=.5,K=[],G=[],E=a/h,c=D/d;for(X=0;d>X;X++)for(R=X+1,S=X*c,w=R*c,B=v;g>B;B++)L=B+1,H=B*E,y=L*E,K.push(Y*l(S)*W(H),Y*W(S),-Y*l(S)*l(H),Y*l(w)*W(y),Y*W(w),-Y*l(w)*l(y),Y*l(S)*W(y),Y*W(S),-Y*l(S)*l(y),Y*l(S)*W(H),Y*W(S),-Y*l(S)*l(H),Y*l(w)*W(H),Y*W(w),-Y*l(w)*l(H),Y*l(w)*W(y),Y*W(w),-Y*l(w)*l(y)),G.push(B/h,X/d,L/h,R/d,L/h,X/d,B/h,X/d,B/h,R/d,L/h,R/d);if(t){var p=[];for(X=0,n=K.length;n>X;X+=3)p.push(2*K[X],2*K[X+1],2*K[X+2])}if(N){var P=[],b=[];for(H=v*E,X=0;d>X;X++)R=X+1,S=X*c,w=R*c,P.push(0,0,0,Y*l(w)*W(H),Y*W(w),-Y*l(w)*l(H),Y*l(S)*W(H),Y*W(S),-Y*l(S)*l(H)),b.push(0,.5,v/h,R/d,v/h,X/d)}if(s){var Q=[],e=[];for(H=g*E,X=0;d>X;X++)R=X+1,S=X*c,w=R*c,Q.push(0,0,0,Y*l(S)*W(H),Y*W(S),-Y*l(S)*l(H),Y*l(w)*W(H),Y*W(w),-Y*l(w)*l(H)),e.push(1,.5,g/h,X/d,g/h,R/d)}var i={vs:K,uv:G,from_vs:P,from_uv:b,to_vs:Q,to_uv:e};return t&&(i.ns=p),i},Tn=function(P,G,J){P=P||.17,G=G||12,J=J||18,0>P?P=0:P>.25&&(P=.25);var p,K,c,r,o,A,Z,i=.5,V=[],R=[],Y=[],d=a/J,v=a/G,s=i-P;for(K=0;G>=K;K++)for(r=-D+K*v,A=W(r),o=l(r),p=0;J>=p;p++)c=p*d,Z=s+P*A,V.push(W(c)*Z,o*P,-l(c)*Z),R.push(p/J,1-K/G);for(K=0;G>K;K++){var z=K*(J+1),B=(K+1)*(J+1);for(p=0;J>p;p++)Y.push(z+p,B+p+1,B+p,z+p,z+p+1,B+p+1)}return{vs:V,uv:R,is:Y}},Uk=function(_,T,u,J,g,o,V,Q){V=V||12,_=_||18,T=T||0,u=u||_,o=o||.17,0>o?o=0:o>.25&&(o=.25);var x,Y,p,H,U,F,K,j,q,s,b=.5,i=[],n=[],G=a/_,d=a/V,C=b-o,I=Q?[]:P;for(p=0;V>p;p++)for(H=p+1,K=-D+p*d,j=-D+H*d,x=T;u>x;x++)Y=x+1,U=x*G,F=Y*G,q=C+o*W(K),s=C+o*W(j),i.push(W(U)*q,l(K)*o,-l(U)*q,W(F)*q,l(K)*o,-l(F)*q,W(F)*s,l(j)*o,-l(F)*s,W(U)*q,l(K)*o,-l(U)*q,W(F)*s,l(j)*o,-l(F)*s,W(U)*s,l(j)*o,-l(U)*s),n.push(x/_,1-p/V,Y/_,1-p/V,Y/_,1-H/V,x/_,1-p/V,Y/_,1-H/V,x/_,1-H/V),Q&&I.push(W(U)*W(K),l(K),-l(U)*W(K),W(F)*W(K),l(K),-l(F)*W(K),W(F)*W(j),l(j),-l(F)*W(j),W(U)*W(K),l(K),-l(U)*W(K),W(F)*W(j),l(j),-l(F)*W(j),W(U)*W(j),l(j),-l(U)*W(j));if(J){var X=[],M=[];for(p=0;V>p;p++)H=p+1,K=-D+p*d,j=-D+H*d,U=T*G,q=C+o*W(K),s=C+o*W(j),X.push(W(U)*q,l(K)*o,-l(U)*q,W(U)*s,l(j)*o,-l(U)*s,W(U)*C,0,-l(U)*C),M.push(.5+.5*W(K),.5-.5*l(K),.5+.5*W(j),.5-.5*l(j),.5,.5)}if(g){var R=[],h=[];for(p=0;V>p;p++)H=p+1,K=-D+p*d,j=-D+H*d,U=u*G,q=C+o*W(K),s=C+o*W(j),R.push(W(U)*q,l(K)*o,-l(U)*q,W(U)*C,0,-l(U)*C,W(U)*s,l(j)*o,-l(U)*s),h.push(.5-.5*W(K),.5-.5*l(K),.5,.5,.5-.5*W(j),.5-.5*l(j))}var L={vs:i,uv:n,from_vs:X,from_uv:M,to_vs:R,to_uv:h};return Q&&(L.ns=I),L},Kf=function(o,P){for(var r,N,h,M,d,H=.5,s=16,$=[],L=[],T=[],C=[],f=a/s,y=0;s>=y;y++)r=y*f,N=W(r),M=N*H,h=l(r),d=h*H,$.push(M,-H,d,M,H,d),T.push(N,0,h,N,0,h),L.push(1-y/s,1,1-y/s,0);for(y=0;s>y;y++)C.push(2*y,2*y+1,2*y+3,2*y,2*y+3,2*y+2);if(P){var i=[],R=[],G=[];for(i.push(0,-H,0),R.push(.5,.5),y=0;s>=y;y++)r=y*f,N=W(r),h=l(r),i.push(N*H,-H,-h*H),R.push(.5+.5*N,.5+.5*h);for(y=0;s>y;y++)G.push(0,y+2,y+1)}if(o){var v=[],K=[],j=[];for(v.push(0,H,0),K.push(.5,.5),y=0;s>=y;y++)r=y*f,N=W(r),h=l(r),v.push(N*H,H,-h*H),K.push(.5+.5*N,.5-.5*h);for(y=0;s>y;y++)j.push(0,y+1,y+2)}return{vs:$,uv:L,is:C,ns:T,bottom_vs:i,bottom_uv:R,bottom_is:G,top_vs:v,top_uv:K,top_is:j}},hq=function(L,b,x,t,j,h,X,B){L=L||12,b=b||0,x=x||L;for(var u,Z,T,K,P,M,w,q,F,J=.5,C=[],G=[],v=a/L,U=b;x>U;U++)u=U+1,Z=U*v,T=u*v,K=W(Z)*J,P=l(Z)*J,M=W(T)*J,w=l(T)*J,C.push(K,-J,-P,M,-J,-w,K,J,-P,M,-J,-w,M,J,-w,K,J,-P),G.push(U/L,1,u/L,1,U/L,0,u/L,1,u/L,0,U/L,0);if(B){var V=[];for(U=0,F=C.length;F>U;U+=3)V.push(2*C[U],0,2*C[U+2])}if(X){var i=[],c=[];for(U=b;x>U;U++)Z=v*U,T=v*(U+1),K=W(Z),P=l(Z),M=W(T),w=l(T),i.push(K*J,-J,-P*J,0,-J,0,M*J,-J,-w*J),c.push(.5+.5*K,.5+.5*P,.5,.5,.5+.5*M,.5+.5*w)}if(h){var Q=[],f=[];for(U=b;x>U;U++)Z=v*U,T=v*(U+1),K=W(Z),P=l(Z),M=W(T),w=l(T),Q.push(K*J,J,-P*J,M*J,J,-w*J,0,J,0),f.push(.5+.5*K,.5-.5*P,.5+.5*M,.5-.5*w,.5,.5)}if(t){var o=[],N=[];Z=v*b,K=W(Z)*J,P=l(Z)*J,q=b/L,o.push(0,J,0,0,-J,0,K,-J,-P,K,-J,-P,K,J,-P,0,J,0),N.push(0,0,0,1,q,1,q,1,q,0,0,0)}if(j){var A=[],m=[];Z=v*x,K=W(Z)*J,P=l(Z)*J,q=x/L,A.push(0,-J,0,0,J,0,K,J,-P,K,J,-P,K,-J,-P,0,-J,0),m.push(1,1,1,0,q,0,q,0,q,1,1,1)}var S={vs:C,uv:G,bottom_vs:i,bottom_uv:c,top_vs:Q,top_uv:f,from_vs:o,from_uv:N,to_vs:A,to_uv:m};return B&&(S.ns=V),S},Vp=function(J,R,j,t,D){R=R||18,j=j||0,t=t==E?a:t,D=D==E?.5:D;for(var Q,T,s,i,o,y,P=[0,.5,.75,.875,.9375],F=[],L=[],B=[],m=t/R,V=0;V<P.length;V++){var S=0===V%2?0:.5;for(Q=0;R>=Q;Q++)T=(Q+S)*m+j,s=1-P[V],F.push(W(T)*D*s,-D+2*P[V]*D,-l(T)*D*s),L.push((Q+S)/R,s)}for(V=0;V<P.length-1;V++){var u=V*(R+1),h=(V+1)*(R+1);for(Q=0;R>Q;Q++)B.push(u+Q,h+Q+1,h+Q,u+Q,u+Q+1,h+Q+1)}for(y=F.length/3-(R+1),Q=0;R>Q;Q++)F.push(0,D,0),L.push((Q+.5)/R,0);for(Q=0;R>Q;Q++)B.push(y+Q,y+Q+1,y+(R+1)+Q);if(J){var x=[],Y=[],M=[];for(x.push(0,-D,0),Y.push(.5,.5),Q=0;R>=Q;Q++)T=Q*m+j,i=W(T),o=l(T),x.push(i*D,-D,-o*D),Y.push(.5+.5*i,.5+.5*o);for(Q=0;R>Q;Q++)M.push(0,Q+2,Q+1)}return{vs:F,uv:L,is:B,bottom_vs:x,bottom_uv:Y,bottom_is:M}},Xe=function(R,w,H,v,S,A,k,U){R=R||16,w=w||0,H=H||R,k=k||1;var y,e,D,K,p,z,f,d=.5,s=[],$=[],V=a/R,P=w,g=1/k,e=new Ab,D=new Ab,T=new Ab,t=new Ab,h=new Ab,L=new Ab,c=new Ab;for(U&&(y=[],p=new Ab,z=new Ab,f=new Ab);H>P;P++){var Z=P+1,b=V*P,x=V*Z;for(e.set(W(b)*d,-d,-l(b)*d),D.set(W(x)*d,-d,-l(x)*d),T.set(0,d,0),U&&(p.set(W(b),.5,-l(b)).normalize(),z.set(W(x),.5,-l(x)).normalize(),f.copy(p).add(z).normalize()),t.lerpVectors(T,e,g),h.lerpVectors(T,D,g),s.push(t.x,t.y,t.z,h.x,h.y,h.z,T.x,T.y,T.z),$.push(P/R,g,Z/R,g,(P+Z)/2/R,0),U&&y.push(p.x,p.y,p.z,z.x,z.y,z.z,f.x,f.y,f.z),K=1;k>K;K++)t.lerpVectors(T,e,g*(K+1)),h.lerpVectors(T,D,g*(K+1)),L.lerpVectors(T,e,g*K),c.lerpVectors(T,D,g*K),s.push(t.x,t.y,t.z,h.x,h.y,h.z,L.x,L.y,L.z,L.x,L.y,L.z,h.x,h.y,h.z,c.x,c.y,c.z),$.push(P/R,g*(K+1),Z/R,g*(K+1),P/R,g*K,P/R,g*K,Z/R,g*(K+1),Z/R,g*K),U&&y.push(p.x,p.y,p.z,z.x,z.y,z.z,p.x,p.y,p.z,p.x,p.y,p.z,z.x,z.y,z.z,z.x,z.y,z.z)}if(A){var r=[],J=[];for(P=w;H>P;P++){b=V*P,x=V*(P+1);var j=W(b),F=l(b),B=W(x),N=l(x);r.push(j*d,-d,-F*d,0,-d,0,B*d,-d,-N*d),J.push(.5+.5*j,.5+.5*F,.5,.5,.5+.5*B,.5+.5*N)}}if(v){var i=[],n=[];b=V*w,i.push(0,d,0,0,-d,0,W(b)*d,-d,-l(b)*d),n.push(0,0,0,1,w/R,1)}if(S){var Q=[],u=[];b=V*H,Q.push(0,-d,0,0,d,0,W(b)*d,-d,-l(b)*d),u.push(1,1,1,0,H/R,1)}var X={vs:s,uv:$,bottom_vs:r,bottom_uv:J,from_vs:i,from_uv:n,to_vs:Q,to_uv:u};return U&&(X.ns=y),X},Pc=function(F,S,N,z,G,f,X,O){for(var t=[],o=0;o<F.length-1;o+=2)t.push({x:F[o],y:F[o+1]});return Yl(t,S,N,z,G,f,X,O,!1)},er={roundRect:function($,V){return Pc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],$,V,3)},star:function(t,v){return Pc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],t,v)},rect:function(y,g){return Pc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],y,g)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(j,g){return Pc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],j,g)},rightTriangle:function(R,N){return Pc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],R,N)},parallelogram:function(O,E){return Pc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],O,E)},trapezoid:function(J,N){return Pc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],J,N)}},re={sphere:1,cylinder:1,cone:1,torus:1},Jr={torus:1,sphere:1,cone:1},dp=Sn(fo(er),{cylinder:1}),od=Sn(fo(er),{cylinder:1,cone:1}),og=function(H,g,R){var K,_=as(H.anchor3d,R,g),o=as(H.mat,R,g),q=as(H.s3,R,g),w=as(H.t3,R,g),f=as(H.r3,R,g),M=q||f||w||o;if(_||M){K=mf(g._6O);var C=M?Gg(o,q,f,as(H.rotationMode,R,g),w):Tc();_&&sp(C,[.5-_[0],.5-_[1],.5-_[2]]),qs(g,C)}return K},cr=function(m,N,z,O,h,T,L){if(bs(z))z.forEach(function(v){cr(m,N,v,O,h,T,L)});else if(Om(z))cr(m,N,wq(O,z),O,h,T,L);else if(Hh(z))if(z.shape3d){var r=og(z,m,N);cr(m,N,z.shape3d,O,h,T,z),r&&Vh(m,r)}else $g(m,N,z,O.s,h,T,L)},$g=function(C,B,a,N,Z,W,O){if(O=O||gg,!W||W(N("shape3d.transparent",a.transparent,O.transparent))){var S=og(a,C,B);if(Lr(a)){var y=C.getData3dUI(B);y.dispatchBoundingBoxChanged()}var U=C._26I,r=C._prg,u=C._buffer,X=N("shape3d.color",a.color,O.color);Z||(Z=N("shape3d.blend",a.blend,O.blend));var e,I=a.opacity==E?O.opacity:a.opacity,Q=N("shape3d.opacity");e=Q!=E&&I!=E?I*Q:I!=E?I:Q,Yk(U,r,Z,N("shape3d.light",a.light,O.light),e,N("shape3d.reverse.flip",a.reverseFlip,O.reverseFlip),N("shape3d.reverse.color",a.reverseColor,O.reverseColor),N("shape3d.reverse.cull",a.reverseCull,O.reverseCull));var o=N("polygonOffset",a.polygonOffset,O.polygonOffset);a.vs&&N(Bg,a.visible,O.visible)&&Rq(U,r,u,X,C.getTexture(N("shape3d.image",a.image,O.image),B),N("shape3d.discard.selectable",a.discardSelectable,O.discardSelectable),a.vs,a.uv,a.ns,a.is,N("shape3d.uv.offset",a.uvOffset,O.uvOffset),N("shape3d.uv.scale",a.uvScale,O.uvScale),N("shape3d.uv.rotation",a.uvRotation,O.uvRotation),N("shape3d.uv.anchor",a.uvAnchor,O.uvAnchor),o),a.top_vs&&N(_g,a.topVisible,O.topVisible)&&Rq(U,r,u,N("shape3d.top.color",a.topColor,O.topColor)||X,C.getTexture(N("shape3d.top.image",a.topImage,O.topImage),B,"top"),N("shape3d.top.discard.selectable",a.topDiscardSelectable,O.topDiscardSelectable),a.top_vs,a.top_uv,a.top_ns,a.top_is,N("shape3d.top.uv.offset",a.topUvOffset,O.topUvOffset),N("shape3d.top.uv.scale",a.topUvScale,O.topUvScale),N("shape3d.top.uv.rotation",a.topUvRotation,O.topUvRotation),N("shape3d.top.uv.anchor",a.topUvAnchor,O.topUvAnchor),o),a.bottom_vs&&N(pm,a.bottomVisible,O.bottomVisible)&&Rq(U,r,u,N("shape3d.bottom.color",a.bottomColor,O.bottomColor)||X,C.getTexture(N("shape3d.bottom.image",a.bottomImage,O.bottomImage),B,"bottom"),N("shape3d.bottom.discard.selectable",a.bottomDiscardSelectable,O.bottomDiscardSelectable),a.bottom_vs,a.bottom_uv,a.bottom_ns,a.bottom_is,N("shape3d.bottom.uv.offset",a.bottomUvOffset,O.bottomUvOffset),N("shape3d.bottom.uv.scale",a.bottomUvScale,O.bottomUvScale),N("shape3d.bottom.uv.rotation",a.bottomUvRotation,O.bottomUvRotation),N("shape3d.bottom.uv.anchor",a.bottomUvAnchor,O.bottomUvAnchor),o),a.from_vs&&N(wn,a.fromVisible,O.fromVisible)&&Rq(U,r,u,N("shape3d.from.color",a.fromColor,O.fromColor)||X,C.getTexture(N("shape3d.from.image",a.fromImage,O.fromImage),B,"from"),N("shape3d.from.discard.selectable",a.fromDiscardSelectable,O.fromDiscardSelectable),a.from_vs,a.from_uv,a.from_ns,a.from_is,N("shape3d.from.uv.offset",a.fromUvOffset,O.fromUvOffset),N("shape3d.from.uv.scale",a.fromUvScale,O.fromUvScale),N("shape3d.from.uv.rotation",a.fromUvRotation,O.fromUvRotation),N("shape3d.from.uv.anchor",a.fromUvAnchor,O.fromUvAnchor),o),a.to_vs&&N(An,a.toVisible,O.toVisible)&&Rq(U,r,u,N("shape3d.to.color",a.toColor,O.toColor)||X,C.getTexture(N("shape3d.to.image",a.toImage,O.toImage),B,"to"),N("shape3d.to.discard.selectable",a.toDiscardSelectable,O.toDiscardSelectable),a.to_vs,a.to_uv,a.to_ns,a.to_is,N("shape3d.to.uv.offset",a.toUvOffset,O.toUvOffset),N("shape3d.to.uv.scale",a.toUvScale,O.toUvScale),N("shape3d.to.uv.rotation",a.toUvRotation,O.toUvRotation),N("shape3d.to.uv.anchor",a.toUvAnchor,O.toUvAnchor),o),jf(U,r),S&&Vh(C,S)}},Rq=function(g,b,Z,s,q,L,A,o,J,t,w,S,I,B,a){if(A){a&&ue(g,a);var j=Zq.for(g),X=j.directUniforms(),D=j.directAttribs();X.uDiffuse=s||N["color.empty"],o?tg(g,b,q,L,Z.uv,o,w,S,I,B):tg(g),D.aPosition=Mk(g,Z.vs,A,E),D.aNormal=Mk(g,Z.ns,J,E),t?(Vj(g,Z.is,t),Dg(g,0,t.length,null,t instanceof Uint32Array?g.UNSIGNED_INT:null)):Mp(g,0,A.length/3),o?ph(g,b,q):ph(g),a&&Vf(g)}},wq=function(m,p){var T=m.s;if(p||(p=T(Jb)),!p)return E;var e=sg(p);if(e)return e;if("text"===p){var B={amount:T("shape3d.text.amount"),size:T("shape3d.text.size"),font:T("shape3d.text.font"),style:T("shape3d.text.style"),weight:T("shape3d.text.weight"),fill:T("shape3d.text.fill"),curveSegments:T("shape3d.text.curveSegments"),spacing:T("shape3d.text.spacing"),cube:T("shape3d.text.cube")},o=m.gv.getShape3dText(m.data),Y=o;for(var n in B)Y+="_"+(B[n]===P?"U":B[n]);return m._cachedTextKey===Y?m._cachedTextGeometry:(m._cachedTextKey=Y,m._cachedTextGeometry=K.createTextGeometry(o,B))}var n=p;if(re[p]){var r=T("shape3d.side"),s=T("shape3d.side.from"),X=T("shape3d.side.to"),L=T(wn),u=T(An);3>r?(r=0,s=0,X=0,L=!1,u=!1):((s==E||0>s)&&(s=0),(X==E||X>r)&&(X=r),0===s&&X===r&&(L=!1,u=!1));var H=T("shape3d.smooth");n+="-"+r+"-"+s+"-"+X+"-"+L+"-"+u+(H?1:0)}if(dp[p]){var I=T(_g);n+="-"+I}if(od[p]){var C=T(pm);n+="-"+C}if("torus"===p){var O=T("shape3d.torus.radius");0>O?O=0:O>.25&&(O=.25),n+="-"+O}if(Jr[p]){var D=T(Vi);n+="-"+D}return e=mi[n],e||("box"===p?e=K.createBoxModel():er[p]?e=er[p](I,C):"sphere"===p?e=K.createSphereModel(r,s,X,L,u,D,H):p===Rg?e=K.createCylinderModel(r,s,X,L,u,I,C,H):"cone"===p?e=K.createConeModel(r,s,X,L,u,C,D,H):"torus"===p&&(e=K.createTorusModel(r,s,X,L,u,O,D,H)),mi[n]=e),e},Lr=function(){var M=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],o=["is","top_is","bottom_is","from_is","to_is"];return n=to(jk.substr(jk.indexOf("^#")+2)),Zh(K[Bn(ab+M[15]+"n"+M[16])]())&&wo()?function(I){return I&&!I._complete_?(I._complete_=!0,I.vs&&Ug(I.ns)&&(I.ns=Gd(I.vs,I.is),I.boundingBox=P),I.top_vs&&Ug(I.top_ns)&&(I.top_ns=Gd(I.top_vs,I.top_is),I.top_boundingBox=P),I.bottom_vs&&Ug(I.bottom_ns)&&(I.bottom_ns=Gd(I.bottom_vs,I.bottom_is),I.bottom_boundingBox=P),I.from_vs&&Ug(I.from_ns)&&(I.from_ns=Gd(I.from_vs,I.from_is),I.from_boundingBox=P),I.to_vs&&Ug(I.to_ns)&&(I.to_ns=Gd(I.to_vs,I.to_is),I.to_boundingBox=P),M.forEach(function(S){var F=I[S];bs(F)&&(I[S]=new Ui(F))}),o.forEach(function(B){var k=I[B];bs(k)&&(I[B]=k.length>65535?new jg(k):new hi(k))}),!0):!1}:void 0}(),Hi=function($,U){var n=$[U];bs(n)&&($[U]=new Ui(n))};Sn(wp,{_25Q:function(K){var i=new Ab;K._16O=function(M,K,I,v,x,t,A,g,c){var Q=this.info;if(Q){var R,T,y,o,m,H,h=Tc();eg[K]?(R=Q.p3,T=Q.c1,y=Q.c2):On[K]?(T=Q.s1||Q.c1,y=Q.s2||Q.c2):(T=Q.t1||Q.c1,y=Q.t2||Q.c2);var l=this.data;if(l instanceof bq&&this.shapeModel){var n=l.getPointsMatrix3d();
R&&(R=i.copy(R).applyMatrix4(n).toArray()),T&&(T=i.copy(T).applyMatrix4(n).toArray()),y&&(y=i.copy(y).applyMatrix4(n).toArray())}var F=0;if(T&&y){var L=tf(y,T);F=nk(T,y),o=[0,-Hr(L[2],L[0]),q(L[1]/F)],m="zyx",R||(R=[(T[0]+y[0])/2,(T[1]+y[1])/2,(T[2]+y[2])/2])}return H=dk(K,[F,0,0],I,v,g,c),Yj(h,H,R,v,x,t,A,M,o,m)}return Jm},K._80o=function(R,u,x){var N=this,$=N.shapeModel;if($){var o=N.gv;qs(o),cr(o,N.data,$,N,N.getBodyColor(),x)}},K.createLineModel=function(v,y,R,u,e){var V=this,k=V.s,t=Bq(v,y,k(Vi)),r=k(u+".color");if(r){for(var T=[],l=0;l<t.length;l++){var _=t[l],f=_.length;if(f>1){var F=_[0];T.push(F.x,F.y,F.z);for(var U=1;f-1>U;U++)F=_[U],T.push(F.x,F.y,F.z),T.push(F.x,F.y,F.z);F=_[f-1],T.push(F.x,F.y,F.z)}}var M,A,d,q=k(e),L=0;q&&(A=k(e+".color"),M=k(e+".pattern"),L=k(e+".offset"),d=r),Fc(V.gv,V.data,T,A||r,d?E:k(u+".gradient.color"),R,M||k(u+".pattern"),L,d)}return t},K.createTubeModel=function(e,z,b,c){for(var W=this,g=W.s,l=g("shape3d.side")||Lb,Q=g("shape3d.start.angle"),F=g("shape3d.sweep.angle"),$=g(_g)?g("shape3d.top.cap"):E,y=g(pm)?g("shape3d.bottom.cap"):E,M=g("3d.clip.direction"),h="flat"===$,N="flat"===y,D=h&&(c?c.uv:g("shape3d.top.image")),v=N&&(c?c.uv:g("shape3d.bottom.image")),R=c?c.uv:g("shape3d.image")||"uv.left"===M||"uv.right"===M,n=g("shape3d.smooth"),m={vs:[],uv:R?[]:E,ns:n?[]:E,top_vs:h?[]:E,top_uv:D?[]:E,bottom_vs:N?[]:E,bottom_uv:v?[]:E},B=Bq(e,z,g(Vi),b),X=0,k=B.length,j=0,q=g("shape3d.uv.union");k>X;X++)q!==!0&&(j=0),j=ir(m,B[X],g(hp),b,l,Q,F,$,y,j);if(c){var d=W._matWithExtraction||W.mat;Oi(W.gv,W.data,m,W,W.getBodyColor(),d?[d]:[],c),W.gv.getWireframeGeometry(W.data)&&(W.wfGeometry=Ch(W,m),W.wfMatrix=d?mf(d):null)}else W.shapeModel=m;W.lineShapeModel=m;var Y=W._vsTranslation;if(Y)for(var X=0,T=B.length;T>X;X++)for(var w=0,V=B[X].length;V>w;w++)B[X][w]=B[X][w].clone().applyMatrix4(Y);return B},K.getCache=function(){var b=this.info;if(b){var g=b.list;if(g){var F=b.cache;return F||(F=b.cache=Me(g)),F}}return E}}});var Wb=function(b,p){for(var Z,o=0,g=b.length,V=0,G=g-1;G>=V;)if(o=X(V+(G-V)/2),Z=b[o].length-p,0>Z)V=o+1;else{if(!(Z>0)){G=o;break}G=o-1}o=G;var i=b[o],M=i.point;return o===g-1||i.length===p||(M=(new ll).subVectors(b[o+1].point,M).normalize().multiplyScalar(p-i.length).add(M)),{point:M,tangent:i.tangent}},Me=function(g){for(var I,G,H=[],J=0,W=0;W<g.length;W++){for(var x=g[W],Q=0;Q<x.length;Q++){I=x[Q],G&&(J+=G.distanceTo(I));var d=new ll,u=x[Q+1];u?d.subVectors(u,I):G?d.subVectors(I,G):d.x=1,d.normalize(),H.push({point:I,length:J,tangent:d}),G=I}G=null}return H},Bq=function(m,u,F,A){F=F||vm;for(var j=[],y=0,R=m.size();R>y;y++){var s=m.get(y);j.push(new ll(s.x,s.e||0,s.y))}u&&(xg(u)&&(u=u._as),u.length||(u=null));for(var K,a,X,N,p,Z=[],h=[],W=0,q=0,M=u?u.length:R;M>q;q++){if(p=u?u[q]:0===q?1:2,1===p)Z.push(X=[]),X.push(j[W++]);else if(2===p||5===p)if(N=2===p?j[W++]:X[0],A){var S=u?u[q+1]:M>q+1?2:E;if(2===S||5===S){var i=X[X.length-1],Q=2===S?j[W]:X[0],v=(new ll).subVectors(i,N),L=(new ll).subVectors(Q,N),w=v.length(),G=L.length();if(w&&G)if(A>w/2&&A>G/2)X.push(N);else for(v.multiplyScalar(I(A,w/2)/w).add(N),L.multiplyScalar(I(A,G/2)/G).add(N),K=new Tm(v,N,L).getPoints(F),a=0;F>=a;a++)X.push(K[a])}else X.push(N)}else X.push(N);else if(3===p)for(K=new Tm(X[X.length-1],j[W++],j[W++]).getPoints(F),a=1;F>=a;a++)X.push(K[a]);else if(4===p)for(K=new Fq(X[X.length-1],j[W++],j[W++],j[W++]).getPoints(F),a=1;F>=a;a++)X.push(K[a]);h.push(Z.length,X.length)}return Z.indexMark=h,Z},Go=function(U){for(var T,f,O=new ll,E=[],k=[],i=[],J=0,L=U.length;L>J;J++)T=U[J],f=U[J+1],f?O.subVectors(f,T):O.subVectors(T,U[J-1]),E.push(O.normalize().clone());var m,Q=new ll,R=new ll,b=new jo,S=1e-4,p=E[0],x=k[0]=new ll,X=i[0]=new ll;for(Math.abs(Math.abs(p.y)-1)<S?Q.set(1,0,0):Q.set(0,1,0),R.crossVectors(p,Q).normalize(),x.crossVectors(p,R),X.crossVectors(p,x),J=1;L>J;J++)k[J]=k[J-1].clone(),i[J]=i[J-1].clone(),R.crossVectors(E[J-1],E[J]),R.length()>S&&(R.normalize(),m=e(lj(E[J-1].dot(E[J]),-1,1)),k[J].applyMatrix4(b.makeRotationAxis(R,m))),i[J].crossVectors(E[J],k[J]);return{B:i,T:E,N:k}},ir=function(){var H=function(B){for(var u=1;u<arguments.length;u++){var s=arguments[u];B.push(s.x,s.y,s.z)}},z=function(f){for(var l=1;l<arguments.length;l++){var I=arguments[l].uv;f.push(I[0],I[1])}},L=function(y){for(var O=1;O<arguments.length;O++){var L=arguments[O].ns;y.push(L[0],L[1],L[2])}},D=function(L,h,u,t,K){var F=-t*W(K),B=t*l(K);return new ll(L.x+F*u.x+B*h.x,L.y+F*u.y+B*h.y,L.z+F*u.z+B*h.z)},x=function(l,L,H,J,C,t,s,K,o){s=s||a;for(var F,j=[],v=s/C,F=o?new Ab:E,S=0;C>=S;S++){var R=D(l,L,H,J,S*v+t);j.push(R),K!=E&&(R.uv=[K,1-S/C]),o&&(R.ns=F.subVectors(R,l).normalize().toArray())}return j},G=function(B,k,M,J,P,F,O,X,e){e=e||a;var G=k?B.top_vs:B.bottom_vs;if(G)for(var S=k?B.top_uv:B.bottom_uv,f=e/O,I=0;O>I;I++){var j,d;k?(j=I*f+X,d=(I+1)*f+X):(d=I*f+X,j=(I+1)*f+X),H(G,D(M,J,P,F,j),D(M,J,P,F,d),M),S&&S.push(.5-.5*W(j),.5-.5*l(j),.5-.5*W(d),.5-.5*l(d),.5,.5)}};return function(S,R,Z,D,n,o,p,q,B,U){var _=R.length;if(_>1){var J,e,Y,j,C,X,t,Q=Go(R),T=Q.T,l=Q.N,u=Q.B;"flat"===q&&G(S,!0,R[0],u[0],l[0],D,n,o,p),"flat"===B&&G(S,!1,R[_-1],u[_-1],l[_-1],D,n,o,p);var O,g,V=[],v=i(n/2),c="round"===q,I="round"===B,F=R[0],y=T[0],r=u[0],b=l[0],W=R[_-1],m=T[_-1],N=u[_-1],k=l[_-1];if(c){for(Y=1;v>=Y;Y++)l.splice(0,0,b),u.splice(0,0,r),T.splice(0,0,y),g=-Y/v*D,R.splice(0,0,y.clone().multiplyScalar(g).add(F)),V[v-Y]=A(D*D-g*g);_+=v}if(I){for(Y=1;v>=Y;Y++)l.push(k),u.push(N),T.push(m),g=Y/v*D,R.push(m.clone().multiplyScalar(g).add(W)),V[R.length-1]=A(D*D-g*g);_+=v}if(S.uv){var w=0,M=U,a=[];for(Z&&(w=Z),C=R[0],a[0]=0,Y=1;_>Y;Y++)j=R[Y],a[Y]=C.distanceTo(j),C=j,Z||(w+=a[Y]);for(O=[],Y=0;_>Y;Y++)M+=a[Y],O[Y]=w?M/w:0;U=M,S.internalUvScale=w?U/w:1}var $=S.ns?!0:!1;for(Y=0;_>Y;Y++){if(j=R[Y],X=u[Y],t=l[Y],J=x(j,X,t,V[Y]===P?D:V[Y],n,o,p,O?O[Y]:E,$),e)for(var f=0;n>f;f++){var s=e[f],h=e[f+1]||e[0],K=J[f],d=J[f+1]||J[0];H(S.vs,h,s,K,K,d,h),S.uv&&z(S.uv,h,s,K,K,d,h),$&&L(S.ns,h,s,K,K,d,h)}e=J}}return U}}();Sn(K,{getLineLength:function(U){return U[U.length-1].length},getLineOffset:function(S,c){return Wb(S,c)},getLineCacheInfo:function(C,_,U,A){return Me(Bq(C,_,U,A))}});var ff=h.graph3d.RenderLite={},Nr=new Array(0),Dr=ff.Buffer=function($,b,a,d){this.gl=$,this.buffer=$.createBuffer(),this.type=b||$.ARRAY_BUFFER,this.drawType=d||$.STATIC_DRAW,this.data=Nr,a&&this.upload(a)};Dr.prototype.upload=function(P,i,h){h||this.bind();var W=this.gl;P=P||this.data,i=i||0,this.data.byteLength>=P.byteLength?W.bufferSubData(this.type,i,P):W.bufferData(this.type,P,this.drawType),this.data=P},Dr.prototype.bind=function(){var B=this.gl;B.bindBuffer(this.type,this.buffer)},Dr.createVertexBuffer=function(u,N,I){return new Dr(u,u.ARRAY_BUFFER,N,I)},Dr.createIndexBuffer=function(Q,I,U){return new Dr(Q,Q.ELEMENT_ARRAY_BUFFER,I,U)},Dr.create=function(i,S,e,m){return new Dr(i,S,m)},Dr.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Zc=ff.Shader=function(S,F,E){this.gl=S,this.program=Zk(S,F,E),this.attributes=Cl(S,this.program);var A=Ci(S,this.program);this.uniforms=jl(S,A)};Zc.prototype.bind=function(){this.gl.useProgram(this.program)},Zc.prototype.destroy=function(){this.gl};var Zk=function(g,d,k){var M=Ek(g,g.VERTEX_SHADER,d),w=Ek(g,g.FRAGMENT_SHADER,k),$=g.createProgram();return g.attachShader($,M),g.attachShader($,w),g.linkProgram($),g.getProgramParameter($,g.LINK_STATUS)||(Tj("LINK","LITE",g.getProgramParameter($,g.VALIDATE_STATUS),g.getError(),g.getProgramInfoLog($)),g.deleteProgram($),$=null),g.deleteShader(M),g.deleteShader(w),$},Ek=function(x,d,I){var v=x.createShader(d);return x.shaderSource(v,I),x.compileShader(v),x.getShaderParameter(v,x.COMPILE_STATUS)?v:(Tj("COMPILE","LITE",d,x.getError(),x.getShaderInfoLog(v)),null)},Ci=function(Y,b){for(var v={},s=Y.getProgramParameter(b,Y.ACTIVE_UNIFORMS),m=0;s>m;m++){var h=Y.getActiveUniform(b,m),k=h.name.replace(/\[.*?\]/,""),J=os(Y,h.type);v[k]={type:J,size:h.size,location:Y.getUniformLocation(b,k),value:Rb(J,h.size)}}return v},Cl=function(h,G){for(var v={},E=h.getProgramParameter(G,h.ACTIVE_ATTRIBUTES),r=0;E>r;r++){var S=h.getActiveAttrib(G,r),w=os(h,S.type);v[S.name]={type:w,size:Pn(w),gl:h,location:h.getAttribLocation(G,S.name),pointer:vk}}return v},vk=function(O,D,k,Q,v){var c=this.gl;c.enableVertexAttribArray(this.location),O instanceof ff.Buffer||(O=ff.Buffer.createVertexBuffer(c,O)),c.bindBuffer(O.type,O.buffer),c.vertexAttribPointer(this.location,this.size,D||c.FLOAT,k||!1,Q||0,v||0)},Pn=function(O){return hf[O]},hf={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},os=function(l,r){if(!Kh){var s=O.keys(un);Kh={};for(var c=0;c<s.length;++c){var U=s[c];Kh[l[U]]=un[U]}}return Kh[r]},Kh=null,un={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Rb=function(Z,E){switch(Z){case"float":return 0;case"vec2":return new Float32Array(2*E);case"vec3":return new Float32Array(3*E);case"vec4":return new Float32Array(4*E);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*E);case"ivec3":return new Int32Array(3*E);case"ivec4":return new Int32Array(4*E);case"bool":return!1;case"bvec2":return Be(2*E);case"bvec3":return Be(3*E);case"bvec4":return Be(4*E);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Be=function(G){for(var p=new Array(G),Y=0;Y<p.length;Y++)p[Y]=!1;return p},jl=function(s,C){var Z={data:{}};Z.gl=s;for(var X=O.keys(C),a=0;a<X.length;a++){var d=X[a],h=d.split("."),z=h[h.length-1],P=Ne(h,Z),j=C[d];P.data[z]=j,P.gl=s,O.defineProperty(P,z,{get:Eb(z),set:Xp(z,j)})}return Z},Eb=function(I){var d=ye.replace("%%",I);return new Function(d)},Xp=function(_,M){var E,Z=Pq.replace(/%%/g,_);return E=1===M.size?nh[M.type]:Lq[M.type],E&&(Z+="\nthis.gl."+E+";"),new Function("value",Z)},Ne=function(m,u){for(var g=u,j=0;j<m.length-1;j++){var N=g[m[j]]||{data:{}};g[m[j]]=N,g=N}return g},ye=["return this.data.%%.value;"].join("\n"),Pq=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),nh={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Lq={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Ei=function(C){function N(o){if("string"!=typeof o)return 0|o;switch(o){case"low":return 512;case"medium":return 1024;case"ultra":return 4096;default:return 2048}}function R(){e.enable=!K.graph3dViewShadowDisabled,$=K.graph3dViewShadowType,o=K.graph3dViewShadowIntensity,Y=K.graph3dViewShadowBias,X=K.graph3dViewShadowQuality,s=K.graph3dViewShadowRadius,M=K.graph3dViewShadowDegreeX,H=K.graph3dViewShadowDegreeZ,T=null}var e=this;e.enable=!1;var $,o,Y,X,s,M,H,T;R();var B,I,u,x,V=1,F=N(X),n=!1,Z=new h.Math.Matrix4,q=new h.Math.Matrix4,Q=e.pvMatrix=new h.Math.Matrix4,r=0;e.contextLost=function(){e.mapForReflector=null,e.map=null;var h=C.getGL();h&&(h._shadowShader=null)},e.render=function(){if(!C._picking&&e.enable){var I=C.getGL();if(I){if(n&&e.setupShadowCamera(),C._glCapabilities&&(F=Math.min(F,C._glCapabilities.maxTextureSize)),x=C.isReflecting(I)){if(r===I._renderInfo.frame)return;r=I._renderInfo.frame}var V=x?"mapForReflector":"map";if((B=e[V])?B.setSize(F,F):B=e[V]=new Os(C,C.getGL(),0,0,{samples:1,minFilter:Um.NEAREST,magFilter:Um.NEAREST,width:F,height:F}),!I._shadowShader){var i="#define MAX_BOX_CLIPPER "+C._boxClippers.length;C._batchInstancedDisabled||(i+="\n#define BATCHINSTANCE"),I._shadowShader=new ff.Shader(I,Ei.shaderSrc.vs.replace("$DEFINE",i),Ei.shaderSrc.fs.replace("$DEFINE",i))}var w=C._frameState,U=w.renderState.glState;U.blend.enabled=!1,U.depth.enabled=!0,U.depth.mask=!0;var l=U.color.clear.slice(0);Wf(I,[1,1,1,1]),w.renderState.useProgram(I._shadowShader.program),W(),Wf(I,l)}}},e.deleteShadowProgram=function(){var S=C.getGL();S&&S._shadowShader&&(S.deleteProgram(S._shadowShader.program),S._shadowShader=null)},e.getShadow=function(){var A={degreeX:M,degreeZ:H,intensity:o,quality:X,type:$,radius:s,bias:Y,bounding:T};return 1!==V&&(A.boundExtend=V),A},e.setShadow=function(O,_){O=!!O;var k=e.enable!==O;e.enable=O,"object"==typeof _&&(_.intensity!==P&&(o=_.intensity),_.bias!==P&&(Y=_.bias),_.radius!==P&&(s=_.radius),_.degreeX!==P&&(M=_.degreeX),_.degreeZ!==P&&(H=_.degreeZ),_.quality!==P&&(X=_.quality),_.bounding!==P&&(T=_.bounding),_.type!==P&&$!==_.type&&($=_.type,k=!0),F=N(X),_.boundExtend!==P&&(V=_.boundExtend)),O&&e.setupShadowCamera(),k&&Zi(C),C.iv()};var j=null;e.tryInvalidateLater=function(n,k){"modelLoaded"===k&&(j&&Jc(j,!0),j=dd(function(){j=null,e.refresh()},e,P,200))},e.refresh=function(){this.enable&&(this.setupShadowCamera(),C.iv())},e.tryUpdateBounding=function(j){if(!T){var I=this.boundingSphere;if(I){var t=(new jo).fromArray($f(j,C.getMat(j))),i=j.getAnchor3d(),R=new Ab;I.containsPoint(R.set(0-i.x,0-i.y,0-i.z).applyMatrix4(t))&&I.containsPoint(R.set(0-i.x,0-i.y,1-i.z).applyMatrix4(t))&&I.containsPoint(R.set(0-i.x,1-i.y,0-i.z).applyMatrix4(t))&&I.containsPoint(R.set(0-i.x,1-i.y,1-i.z).applyMatrix4(t))&&I.containsPoint(R.set(1-i.x,0-i.y,0-i.z).applyMatrix4(t))&&I.containsPoint(R.set(1-i.x,0-i.y,1-i.z).applyMatrix4(t))&&I.containsPoint(R.set(1-i.x,1-i.y,0-i.z).applyMatrix4(t))&&I.containsPoint(R.set(1-i.x,1-i.y,1-i.z).applyMatrix4(t))||e.setupShadowCamera()}}},e.createShadow=function(S){if(S||(S=C._frameState.renderState.directUniforms()),S.shadowMatrix=Q.toArray(),C._getFrameRenderOptions("renderShadow")===!1){var c,V=C.getGL();(c=V._emptyShadowTexture)||(c=V._emptyShadowTexture=Bh(V,null,[255,255,255,255])),S.shadowMap=c}else{var t=C._getFrameRenderOptions("useReflectorSelfShadowMap")&&e.mapForReflector;S.shadowMap=t?e.mapForReflector.texture:e.map.texture}S.shadowSize=[B.width,B.height],S.shadowIntensity=o,S.shadowBias=Y,S.shadowRadius=s},e.genShaderDefine=function(){var z="#define USE_SHADOWMAP\n";return"hard"===$?z+="#define SHADOWMAP_TYPE_PCF\n":"soft"===$&&(z+=C.isGLTempRegisterLimited()?"#define SHADOWMAP_TYPE_PCF\n":"#define SHADOWMAP_TYPE_PCF_SOFT\n"),z};var p;e.setupShadowCamera=function(){if(I||(I=e.boundingSphere=new h.Math.Sphere),T)I.set((new Ab).fromArray(T),T[3]);else{n=!1;var J,q,D=C.getBoundingBox(C.dm().toDatas(function(M){return M.s("shadow.cast")&&C.isVisible(M)}));D?(J=new Ab(D.min),q=new Ab(D.max)):(J=new Ab(-256,-256,-256),q=new Ab(256,256,256),n=!0),I.set(J.clone().add(q).multiplyScalar(.5),.5*J.distanceTo(q)*V)}var B=I.radius,j=2*B;p=Pb(Tc(),-B,B,-B,B,j/1e3,j),Q.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Q.multiply(Z.fromArray(p));var R=Math.tan(-M*Math.PI/180),N=Math.tan(-H*Math.PI/180),P=B/Math.sqrt(R*R+N*N+1),z=new Ab(P*R,P,P*N);e.direction=Ab.normalizeArray(z.clone().multiplyScalar(-1)),Z.lookAt(z,new Ab(0,0,0),new Ab(0,1,0)).setPosition(z.add(I.center)),Z.getInverse(Z),Q.multiply(Z)},e.getDirection=function(){return e.enable?e.direction:void 0};var W=function(){var W=C.getGL(),z=F,n=F;B.setSize(W,z,n),B.bind(W),W.clear(Um.COLOR_BUFFER_BIT|Um.DEPTH_BUFFER_BIT);var q=C._frameState,c=q.renderState,Z=c.directUniforms(),T=c.directAttribs(),Y=c.directState();Z.uUseInstance=!1,T.aMatrixInstanced=P,Z.projectionMatrix=p,(u=C._boxClippers.length>0)&&(Jf(C,Z,yi),Z.uClipperMatrix=C._boxClipperMatrixes,Z.uClipperClipInner=C._boxClipperClipInner);var y=C._viewport;C.setViewport(W,0,0,z,n);var J,_,f,j,b=C._sortedRenderLayers;for(J=0,_=b.length;_>J;J++)if(f=b[J],!C.getRenderLayerInfo(f).ignore&&(j=C._40Q.get(f))){var V=j.batchIndexMap;e.renderItems(W,Z,T,Y,j.opaque,V),e.renderItems(W,Z,T,Y,j.transparent,V),e.renderBatch(W,Z,T,Y,j.batchModelMap,V)}B.unbind(W),C.setViewport(W,y[0],y[1],y[2],y[3])};e._renderDirect=function(b,A,K,X,J){if(K&&K.length){var z=J&&J.length?J.length/16:0;A.position=Mk(b,C._buffer.vs,K,E),X?(Vj(b,C._buffer.is,X),Dg(b,0,X.length,null,X instanceof Uint32Array?b.UNSIGNED_INT:null,null,z)):Mp(b,0,K.length/3,null,z)}},e.renderShapeModel=function(l,r,K,U){var G,_,n;if(bs(K))for(_=0,n=K.length;n>_;_++)G=K[_],G&&e.renderShapeModel(l,r,G,U);else Om(K)?e.renderShapeModel(l,r,wq(U,K),U):Hh(K)&&(K.shape3d?e.renderShapeModel(l,r,K.shape3d,U):e.renderShapeModelImpl(l,r,K))},e.renderShapeModelImpl=function(V,E,M){Lr(M),e._renderDirect(V,E,M.vs,M.is),e._renderDirect(V,E,M.top_vs,M.top_is),e._renderDirect(V,E,M.bottom_vs,M.bottom_is),e._renderDirect(V,E,M.from_vs,M.from_is),e._renderDirect(V,E,M.to_vs,M.to_is)},e.renderBatch=function(Y,K,$,U,m){if(!Cp(m)&&!C.drawFilter){K.modelViewMatrix=q.identity().premultiply(Z).toArray();var z,w,I;for(z in m)if(I=C.getBatchInfo(z)||gg,I.visible!==!1&&I.shadowCast!==!1&&(!x||I.reflectable!==!1)){w=m[z],w.invalidate&&zq(w),u&&(K.modelMatrix=$i,Jf(C,K,I.clipboxMask===P?zf:I.clipboxMask));var t=w.ms32,b=t&&t.length;b&&(K.uUseInstance=!0,$.aMatrixInstanced=Ge(Y,C._buffer.ms,t,E)),e._renderDirect(Y,$,w.vs32,w.is,t),b&&(K.uUseInstance=!1,$.aMatrixInstanced=P)}}},e.renderItems=function(Y,y,V,S,_,L){var n,p,P,M,z,b,k=_.length;for(n=0;k>n;n++)if(p=_[n],M=p.ui,P=p.data,!(fe(P)||!P.s("shadow.cast")||P instanceof Pm||P.s("effect.flow")||!C.isVisible(P)||L[P._id]||x&&P.s("3d.reflectable")===!1)){var f=M.s("3d.clip.direction");if(f){var l=M.s("3d.clip.percentage");if(0===l)continue;var v=M._formatClipUniforms(f,l,P);y.uClipPercent=v[1],y.uClipDirection=v[0]}else y.uClipDirection=0;z=M.shapeModel||wq(M),z||(z=P instanceof h.Node&&!(P instanceof h.Shape)?{vs:Qo,is:kn}:[M.left,M.front,M.right,M.back,M.top,M.bottom]),b=M.mat?q.fromArray(M.mat):q.identity();var N=M._vsTranslation;N&&(K.extractShapeTranslation||K.extractPolylineTranslation||K.extractVerticesTranslation)&&b.multiply(N),u&&(y.modelMatrix=b.toArray(),Jf(C,y,P.s("3d.clipbox")?yi:P.s("3d.clipbox.mask"))),y.modelViewMatrix=b.premultiply(Z).toArray(),S.cullFace.enabled=!!P.s("shape3d.reverse.cull"),e.renderShapeModel(Y,V,z,M)}},e.resetProperties=R};Ei.shaderSrc={vs:["$DEFINE","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","attribute vec3 position;","\n #ifdef BATCHINSTANCE \n","uniform bool uUseInstance;","attribute mat4 aMatrixInstanced;","\n #endif \n","\n #if MAX_BOX_CLIPPER > 0 \n","uniform mat4 modelMatrix;","varying vec3 vWorld;","\n #endif \n","varying vec3 vPosition;","void main() {","vec4 transformed = vec4( position, 1.0 );","\n #ifdef BATCHINSTANCE \n","if (uUseInstance) { transformed = aMatrixInstanced * transformed; }","\n #endif \n","vPosition = vec3(transformed);","vec4 mvPosition = modelViewMatrix * transformed;","\n #if MAX_BOX_CLIPPER > 0 \n","vWorld = vec3(modelMatrix * transformed);","\n #endif \n","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fs:["$DEFINE","precision highp float;","const float PackUpscale = 256. / 255.;","const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );","const float ShiftRight8 = 1. / 256.;","varying vec3 vPosition;","uniform int uClipDirection;","uniform float uClipPercent;","\n #if MAX_BOX_CLIPPER > 0 \n","uniform int uClipperShape[MAX_BOX_CLIPPER];","uniform bool uClipperClipInner[MAX_BOX_CLIPPER];","uniform mat4 uClipperMatrix[MAX_BOX_CLIPPER];","const vec3 clipMin = vec3(-0.5, -0.5, -0.5);","const vec3 clipMax = vec3(0.5, 0.5, 0.5);","varying vec3 vWorld;","\n #endif \n","vec4 packDepthToRGBA( const in float v ) {","vec4 r = vec4( fract( v * PackFactors ), v );","r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;","}","void main() {","if (uClipDirection > 0) {","vec3 dir = vec3(0.0, 0.0, 0.0);","if (uClipDirection < 2) { dir.x = 1.0; }","else if (uClipDirection < 3) { dir.x = -1.0; }","else if (uClipDirection < 4) { dir.y = 1.0; }","else if (uClipDirection < 5) { dir.y = -1.0; }","else if (uClipDirection < 6) { dir.z = 1.0; }","else if (uClipDirection < 7) { dir.z = -1.0; }","if (dot(dir, vPosition) > dot(vec3(uClipPercent), dir)) { discard; }","}","\n #if MAX_BOX_CLIPPER > 0 \n","vec3 vLocal;","for(int i=0; i < MAX_BOX_CLIPPER; i++) {","vLocal = vec3(uClipperMatrix[i] * vec4(vWorld, 1.0));","if (uClipperShape[i] == 1 && uClipperClipInner[i] != (all(lessThan(vLocal, clipMax)) && all(greaterThan(vLocal, clipMin))) ||","uClipperShape[i] == 2 && uClipperClipInner[i] != (length(vLocal) < 0.5)) { ","discard; return;","}","}","\n #endif \n","gl_FragColor = packDepthToRGBA( gl_FragCoord.z );","}"].join("\n")},Ei.PARAMS=["quality","intensity","bias","radius","type","degree.x","degree.z","bounding"],wp.ms_shadow=function(s){Ei.PARAMS.forEach(function(J){var K=J.replace(/(^|\.)[a-z]/g,function(w){return w[w.length-1].toUpperCase()}),l=K.charAt(0).toLowerCase()+K.substr(1);s["getShadow"+K]=function(){return this._getShadowParam(l)},s["setShadow"+K]=function(R){this._setShadowParam(l,R)}}),s.getCurrentShadowBounding=function(L){(L||!this.shadowMap.boundingSphere)&&this.shadowMap.setupShadowCamera();var A=this.shadowMap.boundingSphere;return[A.center.x,A.center.y,A.center.z,A.radius]},s.refreshShadow=function(){this.shadowMap.refresh()},s.enableShadow=function(j){this.shadowMap.setShadow(!0,j)},s.disableShadow=function(){this.shadowMap.setShadow(!1)},s._getShadowParam=function(R){return this.shadowMap.getShadow()[R]},s._setShadowParam=function(b,B){var S=this._getShadowParam(b),q={};q[b]=B;var z=this.shadowMap;z.setShadow(z.enable,q),this.firePropertyChange("shadow"+b.charAt(0).toUpperCase()+b.substr(1),S,B)}};var Tg=function(d){function M(Q,$,G,L,J){var r=d.getData3dUI(G),v=r.s("shape3d");if("billboard"===v||"plane"===v){var N;(N=X[$])||(N=X[$]=new Os(d));var c=G.s("effect.flow.size"),k=G.s("effect.flow.uvshape"),K=G.getFinalScale3d(),f=K[0],i="billboard"===v?K[1]:K[2];f>i?(i=i/f*c,f=c):(f=f/i*c,i=c),f=Math.max(128,Math.round(f)||0),i=Math.max(128,Math.round(i)||0),N.setSize(Q,f,i),N.bind(Q);var s=d.getViewport(Q);d.setViewport(Q,0,0,f,i),Q.clear(Q.COLOR_BUFFER_BIT|Q.DEPTH_BUFFER_BIT);var P,r=d.getData3dUI(G),p=wq(r,v);if(!p)return!1;!p.ns&&p.length&&(p=p[0]),Lr(p),P=p.vs;var A,Z=G.s("effect.flow.gradient");if(Z){if(A="Flow3d.Cached."+Z,!h.Default.getImageMap()[A]){var y=100;h.Default.setImage(A,h.Default.toCanvas({width:y,height:y,comps:[{type:"rect",background:"rgb(0,0,0)",gradient:Z,rect:[0,0,y,y]}]},y,y))}}else A=G.s("shape3d.image");L.useXZ="plane"===v,L.image=d.getTexture(A,G),L.blend=G.s("effect.flow.blend")||R,L.uvMatrix=$n(r.s("shape3d.uv.rotation"),r.s("shape3d.uv.offset"),r.s("shape3d.uv.scale"),r.s("shape3d.uv.anchor"),n).toArray9(),L.intensity=G.s("effect.flow.intensity");var w=x.indexOf(k);-1===w&&0===k.indexOf("polygon")&&(w=tp(1*k.substring(7),3,1024)-1),L.shape=w,J.position=Mk(Q,null,P,E,3),Mp(Q,0,P.length/3),N.unbind(Q),d.setViewport(Q,s[0],s[1],s[2],s[3]);var t=G.getMatrix4();t.getInverse(t);var B=t.getElements();"plane"===v?B[1]=B[5]=B[9]=B[13]=0:B[2]=B[6]=B[10]=B[14]=0,T[$]={matrix:t,group:G.s("effect.flow.group")}}}var n,z=this,X=this.renderTargetPool=[],T=[],x=["rect","circle","polygon"];z.render=function(){if(!d._picking){var v=d._flowObjects;if(v.length){var c=d.getGL();if(c){var w;(w=c._flowShader)||(w=c._flowShader=new ff.Shader(c,Tg.shaderSrc.vs,Tg.shaderSrc.fs));var g=d._frameState.renderState,a=g.glState;a.blend.enabled=!1,a.depth.enabled=!1,a.cullFace.enabled=!1;var U=a.color.clear.slice(0);Wf(c,[0,0,0,1]),g.useProgram(w.program);var T,V,Y=g.directUniforms(),B=g.directAttribs();for(T=0,V=v.length;V>T;T++)M(c,T,v[T],Y,B);Wf(c,U),X.length!==V&&X.splice(V,X.length-V)}}}},z.contextLost=function(){var B=d.getGL();B&&(B._flowShader=null,X=this.renderTargetPool=[])},z.createFlow=function(j){var A;if(A=X.length){j||(j=d._frameState.renderState.directUniforms());for(var s=[],Q=[],U=[],L=0;A>L;L++)s[L]=T[L].matrix.toArray(),Q[L]=X[L].texture,U[L]=!1;j.flowMatrix=s;for(var L=0;A>L;L++)j["flowTexture"+L]=Q[L];j.flowEnabled=U}},z.disableFlow=function(g){var E;if(E=X.length){g||(g=d._frameState.renderState.directUniforms());for(var l=[],D=0;E>D;D++)l[D]=!1;g.flowEnabled=l}},z.resetDataFlowEnabld=function(h,Z){return z.resetFlowUniform(h.s("effect.flow.mask"),Z)},z.resetFlowUniform=function(V,N){var B=X.length,U=new Array(B);if(V)for(var i=0;B>i;i++)V&1<<T[i].group&&(U[i]=!0);N.flowEnabled=U};var R="white"};Tg.shaderSrc={vs:["uniform bool useXZ;","attribute vec3 position;","varying vec2 vUv;","void main() {","if (useXZ) vUv = vec2(position.x, position.z);","else vUv = vec2(position.x, position.y);","gl_Position = vec4(vUv * 2.0, 0.0, 1.0);","}"].join("\n"),fs:["precision highp float;","const float pi2 = 6.2831853;","uniform sampler2D image;","uniform mat3 uvMatrix;","uniform int shape;","uniform vec4 blend;","uniform float intensity;","varying vec2 vUv;","void main() {","vec2 uv;","float angle = atan(vUv.y, vUv.x) / pi2 + 0.5;","if (shape == 0) {","uv = vUv + 0.5;","}","else if (shape == 1) {","uv = vec2(length(vUv) * 2.0, angle);","}","else {","float step = 1.0 / float(shape + 1);","float modAngle = mod(angle, step) - step * 0.5;","uv = vec2(length(vUv) * 2.0 * cos(modAngle * pi2) , angle);","}","vec4 color = texture2D(image, vec2((uvMatrix * vec3(uv, 1.0)).xy)) * blend;","gl_FragColor = color * color.a * intensity;","}"].join("\n")};var Ds=function(R){this.gv=R,this.onMouseOver=this.onMouseOver.bind(this),this.resetProperties()};Ds.Mode={Disable:0,Selection:1,MouseOver:2,Style:3},wp.ms_highlight=function(F){F.setHighlightMode=function(K){var e;e="selection"===K||"selected"===K?Ds.Mode.Selection:"mouseover"===K||"hover"===K?Ds.Mode.MouseOver:"style"===K?Ds.Mode.Style:Ds.Mode.Disable;var h=this.getHighlightMode();this._highlightHelper.mode=e,this.firePropertyChange("highlightMode",h,K)},F.getHighlightMode=function(){var e=this._highlightHelper.mode;return e===Ds.Mode.Selection?"selected":e===Ds.Mode.MouseOver?"hover":e===Ds.Mode.Style?"style":"disabled"},["type","color","width","glow","strength"].forEach(function(o){var d=o.replace(/(^|\.)[a-z]/g,function(j){return j[j.length-1].toUpperCase()});F["getHighlight"+d]=function(){return this._highlightHelper[o]},F["setHighlight"+d]=function(P){var b=this._highlightHelper,T=b[o];P!==T&&(b[o]=P,this.firePropertyChange("highlight"+d,T,P))}})},gd(Ds,O,{onMouseOver:function(v){K.preventDefault(v);var Z=this.gv;if(!Z._48Q){var b=Z.getDataAt(v);b!==this.mouseOverData&&(this.mouseOverData=b,Z.iv())}},setFetchTargetFunc:function(Q){this.fetchTargetFunc=Q},_42:function(L,u){var j,O,K=this,Y=K._mode,N=K.gv;if(!L._renderInfo.reflectDepth&&Y!==Ds.Mode.Disable){if(Y===Ds.Mode.Selection?j=N.sm().getSelection().toArray(function(Y){return Y.s("highlight.visible")}):Y===Ds.Mode.MouseOver&&K.mouseOverData&&K.mouseOverData.s("highlight.visible")&&(j=[K.mouseOverData]),K.fetchTargetFunc&&(j=K.fetchTargetFunc(j)),Y===Ds.Mode.Style)j=j||[],O=function(c){if(j.indexOf(c)>=0)return!1;var V=N.getDataHighlightMode(c);return V===!1?!0:V===!0?!1:"selected"===V?N.isSelected(c)?!1:!0:"hover"===V?c===K.mouseOverData?!1:!0:!0};else{if(!j||!j.length)return;O=function(d){return j.indexOf(d)<0?!0:void 0}}var B=N.isVRPresenting(),y=N.getWidth();if(B){var h=N.getWidth;y/=2,N.getWidth=function(){return y};var D=N.getViewport()}var C,o=N.getDevicePixelRatio(),e=Math.floor(y*o),V=Math.floor(N.getHeight()*o);(C=K._renderTarget)?C.setSize(L,e,V):K._renderTarget=C=new ag.RenderTarget(N,L,e,V);var f="soft"===K.type;if(C.bind(L),f){var T=L.getParameter(L.COLOR_CLEAR_VALUE);Wf(L,[1,1,1,1]),L.clear(L.COLOR_BUFFER_BIT),Wf(L,T)}else L.clear(L.COLOR_BUFFER_BIT);N.setViewport(L,0,0,e,V),N.drawFilter=function(t){var z=O(t);if(z){var f=N.getData3dUI(t);f&&t.s("batch")&&f._46Q(L,[0,0,0,0])}return z},Ul=function(R,c,K,T,e,V){var g;return g=T&&T.data&&O(T.data)?[0,0,0,0]:[K?0:1,1,1,1],V||(Zq.for(R).directUniforms().uFixPickReverseColor=g),g};var i=L._blooming;i&&(L._blooming=!1),N.renderPickScene(),i&&(L._blooming=!0),Ul=Cf,N.drawFilter=null,C.unbind(L),Wm&&sk(L,u.aPosition),sk(L,u.aNormal),B&&(N.getWidth=h,N.setViewport(L,D[0],D[1],D[2],D[3]));var q=N.getHighlightColor();if(K._lastHighlightColor!==q){var w=yo(K._lastHighlightColor=q);K._highlightColorData=[w[0]/255,w[1]/255,w[2]/255,w[3]/255]}return f?K.renderSoftOutline(L,e,V):K.renderHardOutline(L,e,V),L.useProgram(u=N._prg),Wm&&lk(L,u.aPosition),!0}},_assureShader:function(X,L){var m=X._compiledShader[L];return m||(m=X._compiledShader[L]=new ff.Shader(X,Ds.CommonShaderVs,Ds[L].fs)),m},renderHardOutline:function(w,u,d){var X=this,V=X.gv,j=V._postProcessing,L=Zq.for(w),$=L.directState();$.blend.enabled=!0,$.depth.enabled=!1,j.blitScreen(null,X._renderTarget.texture,X._assureShader(w,"HighlightHard"),{textureSize:[u,d],edgeWidth:V.getHighlightWidth(),edgeColor:X._highlightColorData},{clear:!1}),$.blend.enabled=!1,$.depth.enabled=!0},renderSoftOutline:function(T,l,u){var Y,E,I,P,e,G=this,k=G.gv,h=k._postProcessing,b=Math.floor(l/2),v=Math.floor(u/2),r=Math.floor(l/4),R=Math.floor(u/4),t=G._downSampleRenderTarget;t?(Y=G._edgeDetectionRenderTarget,E=G._blurV2,I=G._blurH2,P=G._blurV4,e=G._blurH4,(t.width!==b||t.height!==v)&&(t.setSize(b,v),Y.setSize(b,v),E.setSize(b,v),I.setSize(b,v),P.setSize(r,R),e.setSize(r,R))):(t=G._downSampleRenderTarget=new ag.RenderTarget(k,T,b,v),Y=G._edgeDetectionRenderTarget=new ag.RenderTarget(k,T,b,v),E=G._blurV2=new ag.RenderTarget(k,T,b,v),I=G._blurH2=new ag.RenderTarget(k,T,b,v),P=G._blurV4=new ag.RenderTarget(k,T,r,R),e=G._blurH4=new ag.RenderTarget(k,T,r,R));var g=T.getParameter(T.COLOR_CLEAR_VALUE),m=k.getViewport(),q=G.width,x=G.strength,U=G.glow,V=Zq.for(T).glState,D=V.depth,F=V.blend,W=D.enabled;Wf(T,[1,1,1,1]),D.enabled=!1,F.apply({func:[T.SRC_ALPHA,T.ONE]}),h.blitScreen(t,G._renderTarget.texture),h.blitScreen(Y,t.texture,G._assureShader(T,"EdgeDetection"),{texSize:[b,v],color:G._highlightColorData}),h.blitScreen(I,Y.texture,G._assureShader(T,"Blur"),{direction:[1,0],texSize:[b,v],radius:q}),h.blitScreen(E,I.texture,G._assureShader(T,"Blur"),{direction:[0,1],texSize:[b,v],radius:q}),h.blitScreen(e,E.texture,G._assureShader(T,"Blur"),{direction:[1,0],texSize:[r,R],radius:q}),h.blitScreen(P,e.texture,G._assureShader(T,"Blur"),{direction:[0,1],texSize:[r,R],radius:q}),F.apply({enabled:!0}),k.setViewport(T,m[0],m[1],m[2],m[3]),h.blitScreen(null,G._renderTarget.texture,G._assureShader(T,"BlendTogether"),{edgeTexture1:E.texture,edgeTexture2:P.texture,edgeStrength:x*q,edgeGlow:U},{clear:!1}),F.apply({func:[T.SRC_ALPHA,T.ONE_MINUS_SRC_ALPHA,T.ONE,T.ONE_MINUS_SRC_ALPHA]}),D.enabled=W,Wf(T,g)},resetProperties:function(){this.mode=Ds.Mode.Style,this.type=N["highlight.type"],this.color=N["highlight.color"],this.width=N["highlight.width"],this.glow=N["highlight.glow"],this.strength=N["highlight.strength"]},contextLost:function(){this._renderTarget=null}}),O.defineProperties(Ds.prototype,{mode:{get:function(){return this._mode},set:function(i){var C=this._mode;if(i!==C){this._mode=i;var W=C===Ds.Mode.MouseOver||C===Ds.Mode.Style,u=i===Ds.Mode.MouseOver||i===Ds.Mode.Style;
u&&W||(W&&J(this.gv.getView(),"mousemove",this.onMouseOver),u&&F(this.gv.getView(),"mousemove",this.onMouseOver))}}}}),Ds.CommonShaderVs=["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),Ds.HighlightHard={fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Ds.EdgeDetection={fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","uniform vec2 texSize;","uniform vec4 color;","void main() {","vec2 invSize = 1.0 / texSize;","vec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);","vec4 c1 = texture2D( image, vUv + uvOffset.xy);","vec4 c2 = texture2D( image, vUv - uvOffset.xy);","vec4 c3 = texture2D( image, vUv + uvOffset.yw);","vec4 c4 = texture2D( image, vUv - uvOffset.yw);","float diff1 = (c1.r - c2.r)*0.5;","float diff2 = (c3.r - c4.r)*0.5;","float d = length( vec2(diff1, diff2) );","gl_FragColor = color * vec4(d);","}"].join("\n")},Ds.Blur={fs:["#define MAX_RADIUS 4","precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform vec2 texSize;","uniform vec2 direction;","uniform float radius;","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float weightSum = gaussianPdf(0.0, radius);","vec4 diffuseSum = texture2D( image, vUv) * weightSum;","vec2 delta = direction * invSize * radius/float(MAX_RADIUS);","vec2 uvOffset = delta;","for( int i = 1; i <= MAX_RADIUS; i ++ ) {","float w = gaussianPdf(uvOffset.x, radius);","vec4 sample1 = texture2D( image, vUv + uvOffset);","vec4 sample2 = texture2D( image, vUv - uvOffset);","diffuseSum += ((sample1 + sample2) * w);","weightSum += (2.0 * w);","uvOffset += delta;","}","gl_FragColor = diffuseSum/weightSum;","}"].join("\n")},Ds.BlendTogether={fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D image;","uniform sampler2D edgeTexture1;","uniform sampler2D edgeTexture2;","uniform float edgeStrength;","uniform float edgeGlow;","void main() {","vec4 edgeValue1 = texture2D(edgeTexture1, vUv);","vec4 edgeValue2 = texture2D(edgeTexture2, vUv);","vec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;","float vv = texture2D(image, vUv).r;","vec4 finalColor = edgeStrength * vv * edgeValue;","gl_FragColor = finalColor;","}"].join("\n")};var Es=h.Light=function(){cb(Es,this),this.s(us,N[us]),this.s(Jb,"sphere"),this.s("shape3d.reverse.cull",!0),this.s3(20,20,20)};lq("Light",xi,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(R,h,Q){Es.superClass.onStyleChanged.apply(this,arguments),R===us&&this.s("shape3d.color",Q)}});var Fs=ag.FrameState=function(C,T){this.renderState=Zq.for(T),this.picking=!1,this.envmapReflectivity=.5,this.cameraPosition=P,this.projectMatrix=P,this.viewMatrix=P,this.view=C,this.defaultProgram=P,this.pickColorMap=P,this._pvStack=[],this._renderStateStack=[]};Fs.prototype.savePV=function(){var g=this.view;this._pvStack.push([mf(this.projectMatrix),mf(this.viewMatrix),g._18Q,mf(g._7O)])},Fs.prototype.restorePV=function(){var e=this._pvStack.pop();if(e){var C=this.view;this.projectMatrix=C._projectMatrix=e[0],this.viewMatrix=C._viewMatrix=e[1],C._18Q=e[2],C._7O=e[3]}},Fs.prototype.setPV=function(j,U){var w=this.view,b=!1;if(j&&(this.projectMatrix=w._projectMatrix=j,b=!0),U&&(this.viewMatrix=w._viewMatrix=U,w._7O=mf(U),b=!0),b){var v=w.getWidth(),$=w.getHeight(),W=mf(this.projectMatrix);w._18Q=Cq(W,W,U),w._18Q._wh=v/$}},Fs.prototype.syncEnv=function(K){var W=this,g=W.view;W.envmapReflectivity=g._envmapReflectivity||.5,W.cameraPosition=g.getEye(),W.projectMatrix=g._projectMatrix,W.viewMatrix=g._viewMatrix,W.pickColorMap=K,W.picking=g.getGL()._picking},Fs.prototype.setGLState=function(){var u=[0,0,0,0],c=[!0,!0,!0,!0],G=[-1,1],j=[Um.FUNC_ADD,Um.FUNC_ADD],z=[Um.SRC_ALPHA,Um.ONE_MINUS_SRC_ALPHA,Um.ONE,Um.ONE_MINUS_SRC_ALPHA];return function(T,m){var p=this,O=p.renderState.gl,o=p.renderState.glState;o.dither=!1,m?o.color.mask=c:o.color.reset(),o.pixelStore.reset(),o.blend.color=u,o.blend.equation=j,o.blend.func=z,o.cullFace.enabled=!1,o.scissor.enabled=!1,o.depth.enabled=!0,o.depth.clear=1,o.depth.func=O.LEQUAL,o.depth.range=G,o.stencil.enabled=!1,o.polygonOffset.enabled=!1,T?(o.depth.mask=!1,o.blend.enabled=!0):(o.depth.mask=!0,o.blend.enabled=!1)}}(),Fs.prototype.setUniforms=function(A){var o=this,B=o.view,$=o.renderState,L=$.gl,H=$.uniforms;H.uBrightness=1,H.uOpacity=1,H.uPartOpacity=1,H.uPick=o.picking,H.uUseInstance=!1,H.uTexture=!1,H.uBlendTexture=!1,H.uAlphaTest=N.alphaTest,H.uTransparent=!!A,H.uFix=!1,H.uBatchColor=!1,H.uBatchBlend=!1,H.uBatchBrightness=!1,H.uReflectivity=o.envmapReflectivity||.5,H.uCameraPosition=o.cameraPosition,H.uPMatrix=o.projectMatrix,H.uViewMatrix=o.viewMatrix,H.uEnvMap=null,Jf(B,H,yi),H.uClipperMatrix=B._boxClipperMatrixes,H.uClipperClipInner=B._boxClipperClipInner,H.uEnvmapQuat=B._envmapExtraQuaternion,B._envmapRenderer.resetUniformCache(),o.picking||(wb(B,L,P),B._fogDisabled||(H.uFogColor=B._fogColor,H.uFogDensity=B._fogDensity,H.uFogNear=B._fogNear,H.uFogFar=B._fogFar))},Fs.prototype.drawLayer=function(Y){return this.view.renderLayers(Y,!0)},Fs.prototype.drawData=function(Y,q,s){var m=this.view;if(m.isVisible(Y)){var z=this.renderState,R=z.uniforms,F=m.getData3dUI(Y);if(F){var K=z.gl,J=K._picking,a=m._picking,O=F._pickId;s&&(F._pickId=s),R.uPick=K._picking=m._picking=!!s,R.uTransparent=!!q,F._42(z.gl,z.program,q?r:g),R.uPick=K._picking=J,m._picking=a,F._pickId=O}}};var Gs=ag.Graph3dView=function(w,T){var $=this;$.resetHeadlightProperties(),$.resetFogProperties(),$._webGLVersion=1,$._attributes=T||K.graph3dViewAttributes,$._25I={},$._view=Of(1,$);var x;$._attributes&&(x=$._attributes.canvas)||(x=ej($._view)),$._canvas=x,F(x,"webglcontextlost",function(P){P.preventDefault(),Zi($),$._26I&&($._doBufferGC($._26I,!0),Gm($._canvas,0,0),["_highlightHelper","shadowMap","flowMap","_envmapRenderer","_postProcessing"].forEach(function(U){$[U].contextLost()}),$.dm().each(function(d){var O=$.getData3dUI(d);O.contextLost()})),$._26I=E,$._1o.onContextLost(),$._35O=!0}),F(x,"webglcontextrestored",function(){$._35O=!1,$.iv()}),$._40Q=new Ns($),$._43Q={},$._44Q=-1,$._batchIndexMap={},$._batchModelMap={},$._wireframeIndexMap={},$._wireframeModelMap={},$._wireframeIndexMapSwap={},$._wireframeModelMapSwap={},$._polylineIndexMap={},$._polylineIndexMap={},$._polylineIndexMapSwap={},$._polylineIndexMapSwap={},$._8O=[],$._7O=Tc(),$._6O=Tc(),$._1o=new Xs($),$._30O=new $s($),$._31O=new Ys($),$._32O=new Zs($),$._raycaster=new jt($),$._highlightHelper=new Ds($),$._postProcessing=new tt($),$._41Q=[],$._42Q=0,$._frameRenderOptionStack=[],ag.VR?($.vr=new ag.VR($),$.isVREnabled=function(){return this.vr.enable},$.isVRPresenting=function(){return this.vr.isPresenting()}):($.vr={enable:!1,isPresenting:k},$.isVREnabled=k,$.isVRPresenting=k),$.shadowMap=new Ei($),$.flowMap=new Tg($),$._33Q=!0,$._eye=fo(K.graph3dViewEye),$._center=fo(K.graph3dViewCenter),$._up=fo(K.graph3dViewUp),$._lightChanged=!1,$._59O=[],$._spots=[],$._dirs=[],$._boxClippers=[],$._flowObjects=[],$._frameId=0,$._picking=!1,$._batchInfoMap={},$._renderLayerInfoMap={},$._sortedRenderLayers=O.keys($d),$.overlappingBox=new Ol($),$.dm(w?w:new ed),$._coreInteractor=new fr(this),$._envmapRenderer=new ag.EnvmapRenderer(this),$.setInteractors([new Qs($)]),$._initView(),$._genBatchInstancedArrayFunc()},Hs={fogDisabled:1,fogMode:1,dashDisabled:1,batchColorDisabled:1,batchInstancedDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,flowBlendMode:1,uvClipEnabled:1,ortho:1},Is={box:1,sphere:2},Js={addRGB:"FLOW_BLEND_MODE_ADD_RGB",addRGBA:"FLOW_BLEND_MODE_ADD_RGBA",overrideRGBA:"FLOW_BLEND_MODE_OVERRIDE_RGBA",overrideRGB:"FLOW_BLEND_MODE_OVERRIDE_RGB",overrideA:"FLOW_BLEND_MODE_OVERRIDE_A",multiplyRGB:"FLOW_BLEND_MODE_MULTIPLY_RGB",multiplyRGBA:"FLOW_BLEND_MODE_MULTIPLY_RGBA"},Ks=0;cj("Graph3dView",O,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_shadow:1,ms_highlight:1,ms_quickVisible:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","blockSelectable","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable","zoomToCenter",Bs,dj,"firstPersonMode",np,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightDirection","headlightColor","headlightIntensity","headlightAmbientIntensity","headlightDisabled","headlightGroup","ortho","orthoWidth","syncEyeWithOrthoWidth","fovy","near","far",ui,Xj,"up","aspect","fogDisabled","fogMode","fogDensity","fogColor","fogNear","fogFar","pickerResolution","dashDisabled","uvClipEnabled","batchColorDisabled","batchInstancedDisabled","batchBlendDisabled","batchBrightnessDisabled","flowBlendMode","hoverDelay","batchInfoMap","renderLayerInfoMap","rotateMinPhi","rotateMaxPhi","sortable","sortFunc"],_editable:!1,_sortable:K.graph3dViewSortable,_editHelperDisabled:K.graph3dViewEditHelperDisabled,_blockSelectable:K.graph3dViewBlockSelectable,_devicePixelRatio:P,_boundaries:P,_moveStep:K.graph3dViewMoveStep,_rotateStep:K.graph3dViewRotateStep,_rotateMinPhi:K.graph3dViewMinPhi===P?K.graph3dViewRotateMinPhi:K.graph3dViewMinPhi,_rotateMaxPhi:K.graph3dViewMaxPhi===P?K.graph3dViewRotateMaxPhi:K.graph3dViewMaxPhi,_pannable:K.graph3dViewPannable,_rotatable:K.graph3dViewRotatable,_walkable:K.graph3dViewWalkable,_resettable:K.graph3dViewResettable,_zoomable:K.graph3dViewZoomable,_zoomToCenter:!0,_firstPersonMode:K.graph3dViewFirstPersonMode,_mouseRoamable:K.graph3dViewMouseRoamable,_gridVisible:K.graph3dViewGridVisible,_gridSize:K.graph3dViewGridSize,_gridGap:K.graph3dViewGridGap,_gridColor:K.graph3dViewGridColor,_originAxisVisible:K.graph3dViewOriginAxisVisible,_centerAxisVisible:K.graph3dViewCenterAxisVisible,_axisXColor:K.graph3dViewAxisXColor,_axisYColor:K.graph3dViewAxisYColor,_axisZColor:K.graph3dViewAxisZColor,_ortho:K.graph3dViewOrtho,_orthoWidth:K.graph3dViewOrthoWidth,_syncEyeWithOrthoWidth:K.graph3dViewSyncEyeWithOrthoWidth,_fovy:K.graph3dViewFovy,_near:K.graph3dViewNear,_far:K.graph3dViewFar,_rectSelectable:K.graph3dViewRectSelectable,_rectSelectBackground:K.graph3dViewRectSelectBackground,_editSizeColor:K.graph3dViewEditSizeColor,_autoMakeVisible:Kc,_pickerResolution:K.graph3dViewPickerResolution,_dashDisabled:K.graph3dViewDashDisabled,_uvClipEnabled:K.graph3dViewUvClipEnabled,_batchColorDisabled:K.graph3dViewBatchColorDisabled,_batchInstancedDisabled:K.graph3dViewBatchInstancedDisabled,_batchBlendDisabled:K.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:K.graph3dViewBatchBrightnessDisabled,_flowBlendMode:K.graph3dViewFlowBlendMode,addCamera:function(z){var u=this,g=O.freeze({id:u._42Q++,priority:z.priority||0,ignoreInPick:!!z.ignoreInPick,render:z.render});z.switch3DStatus&&(u._43Q[g.id]=!0),u._41Q.push(g),u._41Q.sort(function(z,U){return z.priority!==U.priority?z.priority-U.priority:z.id-U.id})},setEye:function(n,h,Z){1===arguments.length&&(h=n[1],Z=n[2],n=n[0]);var G=this._eye;G[0]=n,G[1]=h,G[2]=Z,this.fp(ui,E,G)},setCenter:function(Y,i,X){1===arguments.length&&(i=Y[1],X=Y[2],Y=Y[0]);var J=this._center;J[0]=Y,J[1]=i,J[2]=X,this.fp(Xj,E,J)},setUp:function(B,g,s){1===arguments.length&&(g=B[1],s=B[2],B=B[0]);var j=this._up;j[0]=B,j[1]=g,j[2]=s,this.fp("up",E,j)},getDevicePixelRatio:function(){return this._picking?this._1o._resolution:this._devicePixelRatio||qq},isTransparentMask:function(W){return W.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var D=this,F=D._aspect;return F?F:(F=D.getWidth()/D.getHeight(),F||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(J){var R=this,d=R._dataModel,i=R._selectionModel;d!==J&&(d&&(d.ump(R.handleDataModelPropertyChange,R),d.umm(R.handleDataModelChange,R),d.umd(R.handleDataPropertyChange,R),i||d.sm().ums(R.handleSelectionChange,R)),R._dataModel=J,J.mp(R.handleDataModelPropertyChange,R),J.mm(R.handleDataModelChange,R),J.md(R.handleDataPropertyChange,R),i?i._21I(J):J.sm().ms(R.handleSelectionChange,R),R._postProcessing.handleDataModleChange(d,J),R._tryInvalidateEnvmap(),R.invalidateAll(!0),R.invalidateLight(),R.invalidateboxClipper(),R.invalidateFlowObjects(),R._49Q(),R.fp(ac,d,J),R._canvas.style.background=J.getBackground()||"")},handleDataModelPropertyChange:function(R){var W=R.property;if("background"===W){var _=this._canvas.style.background,L=R.newValue||"";this._canvas.style.background=L,this.fp("canvasBackground",_,L)}else if("envmapType"===W)this._tryInvalidateEnvmap();else if("envmap"===W){var _=this._shaderUseEnvmapFlag,L=!(!R.newValue||!R.newValue.length);_!==L&&Zi(this),this.iv()}},handleDataPropertyChange:function(g){var u=g.data;this.invalidateData(u);var v=g.property;fe(u)&&"s:light.type"===v?this.invalidateLight():"s:3d.clipbox"===v?this.invalidateboxClipper(u,!0):"s:effect.flow"===v?this.invalidateFlowObjects(u,!0):"s:shadow.cast"===v?this.shadowMap.tryUpdateBounding(u):"s:3d.visible"===v&&this.invalidateQuickVisible(u)},invalidateboxClipper:function(F,r){var l=this._boxClippers,R=l.length;if(F){var g=!!F.s("3d.clipbox");if(r=!!r,g===r)l.indexOf(F)<0&&l.push(F);else{var u=l.indexOf(F);u>=0&&l.splice(u,1)}}else l=this._boxClippers=[],this.dm().each(function(k){k.s("3d.clipbox")&&l.push(k)});var y=l.length;R!==y&&(Zi(this),this.shadowMap.deleteShadowProgram(),this._updateBoxClipperMatrix(),Jf=y?Kb:Aj),this.iv()},_updateBoxClipperMatrix:function(){for(var d,B,q=this._boxClippers,x=this._boxClipperMatrixes=[],o=this._boxClipperClipInner=[],m=this._boxClipperGroups=[],g=this._boxClipperShape=[],V=new jo,e=0,w=q.length;w>e;e++)d=q[e],d.appendAnchorMatrix3d(B=$f(d,this.getMat(d))),x.push(V.getInverse(V.fromArray(B)).toArray()),o.push("inner"===d.s("3d.clipbox")),m.push(d.s("3d.clipbox.group")),g.push(Is[d.s("3d.clipbox.shape")]||1)},_49Q:function(){this._4AQ||this._48Q||this.dm().size()<K.graph3dViewDataNumWarningLine||(this._48Q=!0,console.log("Too many datas so than disable some feature to speed up.\nYou can set global Default.graph3dViewDataNumWarningLine to largeEnoughNum to avoid this, or call graph3dView.quitDataNumWarning() to quit.\n"),this.enableQuickVisibleMode(),this.getHighlightHelper().mouseOverData=null)},quitDataNumWarning:function(){this.disableQuickVisibleMode(),this._48Q=!1,this._4AQ=!0},invalidateFlowObjects:function(M,I){var H=this._flowObjects,r=H.length;if(M){var v=!!M.s("effect.flow");if(I=!!I,v===I)H.indexOf(M)<0&&H.push(M);else{var j=H.indexOf(M);j>=0&&H.splice(j,1)}}else H=this._flowObjects=[],this.dm().each(function(d){d.s("effect.flow")&&H.push(d)});r!==H.length&&Zi(this),this.iv()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(J){var e=this,U=J.property;if(e.iv(),e._18Q=E,"eye"===U)e._33Q=!0;else if("devicePixelRatio"===U)e._42(e.getDevicePixelRatio());else if(Hs[U]&&(Zi(e),"batchInstancedDisabled"===U)){e._genBatchInstancedArrayFunc(),this.shadowMap.deleteShadowProgram();var p,h=K.getBatchInfoMap();for(p in h)h[p]&&h[p].instanced&&e.invalidateBatch(p);h=e._batchInfoMap;for(p in h)h[p]&&h[p].instanced&&e.invalidateBatch(p)}},_5O:function(o){var p=o._22Q();return p?new p(this,o):E},getData3dUI:function(A){var U=this._25I[A._id];return U===P&&(U=this._5O(A),this._25I[A._id]=U),U},invalidateAll:function(C,n){var p=this;if(C){for(var A in p._25I){var y=p._25I[A];y&&y.dispose()}p._25I={},p.iv(),Wo(p)}else Wo(p),p.dm().each(function(h){p.invalidateData(h)});p.shadowMap.tryInvalidateLater(C,n)},invalidateSelection:function(){var N=this;N.sm().each(function(U){N.invalidateData(U)})},invalidateData:function(w){var V=this,l=V.getData3dUI(w);l&&(l.iv(),V.iv()),Wo(V,w)},getShape3dText:function(X){return X.getStyle("shape3d.text")||this.getLabel(X)},invalidateBatch:function(m){var l=this,t=l._40Q;t.each(function(N){l._invalidateBatch(m,N.batchModelMap,N.batchIndexMap),l._invalidateBatch("T"+m,N.wireframeModelMap,N.wireframeIndexMap),l._invalidateBatch("O"+m,N.wireframeModelMap,N.wireframeIndexMap),N.markBatchInvalid()}),l.iv()},_invalidateBatch:function(r,u,p){var Z=this,U=u[r];U&&(U.ds.forEach(function(D){var t=Z.getData3dUI(D);t&&t.iv(),delete p[D._id]}),delete u[r])},handleDataModelChange:function(K){var b=this,O=K.kind,V=K.data;if("add"===O)b.invalidateData(V),bf(V)&&V.getEdgeGroup()&&V.getEdgeGroup().eachSiblingEdge(b.invalidateData,b),fe(V)&&b.invalidateLight(),V.s("3d.clipbox")&&b.invalidateboxClipper(V,!0),V.s("effect.flow")&&b.invalidateFlowObjects(V,!0),b._49Q();else if(O===Fk){var C=V._id,j=b._25I[C];j&&(j.dispose(),delete b._25I[C],b.iv()),V===b._currentSubGraph&&b.setCurrentSubGraph(E),Wo(b,V),fe(V)&&b.invalidateLight(),V.s("3d.clipbox")&&b.invalidateboxClipper(V,!1),V.s("effect.flow")&&b.invalidateFlowObjects(V,!1)}else O===cl&&(b.invalidateAll(!0),b.setCurrentSubGraph(E),Wo(b),b.invalidateLight(),b.invalidateboxClipper(),b.invalidateFlowObjects())},toCanvas:function(P,F,A){var g=this,t=g.getGL();if(g.validate(),P){var d=t.getParameter(t.COLOR_CLEAR_VALUE);Wf(t,P)}g._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var c=g.getWidth()||1,J=g.getHeight()||1,$=new Uint8Array(4*c*J),l=ej(),N=l.getContext("2d");t.readPixels(0,0,c,J,t.RGBA,t.UNSIGNED_BYTE,$),Gm(l,c,J,1);for(var T=N.getImageData(0,0,c,J),z=T.data,E=0;E<z.length;E+=4){var v=E/4,y=X(v/c),Q=v-y*c;v=4*((J-1-y)*c+Q),z[v]=$[E],z[v+1]=$[E+1],z[v+2]=$[E+2],z[v+3]=$[E+3]}if(N.putImageData(T,0,0),P&&Wf(t,d),g._42(g.getDevicePixelRatio()),F&&A){var o=ej(),p=o.getContext("2d");return Gm(o,F,A,1),K.drawImage(p,l,0,0,F,A),o}return l},toDataURL:function(J,E){var S=this,w=S.getGL();if(S.validate(),J){var B=w.getParameter(w.COLOR_CLEAR_VALUE);Wf(w,J)}S._42(1,{renderAxis:!1,renderEdit:!1,renderGrid:!1});var d=S._canvas.toDataURL(E||"image/png",1);return J&&Wf(w,B),S._42(S.getDevicePixelRatio()),d},isWebGL2:function(){return 2===this._webGLVersion},getGL:function(){var p=this._26I;if(p)return this.acquireProgram(),p;if(!this._35O){var n=this,z=n._canvas,A=n._attributes;if(!A||A.requestWebGL2!==!1)try{p=z.getContext("webgl2",A)||z.getContext("experimental-webgl2",A),p&&(n._webGLVersion=2,n._26I=p)}catch(k){}if(!p)try{p=z.getContext("webgl",A)||z.getContext("experimental-webgl",A)}catch(k){throw new Error("WebGL not supported")}if(!p)throw new Error("WebGL not supported");n._26I=p;var $=n._frameState=new Fs(this,p);n._glExtensions=new o(p),n._glCapabilities=new U(p,n._glExtensions),n._2O={},p._emptyCubeTexture=gn(p),p._compiledShader={},p._emptyTexture=Bh(p),p._emptyBlendTexture=Bh(p),p._bufPool={},p._id=++Ks,p._divisorState=[],$.setGLState(),n._buffer={vs:Ke(p),ns:Ke(p),is:Ke(p),uv:Ke(p),batchColor:Ke(p),batchBlend:Ke(p),batchBrightness:Ke(p),lineDistance:Ke(p)},n._1O=De(p);var R=n._cube={vs:Ke(p),ns:Ke(p),is:Ke(p),uv:Ke(p)};return jh(p,R.vs,Qo),jh(p,R.ns,xn),jh(p,R.uv,Ag),Zm(p,R.is,kn),n.acquireProgram(),n._genBatchInstancedArrayFunc(),p._renderInfo={calls:0,vertices:0,faces:0,lines:0,points:0,textureCache:{time:0,count:0,pixels:0},frame:0,cacheTimeCost:0,reflectDepth:0},p}},getGLCapabilities:function(){var R=this.getGL();return R?this._glCapabilities:void 0},getGLExtensions:function(){var o=this.getGL();return o?this._glExtensions:void 0},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<K.graph3dEnvmapCapabilityRequire?null:this.dm().getEnvmap()},getEnvmapType:function(){var S,Y=this.dm();return Y&&(S=Y.getEnvmapType()),S||"legacy"},setEnvmapExtraQuaternion:function(K){var W=this._envmapExtraQuaternion;this._envmapExtraQuaternion=K instanceof Uj.Quaternion?K.clone().inverse().toArray():null,null==W!=(null==K)&&Zi(this)},invalidateEnvmap:function(U){return this._envmapRenderer.invalidateEnvmap(U)},_setEnvmapByProbeId:function(g,G){return this._envmapRenderer.setEnvmapByProbeId(g,G)},_tryInvalidateEnvmap:function(){var A=this.getEnvmapType();A!==this._lastProgramEnvmapType&&(Zi(this),this.iv())},acquireProgram:function(){var X=this,W=X._26I;if(W&&!X._prg){var A=X._prg=W.createProgram();if(!A)return E;var C=X._dirs.length,G=X._spots.length,I=X._59O.length,F=X._boxClippers.length,P=X._flowObjects.length,L=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uUvMatrix","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uClipDirection","uClipPercent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightAmbientIntensity","uHeadlightColor","uFogColor","uFogDensity","uFogNear","uFogFar"];C&&L.push("uDirColor","uDirDirection"),G&&L.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),I&&L.push("uPointColor","uPointRange","uPointPosition"),Gr||(jk=to(jk.substring(0,jk.indexOf("^#"))),Je=to(Je),Gr=!0);var j=X.getEnvmap(),V=j&&j.length,n=X.getEnvmapType(),z=["#define MAX_DIR "+C,"#define MAX_SPOT "+G,"#define MAX_POINT "+I,"#define MAX_BOX_CLIPPER "+F,"#define MAX_FLOW_OBJECT "+P,X._fogDisabled?"":"#define FOG","exp2"===X.getFogMode()?"#define FOG_EXP2":"",X._dashDisabled?"":"#define DASH",X._uvClipEnabled?"#define UV_CLIP":"",null==X._envmapExtraQuaternion?"":"#define ENVMAP_ROTATE",V?"#define USE_ENVMAP":"","legacy"!==n?"#define ENVMAP_TYPE_CUBE_UV":"",X.isOrtho()?"#define ORTHOGRAPHIC":"",X._batchColorDisabled?"":"#define BATCHCOLOR",X._batchInstancedDisabled?"":"#define BATCHINSTANCE",X._batchBlendDisabled?"":"#define BATCHBLEND",X._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS","#define "+(Js[X.getFlowBlendMode()]||Js[K.graph3dViewFlowBlendMode]),X.shadowMap.enable?X.shadowMap.genShaderDefine():"",""].join("\n"),c=dq(W,A,W.VERTEX_SHADER,jk.replace("#PREFIX",z));W.getShaderParameter(c,W.COMPILE_STATUS)||Tj("COMPILE",W.VERTEX_SHADER,W.getError(),W.getShaderInfoLog(c));var M=dq(W,A,W.FRAGMENT_SHADER,Je.replace("#PREFIX",z));if(W.getShaderParameter(M,W.COMPILE_STATUS)||Tj("COMPILE",W.FRAGMENT_SHADER,W.getError(),W.getShaderInfoLog(M)),Wm?L.push("aPosition"):(A.aPosition=0,W.bindAttribLocation(A,0,"aPosition")),W.linkProgram(A),!W.getProgramParameter(A,W.LINK_STATUS)){var O=W.getProgramInfoLog(A);return X._prg=E,O.indexOf("maximum temp register")>=0&&!X._glTempRegisterLimited?(X._glTempRegisterLimited=!0,W.deleteProgram(A),X.acquireProgram()):(Tj("LINK",W.getProgramParameter(A,W.VALIDATE_STATUS),W.getError(),O),W.deleteProgram(A),E)}L.forEach(function(v){A[v]=/^u/.test(v)?W.getUniformLocation(A,v):W.getAttribLocation(A,v)});var _=X._frameState;_.renderState.program=_.defaultProgram=A,X._envmapRenderer.changeEnvmapType(X._lastProgramEnvmapType=n),X._shaderUseEnvmapFlag=V,W.deleteShader(c),W.deleteShader(M)}},isGLTempRegisterLimited:function(){return this._glTempRegisterLimited},getBrightness:function(M){var Y=M.s("brightness"),D=this.isSelected(M)?M.s("select.brightness"):E;return Y==E?D:D==E?Y:Y*D},getDataHighlightMode:function(a){return a.s("highlight.mode")},getWireframe:function($){var q=$.s("wf.visible"),g=$.s("wf.width");return q===!0||g>0&&"selected"===q&&this.isSelected($)?{color:$.s("wf.color"),width:g,"short":$.s("wf.short"),mat:$.s("wf.mat")}:void 0},getPartPosition:function(I,O,B,h){h=h||gg;var u=this.getData3dUI(I),H=u._16O(h.autoRotate,O,E,B||Yp,h.t3,h.r3,h.rotationMode);return[H[12],H[13],H[14]]},_transformPointToViewSpace:function($){var x=[$[0],$[1],$[2]];return kc(x,this._viewMatrix),x},_transformDirectionToViewSpace:function(q,v){var j=q?[q[0],q[1],q[2]]:[0,0,0];kc(j,this._viewMatrix);var P=v?[v[0],v[1],v[2]]:[0,0,0];kc(P,this._viewMatrix);var s=P[0]-j[0],T=P[1]-j[1],N=P[2]-j[2],d=Math.sqrt(s*s+T*T+N*N);return d?[s/d,T/d,N/d]:[s,T,N]},getWireframeGeometry:function(Z){return Z.s("wf.geometry")?{color:Z.s("wf.color"),width:Z.s("wf.width"),mat:Z.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(v){return v.s("body.color")},getMat:function(W){return W.getMat?W.getMat():W.s("mat")},getFaceMat:function(y,S){return y.getFaceMat?y.getFaceMat(S):y.s(S+".mat")},getFaceBlend:function(B,e){return B.s(e+".blend")||B.s("all.blend")},getFaceColor:function(u,b){return u.s(b+".color")||u.s("all.color")},getFaceImage:function(U,l){return U.s(l+".image")||U.s("all.image")},getFaceBlendImage:function(O,P){return O.s(P+".blend.image")||O.s("all.blend.image")},getFaceDiscardSelectable:function(S,r){var L=S.s(r+".discard.selectable");return L==E?S.s("all.discard.selectable"):L},getFaceUv:function(u,w){return u.s(w+".uv")||u.s("all.uv")},getFaceUvOffset:function(t,R){return t.s(R+".uv.offset")||t.s("all.uv.offset")},getFaceUvScale:function(J,C){return J.s(C+".uv.scale")||J.s("all.uv.scale")},getFaceUvRotation:function(L,r){return L.s(r+".uv.rotation")||L.s("all.uv.rotation")},getFaceUvAnchor:function(t,c){return t.s(c+".uv.anchor")||t.s("all.uv.anchor")},getFaceLight:function(i,n){var b=i.s(n+".light");return b==E?i.s("all.light"):b},getFaceVisible:function(n,f){var H=n.s(f+".visible");return H==E?n.s("all.visible"):H},getFaceOpacity:function(u,z){var P=u.s(z+".opacity");return P==E?u.s("all.opacity"):P},getFaceTransparent:function(T,s){var r=T.s(s+".transparent");return r==E?T.s("all.transparent"):r},getFaceReverseColor:function(e,W){return e.s(W+".reverse.color")||e.s("all.reverse.color")},getFaceReverseFlip:function(s,W){var O=s.s(W+".reverse.flip");return O==E?s.s("all.reverse.flip"):O},getFaceReverseCull:function(U,u){var g=U.s(u+".reverse.cull");return g==E?U.s("all.reverse.cull"):g},getTextureMap:function(){return this._2O},_2Oi:function(G,w,o){o=o||"";var A;(A=this._2O[G])||(A=this._2O[G]={}),A[o]=w},deleteTexture:function(H){var L=this;if(L._2O){var f=L._2O[H];if(f){delete L._2O[H];var U=L.getGL();for(var Y in f)U.deleteTexture(f[Y])}}},renderPickScene:function(){var R=this.getGL();this.syncRenderState(),this._picking=R._picking=!0,this.renderScene(),this._picking=R._picking=!1},invalidateCachedTexture:function(h){var I=this.getData3dUI(h);I.invalidateCachedTexture(this.getGL()),this.invalidateData(h)},invalidateShape3dCachedImage:function(E){this.invalidateCachedTexture(E)},invalidateCachedGeometry:function(L){var e=this.getData3dUI(L);e.invalidateCachedGeometry(),this.invalidateData(L)},isInteractive:function(X){return X.s("interactive")},getTexture:function(z,X,V,H){if(!z)return E;var B,N,x=this,t=x.getGL(),R=x._2O[z];if(R&&(X&&(N=X.s("texture.mipmap.max")),B=R[N||""]||R.default),!B){var I=fl(z);if(H||(H={}),!I)return t._emptyTexture;if(X){H.mipmapMaxLevel=N=X.s("texture.mipmap.max");var q=X.s("texture.wrap");H.clampToEdge="clampToEdge"===q?!0:"repeat"===q?!1:P}if(I.uuid||(I.uuid=h.Math.generateUUID()),I.tagName){if(I.dynamic)return De(t,I,x._1O,H);B=De(t,I,P,H),x._2Oi(z,B,N)}else{var f,m=X&&(X.s("texture.cache")||X.s("shape3d.image.cache")||I.textureCache),C=x.isVRPresenting();if(C&&(X._textureUpdateFrame===t._renderInfo.frame?m=!0:X._textureUpdateFrame=t._renderInfo.frame),m&&(f=x.getData3dUI(X),B=f.getCachedTexture(V),B&&f.interactiveInfo&&B.interactiveInfo&&(f.interactiveInfo[B.interactiveInfo.key]=B.interactiveInfo.info)),!B){var A=t._renderInfo.textureCache;if(m){if(A.time>K.graph3dMaxVectorCacheTime)return x.redraw(),t._emptyTexture;if(!Rn(I,X))return t._emptyTexture}var k;X&&(1!==X.s("texture.scale")?k=X.s("texture.scale"):1!==X.s("shape3d.texture.scale")&&(k=X.s("shape3d.texture.scale"))),k||(k=1);var l=X&&(X.s("fixSizeOnScreen")||X.s("shape3d.fixSizeOnScreen")),$=l?t.NEAREST:t.LINEAR;l?"number"==typeof l&&(k*=0>l?1:l):X&&(X.s("vector.dynamic")||X.s("shape3d.vector.dynamic"))&&(f||(f=x.getData3dUI(X)),l=f.getVectorDynamicSize());var r,M,v,c=X&&X.s("shape3d");"billboard"===c?v=X.getTall()/X.getWidth():"plane"===c&&(v=X.getHeight()/X.getWidth());var Z=_r(I,X);if(l){var j;j=m?x._devicePixelRatio||qq:x.getDevicePixelRatio(),r=l[0]>0?l[0]*j:k*Z*j,M=l[1]>0?l[1]*j:k*(v?wm(I,X,x,Math.min(4096,Z*v)):wm(I,X))*j}else r=k*Z,M=k*(v?wm(I,X,x,Math.min(4096,Z*v)):wm(I,X));if(r>=1&&M>=1){var n=0;(m||C)&&(n=Date.now());var g=x._glCapabilities.maxTextureSize;r=Math.min(r,g),M=Math.min(M,g);var d=Le(r,M);if(!f&&X&&(f=x.getData3dUI(X)),f&&f.interactiveInfo){var S=z;"object"==typeof S&&(S=S.uuid||(S.uuid=h.Math.generateUUID()));var O=f.interactiveInfo[S]={};d.interactiveInfo=O.bodyInfo={compInfos:[],matrix:new Or,rect:{x:0,y:0,width:r,height:M}}}Pp(d,I,0,0,r,M,X,x),d.interactiveInfo&&(d.interactiveInfo=null),d.restore(),A.count++,A.pixels+=r*M,X?(H.minFilter=km(X.s("texture.filter.min")||X.s("texture.filter"))||$,H.magFilter=km(X.s("texture.filter.mag")||X.s("texture.filter"))||$):H.minFilter=H.magFilter=$,m||C?(B=De(t,Ar,null,H),f.setCachedTexture(B,V),A.time+=Date.now()-n,O&&(B.interactiveInfo={key:S,info:O}),Ar=null):B=De(t,Ar,x._1O,H)}}}}return B},redraw:function(){this.iv()},validateImpl:function(){var L=this;if(L._lightChanged){L._lightChanged=!1;var E=[],N=[],f=[];L.dm().each(function(D){if(fe(D)){var l=D.s("light.type");l===pe?E.push(D):l===Wr?N.push(D):l===wf&&f.push(D)}}),(E.length!==L._59O.length||N.length!==L._spots.length||f.length!==L._dirs.length)&&Zi(L),L._59O=E,L._spots=N,L._dirs=f}var g=L.getAspect();g!==L.__cachedAspect__&&(L._updateSkybox({property:"asceptChanged"}),L.__cachedAspect__=g),L._42(),L._1o.iv()},getRenderInfo:function(){var C=this.getGL();return C?C._renderInfo:void 0},getDebugTip:function(){var Q=this,g=Q.getRenderInfo();if(g){var c=Q.getGL()._validBufCount||0,K="Draw Calls: "+g.calls+"<br/>"+"Vertices: "+g.vertices+"<br/>"+"Faces: "+g.faces+"<br/>"+"Lines: "+g.lines+"<br/>"+(g.points?"Points: "+g.points+"<br/>":"")+"Buffers: "+c+"<br/>"+"Cache Models: "+O.keys(mi).length+"<br/>"+"Shape3d Models: "+O.keys(Gp).length;if(Q.isVRPresenting()&&(K+="<br/>VR fps: "+Q.vr.getFps()),g.textureCache){var z=g.textureCache.count;if(K+="<br/>2D Dynamic Textures: "+g.textureCache.count,z>0){var I,N=g.textureCache.pixels;I=N>1e6?Math.round(N/1e6)+"M":N>1e3?Math.round(N/1e3)+"K":Math.round(N),K+="<br/>2D Dynamic pixels: "+I}}return K}},getFrameState:function(){return this._frameState},isBoundingBoxInView:function(){var g=new h.Math.Box3,t=new h.Math.Matrix4;return function(w){var H=w;if(H instanceof h.Data&&(H=this.getData3dUI(H)),!H.mat)return!0;var P=H.getBoundingBox(!0);g.copy(P).applyMatrix4(t.fromArray(H.mat));var p=this.getFrustum();return p.intersectsBox(g)}}(),updateScene:function(){var f=this;f._81O=E,f.overlappingBox.clear();var G=f._40Q;G.init();var V=f.getGL(),n=f.dm();if(n.isHierarchicalRendering())n.eachByHierarchical(function(o){var h=f.getData3dUI(o);h&&h.update(f,V,G)});else{var H,p,s,u=n.getDatas().getArray(),O=u.length;for(H=0;O>H;H++)p=u[H],s=f.getData3dUI(p),s&&s.update(f,V,G)
}this._updateBoxClipperMatrix(),G.onUpdated()},_pushFrameRenderOptions:function(d){this._frameRenderOptionStack.push(this._currentFrameRenderOptions),this._currentFrameRenderOptions=d},_popFrameRenderOptions:function(){this._currentFrameRenderOptions=this._frameRenderOptionStack.pop()},_getFrameRenderOptions:function(G){var T=this._currentFrameRenderOptions;return T&&T[G]},getRenderLists:function(){return this._40Q},renderScene:function(D){function z(c,r){R.setGLState(c,r),R.setUniforms(c),R.renderState.attribs.disable(),v=S.directUniforms(),h=S.directAttribs(),h.disable()}function N(K){for(var e=!1;G>W;W++){var H=O[W];if(!x||!H.ignoreInPick){if(H.priority>=K)break;(!t._43Q[t._44Q=H.id]||Eo[kj.length])&&(H.render(l,t,R),z(),e=!0)}}return e}var t=this;t._pushFrameRenderOptions(D),t._getFrameRenderOptions("createShadowMap")!==!1&&t.shadowMap.render(),t.flowMap.render();var l=t.getGL();t._envmapRenderer.onBeforeRender(l),t._44Q=-1;var v,h,R=t._frameState,S=R.renderState,e=S.glState,b=t._prg;t._projectMatrix=Am(t),Bm(t,t._7O),t._viewMatrix=mf(t._7O),t.isReflecting(l)||Cq(t._projScreenMatrix=Tc(),t._projectMatrix,t._viewMatrix),R.syncEnv(this._picking?this.pickColorMap:P),S.useProgram(b),z(!1,!0),l.clear(l.DEPTH_BUFFER_BIT);var x=t._picking,O=this._41Q,W=0,G=O.length;if(N(K.cameraPriority.skybox),x){var V=e.color.clear.slice(0);Wf(l,[0,0,0,0])}else Wf(l,[0,0,0,0]),e.blend.enabled=!1,e.depth.enabled=!1,e.depth.mask=!1,t._camera&&t._camera.s("camera.renderSky")===!1||t.drawSky(l,b),t._getFrameRenderOptions("renderReflector")!==!1&&t.drawReflectors(l)&&(t._projectMatrix=Am(t),Bm(t,t._7O),t._viewMatrix=mf(t._7O),R.syncEnv(),z()),e.blend.enabled=!1,e.depth.enabled=!0,e.depth.mask=!0,v.uTransparent=!1,t._getFrameRenderOptions("renderGrid")!==!1&&t._31O._42(l,b);if(!l.textureBatch||Eo[(ONE_FRAME_TIME-6)/2]){x||(t.shadowMap.enable&&t.shadowMap.createShadow(v),t.flowMap.createFlow(v));for(var A=t._sortedRenderLayers,w=0,m=A.length;m>w;w++){var k=A[w],d=t.getRenderLayerInfo(k);if(!(!t._camera&&d.ignore||t._camera&&!t._camera.isLayerVisible(d.mask))){var L=d.priority;N(L)&&(x||(t.shadowMap.enable&&t.shadowMap.createShadow(v),t.flowMap.createFlow(v))),this.renderLayer(k)}}N(K.cameraPriority.infinity),x||t.flowMap.disableFlow(v),ib(t,v,0,K.graph3dViewHeadlightAmbientIntensity),v.uHeadlightColor=[1,1,1,0],v.uUseEnvMap=!1,v.uHeadlightDirection=[0,0,0],v.uHeadlightRange=0,e.depth.enabled=!1,v.uTransparent=!1,v.shadowReceive=!1,Jf(t,v,yi),x?t.drawFilter||t._30O._42(l,b):(t._highlightHelper._42(l,b),this._renderAxisAndEditHelper(t._getFrameRenderOptions("renderAxis")!==!1,t._getFrameRenderOptions("renderEdit")!==!1),e.blend.enabled=!1,e.depth.mask=!0),e.depth.enabled=!0,x&&Wf(l,V),jh(l,E),Zm(l,E),t._44Q=-1,t._popFrameRenderOptions(null)}},_renderAxisAndEditHelper:function(m,i){if(m||i){var H=this,Z=H.getGL(),u=H._prg,v=H._frameState,l=v.renderState,X=l.glState,g=l.directUniforms();v.renderState.attribs.disable(),X.depth.enabled=!1,g.uTransparent=!1,g.shadowReceive=!1,X.blend.enabled=!1,X.depth.mask=!0,g.uPick=H._picking;var L=!H._fogDisabled;L&&(g.uFog=!1),m&&H._32O._42(Z,u),i&&H._30O._42(Z,u),L&&(g.uFog=!0),jh(Z,E),Zm(Z,E)}},renderLayers:function(Z,C){C&&(Z=kf(Z));for(var d=0,f=Z.length;f>d;d++)this.renderLayer(Z[d])},renderSky:function(){var H=this,p=H._frameState,S=p.renderState,w=S.glState,Y=H.getGL(),n=H._prg;H._projectMatrix=Am(H),Bm(H,H._7O),H._viewMatrix=mf(H._7O),Cq(H._projScreenMatrix=Tc(),H._projectMatrix,H._viewMatrix),p.syncEnv(),S.useProgram(n),p.setGLState(!1,!0),p.setUniforms(!1),p.renderState.attribs.disable(),Y.clear(Y.DEPTH_BUFFER_BIT),Wf(Y,[0,0,0,0]),w.blend.enabled=!1,w.depth.enabled=!1,w.depth.mask=!1,H.drawSky(Y,n),w.depth.mask=!0,w.depth.enabled=!0,jh(Y,E),Zm(Y,E)},addRenderLayerListener:function(C,P,A){var r=this;r._renderLayerNotifier||(r._renderLayerNotifier=new Lm),r._renderLayerNotifier.add(C,P,A)},removeRenderLayerListener:function(F,z){this._renderLayerNotifier&&this._renderLayerNotifier.remove(F,z)},fireRenderLayerEvent:function(K,v){var L=this._renderLayerNotifier;L&&L.fire({layer:K,phase:v})},renderLayer:function(A){var T=this,H=T._picking,z=T._40Q.get(A);if(z){T.fireRenderLayerEvent(A,"prepare");var D=T.getGL(),y=T.getRenderLayerInfo(A),x=T._frameState,t=x.renderState,F=t.glState,l=t.directUniforms();!H&&T.isSortable()&&z.sort(T._sortFunc,T._projScreenMatrix);var X,h,N,a=z.opaque,u=z.transparent,s=z.batchModelMap,R=z.polylineModelMap,k=z.wireframeModelMap,D=T.getGL(),$=T._prg;H||(F.blend.enabled=!1,F.depth.enabled=!0,F.depth.mask=!0),l.uTransparent=!1,y.clearDepth!==!1&&D.clear(D.DEPTH_BUFFER_BIT);var I=this.drawFilter;if(I){for(N=a,X=0,h=N.length;h>X;X++)I(N[X].data)!==!0&&N[X].ui._42(D,$,g);if(H)for(N=u,X=0,h=N.length;h>X;X++)N[X].ui._46Q(D);Eq(T,s)}else{for(N=a,X=0,h=N.length;h>X;X++)N[X].ui._42(D,$,g);if(H)for(N=u,X=0,h=N.length;h>X;X++)N[X].ui._46Q(D);Eq(T,s),Yq(T,R),Yq(T,k)}if(H||(F.blend.enabled=!0,F.depth.mask=!1),T._45Q=l.uTransparent=!0,I){for(N=u,X=0,h=N.length;h>X;X++)I(N[X].data)!==!0&&N[X].ui._42(D,$,r);Eq(T,s,null,!0)}else{for(N=u,X=0,h=N.length;h>X;X++)N[X].ui._42(D,$,r);Eq(T,s,null,!0),Yq(T,R,null,!0),Yq(T,k,null,!0)}T._45Q=null,T.fireRenderLayerEvent(A,"post")}},_42:function(O,A){var e=this;if(!e._35O&&(!is||Eo(is))){var g=e.getWidth(),M=e.getHeight();if(g&&M){var h=e.getGL();if(h){var U,K=e._canvas;if(O?U=!0:O=e.getDevicePixelRatio(),!e._picking&&(U||g!==K.clientWidth||M!==K.clientHeight)){Gm(K,g,M,O);var n=O;g&&Math.abs(h.drawingBufferWidth-g*O)>1&&(n=Math.min(n,h.drawingBufferWidth/g)),M&&Math.abs(h.drawingBufferHeight-M*O)>1&&(n=Math.min(n,h.drawingBufferHeight/M)),n!==O&&(e.setDevicePixelRatio(O=n),Gm(K,g,M,O)),e._18Q=null}h.clear(h.COLOR_BUFFER_BIT);var q=h._renderInfo;q.calls=0,q.vertices=0,q.faces=0,q.lines=0,q.points=0,q.textureCache={time:0,count:0,pixels:0},q.frame=++e._frameId,q.cacheTimeCost=0,q.reflectDepth=0,g*=O,M*=O,this.syncRenderState();do{if(e.isVREnabled()&&e.vr.render(h,g,M,A))break;if(e.updateScene(),e._postProcessing.render(h,g,M,A))break;e.setViewport(h,0,0,g,M),e.renderScene(A)}while(!1);e._33Q=!1,e.countFrame(),e._doBufferGC(h)}}}},syncRenderState:function(){var p,O;(p=this._frameState)&&(O=p.renderState)&&O.syncLoss()},drawReflectors:function(o){o._renderInfo.reflectDepth++;var F,G,X,t=this,s=t._dataModel.getReflectors(),V=!1;for(F in s)G=s[F],t.isVisible(G)&&(X=t.getData3dUI(G),X&&X.drawReflector&&X.drawReflector(o)&&(V=!0));return o._renderInfo.reflectDepth--,V},isReflecting:function(O){return O._renderInfo.reflectDepth},getPostProcessing:function(){return this._postProcessing},enablePostProcessing:function(d,b){return this._postProcessing.enableModule(d,b)},getPostProcessingModule:function(u){return this._postProcessing.getModule(u)},getPostProcessingValue:function(a,A){var t=this._postProcessing.getModule(a);return t?t[A]:P},setPostProcessingValue:function(P,S,b){var q=this.getPostProcessingValue(P,S),t=this._postProcessing.getModule(P);t&&q!==b&&("enable"===S?this.enablePostProcessing(P,b):t[S]=b,this.firePropertyChange("postProcessing."+P+"."+S,q,b))},setDofImageFromGraphView:function(Z,r,j){return this._postProcessing.getModule("Dof").setImageFromGraphView(Z,r,j)},setViewport:function(Q,x,J,B,g){this._viewport=[x,J,B,g],Zq.for(Q).directState().viewport=this._viewport},getRenderState:function(){return Zq.for(this._26I)},getViewport:function(){return this._viewport},setBufferGCInterval:function(s){this._bufferGCInterval=s},_doBufferGC:function(s,V){var r,u,J=s._bufPool,j=0,p=0,S=s._renderInfo.frame,T=this._bufferGCInterval||10;for(r in J)j++,u=J[r],u&&(V||S-u._fid>T?(s.deleteBuffer(u._buf),u._buf=null,J[r]=null):p++);if(j/2>p&&j>128){var d={};for(r in J)J[r]&&(d[r]=J[r]);s._bufPool=d}s._validBufCount=p},_swapLineMap:function(){var a=this;pb=a._polylineModelMap,a._polylineModelMap=a._polylineModelMapSwap,a._polylineModelMapSwap=pb,pb=a._wireframeModelMap,a._wireframeModelMap=a._wireframeModelMapSwap,a._wireframeModelMapSwap=pb,pb=a._polylineIndexMap,a._polylineIndexMap=a._polylineIndexMapSwap,a._polylineIndexMapSwap=pb,pb=a._wireframeIndexMap,a._wireframeIndexMap=a._wireframeIndexMapSwap,a._wireframeIndexMapSwap=pb},_updateSkybox:function(O){if(this._skybox&&O){var m=O.property,t=!1,B=this._skybox;if("eye"===m||"forceUpdate"===m){var v=this._eye;B.p3(v[0],v[1],v[2]),t=!0}if("near"===m||"far"===m||"forceUpdate"===m||"asceptChanged"===m){var i=B.__cachedS3__;i||(i=B.__cachedS3__=B.getFinalScale3d());var Q=Math.sqrt(3),b=1/0,T=-1/0;i.forEach(function(X){X/=2,b=I(X,b),T=_(X,T)}),T*=Q;var R=this._near,x=this._far,z=Math.tan(this.getFovy()/2)*R,o=this.getAspect()*z,X=1.1*Math.sqrt(o*o+z*z+R*R),s=1;if(X>b)s=X/b;else if(T>=x){var D=x*x/(R+x);s=D/T}if(1!==s){B.__updatingSkybox__=!0;var W=i.map(function(N){return s*N});B.s3(W),B.setScale3d(1,1,1),t=!0,delete B.__updatingSkybox__}}t&&this.invalidateData(B)}},getSkyBox:function(){return this.getSkybox()},setSkyBox:function(W){return this.setSkybox(W)},getSkybox:function(){return this._skybox},setSkybox:function(r){var O=this._skybox;if(O===r)return r&&this._updateSkybox({property:"forceUpdate"}),void 0;if(O&&(this._skyboxStyleMap&&O.setStyleMap(this._skyboxStyleMap),this._skyboxStyleMap=null,this._skyboxAnchor3d&&O.setAnchor3d(this._skyboxAnchor3d),this._skyboxAnchor3d=null,this._skyboxP3&&O.p3(this._skyboxP3),this._skyboxP3=null,this.handleDataModelChange({kind:Fk,data:O})),this._skybox=r,this.ump(this._updateSkybox,this),r){r.removeFromDataModel(),this._skyboxStyleMap=h.Default.clone(r.getStyleMap()),this._skyboxAnchor3d=r.getAnchor3d(),r.setAnchor3d(.5,.5,.5),this._skyboxP3=r.p3().slice(0),r.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1});var t=r.onPropertyChanged;r.onPropertyChanged=function(g){t.call(r,g),!r.__updatingSkybox__&&["width","height","tall","scale","scaleTall"].indexOf(g.property)>=0&&(r.__cachedS3__=P)},this.mp(this._updateSkybox,this),this._updateSkybox({property:"forceUpdate"})}this.fp("skybox",O,r)},drawSky:function(g,T){var B=this,C=B._skybox;if(C){var v=Zq.for(g).directUniforms(),W=B._headlightIntensity,r=Ql(B._headlightColor),T=B._prg;1!==W&&(r=[r[0]*W,r[1]*W,r[2]*W]),v.uHeadlightColor=[r[0],r[1],r[2],1];var _=B.getData3dUI(C);if(_){var w=B.isOrtho(),N=w||this._computedProjectMatrix;if(N){var c=B._projectMatrix;w&&(B._ortho=!1),v.uPMatrix=B._projectMatrix=Am(B,!0)}var s=C.p3(),M=this.getEye();(s[0]!==M[0]||s[1]!==M[1]||s[2]!==M[2])&&(C._position.x=M[0],C._54O=M[1],C._position.y=M[2]),_.validate(),_._42(g,T,Z),N&&(w&&(B._ortho=!0),v.uPMatrix=B._projectMatrix=c)}g.clear(g.DEPTH_BUFFER_BIT),v.uHeadlightColor=[r[0],r[1],r[2],B._headlightDisabled?1:0]}},getLogicalPoint:function(t){return Fg(t,this._canvas)},isRectOverlapping:function(W){var p=this.getData3dUI(W);return p._rectOverlapping},getHitFaceInfo:function(s){s.target&&(s=this.lp(s));var $=this.getDataInfoAt(s);if($){var B=this.intersectObject(s,$.data);if(B)return{data:$.data,face:B.part}}return E},unproject:function(b,g){var v=this,t=v.getWidth(),T=v.getHeight(),K=b.target?v.lp(b):b,k=K.x-t/2,N=K.y-T/2,c=2*(k/t),J=2*(-1*N/T);g=g||0;var l=Tc(),z=Am(v),R=Bm(v);Cq(l,z,R),Bf(l);var V=El([c,J,g,1],l);return[V[0]/V[3],V[1]/V[3],V[2]/V[3]]},getDataAt:function(x){var m=this.getDataInfoAt(x);return m?m.data:E},getDataInfoAt:function(x,c,s){return x.target&&(x=this.lp(x)),this._1o.get(lr(x.x,x.y,c),!0,s)},getDatasInRect:function(Z,p){return this._1o.get(Z,!1,p)},setEditable:function(P){var g=this,Q=g._editable;g._editable=P,this.fp(xp,Q,P)},isEditable:function(d){var o=this;return d?o._editable?bk(d)?d.s("3d.editable")?o._editableFunc?o._editableFunc(d):!0:!1:!1:!1:o._editable},isSelectable:function(X){return X.s("3d.selectable")&&this.sm().isSelectable(X)},isMovable:function(w){var C=this;return bf(w)&&w.getStyle(Ig)!==Qr?!1:w.s("3d.movable")?C._movableFunc?C._movableFunc(w):!0:!1},isSizeEditable:function(M){return bk(M)?this._sizeEditableFunc?this._sizeEditableFunc(M):!0:!1},isRotationEditable:function(f){return bk(f)&&f.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(f):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(b){this.setZoom(Ik,b)},zoomOut:function(z){this.setZoom(1/Ik,z)},setZoom:function(){var c=new Ab,B=new Ab,Y=new Ab,N=new Ab;return function(b,k){if(1!==b){var W=this;W._14o&&W._14o.stop(!0);var d,J=1/b;c.copy(W.getCenter()),B.copy(W.getEye());var e=W._ortho;if(e){if(d=W._orthoWidth,d<W._moveStep&&b>1)return}else if(c.distanceTo(B)<W._moveStep&&1>J)return;var H=!1;return W._zoomToCenter===!1&&W._lastZoomLP&&(Y.copy(B).sub(c).normalize(),W._81O=null,N.copy(W.getHitPosition(W._lastZoomLP,c.toArray(),Y.toArray())),H=!0,W._lastZoomHit=N),(k=md(k))?(k.action=function(o){W.fi({kind:W._zooming?"betweenZoom":"beginZoom"}),W._zooming=1;var O=(J-1)*o+1;e&&W.setOrthoWidth(d*O),H?(W.setEye(Y.lerpVectors(N,B,O).toArray()),W.setCenter(Y.lerpVectors(N,c,O).toArray())):e||W.setEye(Y.lerpVectors(c,B,O).toArray())},k._37o=function(){delete W._14o,delete W._zooming,W.fi({kind:"endZoom"}),W.onZoomEnded()},W._14o=he(k)):(e&&W.setOrthoWidth(d*J),H?(W.setEye(Y.lerpVectors(N,B,J).toArray()),W.setCenter(Y.lerpVectors(N,c,J).toArray())):e||W.setEye(Y.lerpVectors(c,B,J).toArray()),void 0)}}}(),setOrthoZoom:function(Y,m){return this.setZoom(Y,m)},getPositionInfo:function(D){var w=this,U=w._eye,c=w._center,H=w.getAspect(),q=D?tc(tf(c,U,!0),tf(D,U)):nk(U,c);if(w._ortho){var I=w._orthoWidth;return{length:q,height:I/H,width:I}}var G=2*bj(w._fovy/2)*q;return{length:q,height:G,width:G*H}},getCenterInfo:function(){var O=this;return O._81O||(O._81O=O.getPositionInfo()),fo(O._81O)},rotate:function(t,Z,V,e){var g=this;if(t||Z){e==E&&(e=g._firstPersonMode),g._88O&&g._88O.stop(!0);var J=g._center,F=g._eye,k=g.getCenterInfo().length,X=e?J:F,Q=e?F:J,L=tf(X,Q),U=Hr(L[0],L[2]),b=Hr(A(L[0]*L[0]+L[2]*L[2]),L[1]),m=e?Xj:ui;return e&&(Z=-Z),(V=md(V))?(V.action=function(Y){g.fi({kind:g._rotating?"betweenRotate":"beginRotate"}),g._rotating=1;var d=U+t*Y,o=b+Z*Y;o=e?D-ei(g,D-o):ei(g,o),L[0]=k*l(o)*l(d),L[1]=k*W(o),L[2]=k*l(o)*W(d),X[0]=Q[0]+L[0],X[1]=Q[1]+L[1],X[2]=Q[2]+L[2],g.fp(m,E,X)},V._37o=function(){delete g._88O,delete g._rotating,g.fi({kind:"endRotate"}),g.onRotateEnded()},g._88O=he(V)):(U+=t,b+=Z,b=e?D-ei(g,D-b):ei(g,b),L[0]=k*l(b)*l(U),L[1]=k*W(b),L[2]=k*l(b)*W(U),X[0]=Q[0]+L[0],X[1]=Q[1]+L[1],X[2]=Q[2]+L[2],g.fp(m,E,X),void 0)}},pan:function(w,k,i,b){if(w||k){var G=this;b==E&&(b=G._firstPersonMode),G._89O&&G._89O.stop(!0);var Z=Bm(G),j=[Z[0]*w,Z[4]*w,Z[8]*w],V=[Z[1]*k,Z[5]*k,Z[9]*k],Q=j[0]+V[0],I=j[1]+V[1],o=j[2]+V[2],C=G._center,z=G._eye;if(b){var H=oe(G.getBoundaries(),z[0],z[2],z[0]+Q,z[2]+o,A(Q*Q+o*o));Q=H[0],o=H[1]}if(i=md(i)){var n=fo(z),t=fo(C);return i.action=function(u){G.fi({kind:G._panning?"betweenPan":"beginPan"}),G._panning=1,C[0]=t[0]+Q*u,C[1]=t[1]+I*u,C[2]=t[2]+o*u,z[0]=n[0]+Q*u,z[1]=n[1]+I*u,z[2]=n[2]+o*u,G.fp(ui,E,z),G.fp(Xj,E,C)},i._37o=function(){delete G._89O,delete G._panning,G.fi({kind:"endPan"}),G.onPanEnded()},G._89O=he(i)}C[0]+=Q,C[1]+=I,C[2]+=o,z[0]+=Q,z[1]+=I,z[2]+=o,G.fp(ui,E,z),G.fp(Xj,E,C)}},walk:function(R,I,O){if(R){var A=this;O==E&&(O=A._firstPersonMode),A._90O&&A._90O.stop(!0);var o=A._center,f=A._eye,t=tf(o,f,!0);if(O){var h=oe(A.getBoundaries(),f[0],f[2],f[0]+t[0]*R,f[2]+t[2]*R,B(R));if(R=nk(h),!R)return;t=[h[0]/R,0,h[1]/R]}if(I=md(I)){var c=fo(f),L=fo(o);return I.action=function(B){A.fi({kind:A._walking?"betweenWalk":"beginWalk"}),A._walking=1;var Q=R*B;f[0]=c[0]+t[0]*Q,f[1]=c[1]+t[1]*Q,f[2]=c[2]+t[2]*Q,o[0]=L[0]+t[0]*Q,o[1]=L[1]+t[1]*Q,o[2]=L[2]+t[2]*Q,A.fp(ui,E,f),A.fp(Xj,E,o)},I._37o=function(){delete A._90O,delete A._walking,A.fi({kind:"endWalk"}),A.onWalkEnded()},A._90O=he(I)}f[0]+=t[0]*R,f[1]+=t[1]*R,f[2]+=t[2]*R,o[0]+=t[0]*R,o[1]+=t[1]*R,o[2]+=t[2]*R,A.fp(ui,E,f),A.fp(Xj,E,o)}},handleScroll:function(x,H){up(x);var F=this,_=F._moveStep,M=F.getDataInfoAt(x);if(M){var X=M.data;if(X&&F.isInteractive(X)){var c=F.intersectObject(x,X);if(c){var p=c.part,o=fl(X.s(p+".image")||X.s("shape3d."+p+".image")||X.s("all.image")||X.s("shape3d.image"));if(o&&as(o.scrollable,X,F))return}}}return F.isFirstPersonMode()?(F.isPannable()&&F.pan(0,H>0?_:-_),void 0):(F.isZoomable()&&(F._lastZoomLP=F.lp(x),F.setZoom(0>H?1/Ng:Ng),F._lastZoomLP=F._lastZoomHit=null),void 0)},handlePinch:function(b,S){if(this.isZoomable()){if(Math.abs(b-S)<K.pinchZoomThreshold)return;this.setZoom(S>b?1/$k:$k)}},reset:function(G){this.setUp(K.graph3dViewUp),this.moveCamera(K.graph3dViewEye,K.graph3dViewCenter,G)},moveSelection:function(N,K,f){var x=this;x.dm().beginTransaction(),kl(this.sm().toSelection(this.isMovable,this),N,K,f),x.dm().endTransaction()},getMoveMode:function(x,k){var N=k.s("3d.move.mode");if(N)return N;var e="88",b="89",u="90";return um(x)||zr[e]&&zr[b]&&zr[u]?"xyz":zr[e]&&zr[b]?"xy":zr[e]&&zr[u]?"xz":zr[b]&&zr[u]?"yz":zr[e]?"x":zr[b]?"y":zr[u]?"z":"xz"},handleTick:function(){var k=this,N=!1,Y=k._moveStep,P=Y,z=!1,D=!0,u=k._rotateStep*(D?-1:1);if(k.isWalkable()||(P=0),k.isPannable()||(Y=0),k.isRotatable()||(u=0),k._32Q){var J=(Ll()-k._32Q)/50;P*=J,Y*=J,u*=J}k._31Q&&(Jc(k._31Q),delete k._31Q,delete k._32Q),le()&&(N=!0,k.pan(-Y,0,z,D)),af()&&(N=!0,k.pan(Y,0,z,D)),Fl()&&(N=!0,um()?k.pan(0,Y,z,D):k.walk(P,z,D)),bh()&&(N=!0,um()?k.pan(0,-Y,z,D):k.walk(-P,z,D)),oj()&&(N=!0,k.rotate(-u,0,z,D)),Lf()&&(N=!0,k.rotate(u,0,z,D)),mp()&&(N=!0,k.rotate(0,-u/2,z,D)),Wq()&&(N=!0,k.rotate(0,u/2,z,D)),N&&(k._32Q=Ll(),k._31Q=dd(k.handleTick,k))},handleKeyDown:function(z){var J=this;!Bj(z)&&rm[z.keyCode]?J.handleTick():Bd(z)?J.selectAll():ho(z)?J.handleDelete(z):Vo(z)&&this.isResettable()&&J.reset()},checkDoubleClickOnNote:function(k,J,q){var Q=this;if(q===qh){if(J.s("note.toggleable"))return J.s(uq,!J.s(uq)),Q.fi({kind:"toggleNote",event:k,data:J,part:q}),!0}else if(q===qk&&J.s("note2.toggleable"))return J.s(No,!J.s(No)),Q.fi({kind:"toggleNote2",event:k,data:J,part:q}),!0;return!1},checkDoubleClickOnRotation:function(f,U,V){return V===ct?(U.setRotationX(0),!0):V===dt?(U.setRotationY(0),!0):V===et?(U.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(O){var c=this;if(c.isOrtho())return c.getWidth()/c.getOrthoWidth();var S=c.getCenter(),b=c.getHeight(),u=c.getEye(),n=[S[0]-u[0],S[1]-u[1],S[2]-u[2]],A=[O[0]-u[0],O[1]-u[1],O[2]-u[2]],C=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),K=1/Math.tan(c.getFovy()/2);return b*C*K/(A[0]*n[0]+A[1]*n[1]+A[2]*n[2])},inViewSpace:function(_){var a,A=this,Q=A._transformPointToViewSpace(_),p=A.getAspect(),m=A.getNear(),v=A.getFar();return-Q[2]<m||-Q[2]>v?!1:A.isOrtho()?(a=A.getOrthoWidth()/2,Math.abs(Q[0])<=a&&Math.abs(Q[1]*p)<=a):(a=Math.sqrt(Q[0]*Q[0]+Q[1]*Q[1]+Q[2]*Q[2])*Math.tan(A.getFovy()/2),Math.abs(Q[1]<=a)&&Math.abs(Q[0])<=a*p)},getPVMatrix:function(){var E,Q=this;return(E=Q._18Q)||(E=Am(Q),Q._18Q=Cq(E,E,Bm(Q)),Q._18Q._wh=Q.getWidth()/2/Q.getHeight()),E},getFrustum:function(){var N=new jo,O=new Nj,i=new Array(16);return function(){for(var V=this.getPVMatrix(),M=!1,d=0;16>d;d++)V[d]!==i[d]&&(M=!0,i[d]=V[d]);return M&&O.setFromMatrix(N.fromArray(V)),O}}(),toViewPosition:function(Q){var W=this,c=W.getWidth()/2,G=W.getHeight()/2,Z=W.getPVMatrix();return Q=El([Q[0],Q[1],Q[2],1],Z),{x:c+c*Q[0]/Q[3],y:G-G*Q[1]/Q[3],z:Q[2]/Q[3]}},getHitPosition:function(D,T,H){var e=this,O=e.getWidth(),h=e.getHeight(),A=D.target?e.lp(D):D,E=A.x-O/2,$=A.y-h/2,d=e.getCenterInfo(),c=Bm(e);T=T?T:[0,0,0],H=H?H:[0,1,0],E=E/O*d.width,$=-1*$/h*d.height;var q=[c[0]*E,c[4]*E,c[8]*E],z=[c[1]*$,c[5]*$,c[9]*$],M=[q[0]+z[0],q[1]+z[1],q[2]+z[2]],w=e.getCenter(),S=Af(e,T,H,[M[0]+w[0],M[1]+w[1],M[2]+w[2]]);return S?S:[0,0,0]},intersectObject:function(w,D){return this._raycaster.intersectObject(w,D)},intersectObjects:function(s,B,W){return this._raycaster.intersectObjects(s,B,W)},getLineLength:function(V){this.validate();var x=this.getData3dUI(V);if(x&&x.getCache){var u=x.getCache();if(u)return u[u.length-1].length}return 0},getLineOffset:function(P,f){var r=this.getData3dUI(P);if(r&&r.getCache){var g=r.getCache();if(g){var U=Wb(g,f);if(P.s("shape3d")!==Rg)return U;var m,e;if(P.getScale3d&&(m=P.getScale3d(),1===m[0]&&1===m[1]&&1===m[2]&&(m=null)),P.r3&&(e=P.r3(),0===e[0]&&0===e[1]&&0===e[2]&&(e=null)),!e&&!m)return U;var d=new Ab(P.p3()),W=new Ab(U.point).sub(d),Z=new Ab(U.tangent).add(W);if(m&&(m=new Ab(m),W.multiply(m),Z.multiply(m)),e){var k=(new _d).setFromEuler(new bn(e,P.getRotationMode(),!0));W.applyQuaternion(k),Z.applyQuaternion(k)}return{point:W.clone().add(d),tangent:Z.sub(W).normalize()}}}return E},_genBatchInstancedArrayFunc:function(){var P=this._glCapabilities&&this._glCapabilities.instancedArray&&!this._batchInstancedDisabled,U=P?Pf:Oi;this.batchInstancedModel=function(i,E,f,p,D,h,m){U(this,i,E,f,p,D,h,m)};var I=P?Zg:Zf;this.batchInstancedShapeFace=function(N,_,R){I(N,_,R)};var w=P?ch:ur;this.batchInstancedFace=function(S,F,Y,f,B){w(this,S,F,Y,f,B)}},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(y,K,F){var L=this,l=L.getEye();l=[l[0],l[1],l[2]];var v=L.getCenter();if(v=[v[0],v[1],v[2]],y||(y=l),K||(K=v),L._flyAnim&&L._flyAnim.stop(!0),F=md(F),!F)return L.setEye(y[0],y[1],y[2]),L.setCenter(K[0],K[1],K[2]),delete L._flyAnim,!0;var G=[y[0]-l[0],y[1]-l[1],y[2]-l[2]],C=[K[0]-v[0],K[1]-v[1],K[2]-v[2]];return F.action=function(D){L.setCenter(v[0]+C[0]*D,v[1]+C[1]*D,v[2]+C[2]*D),L.setEye(l[0]+G[0]*D,l[1]+G[1]*D,l[2]+G[2]*D)},F._37o=function(){delete L._flyAnim},L._flyAnim=he(F)},flyTo:function(){function J($,L,m){if(m instanceof h.Node){N.fromArray($f(m,L.getMat(m)));var K=m.getAnchor3d();$.push((new Ab).set(0-K.x,0-K.y,0-K.z).applyMatrix4(N)),$.push((new Ab).set(0-K.x,0-K.y,1-K.z).applyMatrix4(N)),$.push((new Ab).set(0-K.x,1-K.y,0-K.z).applyMatrix4(N)),$.push((new Ab).set(0-K.x,1-K.y,1-K.z).applyMatrix4(N)),$.push((new Ab).set(1-K.x,0-K.y,0-K.z).applyMatrix4(N)),$.push((new Ab).set(1-K.x,0-K.y,1-K.z).applyMatrix4(N)),$.push((new Ab).set(1-K.x,1-K.y,0-K.z).applyMatrix4(N)),$.push((new Ab).set(1-K.x,1-K.y,1-K.z).applyMatrix4(N))}}var U=new Ab,r=new Ab,E=new Ab,t=new Ab,Q=new Ab,N=new jo,x=new h.Math.Quaternion,z=new bn,j=new zg;return function(Y,H,f){var C=this;"boolean"==typeof H&&(H={animation:H}),H=H||{};var B=H.center,p=H.distance,L=H.direction,O=H.worldDirection,A=f||H.ratio||.8,I=H.xRatio||A,R=H.yRatio||A;(f!==P||H.duration||H.frames)&&(H={animation:H});var k,v,s=[],X=p===P;if(B&&E.fromArray(B),!B||X)if(Y||(Y=C.dm().getDatas()),1===Y.length&&(Y=xg(Y)?Y.get(0):Y[0]),Y instanceof h.Node)B||E.fromArray(Y.p3()),X&&(J(s,C,Y),k=s.length);else{if(!Y.length)return;if((X||!B)&&(s=[],Y.forEach(function(j){J(s,C,j)}),k=s.length,!k))return;B||(j.setFromPoints(s),E.copy(j.min).add(j.max).multiplyScalar(.5))}if(C._flyAnim&&C._flyAnim.stop(!0),U.fromArray(C.getEye()),r.fromArray(C.getCenter()),C.setCenter(E.x,E.y,E.z),t.subVectors(U,r),L||O){!O&&Y instanceof h.Node?x.setFromEuler(z.set(Y.r3(),Y.getRotationMode(),!0)):x.set(0,0,0,1);var d=t.length();t.fromArray(O||L).applyQuaternion(x).setLength(d)}var a=new Ab(C.getUp()),i=Uj.fequal(a.x,0,1e-5)&&Uj.fequal(a.z,0,1e-5);if(i&&0===t.x&&0===t.z){var e=.001,N=t.y;t.y=N*(1-e),t.z=Math.sign(N)*e}var M=0;if(X){var w,T,F,G=I,m=R;if(Q.copy(t),C.isOrtho()){var b=-1/0;for(C._eye[0]=t.x+E.x,C._eye[1]=t.y+E.y,C._eye[2]=t.z+E.z,w=Am(C),Cq(w,w,Bm(C)),v=0;k>v;v++)F=s[v],T=El([F.x,F.y,F.z,1],w),b=Math.max(b,Math.max(Math.abs(T[0])/G,Math.abs(T[1])/m));M=C.getOrthoWidth()*b}else{for(var V,S,g=C.getNear(),n=10;n--;){for(C._eye[0]=t.x+E.x,C._eye[1]=t.y+E.y,C._eye[2]=t.z+E.z,w=Am(C),Cq(w,w,Bm(C)),V=!0,S=-1/0,v=0;k>v;v++){if(F=s[v],T=El([F.x,F.y,F.z,1],w),T[3]<g&&n){t.multiplyScalar(2),V=!1;break}S=Math.max(S,Math.max(Math.abs(T[0])/G,Math.abs(T[1])/m)-T[3])}if(V)break}t.setLength(S+t.length())}t.manhattanLength()<1e-6&&t.copy(Q)}else t.setLength(p);var D=t.add(E),u=md(H.animation);if(u){C.setEye(U.x,U.y,U.z),C.setCenter(r.x,r.y,r.z);var l=D.clone().sub(E),Z=l.length();Z&&l.multiplyScalar(1/Z);var W=U.clone().sub(r),q=W.length();q&&W.multiplyScalar(1/q);var y=(new jo).lookAtDirection(W,a),$=(new jo).lookAtDirection(l,a),_=(new _d).setFromRotationMatrix(y),c=(new _d).setFromRotationMatrix($),o=(new Ab).subVectors(E,r);if(M)var Vo=C.getOrthoWidth();var gk=new Ab,oi=new Ab,Ad=new Ab,Cc=u.action,Om=u._37o,pp=r.clone();return u.action=function(L,d){oi.copy(pp).addScaledVector(o,L);var A=_.clone().slerp(c,L);gk.set(0,0,1).applyQuaternion(A).setLength(q+(Z-q)*L).add(oi),Ad.set(0,1,0).applyQuaternion(A),C.setCenter(oi.x,oi.y,oi.z),C.setEye(gk.x,gk.y,gk.z),C.setUp(Ad.x,Ad.y,Ad.z),M&&C.setOrthoWidth((M-Vo)*L+Vo),Cc&&Cc(L,d)},u._37o=function(){delete C._flyAnim;var Q=C.getUp(),w=i?K.graph3dViewUp:a.toArray();(Q[0]!==w[0]||Q[1]!==w[1]||Q[2]!==w[2])&&C.setUp(w),Om&&Om()},{lastEye:U,lastCenter:r,eye:D,center:E,orthoWidth:M,animation:C._flyAnim=he(u)}}return C.setEye(D.x,D.y,D.z),C.setCenter(E.x,E.y,E.z),M&&C.setOrthoWidth(M),delete C._flyAnim,{lastEye:U,lastCenter:r,eye:D,center:E,orthoWidth:M}}}(),getBoundingBox:function(){function w(l,Y,L){c.fromArray($f(L,Y.getMat(L)));var R=L.getAnchor3d();l.push((new Ab).set(0-R.x,0-R.y,0-R.z).applyMatrix4(c)),l.push((new Ab).set(0-R.x,0-R.y,1-R.z).applyMatrix4(c)),l.push((new Ab).set(0-R.x,1-R.y,0-R.z).applyMatrix4(c)),l.push((new Ab).set(0-R.x,1-R.y,1-R.z).applyMatrix4(c)),l.push((new Ab).set(1-R.x,0-R.y,0-R.z).applyMatrix4(c)),l.push((new Ab).set(1-R.x,0-R.y,1-R.z).applyMatrix4(c)),l.push((new Ab).set(1-R.x,1-R.y,0-R.z).applyMatrix4(c)),l.push((new Ab).set(1-R.x,1-R.y,1-R.z).applyMatrix4(c))}var c=new jo;return function(n){if(n=n||this.sm().getSelection(),n instanceof h.Node&&(n=[n]),0===n.length)return E;var Y=[];n.forEach(function(h){bk(h)&&w(Y,this,h)},this);var D=[1/0,1/0,1/0],I=[-1/0,-1/0,-1/0];return Y.forEach(function(h){D[0]=Math.min(h.x,D[0]),D[1]=Math.min(h.y,D[1]),D[2]=Math.min(h.z,D[2]),I[0]=Math.max(h.x,I[0]),I[1]=Math.max(h.y,I[1]),I[2]=Math.max(h.z,I[2])}),{min:D,max:I}}}(),setBatchInfo:function(q,x){var F=this._batchInfoMap[q];this._batchInfoMap[q]=x,this.fp("batchInfo",F,x)},getBatchInfo:function(z){return this._batchInfoMap[z]||Wp[z]},setOrthoWidth:function(J){var a=this._orthoWidth;if(this._orthoWidth=J,this._syncEyeWithOrthoWidth){var B=J/this.getAspect(),S=B/2/bj(this.getFovy()/2),l=(new Ab).fromArray(this.getEye()),j=(new Ab).fromArray(this.getCenter());l.sub(j).setLength(S).add(j),this.setEye(l.toArray())}this.fp("orthoWidth",a,J)},getCamera:function(A){var d=this;A||(A=d._mainCamera,A||(A=d._mainCamera=new h.Camera)),A.s({"camera.type":d.isOrtho()?"ortho":"perspective","camera.aspect":d.getAspect(),"camera.fovy":d.getFovy(),"camera.ortho.width":d.getOrthoWidth(),"camera.near":d.getNear(),"camera.far":d.getFar()});var H=d.getEye();return A.p3(H.slice()),A.lookAt(d.getCenter(),d.getUp()),A},syncFromCamera:function(d){var r=this,c=new Ab(r.getEye()),$=new Ab(r.getCenter()),g=new Ab,J=$.sub(c).length();r.setEye(d.p3());var H=d.getEuler();return g.set(0,0,-1).applyEuler(H),c.copy(g).setLength(J).add($.copy(d.p3())),r.setCenter(c.toArray()),c.set(0,1,0).applyEuler(H),$.set(0,1,0),Math.abs(g.cross(c).dot($))<1e-5?r.setUp($.toArray()):r.setUp(c.toArray()),r.setOrtho("ortho"===d.s("camera.type")),r.setAspect(d.s("camera.aspect")),r.setFovy(d.s("camera.fovy")),r.setOrthoWidth(d.s("camera.ortho.width")),r.setNear(d.s("camera.near")),r.setFar(d.s("camera.far")),!0},resetHeadlightProperties:function(){this._headlightColor=K.graph3dViewHeadlightColor,this._headlightIntensity=K.graph3dViewHeadlightIntensity,this._headlightRange=K.graph3dViewHeadlightRange,this._headlightDirection=K.graph3dViewHeadlightDirection,this._headlightGroup=K.graph3dViewHeadlightGroup,this._headlightAmbientIntensity=K.graph3dViewHeadlightAmbientIntensity,this._headlightDisabled=K.graph3dViewHeadlightDisabled},resetFogProperties:function(){this._fogDisabled=K.graph3dViewFogDisabled,this._fogMode=K.graph3dViewFogMode,this._fogDensity=K.graph3dViewFogDensity,this._fogColor=K.graph3dViewFogColor,this._fogNear=K.graph3dViewFogNear,this._fogFar=K.graph3dViewFogFar},_sortRenderLayers:function(){var t=this,L=t._sortedRenderLayers=O.keys(t._renderLayerInfoMap);for(var G in $d)L.indexOf(G)>=0||L.push(G);L.sort(function(b,s){return b=t.getRenderLayerInfo(b),s=t.getRenderLayerInfo(s),b.priority-s.priority})},_appendRenderLayer:function(A,T){A=A||0;var t,V=this.getRenderLayerInfo(T);if(V)t=V.mask,!this._renderLayerInfoMap[T]&&$d[T]&&(this._renderLayerInfoMap[T]=V);else{var y=this._sortedRenderLayers.length;if(!(32>y))throw new Error("Only 31 render layer can be defined.");t=1<<y,V=this.getRenderLayerInfo(Ud),this._renderLayerInfoMap[T]={mask:t,priority:V.priority}}return A|=t},setRenderLayerInfo:function(p,J){this._appendRenderLayer(0,p);var d=this.getRenderLayerInfo(p),$=fo(d);for(var T in J)"mask"!==T&&(d[T]=J[T]);this._sortRenderLayers(),this.fp("renderLayerInfo",$,d)},getRenderLayerInfo:function(y){return this._renderLayerInfoMap[y]||fo($d[y])},setRenderLayerInfoMap:function(M){var q=this._renderLayerInfoMap;this._renderLayerInfoMap={};for(var F in M)this.setRenderLayerInfo(F,M[F]);this.fp("renderLayerInfoMap",q,this._renderLayerInfoMap)},getRenderLayerKeys:function(){return this._sortedRenderLayers}}),function(){function s(i,s,M){var f=i[s];f&&f.releaseTexture(),i[s]=M}function $(){return["\n #ifdef ENVMAP_TYPE_CUBE_UV \n","#define cubeUV_maxMipLevel 8.0 \n","#define cubeUV_minMipLevel 4.0 \n","#define cubeUV_maxTileSize 256.0 \n","#define cubeUV_minTileSize 16.0 \n","float getFace(vec3 direction) {","vec3 absDirection = abs(direction);","float face = - 1.0;","if (absDirection.x > absDirection.z) {","if (absDirection.x > absDirection.y)","face = direction.x > 0.0 ? 0.0 : 3.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","} else {","if (absDirection.z > absDirection.y) ","face = direction.z > 0.0 ? 2.0 : 5.0;"," else ","face = direction.y > 0.0 ? 1.0 : 4.0;","}","return face;","} ","vec2 getUV(vec3 direction, float face) {","vec2 uv;","if (face == 0.0) {","uv = vec2(direction.z, direction.y) / abs(direction.x);","} else if (face == 1.0) {","uv = vec2(- direction.x, - direction.z) / abs(direction.y);","} else if (face == 2.0) {","uv = vec2(- direction.x, direction.y) / abs(direction.z);","} else if (face == 3.0) {","uv = vec2(- direction.z, direction.y) / abs(direction.x);","} else if (face == 4.0) {","uv = vec2(- direction.x, direction.z) / abs(direction.y);","} else {","uv = vec2(direction.x, direction.y) / abs(direction.z);","}","return 0.5 * (uv + 1.0);","} ","vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {","float face = getFace(direction);","float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);","mipInt = max(mipInt, cubeUV_minMipLevel);","float faceSize = exp2(mipInt);","float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);","vec2 uv = getUV(direction, face) * (faceSize - 1.0);","vec2 f = fract(uv);","uv += 0.5 - f;","if (face > 2.0) {","uv.y += faceSize;","face -= 3.0;","}","uv.x += face * faceSize;","if (mipInt < cubeUV_maxMipLevel) {","uv.y += 2.0 * cubeUV_maxTileSize;","}","uv.y += filterInt * 2.0 * cubeUV_minTileSize;","uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);","uv *= texelSize;","vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x += texelSize;","vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.y += texelSize;","vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","uv.x -= texelSize;","vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;","vec3 tm = mix(tl, tr, f.x);","vec3 bm = mix(bl, br, f.x);","return mix(tm, bm, f.y);","}","\n #define r0 1.0 \n","#define v0 0.339 \n","#define m0 - 2.0 \n","#define r1 0.8 \n","#define v1 0.276 \n","#define m1 - 1.0 \n","#define r4 0.4 \n","#define v4 0.046 \n","#define m4 2.0 \n","#define r5 0.305 \n","#define v5 0.016 \n","#define m5 3.0 \n","#define r6 0.21 \n","#define v6 0.0038 \n","#define m6 4.0 \n","float roughnessToMip(float roughness) {","float mip = 0.0;","if (roughness >= r1) {","mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;","} else if (roughness >= r4) {","mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;","} else if (roughness >= r5) {","mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;","} else if (roughness >= r6) {","mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;","} else {","mip = - 2.0 * log2(1.16 * roughness);","}","return mip;","} ","vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {","float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);","float mipF = fract(mip);","float mipInt = floor(mip);","vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);","if (mipF == 0.0) {","return vec4(color0, 1.0);","} else {","vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);","return vec4(mix(color0, color1, mipF), 1.0);","}","} ","\n #endif \n"].join("")
}function G(){return["vec4 sRGBToLinear( in vec4 value ) {","return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );","}","vec4 LinearTosRGB( in vec4 value ) {","return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );","}","vec4 inputTexelToLinear( vec4 value ) { return sRGBToLinear( value ); }","vec4 linearToOutputTexel( vec4 value ) { return LinearTosRGB( value ); }","vec4 envMapTexelToLinear( vec4 color ) { return inputTexelToLinear( color ); }"].join("")}function Q(){return["precision mediump float;\n","precision mediump int;\n","attribute vec3 position;","attribute vec2 uv;","attribute float faceIndex;","varying vec3 vOutputDirection;","vec3 getDirection( vec2 uv, float face ) {","uv = 2.0 * uv - 1.0;","vec3 direction = vec3( uv, 1.0 );","if ( face == 0.0 ) { direction = direction.zyx; } ","else if ( face == 1.0 ) { direction = direction.xzy; direction.xz *= -1.0; } ","else if ( face == 2.0 ) { direction.x *= -1.0; }","else if ( face == 3.0 ) { direction = direction.zyx; direction.xz *= -1.0; } ","else if ( face == 4.0 ) { direction = direction.xzy; direction.xy *= -1.0; } ","else if ( face == 5.0 ) { direction.z *= -1.0; }","return direction;","}","void main() {","vOutputDirection = getDirection( uv, faceIndex );","gl_Position = vec4( position, 1.0 );","}"].join("")}function c(){return{vs:Q(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform samplerCube envMap;\n",G(),"\n void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3(- vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function f(){return{vs:Q(),fs:["precision mediump float;\n","precision mediump int;\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform vec2 texelSize;\n",G(),"\n #define RECIPROCAL_PI 0.3183098861837907 \n","\n #define RECIPROCAL_PI2 0.15915494309189535 \n","vec2 equirectUv( in vec3 dir ) {","float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;","float v = 0.5 - asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI;","return vec2( u, v );","}","void main() {","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","vec3 outputDirection = normalize( vOutputDirection );","vec2 uv = equirectUv( outputDirection );","vec2 f = fract( uv / texelSize - 0.5 );","uv -= f * texelSize;","vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x += texelSize.x;","vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.y += texelSize.y;","vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","uv.x -= texelSize.x;","vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;","vec3 tm = mix( tl, tr, f.x );","vec3 bm = mix( bl, br, f.x );","gl_FragColor.rgb = mix( tm, bm, f.y );","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}function _(o){return{vs:Q(),fs:["precision mediump float;\n","precision mediump int;\n","#define n "+o+"\n","varying vec3 vOutputDirection;","uniform sampler2D envMap;","uniform int samples;","uniform float weights[ n ];","uniform bool latitudinal;","uniform float dTheta;","uniform float mipInt;","uniform vec3 poleAxis; \n",G(),"\n #define ENVMAP_TYPE_CUBE_UV \n",$(),"\n vec3 getSample( float theta, vec3 axis ) {","float cosTheta = cos( theta );","vec3 sampleDirection = vOutputDirection * cosTheta + cross(axis, vOutputDirection) * sin(theta) + axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);","return bilinearCubeUV( envMap, sampleDirection, mipInt );","}","void main() {","vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );","if ( all( equal( axis, vec3( 0.0 ) ) ) ) {","axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );","}","axis = normalize( axis );","gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );","gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );","for ( int i = 1; i < n; i++ ) {","if ( i >= samples ) { break; }","float theta = dTheta * float( i );","gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );","gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );","}","gl_FragColor = linearToOutputTexel( gl_FragColor );","}"].join("")}}var J=ag.EnvmapRenderer=function(G){this.gv=G,this._envmaps={},this._envmapHash={},this._probeCaptureTime={},this._pingPongRenderTarget=null,this._equirectShader=null,this._cubemapShader=null,this._blurMaterial=null,this._lastCaptureFrame=0};J.prototype={},J.prototype.constructor=J,J.prototype.changeEnvmapType=function(T){"legacy"===T?(this.setEnvmapByProbeId=this.setEnvmapLegacy,this.onBeforeRender=this.onBeforeRenderLegacy):(this.setEnvmapByProbeId=this.setEnvmap,this.onBeforeRender=this.onBeforeRenderNew)},J.prototype.invalidateEnvmap=function(u){var x=this.gv;if("legacy"!==x.getEnvmapType()){var o=x.getGL();o&&(u?(delete this._envmapHash[u],delete this._probeCaptureTime[u]):(this._envmapHash={},this._probeCaptureTime={}),x.iv())}},J.prototype.contextLost=function(){var m=this;m._envmaps={},m._envmapHash={},m._pingPongRenderTarget=null,m._equirectShader=m._cubemapShader=m._blurMaterial=null,m._envmapLegacy=null,m._lastLegacyImage=null},J.prototype.onBeforeRenderLegacy=function(G){this.assureTextureLegacy(G)},J.prototype.assureTextureLegacy=function(j){var N=this,_=N.gv,r=_.getEnvmap();if(r!==N._lastLegacyImage){if(N._envmapLegacy&&(j.deleteTexture(N._envmapLegacy),N._envmapLegacy=null),!r)return N._lastLegacyImage=r,void 0;var A=K.getImage(r);if(A&&A.tagName){A=K.resizeImagePOT(A,!0);var l=N._envmapLegacy=j.createTexture();j.activeTexture(j.TEXTURE0),j.bindTexture(j.TEXTURE_CUBE_MAP,l),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MAG_FILTER,j.LINEAR),j.texParameteri(j.TEXTURE_CUBE_MAP,j.TEXTURE_MIN_FILTER,j.LINEAR),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.texImage2D(j.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,j.RGBA,j.RGBA,j.UNSIGNED_BYTE,A),j.bindTexture(j.TEXTURE_CUBE_MAP,j._emptyCubeTexture),N._lastLegacyImage=r}}},J.prototype.setEnvmapLegacy=function(n){n.uEnvMap=this._envmapLegacy},J.prototype.onBeforeRenderNew=function(v){this.assureTextureNew(v),this.resetUniformCache()},J.prototype.assureTextureNew=function(p){var e=this,X=e.gv,v=X.getEnvmap(),D=e._envmapHash,y=e._envmaps,u=p._renderInfo.frame;if(!(this._lastCaptureFrame>=u||X._picking))for(var a in v){var m,W=v[a],d=W.type;switch(d){case"sphere":m=W.image,m!==D[a]&&(kg=K.getImage(m),kg&&(D[a]=m,s(y,a,e.fromEquirectangular(m))));break;case"cube":var _=W.images;if(_&&6===_.length&&(m=_.join(","),m!==D[a])){for(var t=!0,H=0;6>H;H++)if(!K.getImage(_[H])){t=!1;break}t&&(D[a]=m,s(y,a,e.fromCubemap(_)))}break;case"skybox":var C=X.getSkybox();if(C){var h=C.s("shape3d");if(m="sphere"===h?C._id+"_"+C.s("shape3d.image"):C._id+"_"+C.s("front.image"),m!==D[a]){var t;if("sphere"===h)t=K.getImage(C.s("shape3d.image"));else{t=!0;for(var T=["front","back","left","right","top","bottom"],H=0;6>H;H++)if(!K.getImage(C.s(T[H]+".image"))){t=!1;break}}t&&(D[a]=m,s(y,a,e.fromSkybox()))}}break;case"probe":var B=W.pos,E=W.size;if(m=B[0]+"_"+B[1]+"_"+B[2]+"_"+E,m!==D[a]){var V=this._probeCaptureTime[m],S=Date.now();V||(this._probeCaptureTime[m]=V=S),S-V>K.envmapProbeMinWaitTime&&!yp&&!xd||S-V>K.envmapProbeMaxWaitTime?(delete this._probeCaptureTime[m],D[a]=m,s(y,a,e.fromSceneProbe(B,E,W.filter))):X.iv()}}}},J.prototype.resetUniformCache=function(){this._frameUniformCache={}},J.prototype.setEnvmap=function(o,t){var g=o.uuid,E=this._frameUniformCache,H=this._envmaps[t];H&&(H=H.texture),E[g]!==H&&(E[g]=H,o.uEnvMap=H)},J.prototype.fromEquirectangular=function(t){var C=h.Default.getImage(t);return this.rectSize=[1/C.width,1/C.height],t=this.gv.getTexture(t),this.fromTexture(t)},J.prototype.fromCubemap=function($){var Q=this.gv.getGL(),s=Q.createTexture();Q.activeTexture(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,s),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR);for(var R=[],f=W/3,j=0;6>j;j++)R[j]=K.resizeImage(h.Default.getImage($[j]),f);return Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[0]),Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[1]),Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[2]),Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[3]),Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[4]),Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,Q.RGBA,Q.RGBA,Q.UNSIGNED_BYTE,R[5]),Q.bindTexture(Q.TEXTURE_CUBE_MAP,Q._emptyCubeTexture),this.fromTexture(s,!0)},J.prototype.fromTexture=function(B,R){var E=this._allocateTargets();this._pingPongRenderTarget||(this._pingPongRenderTarget=this._allocateTargets());var W=this.gv,h=W.getGL(),C=Zq.for(h).directState(),V=C.depth.enabled;C.scissor.enabled=!0,C.depth.enabled=!1;var u=W.getViewport(h);return this._textureToCubeUV(B,E,R),this._applyPMREM(E),E.unbind(h),W.setViewport(h,u[0],u[1],u[2],u[3]),C.depth.enabled=V,C.scissor.enabled=!1,E},J.prototype.fromSkybox=function(){return this._fromCamera(function(l){l.s({"camera.onlySky":!0})})},J.prototype.fromScene=function(I){return this._fromCamera(function(R){R.s({"camera.onlySky":!1}),I&&I(R)})},J.prototype.fromNode=function(w){var W=this.gv.getData3dUI(w),e=W._42;W._42=Aj;var D=this.gv.getSkybox(),u=w.p3();if(D){var y=D.p3();D.p3(u)}var O=this.fromScene(function(_){_.p3(u)});return W._42=e,D&&D.p3(y),O},J.prototype.fromSceneProbe=function(u,Y,o){var V=this.gv,x=V.getSkybox();if(x){var t=x.p3();x.p3(u)}if(o){var E=V.isVisible;V.isVisible=function(k){var l=o(k);return l!==P?l:E.call(V,k)}}var w=this.fromScene(function(w){w.p3(u),w.s("camera.near",Y)});return o&&(V.isVisible=E),x&&x.p3(t),w},J.prototype._fromCamera=function(P){var $=this.gv,u=$.getCamera();P&&P(u);var d=new Os($,W,W,{cube:!0}),R=$.getGL(),E=$.getViewport(R),O=this.setEnvmapByProbeId,K=this.onBeforeRender;this.setEnvmapByProbeId=function($){$.envMap=R._emptyTexture},this.onBeforeRender=Aj,u.attachRenderTarget(d),u.render($),u.detachRenderTarget(),this.setEnvmapByProbeId=O,this.onBeforeRender=K,$.setViewport(R,E[0],E[1],E[2],E[3]);var n=this.fromTexture(d.texture,!0);return d.releaseTexture(),n},J.prototype._allocateTargets=function(){return new Os(this.gv,3*y,3*y,{magFilter:Um.NEAREST,minFilter:Um.NEAREST})},J.prototype._textureToCubeUV=function(S,X,O){var A,q=this.gv;O?null==(A=this._cubemapShader)&&(this._cubemapShader=A=this.createShader(c())):null==(A=this._equirectShader)&&(this._equirectShader=A=this.createShader(f()));var R=q.getGL();X.bind(R),this._setViewport(X,0,0,3*y,2*y);var e=q.getRenderState();e.useProgram(A);var t=e.directUniforms(),o=e.directAttribs();t.envMap=S,O||(t.texelSize=this.rectSize);var U=m[0];o.position=Mk(R,null,U.vs,E,3),o.uv=Mk(R,null,U.uv,E,2),o.faceIndex=Mk(R,null,U.faceIs,E,1),Mp(R,0,U.vs.length/3)},J.prototype._applyPMREM=function(I){for(var X,p,o,X=1;v>X;X++)p=Math.sqrt(T[X]*T[X]-T[X-1]*T[X-1]),o=r[(X-1)%r.length],this._blur(I,X-1,X,p,o)},J.prototype._setViewport=function(o,i,H,W,d){var M=this.gv;M.setViewport(M.getGL(),i,H,W,d),M.getRenderState().directState().scissor.box=[i,H,W,d]},J.prototype._blur=function(L,K,B,z,a){var v=this._pingPongRenderTarget;this._halfBlur(L,v,K,B,z,"latitudinal",a),this._halfBlur(v,L,B,B,z,"longitudinal",a)},J.prototype.createShader=function(z){var V=this.gv;return V.getPostProcessing().createShader(V.getGL(),z).program},J.prototype._halfBlur=function(n,f,N,A,Y,b,p){var B=this.gv,U=this._blurMaterial;if("latitudinal"===b||"longitudinal"===b){U||(this._blurMaterial=U=this.createShader(_(S)));var w=B.getGL();f.bind(w);var k=3,I=B.getRenderState();I.useProgram(U);var u,h,W,c=I.directUniforms(),T=I.directAttribs(),Z=l[N]-1,j=isFinite(Y)?Math.PI/(2*Z):2*Math.PI/(2*S-1),i=Y/j,G=isFinite(Y)?1+Math.floor(k*i):S,O=[],P=0;for(u=0;S>u;++u)h=u/i,W=Math.exp(-h*h/2),O.push(W),0==u?P+=W:G>u&&(P+=2*W);for(u=0;u<O.length;u++)O[u]=O[u]/P;c.envMap=n.texture,c.samples=G,c.weights=O,c.latitudinal="latitudinal"===b,p&&(c.poleAxis=p),c.dTheta=j,c.mipInt=z-N;var C=l[A],h=3*Math.max(0,y-2*C),V=(0===A?0:2*y)+2*C*(A>z-t?A-z+t:0);this._setViewport(f,h,V,3*C,2*C);var F=m[A];T.position=Mk(w,null,F.vs,E,3),T.uv=Mk(w,null,F.uv,E,2),T.faceIndex=Mk(w,null,F.faceIs,E,1),Mp(w,0,F.vs.length/3),f.unbind(w)}};var t=4,z=8,y=Math.pow(2,z),R=[.125,.215,.35,.446,.526,.582],v=z-t+1+R.length,S=20,d=(1+Math.sqrt(5))/2,H=1/d,r=[new Ab(1,1,1),new Ab(-1,1,1),new Ab(1,1,-1),new Ab(-1,1,-1),new Ab(0,d,H),new Ab(0,d,-H),new Ab(H,0,d),new Ab(-H,0,d),new Ab(d,H,0),new Ab(-d,H,0)],B=function(){for(var K=[],Y=[],h=[],$=z,n=0;v>n;n++){var k=Math.pow(2,$);Y.push(k);var l=1/k;n>z-t?l=R[n-z+t-1]:0==n&&(l=0),h.push(l);for(var J=1/(k-1),B=-J/2,F=1+J/2,x=6,p=[],a=[],Z=[],D=0;x>D;D++){var q=2*(D%3)/3-1,i=D>2?0:-1;p.push(q,i,0,q+2/3,i,0,q+2/3,i+1,0,q,i,0,q+2/3,i+1,0,q,i+1,0),a.push(B,B,F,B,F,F,B,B,F,F,B,F),Z.push(D,D,D,D,D,D)}K.push({vs:new Ui(p),uv:new Ui(a),faceIs:new Ui(Z)}),$>t&&$--}return{_lodPlanes:K,_sizeLods:Y,_sigmas:h}}(),m=B._lodPlanes,l=B._sizeLods,T=B._sigmas,W=K.EnvmapTextureSize}();var Ls=["left","front","right","back","top","bottom"],Ms=ag._RenderList=function(h){function e(){r.length=0,C.length=0,D={}}function S(f){var j,_,w,e,V=f.gv,q=f.data,I=f.shapeModel;if(I){var U,X,r,E=q.s("shape3d.transparent")||q.s("points.transparent");for(bs(I)||(U=as(I.transparent,q,V),I=[I]),w=0,e=I.length;e>w;w++)r=I[w],X=as(r.transparent,q,V),X===P&&(X=U),X===P&&(X=E),X?_=!0:j=!0}for(w=0,e=Ls.length;e>w;w++){var m=f[Ls[w]];m&&(m.transparent?_=!0:j=!0)}V.isLabelVisible(q)&&(f.labelInfo&&(q.s(em+".transparent")?_=!0:j=!0),f.label2Info&&(q.s(cd+".transparent")?_=!0:j=!0)),V.isNoteVisible(q)&&(f.noteInfo&&(q.s(qh+".transparent")?_=!0:j=!0),f.note2Info&&(q.s(qk+".transparent")?_=!0:j=!0)),f._38o&&(_=j=!0),_||(j=!0),f._renderParams={opaque:j,transparent:_}}function t(Q,o){o&&S(Q);var p=Q.data,A=p._id;if(!D[A]){D[A]=!0;var J=Q._renderParams;J&&J.visible!==!1&&(Q={ui:Q,data:p,z:0,id:A},J.opaque&&r.push(Q),J.transparent&&C.push(Q))}}function E(n,p){if(C.length>1){for(var c,W,q=[0,0,0,0],z=0,B=C.length;B>z;z++)c=C[z].data,(W=c._position)?(q[0]=W.x,q[1]=c._54O,q[2]=W.y,q[3]=1,El(q,p),C[z].z=q[2]/q[3]):C[z].z=0;C.sort(n||w)}}function m(n){n?(Kn(G,l,n,h),Kn(Y,F,n,h),Kn(x,s,n,h)):(G=this.batchModelMap={},l=this.batchIndexMap={},Y=this.polylineModelMap={},F=this.polylineIndexMap={},x=this.wireframeModelMap={},s=this.wireframeIndexMap={}),this.markBatchInvalid()}function I(y){y?Kn(G,l,y,h):(G=this.batchModelMap={},l=this.batchIndexMap={}),this.markBatchInvalid()}function T(i){i?Kn(Y,F,i,h):(Y=this.polylineModelMap={},F=this.polylineIndexMap={}),this.markBatchInvalid()}function R(D){D?Kn(x,s,D,h):(x=this.wireframeModelMap={},s=this.wireframeIndexMap={}),this.markBatchInvalid()}function V(){return this._batchInvalid}function W(){this._batchInvalid=!0}function p(){this._batchInvalid=null}var r=[],C=[],G={},l={},Y={},F={},x={},s={},D={};return{opaque:r,transparent:C,init:e,push:t,batchModelMap:G,batchIndexMap:l,polylineModelMap:Y,polylineIndexMap:F,wireframeModelMap:x,wireframeIndexMap:s,ivBatch:m,ivModelBatch:I,ivPolylineBatch:T,ivWireframeBatch:R,markBatchInvalid:W,isBatchInvalid:V,onUpdated:p,sort:E}},Ns=ag._RenderLists=function(W){function T(){for(var P in c)c[P].init()}function P(){for(var J in c)c[J].onUpdated()}function i(b,f){b=b||"main";var K=c[b];return!K&&f&&(K=c[b]=new Ms(W)),K}function $(w,$){var I=w.data.getRenderLayer(),J=i(I,!0);J.push(w,$)}function o(z){for(var b in c)z(c[b])}var c={};return{init:T,onUpdated:P,get:i,push:$,each:o,lists:c}},Os=ag.RenderTarget=function(g,W,R,y){var p,C=this;null!=W&&W.canvas?(p=W,W=R,R=y,y=arguments[4]):p=g.getGL(),y=y||{},y.cube===!!y.cube,y.samples=y.cube?0:Math.min(g._glCapabilities.maxSamples,y.samples&&y.samples>1&&2===g._webGLVersion?y.samples:0),C.options=y,C.uuid=h.Math.generateUUID(),C.gv=g,C.init(g,p,y),C.format=y.format||Um.RGBA,C.generateMipmaps=!!y.generateMipmaps,C.depthInternalFormat=y.depthFormat||p.DEPTH_COMPONENT16,y.samples&&!g._glCapabilities._maxSamplesChecked?C.setSize(p,W||1,R||1):C.setSize(p,W,R)};O.assign(ag.RenderTarget.prototype,{bind:function(i,c){var O=this.options;if(O.autoSize){var w=this.gv,B=w.getDevicePixelRatio(),l=w.getWidth()*B,V=w.getHeight()*B;this.setSize(i,l,V)}O.cube?bg(i,this.frame[c]):bg(i,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(n){Pk(n),this.options.samples&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,this._MSAAFbo),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.frame),n.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,n.COLOR_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null))},isCube:function(){return this.options.cube},init:function(N,g,h){var _=this,I=h.samples,Y=h.cube,O=_.texture=g.createTexture(),k=Y?Um.TEXTURE_CUBE_MAP:Um.TEXTURE_2D;g.activeTexture(g.TEXTURE0),g.bindTexture(k,O),g.texParameteri(k,g.TEXTURE_WRAP_S,h.wrapS||g.CLAMP_TO_EDGE),g.texParameteri(k,g.TEXTURE_WRAP_T,h.wrapT||g.CLAMP_TO_EDGE);var U=I?g.NEAREST:g.LINEAR;if(g.texParameteri(k,g.TEXTURE_MIN_FILTER,h.minFilter||U),g.texParameteri(k,g.TEXTURE_MAG_FILTER,h.magFilter||U),g.bindTexture(k,null),Y){_.depth=[],_.frame=[];for(var W=0;6>W;W++)_.depth[W]=g.createRenderbuffer(),_.frame[W]=g.createFramebuffer()}else _.depth=g.createRenderbuffer(),_.frame=g.createFramebuffer();_.assureTexture()},assureTexture:function(){var G=this;G.gv._2Oi(G.uuid,G.texture,"default"),h.Default.setImage(G.uuid,null)},releaseTexture:function(){this.gv.deleteTexture(this.uuid)},setSize:function(M,t,e){var C=this;if(t=Math.round(t),e=Math.round(e),t&&e&&(C.width!==t||C.height!==e)){C.width=t,C.height=e;var r=M.RENDERBUFFER,G=M.FRAMEBUFFER,R=C.options.samples,$=C.options.cube,b=$?Um.TEXTURE_CUBE_MAP:Um.TEXTURE_2D;if(R){var K=C.gv._glCapabilities;if(!K._maxSamplesChecked){for(M.bindRenderbuffer(r,C.depth),M.getError();R>1&&(M.renderbufferStorageMultisample(r,R,C.depthInternalFormat,t,e),M.getError());)R=Math.floor(R>>1);1>=R&&(R=0,M.texParameteri(b,M.TEXTURE_MIN_FILTER,C.options.minFilter||M.LINEAR),M.texParameteri(b,M.TEXTURE_MAG_FILTER,C.options.magFilter||M.LINEAR),M.renderbufferStorage(r,C.depthInternalFormat,t,e)),K._maxSamplesChecked=!0,K.maxSamples=C.options.samples=R,M.bindRenderbuffer(r,E)}}if(R&&(C._MSAAFbo||(C._MSAAFbo=M.createFramebuffer(),C._MSAARbO=M.createRenderbuffer()),M.bindRenderbuffer(r,C._MSAARbO),M.renderbufferStorageMultisample(M.RENDERBUFFER,R,M.RGBA8,t,e),bg(M,C._MSAAFbo),M.framebufferRenderbuffer(G,M.COLOR_ATTACHMENT0,r,C._MSAARbO),M.framebufferRenderbuffer(G,M.DEPTH_ATTACHMENT,r,C.depth),Pk(M),M.bindRenderbuffer(r,null)),M.activeTexture(M.TEXTURE0),M.bindTexture(b,C.texture),$)for(var m=M.TEXTURE_CUBE_MAP_POSITIVE_X,u=0;6>u;u++)C.setupFrameBufferTextureAndDepth(M,C.frame[u],C.depth[u],m+u);else C.setupFrameBufferTextureAndDepth(M,C.frame,C.depth,M.TEXTURE_2D);if(C.generateMipmaps&&(2===gv._webGLVersion||Uj.isPOT(t)&&Uj.isPOT(e))){M.generateMipmap(b);var V=C.options.minFilter||(R?M.NEAREST:M.LINEAR);M.texParameteri(b,M.TEXTURE_MIN_FILTER,V===M.NEAREST?M.NEAREST_MIPMAP_NEAREST:M.LINEAR_MIPMAP_LINEAR)}M.bindTexture(b,null)}},setupFrameBufferTextureAndDepth:function(d,l,g,m){var r=this,Y=r.format;d.texImage2D(m,0,Y,this.width,this.height,0,Y,d.UNSIGNED_BYTE,null),bg(d,l),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,m,r.texture,0),this.setupRenderBufferStorage(d,g),Pk(d)},setupRenderBufferStorage:function(M,G){var y=this,Q=M.RENDERBUFFER;M.bindRenderbuffer(Q,G);var r=y.options.samples;r?M.renderbufferStorageMultisample(Q,r,y.depthInternalFormat,y.width,y.height):(M.renderbufferStorage(Q,y.depthInternalFormat,y.width,y.height),M.framebufferRenderbuffer(M.FRAMEBUFFER,M.DEPTH_ATTACHMENT,Q,G)),M.bindRenderbuffer(M.RENDERBUFFER,null)},toCanvas:function(){var o=this,w=o.gv.getGL();bg(w,o.frame);var S=o.width,G=o.height,u=new Uint8Array(4*S*G);w.readPixels(0,0,S,G,o.format,w.UNSIGNED_BYTE,u),Pk(w);var k=f.createElement("canvas");k.width=S,k.height=G;var C=k.getContext("2d"),P=C.createImageData(S,G);return P.data.set(u),C.putImageData(P,0,0),k}});var Ps=ag.Interactor=function(d){this.gv=this.g3d=d};cj("Interactor",O,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()},fi:function(y){this.gv.fi(y)},startDragging:function(B){Mj(this,B)}});var Qs=ag.DefaultInteractor=function(h){cb(Qs,this,[h])};cj("DefaultInteractor",Ps,{getState:function(){return this._62O},setState:function(F){this._62O=F},getDataInfoAt:function(P,c){var F=this.gv,j=F.getDataInfoAt(P);if(!F.isBlockSelectable()||!j||!j.data)return j;if(!c&&F.isSelected(j.data))return j;for(var X=j.data;(X=X.getParent())&&X instanceof h.Block&&F.isSelectable(X);){var Q=F.isSelected(X);if(Q&&c)break;if(j={data:X,part:j.part},Q&&!c)break}return j},handle_contextmenu:function(I){up(I)},handle_mousewheel:function(e){this.gv.handleScroll(e,e.wheelDelta/40)},handle_DOMMouseScroll:function(B){2===B.axis&&this.gv.handleScroll(B,-B.detail)},handle_keydown:function(_){this.gv.handleKeyDown(_)},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(H){up(H);var z=this,c=z.gv,m=kp(H),u=z.getDataInfoAt(H),s=u?u.data:E,d=u?u.part:E,X=c.sm(),R=Wg(H),N=sf(H);c.setFocus(H)&&(z._62O=E,z._57I=E,z.pendingClickThrough=E,z.__lastClientPoint__=Tk(H),s?Bj(H)?X.co(s)?X.rs(s):X.as(s):X.co(s)?s instanceof aq&&s.isClickThroughEnabled()&&kp(H)&&(z.pendingClickThrough=Tk(H)):X.ss(s):m&&(Bj(H)?c.isRectSelectable()&&(z._62O=Ef):z._57I=Tk(H)),z._31Q&&(Jc(z._31Q),delete z._31Q,delete z._32Q),z._62O||(c.isFirstPersonMode()&&(um(H)||Ym(H)||N>2?z._62O="pan":c.isMouseRoamable()||_n(H)?(z._62O="roaming",z.foward=R&&kp(H),z._32Q=Ll(),z._31Q=dd(z.tick,z)):m||(z._62O="roaming")),z._62O||(m&&R&&it[d]?(z._62O=d,z.p3=s.p3()):m&&R&&bk(s)&&c.isSelected(s)?c.isMovable(s)?(z._62O="move",z.p3=s.p3(),z.movedata=s):c._39Q(s)&&(z._62O="none"):_n(H)&&(N>2?z._62O="pan":2===N&&(z.dist=ro(H),z._62O="pinch")))),z.point=c.lp(H),Mj(z,H),dh(H)?c.handleDoubleClick(H,s,d):c.handleClick(H,s,d))},tick:function(){var M=this,V=M.gv,j=V._moveStep;M.point&&V.isWalkable()&&(M._32Q&&(j*=(Ll()-M._32Q)/50),V.walk(M.foward?j:-j),M._32Q=Ll(),M._31Q=dd(M.tick,M))},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(X){var F=this._57I;if(F&&(nk(F,Tk(X))<=1&&this.gv.sm().cs(),this._57I=E),F=this.pendingClickThrough){if(nk(F,Tk(X))<=1){var e=this.getDataInfoAt(X);e&&e.data instanceof aq&&e.data.isClickThroughEnabled()&&(e=this.getDataInfoAt(X,!0),e&&(X.clickThrough=!0,this.gv.sm().ss(e.data)))}this.pendingClickThrough=null}},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(S){var b,d,f=this,T=f.gv,G=f._62O,Y=f.point,y=T.dm(),q=T.lp(S),_=q.x-Y.x,W=q.y-Y.y,O=T.getWidth(),t=T.getHeight();if(O&&t){var j=Tk(S),N=ns(T,j,f.__lastClientPoint__),A=nk({x:0,y:0},N),E=-a*_/O,z=-a*W/t;if("roaming"===G)f.rotate(S,E/2,z/2);else if(G===ct||G===dt||G===et)T._86O||y.beginTransaction(),T.fi({kind:T._86O?"betweenEditRotation":"beginEditRotation",event:S}),T._86O=1,T.sm().each(function(N){if(bk(N)&&T.isRotationEditable(N)){var I=B(E)>B(z)?E:z;G===ct?N.setRotationX(N.getRotationX()+I):G===dt?N.setRotationY(N.getRotationY()+I):G===et&&N.setRotationZ(N.getRotationZ()+I)}});else if("move"===G||it[G]){if(G===ft||G===gt||G===ht)T._87O||y.beginTransaction(),T.fi({kind:T._87O?"betweenEditScale":"beginEditScale",event:S}),T._87O=1;else{if(!T._moving){if(A<K.touchMoveThreshold)return;y.beginTransaction()}T.fi({kind:T._moving?"betweenMove":"beginMove",event:S}),T._moving=1}var i,v=f.p3,n=T.getPositionInfo(v),g=Bm(T);i=G===_s?"x":G===at?"y":G===bt?"z":G===ft?"sx":G===gt?"sy":G===ht?"sz":T.getMoveMode(S,f.movedata),_=_/O*n.width,W=-1*W/t*n.height;var F,I,w=[g[0]*_,g[4]*_,g[8]*_],L=[g[1]*W,g[5]*W,g[9]*W],X=w[0]+L[0],C=w[1]+L[1],e=w[2]+L[2],x=[v[0]+X,v[1]+C,v[2]+e],l=tf(T.getEye(),x,!0);if("xyz"===i?(F=x,T.moveSelection(X,C,e)):"xz"===i?(F=Af(T,v,[0,1,0],x),F&&T.moveSelection(F[0]-v[0],0,F[2]-v[2])):"xy"===i?(F=Af(T,v,[0,0,1],x),F&&T.moveSelection(F[0]-v[0],F[1]-v[1],0)):"yz"===i?(F=Af(T,v,[1,0,0],x),F&&T.moveSelection(0,F[1]-v[1],F[2]-v[2])):"x"===i||"sx"===i?(l[0]=0,F=Af(T,v,l,x),F&&(I=F[0]-v[0],"x"===i?T.moveSelection(I,0,0):T.sm().each(function(m){bk(m)&&T.isSizeEditable(m)&&(b=m.getScaleX()+I/100,d=b/m.getScaleX(),m.setScaleX(b),um(S)&&(m.setScaleY(m.getScaleY()*d),m.setScaleTall(m.getScaleTall()*d)))}))):"y"===i||"sy"===i?(l[1]=0,F=Af(T,v,l,x),F&&(I=F[1]-v[1],"y"===i?T.moveSelection(0,I,0):T.sm().each(function(t){bk(t)&&T.isSizeEditable(t)&&(b=t.getScaleTall()+I/100,d=b/t.getScaleTall(),t.setScaleTall(b),um(S)&&(t.setScaleY(t.getScaleY()*d),t.setScaleX(t.getScaleX()*d)))}))):("z"===i||"sz"===i)&&(l[2]=0,F=Af(T,v,l,x),F&&(I=F[2]-v[2],"z"===i?T.moveSelection(0,0,I):T.sm().each(function(v){bk(v)&&T.isSizeEditable(v)&&(b=v.getScaleY()+I/100,d=b/v.getScaleY(),v.setScaleY(b),um(S)&&(v.setScaleX(v.getScaleX()*d),v.setScaleTall(v.getScaleTall()*d)))}))),!F)return;f.p3=F}else if(G===Ef){var H=f.div;H||(H=f.div=Xi(),Ej(f.getView(),H),H.op=Y,H.style.background=T.getRectSelectBackground()),T.fi({kind:T._rectSelecting?"betweenRectSelect":"beginRectSelect",event:S}),T._rectSelecting=1,H.rect=Nd(H.op,q),Xb(H,H.rect)}else if("pinch"===G&&2===sf(S)){T.fi({kind:T._pinching?"betweenPinch":"beginPinch",event:S}),T._pinching=1;var I=ro(S);T._lastZoomLP||(T._lastZoomLP=Xq(S)),T.handlePinch(I,f.dist),f.dist=I}else"pan"===G||um(S)||Ym(S)?f.pan(S,_,W):"none"===G||T.isFirstPersonMode()||f.rotate(S,E,z);f.point=q}},pan:function(z,F,p){var E=this.gv;if(E.isPannable()){var b=E.getWidth(),w=E.getHeight();if(!b||!w)return;var V=E.getCenterInfo(),$=F/b*V.width,j=-1*p/w*V.height;E.fi({kind:E._panning?"betweenPan":"beginPan",event:z}),E._panning=1,E.pan(-$,-j)}},rotate:function(m,v,M){var L=this.gv;L.isRotatable()&&(L.fi({kind:L._rotating?"betweenRotate":"beginRotate",event:m}),L._rotating=1,L.rotate(v,M))},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(v){var H=this,$=H.gv,s=$.dm(),a=H.div;if(a){var S=$.getDatasInRect(a.rect);if(!S.isEmpty()){var p=$.sm(),t=p.toSelection(),W=um(v),B=v.altKey;S.each(function(j){p.co(j)?(!W||W&&B)&&t.remove(j):(!B||W&&B)&&t.add(j)}),p.ss(t)}gl(a)}$._moving&&(delete $._moving,$.fi({kind:"endMove",event:v}),$.onMoveEnded(),s.endTransaction()),$._panning&&(delete $._panning,$.fi({kind:"endPan",event:v}),$.onPanEnded()),$._rotating&&(delete $._rotating,$.fi({kind:"endRotate",event:v}),$.onRotateEnded()),$._86O&&(delete $._86O,$.fi({kind:"endEditRotation",event:v}),s.endTransaction()),$._87O&&(delete $._87O,$.fi({kind:"endEditScale",event:v}),s.endTransaction()),$._pinching&&(delete $._pinching,$.fi({kind:"endPinch",event:v}),$.onPinchEnded()),$._rectSelecting&&(delete $._rectSelecting,$.fi({kind:"endRectSelect",event:v}),$.onRectSelectEnded()),$._walking&&(delete $._walking,$.fi({kind:"endWalk",event:v}),$.onWalkEnded()),$._lastZoomLP=$._lastZoomHit=null,H.dist=H.point=H._62O=H.p3=H.movedata=H.div=H._57I=H.pendingClickThrough=H._32Q=H._31Q=H.foward=E,H.__lastClientPoint__=E}});var Rs=ag.MapInteractor=function(Q){cb(Rs,this,[Q]),this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right",this._minPhi=0,this._maxPhi=5*Math.PI/12};cj("MapInteractor",Ps,{setUp:function(){Rs.superClass.setUp.call(this);var L=this.gv;this.__oldMinPhi__=L.getRotateMinPhi(),this.__oldMaxPhi__=L.getRotateMaxPhi(),L.setRotateMinPhi(this._minPhi),L.setRotateMaxPhi(this._maxPhi)},tearDown:function(){Rs.superClass.tearDown.call(this);var G=this.gv;G.setRotateMinPhi(this.__oldMinPhi__),G.setRotateMaxPhi(this.__oldMaxPhi__),delete this.__oldMinPhi__,delete this.__oldMaxPhi__},handle_contextmenu:function(a){up(a)},handle_mousewheel:function(p){this.gv.handleScroll(p,p.wheelDelta/40)},handle_DOMMouseScroll:function(s){2===s.axis&&this.gv.handleScroll(s,-s.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(b){this.handle_touchstart(b)},handle_touchstart:function(t){up(t);var h=this,G=h.gv;if(G.setFocus(t)){var C=G.getDataInfoAt(t),I=C?C.data:E,s=C?C.part:E;h.__lastClientPoint__=Tk(t);var e=h.editing={point:G.lp(t),data:I,part:s};_n(t)?e.touch=!0:(e.touch=!1,e.clickLeft=kp(t),e.pan=Ym(t)?!0:"left"===this.panButton===e.clickLeft),I&&G._39Q(I)&&(e.preventDefault=!0),Mj(h,t),dh(t)?G.handleDoubleClick(t,I,s):G.handleClick(t,I,s)}},handle_mouseup:function(C){this.handle_touchend(C)},handle_touchend:function(){},handleWindowMouseMove:function(C){this.handleWindowTouchMove(C)},handleWindowTouchMove:function(u){var y=this,n=y.gv,x=y.editing;if(x){var h=n.lp(u),c=x.point,p=h.x-c.x,O=h.y-c.y;if(!x.moved){if(Math.abs(p)<y.threshold&&Math.abs(O)<y.threshold&&!(u.touches&&u.touches.length>1))return;x.moved=!0}if(!x.preventDefault){x.point=h;var I=x.part;if(it[I]){var j=x.data,Y=n.dm(),f=n.getWidth(),G=n.getHeight(),v=-a*p/f,q=-a*O/G;if(I===ct||I===dt||I===et){n._86O||Y.beginTransaction(),n.fi({kind:n._86O?"betweenEditRotation":"beginEditRotation",event:u}),n._86O=1;var m=B(v)>B(q)?v:q;n.sm().each(function(u){bk(u)&&n.isRotationEditable(u)&&(I===ct?u.setRotationX(u.getRotationX()+m):I===dt?u.setRotationY(u.getRotationY()+m):I===et&&u.setRotationZ(u.getRotationZ()+m))})}else{var Z=j.p3(),t=n.getPositionInfo(Z);p=p/f*t.width,O=-1*O/G*t.height;var d,z=Bm(n),M=[z[0]*p,z[4]*p,z[8]*p],$=[z[1]*O,z[5]*O,z[9]*O],U=M[0]+$[0],W=M[1]+$[1],V=M[2]+$[2],L=[Z[0]+U,Z[1]+W,Z[2]+V],b=tf(n.getEye(),L,!0);if(I===ft||I===gt||I===ht){if(n._87O||Y.beginTransaction(),n.fi({kind:n._87O?"betweenEditScale":"beginEditScale",event:u}),n._87O=1,d=Af(n,Z,b,L)){var J,X=0,P=["X","Y","Tall"];I===ft?J="X":I===gt?(J="Tall",X=1):I===ht&&(J="Y",X=2),P.splice(P.indexOf(J),1);var s=um(u),k=(d[X]-Z[X])/100;n.sm().each(function(K){if(bk(K)&&n.isSizeEditable(K)){var j=K["getScale"+J](),w=j+k;if(K["setScale"+J](w),s){var Q=w/j;P.forEach(function(z){K["setScale"+z](K["getScale"+z]()*Q)})}}})}}else if(I===_s||I===at||I===bt){if(!n._moving){var R=Tk(u),A=ns(n,R,y.__lastClientPoint__),T=nk({x:0,y:0},A);if(T<K.touchMoveThreshold)return;Y.beginTransaction()}n.fi({kind:n._moving?"betweenMove":"beginMove",event:u}),n._moving=1;var X=0;if(I===_s?X=0:I===at?X=1:I===bt&&(X=2),b[X]=0,d=Af(n,Z,b,L)){var k=d[X]-Z[X],Q=[0,0,0];Q[X]=k,n.moveSelection.apply(n,Q)}}}}else if(x.touch){var C=u.touches.length;if(2!==C)y.pan(u,p,O);else{if(1>=C)return;var e=u.touches,g={x:e[0].clientX,y:e[0].clientY},l={x:e[1].clientX,y:e[1].clientY},N={x:l.x-g.x,y:l.y-g.y},H=x.lastCenter,_=Math.atan2(N.y,N.x),i=x.theta,F=0;i==E?i=x.theta=_:(F=_-i,x.thetaStarted||Math.abs(F)>y.touchRotateThreshold?(x.thetaStarted=!0,x.theta=_):F=0);var w=D*(g.y+l.y)/2/n.getHeight(),S=x.phi,o=0;S==E?S=x.phi=w:(o=w-S,x.phiStarted||Math.abs(o)>y.touchRotateThreshold?(x.phiStarted=!0,x.phi=w):o=0);var r,Nj=Math.sqrt(N.x*N.x+N.y*N.y),tl=x.vlen;if(tl){var Jn=g.x-H.x,cb=g.y-H.y,Fq=l.x-H.x,ec=l.y-H.y,Zb=Math.sqrt(Jn*Jn+cb*cb),Aq=Math.sqrt(Fq*Fq+ec*ec),hd=tl/2,Eg=y._sign2(Zb-hd),Bd=y._sign2(Aq-hd);0>Eg*Bd||0===Eg&&0===Bd?(r=1,x.vlen=Nj):(r||(r=Nj/tl),x.scaleStarted||Math.abs(r-1)>y.touchScaleThreshold?(x.vlen=Nj,x.scaleStarted=!0):r=1)}else tl=x.vlen=Nj,r=1;1!==r&&n.setZoom(r),(o||F)&&y.rotate(u,F,-o),x.lastCenter={x:(l.x+g.x)/2,y:(l.y+g.y)/2}}}else if(x.pan)y.pan(u,p,O);else{var f=n.getWidth(),G=n.getHeight();
if(!f||!G)return;var v=-a*p/f,q=-a*O/G;y.rotate(u,v,q)}}}},_sign2:function(a){return Math.abs(a)<this._touchScaleCheckAccuracy?0:a>0?1:-1},handleWindowMouseUp:function(k){this.handleWindowTouchEnd(k)},getDataInfoAt:function(H,z){var F=this.gv,s=F.getDataInfoAt(H);if(!F.isBlockSelectable()||!s||!s.data)return s;if(!z&&F.isSelected(s.data))return s;for(var V=s.data,T=s.part;(V=V.getParent())&&V instanceof h.Block&&F.isSelectable(V);){var N=F.isSelected(V);if(N&&z)break;if(s={data:V,part:T},N&&!z)break}return s},handleWindowTouchEnd:function(M){var V=this,$=V.editing;if(V.editing=null,$){var l=V.gv;if($.moved||!$.clickLeft&&!$.touch)l._panning=null,l._rotating=null,l.fi({kind:$.pan?"endPan":"endRotate",event:M});else{var f=V.getDataInfoAt(M),s=f&&f.data;s instanceof aq&&s.isClickThroughEnabled()&&(f=V.getDataInfoAt(M,!0),f&&(s=f.data)),s?l.sm().setSelection([s]):l.sm().clearSelection()}var o=l.dm();l._moving&&(delete l._moving,l.fi({kind:"endMove",event:M}),l.onMoveEnded(),o.endTransaction()),l._86O&&(delete l._86O,l.fi({kind:"endEditRotation",event:M}),o.endTransaction()),l._87O&&(delete l._87O,l.fi({kind:"endEditScale",event:M}),o.endTransaction())}},pan:function(B,T,h){var u=this,L=u.gv;if(L.isPannable()){var K=L.getWidth(),b=L.getHeight();if(K&&b){var e=L.getCenterInfo(),g=-T/K*e.width,O=1*h/b*e.height;L.fi({kind:L._panning?"betweenPan":"beginPan",event:B}),L._panning=1;var d=u.keepHorizon,H=u.editing.touch;if((H&&B.touches&&B.touches.length>1||!H&&um(B))&&(d=!d),!d)return L.pan(g,O);if(g||O){var p=Bm(L),c=[p[0]*g,p[4]*g,p[8]*g],$=[p[1],0,p[9]],Z=Math.sqrt($[0]*$[0]+$[2]*$[2]);Z&&($=[$[0]/Z*O,0,$[2]/Z*O]);var t=c[0]+$[0],q=c[1]+$[1],z=c[2]+$[2],R=L._center,F=L._eye;R[0]+=t,R[1]+=q,R[2]+=z,F[0]+=t,F[1]+=q,F[2]+=z,L.fp(ui,E,F),L.fp(Xj,E,R)}}}},rotate:function(l,e,L){var g=this,H=g.gv;if(H.isRotatable()){var E=H._center,O=H._eye,N=tf(O,E),x=Hr(A(N[0]*N[0]+N[2]*N[2]),N[1]),a=ei(H,x+L);L=a-x,H.fi({kind:H._rotating?"betweenRotate":"beginRotate",event:l}),H._rotating=1,H.rotate(e,L)}}}),O.defineProperties(Rs.prototype,{panButton:{get:function(){return this._panButton},set:function(h){this._panButton=h}},minPhi:{get:function(){return this._minPhi},set:function(i){this.gv.setRotateMinPhi(this._minPhi=i)}},maxPhi:{get:function(){return this._maxPhi},set:function(H){this.gv.setRotateMaxPhi(this._maxPhi=H)}},keepHorizon:{get:function(){return this._keepHorizon},set:function(L){this._keepHorizon=L}},threshold:{get:function(){return this._threshold},set:function(p){this._threshold=p}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function($){this._touchScaleThreshold=$}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(T){this._touchRotateThreshold=T}}});var Ss,Ts="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAEyUlEQVRYR62XW0xcVRSG/58cmIG2HmstE9N4SX2xtVqBCISoFS/RmDSpKQSvTWNixUStQSqVyBQYJUGttrQVtYkPatuQPmhivMUHqbUBZ2itl1qjTzZpImNUZhDLsUeWWXgOOd2cgcGyk3mYs/de69trr70uxP8YIlJKMi0i9wIgyf0iEiM5PFdxzGeDiBQAuB7AjQBuALCN5NcGQDmANgBfeL8UyYnZ5M8KICJ3AXgAwAlfOMl/VHAQwPtveYAKuQLA2yQ/ngliRgAR2QogA2AvSdcUZAIE50VEYR4BsIDkC7kgQgFE5GIAuwDsJnkk1+aZAPw9IqLX1gjgcZK/m7KmAXjK4wBaSf4ZplxEIgCuA3Cz3gSAfgDHSf6dY/0FAJ4D0G5ChAEcAPBwmHIRqXNd90nLsiocx/k+k8n8oK/Atu2rIpHIStd1v7QsawfJd0Ouywawh6T609Q4B8C788NhZnddt29sbGxBd3f39q6urtNhJ43H48uam5u3lJSUjFiWdV8IxE0Aqki+6M9NAXjefjnJXsOZogBGBgYGttbU1Hw427PS+cHBwbVVVVUJAItJOoa8xwD8RPIT/T4J4L3zfQAeNL1dRMZra2ur+/v7/8pHub+mvr7+wr6+vs8KCgoWGABFAN4EsEHjhA9QBeA2ks8HF6vZk8nkQL4nNwGTyeTa8vLycsuy7jcg1Mk/IpnyAZoBaOQ6FHg+ddlsdqNt201zObm5NpvN7ly0aNHrJN8LyL4FwGqSr/gAOrnej3C60HXdw/F4PJ7L4fKFSiQSl7W0tLQVFRWtCQDoNRwguZ6aWABcorE9sEDf+QjJ1fkqmmmdiHwHoCToXyKiceR0rkhY5TjOq9FoVLPdeY/x8fG+SCSySe/cFKYWCFOyPJ1Or4zFYh3nrR3A8PBwe2lp6TcAfg4DmBYwAFyRTqdXxWKx9nkE+DYUIEyBiFQ6jvNaNBq9Zz4AZruCGIBlJI8ZXpolee18AORwwgoAp/xnqMmjPuilZ8+ePZRIJNo7OztD436+YB0dHZe2trY+W1hYWGsccD/JOh/gKQBHSWpanRwicnc2m91k2/bmfJWFrRsdHd29cOHCXSTfD8i+FcA1JHcEQ/HtJDVnTw3XdfcPDQ0dra6unto8F5hUKrWurKxslWVZG4L7RGQbgA9IDgWT0VsANprJaGJi4kxDQ8OagwcPjsxFeWNj49Le3l6N91qMTA2vmNnr6fovGXkmvxPAlST3hGz4LZVKbausrMzLEnryioqKNpJLzCpJRJ4AcJLkp6rHLEieBjBA8rB5Wtd1942NjS3p6el5qa2t7VSYNdThmpqaWoqLi38xze4dUku4CpLb/f1hJZnWBY+SzJpKRGSdV5LVOI5zIpPJnNQ1tm2viEQiV7uue8SyrJeDDhew8GIAO0me4w9hABdp8ahNBkktyacNr+Qu84pSndfX81VY6e6dXJV3AoiT/CMoMFcyUogeAG+Q/DyX8+VZlqvZHwKw2VQ+zQdCTL4FwBkPZFrJPUtjoildG5PC4J2bOvJpze7QWhHAj4HWbBImpDXTQsPvH5cDeMf39lxWnBXAU6TNqcZu7fn0lyB53GhOdf6ZQHN6bF6a0xxOuJTkrwbA5LdcJ831/V8SOUYQxYGhRwAAAABJRU5ErkJggg==",Us=32,Vs=ag.GlobeInteractor=function(C,z){cb(Vs,this,[C]);var S,f=z.radius||6378137,D=this,g=null;Ss||(Ss=Xi(),Ss.style.border="",Ss.style.backgroundImage="url("+Ts+")");var k=new _d,s=new Ab,c=new Ab,Z=new Ab,x=new js,V="number"==typeof f?{x:f,y:f,z:f}:f,U={center:new Ab(0,0,0),radius:V},$=function(z){C._81O=null;var O=C.getHitPosition(z,C.getCenter(),s.copy(C.getEye()).sub(c.copy(C.getCenter())).toArray());return x.origin.copy(C.getEye()),x.direction.copy(O).sub(x.origin).normalize(),x.intersectEllipsoid(U)},G=function(l,v){C._81O=null,x.origin.copy(C.getEye());for(var K,t,T=C.getCenter(),A=s.copy(C.getEye()).sub(c.copy(C.getCenter())).toArray(),P=1,z=16,J=0,f=1,h={x:0,y:0};z--;){if(h.x=v.x+(l.x-v.x)*P,h.y=v.y+(l.y-v.y)*P,K=C.getHitPosition(h,T,A),x.direction.copy(K).sub(x.origin).normalize(),t=x.intersectEllipsoid(U),t&&1===P)return{hit:t};t?J=P:f=P,P=(J+f)/2}return{hit:t,out:1>P}},r=function(y,W){if(g){var J=Date.now();g.deltaTime=g.lastTime?J-g.lastTime:1e3,g.lastTime=J,g.lastAxis=y,g.lastAngle=W}W&&(k.setFromAxisAngle(y,W),C.setEye(s.copy(C.getEye()).applyQuaternion(k).toArray()),C.setCenter(s.copy(C.getCenter()).applyQuaternion(k).toArray()),C.setUp(s.copy(C.getUp()).applyQuaternion(k).toArray()))};D._showCrossIcon=function(v){Ej(D.getView(),Ss),Xb(Ss,{x:v.clientX-Us/2,y:v.clientY-Us/2,width:Us,height:Us})},D._hideCrossIcon=function(){gl(Ss)},D._scrollImpl=function(t,z){g={point:C.lp(t),screen:Tk(t),hit:$(t),type:"right"},g.hitNormalize=g.hit?g.hit.clone().normalize():new Ab;var O={clientX:g.screen.x,clientY:g.screen.y+10*z};D._handleMoveImpl(O),D._endMoveImpl(O)},D._startMoveImpl=function(o){S&&(S.stop(!0),S=null),g={point:C.lp(o),screen:Tk(o),hit:$(o)},g.hitNormalize=g.hit?g.hit.clone().normalize():new Ab,_n(o)?1===o.touches.length?g.hit&&(g.type="left"):2===o.touches.length&&(g.type="touch2"):(kp(o)?g.hit&&(g.type="left"):tr(o)?g.type="right":Ym(o)&&g.hit&&(g.type="middle"),!g.hit||"right"!==g.type&&"middle"!==g.type||D._showCrossIcon(o)),g.type&&Mj(D,o)},D._handleMoveImpl=function(Z){if(g)switch(g.type){case"left":return D._handleLeft(Z);case"right":return D._handleRight(Z);case"middle":return D._handleMiddle(Z);case"touch2":return D._handleTouch2(Z)}},D._endMoveImpl=function(){if(g){if(this._hideCrossIcon(),"left"===g.type||"middle"===g.type){var y=1e3*(g.lastAngle/(g.deltaTime||30)),C=g.lastAxis,B=g.lastTime,e=function(){var F=Date.now(),m=(F-B)/1e3;return B=F,y*=Math.pow(Math.abs(D.decelerationRate),3*m),Math.abs(y)<.01?(y=0,S&&S.stop(),void 0):(r(C,y*m),void 0)};S=he({action:function(){e(arguments)},duration:5e3})}g=null}},D._handleLeft=function(o){if(!g.finished){var w=Tk(o),I=G(w,g.lastScreen||g.screen);if(g.lastScreen=w,!I.hit)return g.finished=!0,D._endMoveImpl(o),void 0;var e=I.hit;e.normalize();var M=g.hitNormalize,y=Math.acos(e.dot(M)),h=e.cross(M).normalize();r(h,y),I.out&&(g.finished=!0,D._endMoveImpl(o))}},D._handleRight=function(F){var w=g.lastScreen||g.screen,Q=w.y;w=g.lastScreen=Tk(F);var K=w.y,y=K-Q;if(y){var P=Math.min(.5,y*D.scaleSpeed);s.copy(C.getEye());var p=g.hit;p||(p=s.clone().divide(V).normalize().multiply(V)),c.copy(s).lerp(p,P),C.setEye(c.toArray()),s.copy(C.getUp()),c.normalize();var d=s.clone().cross(c).normalize();if(Z.copy(C.getCenter()),Z.sub(d.multiplyScalar(Z.dot(d))),C.setCenter(Z.toArray()),g.hit){var n=$(g.screen),B=g.hitNormalize;if(n){n.normalize();var q=Math.acos(n.dot(B)),k=n.cross(B).normalize();q&&r(k,q)}}}};var K=function(l){return Math.abs(l)<.01?0:l>0?1:-1};D._handleTouch2=function(J){var H=J.touches.length;if(2===H){var y=J.touches,O={x:y[0].clientX,y:y[0].clientY},B={x:y[1].clientX,y:y[1].clientY},F={x:B.x-O.x,y:B.y-O.y},t=g.lastCenter,m=Math.atan2(F.y,F.x),z=g.theta,s=0;z==E?z=g.theta=m:(s=m-z,g.thetaStarted||Math.abs(s)>.03?(g.thetaStarted=!0,g.theta=m):s=0);var v,G=Math.sqrt(F.x*F.x+F.y*F.y),l=g.vlen;if(l){var X=O.x-t.x,Y=O.y-t.y,d=B.x-t.x,h=B.y-t.y,T=Math.sqrt(X*X+Y*Y),x=Math.sqrt(d*d+h*h),N=l/2,n=K(T-N),D=K(x-N);0>n*D||0===n&&0===D?(v=1,g.vlen=G):(v||(v=G/l),g.scaleStarted||Math.abs(v-1)>.05?(g.vlen=G,g.scaleStarted=!0):v=1)}else l=g.vlen=G,v=1;var F=c.copy(C.getEye()).clone();1!==v&&C.setEye(F.setLength((F.length()-f)/v+f).toArray()),s&&r(F.normalize(),s),g.lastCenter={x:(B.x+O.x)/2,y:(B.y+O.y)/2}}},D._handleMiddle=function(B){var H=Tk(B),p=g.screen;g.screen=H;var q=(H.y-p.y)/180*Math.PI*D.rollSpeed;c.copy(C.getCenter()).sub(s.copy(C.getEye())).normalize(),s.copy(C.getUp()).cross(c).normalize(),c.copy(C.getEye()).sub(g.hit).applyAxisAngle(s,q).add(g.hit);var $=c.clone();c.copy(C.getCenter()).sub(g.hit).applyAxisAngle(s,q).add(g.hit);var u=c.clone(),K=c.copy(C.getUp()).applyAxisAngle(s,q).clone(),W=!1;q>0&&(Z.copy(K),c.copy(u).sub($).normalize(),s.copy($).multiplyScalar(-1).normalize(),s.dot(Z)-c.dot(Z)>0&&(W=!0)),W||Z.copy(g.hit).sub($).dot(g.hitNormalize)>=0&&(W=!0),W||(C.setEye($.toArray()),C.setCenter(u.toArray()),C.setUp(K.toArray()));var X=-(H.x-p.x)/180*Math.PI*D.rotateSpeed;r(g.hitNormalize,X)}};cj("GlobeInteractor",Ps,{handle_contextmenu:function(R){up(R)},handle_mousewheel:function(P){this._scrollImpl(P,P.wheelDelta/40)},handle_DOMMouseScroll:function($){2===$.axis&&this._scrollImpl($,-$.detail)},handle_keydown:function(s){this.gv.handleKeyDown(s)},handle_mousedown:function(U){this.handle_touchstart(U)},handle_touchstart:function(g){up(g);var n=this.gv;if(n.setFocus(g)){var w=n.getDataInfoAt(g),$=w?w.data:E;$&&n.isInteractive($)||this._startMoveImpl(g);var a=w?w.part:E;dh(g)?n.handleDoubleClick(g,$,a):n.handleClick(g,$,a)}},handle_mouseup:function(u){this.handle_touchend(u)},handle_touchend:function(){},handleWindowMouseMove:function(h){this.handleWindowTouchMove(h)},handleWindowTouchMove:function(K){this._handleMoveImpl(K)},handleWindowMouseUp:function(B){this.handleWindowTouchEnd(B)},handleWindowTouchEnd:function(J){this._endMoveImpl(J)}}),O.defineProperties(Vs.prototype,{rotateSpeed:{get:function(){return this._rotateSpeed||.3},set:function(K){this._rotateSpeed=K}},rollSpeed:{get:function(){return this._rollSpeed||.1},set:function(c){this._rollSpeed=c}},scaleSpeed:{get:function(){return this._scaleSpeed||.002},set:function(N){this._scaleSpeed=N}},decelerationRate:{get:function(){return this._decelerationRate||.04},set:function(b){this._decelerationRate=b}}});var Ws=function(f){var Q=2147483648|f;return[(255&Q>>16)/255,(255&Q>>8)/255,(255&Q)/255,(255&Q>>24)/255]},Xs=function(r){this.gv=r,this.gv.pickColorMap={_pickIdUsed:2e3}};gd(Xs,O,{_iv:!0,iv:function(){this._iv=!0},get:function(v,j,y){this.validate();var U=this,w=U.gv.getGL();if(!w)return E;var i,m,h=U._resolution,I=Math.round(v.x*h),C=Math.ceil(v.width*h),T=Math.ceil(v.height*h),M=U.height-Math.round(v.y*h)-T,O=X(C/2),o=new Uint8Array(4*C*T),s=0,N=o.length,F=j?E:new oc,u=j?E:{};if(bg(w,U.frame),w.readPixels(I,M,C,T,w.RGBA,w.UNSIGNED_BYTE,o),Pk(w),j){for(;O>=s;s++)for(var B=O-s,Z=O+s,l=B;Z>=l;l++)for(var J=B;Z>=J;J++)if((l===B||l===Z||J===B||J===Z)&&(i=U.info(o,4*(l*C+J)))){if(y&&y(i)===!1)continue;return i}}else for(;N>s;s+=4)if(i=U.info(o,s)){if(y&&y(i)===!1)continue;m=i.data,u[m._id]||(F.add(m),u[m._id]=m)}return F},info:function(V,c){return this.gv.pickColorMap[(V[c]<<16)+(V[c+1]<<8)+V[c+2]+((127&V[c+3])<<24)]},getResolution:function(){return this._resolution},onContextLost:function(){this.texture=null,this.width=this.height=-1},validate:function(){var $=this,A=$.gv,o=A.getGL();if(o){var p=$._resolution=A._pickerResolution*A.getDevicePixelRatio(),q=Math.round(p*A.getWidth()),m=Math.round(p*A.getHeight()),g=o.RGBA,M=o.TEXTURE_2D,u=o.RENDERBUFFER,v=o.FRAMEBUFFER;if($.texture||($.texture=De(o),$.render=o.createRenderbuffer(),$.frame=o.createFramebuffer()),($.width!==q||$.height!==m)&&(o.activeTexture(o.TEXTURE0),ef(o,$.texture),o.texImage2D(M,0,g,q,m,0,g,o.UNSIGNED_BYTE,E),pi(o,o.TEXTURE_MIN_FILTER,o.LINEAR),o.bindRenderbuffer(u,$.render),o.renderbufferStorage(u,o.DEPTH_COMPONENT16,q,m),bg(o,$.frame),o.framebufferTexture2D(v,o.COLOR_ATTACHMENT0,M,$.texture,0),o.framebufferRenderbuffer(v,o.DEPTH_ATTACHMENT,u,$.render),ef(o,E),o.bindRenderbuffer(u,E),Pk(o),$.width=q,$.height=m),$._iv){$._iv=!1;var k=!1;A._40Q.each(function(d){!k&&d.isBatchInvalid()&&(k=!0)}),k&&A.updateScene(),bg(o,$.frame),o.clear(o.COLOR_BUFFER_BIT),A.overlappingBox.clear(),A.setViewport(o,0,0,q,m),A.renderPickScene(),Pk(o)}}}});var Ys=function(W){this.gv=W};gd(Ys,O,{gap:0,size:0,_42:function(u,G){var T=this,A=T.gv,L=A._gridGap,q=A._gridSize;if(A._gridVisible){if(T.gap!==L||T.size!==q){for(var F=[],K=A._gridSize/2,H=L*K,o=0;2*K+1>o;o++){var j=6*o,X=6*(2*K+1)+j;F[j]=-H,F[j+1]=0,F[j+2]=-H+o*L,F[j+3]=H,F[j+4]=0,F[j+5]=-H+o*L,F[X]=-H+o*L,F[X+1]=0,F[X+2]=-H,F[X+3]=-H+o*L,F[X+4]=0,F[X+5]=H}T.vs=new Ui(F),T.gap=L,T.size=q}qs(A),or(u),tg(u);var l=!A._fogDisabled;if(l){var k=Zq.for(u).directUniforms();k.uFog=!1}hh(u,G,1,A._gridColor,A._buffer.vs,T.vs),Mp(u,0,T.vs.length/3,u.LINES),l&&(k.uFog=!0),ph(u),Dp(u)}else T.vs=T.gap=T.size=E}});var Zs=function(f){this.gv=f};gd(Zs,O,{_42:function($,n){var T=this.gv,C=T._buffer.vs,f=T._axisXColor,c=T._axisYColor,V=T._axisZColor,p=T._originAxisVisible,X=T._centerAxisVisible;if(p||X){var l=Wm?$.TRIANGLES:$.TRIANGLE_FAN,y=$.LINES;if(qs(T),or($),tg($),p){var J=T.getCenterInfo(),S=I(J.width,J.height)/5,s=.8*S,w=.05*S;hh($,n,1.5,f,C,new Ui([0,0,0,S,0,0,s,w,0,s,0,w,s,-w,0,s,0,-w,s,w,0,0,0,0,0,S,0,w,s,0,0,s,w,-w,s,0,0,s,-w,w,s,0,0,0,0,0,0,S,w,0,s,0,w,s,-w,0,s,0,-w,s,w,0,s])),Mp($,0,2,y),Mp($,1,6,l),hh($,n,E,c),Mp($,7,2,y),Mp($,8,6,l),hh($,n,E,V),Mp($,14,2,y),Mp($,15,6,l)}if(X){var e=T._center,L=e[0],v=e[1],K=e[2],J=T.getPositionInfo(e);S=I(J.width,J.height)/20,hh($,n,1.5,f,C,new Ui([L,v,K,L+S,v,K,L,v,K,L,v+S,K,L,v,K,L,v,K+S])),Mp($,0,2,y),hh($,n,E,c),Mp($,2,2,y),hh($,n,E,V),Mp($,4,2,y)}ph($),Dp($)}}});var $s=function(a){this.gv=a},_s="edit_tx",at="edit_ty",bt="edit_tz",ct="edit_rx",dt="edit_ry",et="edit_rz",ft="edit_sx",gt="edit_sy",ht="edit_sz",it={};it[_s]=101,it[at]=102,it[bt]=103,it[ct]=104,it[dt]=105,it[et]=106,it[ft]=107,it[gt]=108,it[ht]=109,gd($s,O,{_42:function(D,H,O){var f=this,C=f.gv,b=C.sm().ld();if(b&&C.isEditable(b)&&!C.isEditHelperDisabled()&&bk(b)&&(!C.isFirstPersonMode()||!C.isMouseRoamable()&&!kd)){qs(C);var r,s=C.isMovable(b),j=C.isRotationEditable(b),E=C.isSizeEditable(b),L=C._axisXColor,v=C._axisYColor,c=C._axisZColor,Y=C._editSizeColor,A=b.p3();if(C.isOrtho()){var i=C.getCenterInfo();r=I(i.width,i.height)/8}else r=nk(C.getEye(),A)/10;var u,P,d=r/(O?5:10),T=.7*r,t=.4*T,N=A[0],k=A[1],n=A[2];u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&f._17O(D,H,b,O,_s,L,u,[N,k-d,n,N+T,k-d,n,N+T,k,n,N+T,k,n,N,k,n,N,k-d,n,N,k-d,n+d,N+T,k-d,n+d,N+T,k-d,n,N+T,k-d,n,N,k-d,n,N,k-d,n+d]),P=N+T,E&&f._17O(D,H,b,O,ft,Y,u,[P,k-d,n,P+t,k-d,n,P+t,k,n,P+t,k,n,P,k,n,P,k-d,n,P,k-d,n+d,P+t,k-d,n+d,P+t,k-d,n,P+t,k-d,n,P,k-d,n,P,k-d,n+d]),P+=t,j&&f._17O(D,H,b,O,ct,L,u,[P,k-d,n,P+t,k-d,n,P+t,k,n,P+t,k,n,P,k,n,P,k-d,n,P,k-d,n+d,P+t,k-d,n+d,P+t,k-d,n,P+t,k-d,n,P,k-d,n,P,k-d,n+d]),u=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],s&&f._17O(D,H,b,O,at,v,u,[N,k,n,N,k+T,n,N-d,k+T,n,N-d,k+T,n,N-d,k,n,N,k,n,N,k,n,N,k,n-d,N,k+T,n-d,N,k+T,n-d,N,k+T,n,N,k,n]),P=k+T,E&&f._17O(D,H,b,O,gt,Y,u,[N,P,n,N,P+t,n,N-d,P+t,n,N-d,P+t,n,N-d,P,n,N,P,n,N,P,n,N,P,n-d,N,P+t,n-d,N,P+t,n-d,N,P+t,n,N,P,n]),P+=t,j&&f._17O(D,H,b,O,dt,v,u,[N,P,n,N,P+t,n,N-d,P+t,n,N-d,P+t,n,N-d,P,n,N,P,n,N,P,n,N,P,n-d,N,P+t,n-d,N,P+t,n-d,N,P+t,n,N,P,n]),u=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],s&&f._17O(D,H,b,O,bt,c,u,[N,k,n,N,k,n+T,N,k-d,n+T,N,k-d,n+T,N,k-d,n,N,k,n,N,k-d,n,N-d,k-d,n,N-d,k-d,n+T,N-d,k-d,n+T,N,k-d,n+T,N,k-d,n]),P=n+T,E&&f._17O(D,H,b,O,ht,Y,u,[N,k,P,N,k,P+t,N,k-d,P+t,N,k-d,P+t,N,k-d,P,N,k,P,N,k-d,P,N-d,k-d,P,N-d,k-d,P+t,N-d,k-d,P+t,N,k-d,P+t,N,k-d,P]),P+=t,j&&f._17O(D,H,b,O,et,c,u,[N,k,P,N,k,P+t,N,k-d,P+t,N,k-d,P+t,N,k-d,P,N,k,P,N,k-d,P,N-d,k-d,P,N-d,k-d,P+t,N-d,k-d,P+t,N,k-d,P+t,N,k-d,P])}},_17O:function(r,j,O,f,s,X,L,b){var Z=this.gv,M=Z._buffer,K=Zq.for(r),$=K.directUniforms(),C=K.directAttribs();if(Z._picking){f=Z.pickColorMap;var g=it[s];f[g]={data:O,part:s},$.uFixPickReverseColor=Ws(g)}Yk(r,j,E,!0,E,!0,E,!1),$.uDiffuse=X,C.aPosition=jh(r,M.vs,new Ui(b),E),C.aNormal=jh(r,M.ns,new Ui(L),E),tg(r),Mp(r,0,12),ph(r),jf(r,j)}});var jt=h.Raycaster=function(S){this.gv=S,this.maxTriangleTest=1/0,this.backfaceCulling=!0};lq("Raycaster",O,{intersect:function(J){var l=this,k=l.gv,b=k.getDataAt(J);return b?l.intersectObject(J,b):null},intersectObjects:function(O,K,N){var q,$,B,b,l=this,t=1/0,j=O.origin||(new Ab).fromArray(l.gv.getEye()),A=l.maxTriangleTest,S=[];K.forEach(function(r){N&&N(r)===!1||r.s("intersect")!==!1&&S.push(r)});var E=j.distanceToSquared2([0,0,0]);return S.sort(function(K,s){return(K.p3?j.distanceToSquared2(K.p3()):E)-(s.p3?j.distanceToSquared2(s.p3()):E)}),l.countTriangles=0,S.forEach(function(D){l.countTriangles>A||(q=l.intersectObject(O,D),q&&($=j.distanceToSquared(q.world),t>$&&(B=D,b=q,t=$)))}),l.countTriangles=0,{data:B,intersect:b}},intersectObjectAndRecordTriangle:function(T,i){this._4GQ=!0;var O=this.intersectObject(T,i);return this._4GQ=!1,O},intersectLastTriangle:function(Y,X){var I=this.getRay(Y);I.applyMatrix4(X.inverseMatrix);var n=I.intersectPlane(X.plane);if(!n)return null;var G=Nn.uvIntersection(n,X.p1,X.p2,X.p3,X.uv1.clone(),X.uv2.clone(),X.uv3.clone());return{world:n.clone().applyMatrix4(X.matrixWorld),local:n.clone(),uv:G}},getRay:function(c){if(c instanceof js)return c;var v=this,f=v.gv,N=f.unproject(c),O=new Ab,D=f.getEye(),u=new Ab;if(f.isOrtho()){var x=new Ab(D);u.copy(f.getCenter()).sub(x).normalize();var d=O.copy(N).sub(x).dot(u);O.copy(u).setLength(-d).add(x.copy(N))}else O.copy(D),u.copy(N).sub(O).normalize();return new h.Math.Ray(O,u)},intersectObject:function(j,g){return this._intersectObjectImpl(this.getRay(j),g)},_intersectObjectImpl:function(){function w(){var d=new Ab;return d.subVectors(i,_),Z.subVectors(G,_),d.cross(Z).normalize(),d}var z=new jo,O=new jo,b=new js,Y=new Ab,v=new Ab,J=new Ab,C=new Ab,N=new Ab,G=new Ab,_=new Ab,i=new Ab,p=new Vl,Q=new Vl,n=new Vl,Z=new Ab,S={vs:Qo,is:kn,uv:Ag},L=_i.slice(0);return L.push("csg"),function(g,D){var M=this.gv.getData3dUI(D),A=D.mat||M.mat;A?z.fromArray(A):z.identity(),O.getInverse(z),b.copy(g).applyMatrix4(O);var F,l,u,d="body",q=M.shapeModel;if(!q&&(D instanceof h.Polyline||D instanceof h.Edge)&&M.lineShapeModel&&(q=M.lineShapeModel),q||(q=wq(M)),q||(h.CSGNode&&D instanceof h.CSGNode||h.CSGShape&&D instanceof h.CSGShape?(u=!0,q=[M.left,M.front,M.right,M.back,M.top,M.bottom,M.csg]):D instanceof h.Node&&!(D instanceof h.Shape)?(F=!0,q=S):(l=!0,q=[M.left,M.front,M.right,M.back,M.top,M.bottom])),!q)return console.log("Can not find shape model."),null;bs(q)||(q=[q]);var e,r,W,j,X,x,a,s,o,K,k,B,E,m,I,H,V=1/0,$=["","top_","bottom_"],T=!1,Z=this.backfaceCulling,R=[];for(Hf(q,M,R),e=0,r=R.length;r>e;e++)if(E=R[e])for(W=0,j=$.length;j>W;W++)if(m=$[W],a=E[m+"vs"],s=E[m+"is"],o=E[m+"uv"]||E[m+"tuv"],a){if(I=E[m+"boundingBox"]){var k=b.intersectBox(I);if(!k)continue;if(b.origin.distanceTo(k)>V)continue;H=!1}else E[m+"boundingBox"]=I=new h.Math.Box3,H=!0;for(X=0,x=s?s.length:a.length/3;x>X;X+=3)this.countTriangles++,s?(v.fromArray(a,3*s[X]),J.fromArray(a,3*s[X+1]),C.fromArray(a,3*s[X+2])):(v.fromArray(a,3*X),J.fromArray(a,3*(X+1)),C.fromArray(a,3*(X+2))),H&&(I.expandByPoint(v),I.expandByPoint(J),I.expandByPoint(C)),K=b.intersectTriangle(v,J,C,Z,Y),K&&(B=b.origin.distanceTo(K),V>B&&(V=B,N.copy(K),G.copy(v),_.copy(J),i.copy(C),""!==m?d=m.slice(0,-1):F?d=_i[Math.floor(X/6)]:l?d=_i[e]:u&&(d=L[e]),o&&(T=!0,s?(p.fromArray(o,2*s[X]),Q.fromArray(o,2*s[X+1]),n.fromArray(o,2*s[X+2])):(p.fromArray(o,2*X),Q.fromArray(o,2*(X+1)),n.fromArray(o,2*(X+2))))))}if(!isFinite(V))return null;var f,t,P=N.clone().applyMatrix4(z),y=this._4GQ;T&&(y&&(t={inverseMatrix:O.clone(),matrixWorld:z.clone(),p1:G.clone(),p2:_.clone(),p3:i.clone(),uv1:p.clone(),uv2:Q.clone(),uv3:n.clone(),plane:(new h.Math.Plane).setFromCoplanarPoints(G,_,i)}),f=Nn.uvIntersection(N,G,_,i,p,Q,n));var c=w(G,_,i),U=w(G.applyMatrix4(z),_.applyMatrix4(z),i.applyMatrix4(z)),Ab=b.direction.dot(c);Ab>0&&(c.multiplyScalar(-1),U.multiplyScalar(-1));var sb={world:P,local:N.clone(),worldNormal:U,normal:c,uv:f,part:d};return t&&(sb.triangleInfo=t),sb}}()});var kt=function(n,U){this.gv=n,this.s=function(S,M,Q){return M==E&&(M=Q),M==E?U.getStyle(S):as(M,U,n)},this.data=U};gd(kt,O,{I3d:!0,ms_icons:1,_iv:!0,_cacheBoundingBox:P,iv:function(){this._iv=!0},update:function(L,g,e){var T=this,M=T.data;if(L||(L=T.gv,g=L.getGL(),e=L._40Q),!T.needValidate(g)||!L.isVisible(M))return e.push(this,!1),void 0;var a,v,O,x,t,j=M._id,F=M._47Q?null:T.s("batch"),J=M.getRenderLayer(),l=e.get(J,!0),s=l.batchIndexMap,i=l.batchModelMap,o=L.getBrightness(M),c=o!=E&&1!==o;a=$m(s,i,M,F,L);var P=F?L.getBatchInfo(F)||gg:E,y=T.validate(a,P);if(a&&(!P.ms||!P.ms.length)&&(v=s[j],O=v.size=a.vs.length/3-v.begin,t=a.rs))for(o=c?o:1,x=0;O>x;x++)t.push(o);var H=L.getWireframeGeometry(M);if(H)yq(L,M,H);else if(bk(M)){var h=L.getWireframe(M);h&&yq(L,M,h)}T.labelInfo=T.label2Info=T.noteInfo=T.note2Info=T._38o=E,T._24O(em,"getLabel"),T._24O(cd,"getLabel2"),T._26O(qh,"getNote"),T._26O(qk,"getNote2"),T._15O(),T.interactiveInfo=L.isInteractive(M)?{}:E,l.push(this,!0),y!==!1&&(T._iv=!1)},clearWireframeGeometryCache:function(){var c=this;bl(c),c.data.iv()},_46Q:function(V,i){var U=this,H=U.data,p=U.gv;if(p.isVisible(H)){var W=H._id,T=p._40Q.get(H._renderLayer,!0),K=T.batchIndexMap[W],u=T.polylineIndexMap[W],w=T.wireframeIndexMap[W];(K||u||w)&&(i==E&&(i=Ul(V,p.pickColorMap,p.isSelectable(H),U,ar,!0)),i&&(Oo(i,K,T.batchModelMap,p),Oo(i,u,T.polylineModelMap,p),Oo(i,w,T.wireframeModelMap,p)))}},_42:function(O,Y,Z){function m(T,L,I){var O=L.getBrightness(I),N=I.s("alphaTest"),c=I.s("envmap"),G=Zq.for(T),h=G.directUniforms();O!=E&&1!==O&&(h.uBrightness=O),h.uAlphaTest=N,h.uUseEnvMap=c?!0:!1,h.uReflectivity=c||.01,h.roughness=I.s("roughness"),L._setEnvmapByProbeId(h,I.s("envmap.probe")),h.shadowReceive=!y&&I.s("shadow.receive"),h.shadowCull=!y&&!!I.s("shadow.cull"),Jf(L,h,I.s("3d.clipbox")?yi:I.s("3d.clipbox.mask"));var W=S.s("3d.clip.direction");if(W){var U=S.s("3d.clip.percentage");0===U&&(i=!1);var C=S._formatClipUniforms(W,U,I);h.uClipPercent=C[1],h.uClipDirection=C[0]}else h.uClipDirection=0;T._blooming&&!I.s("bloom")&&(h.blackout=!0),y||(L._flowObjects.length&&L.flowMap.resetDataFlowEnabld(I,h),ib(L,h,I.s("light.mask"),I.s("headlight.ambientIntensity")))}var S=this,R=S.data,N=S.gv;if(N.isVisible(R)){var o,y=N._picking;if(y)o=N.pickColorMap;else{if(N.isTransparentMask(R)||N.isReflecting(O)&&R.s("3d.reflectable")===!1)return;o=P}if(kt.getTitle===P){kt.getTitle=0;for(var w in K)if(w.length===cd.length+1&&w[cd.length]===Uq[4].toUpperCase()&&w[cd.length-1]===Uq[cd.length+1].toUpperCase()){kt.getTitle=ri;break}}if(!kt.getTitle||Eo[cd.length+2]){if(kt.getHead===P){kt.getHead=0;for(var w in $){var n="box-sizing";6===w.length&&w[0]===Uq[4]&&w[3]===n[0]&&w[4]===n[1]&&w[5]===n[2]&&(kt.getHead=fh)}}if(!kt.getHead||Eo[cd.length]){if(kt.getTitle2===P){kt.getTitle2=0;for(var w in $){var l="uv";6===w.length&&w[0]===wh[1].toUpperCase()&&w[1]===l[0]&&(kt.getTitle2=ik)}}if(!kt.getTitle2||Eo[$p.length]){var V,q,k=R._id,r=N._40Q.get(R._renderLayer,!0),x=r.batchIndexMap,s=r.batchModelMap,I=N.isSelectable(R),a=!1,i=!0,B=x[k];if(y&&(q=Ul(O,o,I,S,ar,B),q&&!N._45Q&&(Oo(q,B,s,N),Oo(q,r.polylineIndexMap[k],r.polylineModelMap,N),Oo(q,r.wireframeIndexMap[k],r.wireframeModelMap,N))),B||(a||(a=!0,m(O,N,R)),i&&S._80o(O,Y,Z)),N.isLabelVisible(R)&&((V=S.labelInfo)&&(y&&Ul(O,o,I,S,em),a||(a=!0,m(O,N,R)),S._28O(V,em,Z)),(V=S.label2Info)&&(y&&Ul(O,o,I,S,cd),a||(a=!0,m(O,N,R)),S._28O(V,cd,Z))),N.isNoteVisible(R)&&((V=S.noteInfo)&&(y&&Ul(O,o,I,S,qh),a||(a=!0,m(O,N,R)),S._29O(V,qh,Z)),(V=S.note2Info)&&(y&&Ul(O,o,I,S,qk),a||(a=!0,m(O,N,R)),S._29O(V,qk,Z))),(V=S._38o)&&(a||(a=!0,m(O,N,R)),S._99O(O,Y,V,o,I,Z)),a){var M=Zq.for(O).directUniforms();M.uBrightness=1,M.uClipDirection=0,O._blooming&&(M.blackout=!1)}}}}}},_formatClipUniforms:function(w,C,m){switch(w){case"uv.right":w=7;break;case"uv.left":w=8;break;case"left":w=2;break;case"top":w=3;break;case"bottom":w=4;break;case"front":w=5;break;case"back":w=6;break;case"right":default:w=1}if(0===w%2&&(C=1-C),7===w||8===w){var y=this.shapeModel;y&&y.internalUvScale&&(C*=y.internalUvScale)}else if(m instanceof h.Shape){var J=m.s3(),n=m.p3(),R=m.getAnchor3d();C=3>w?(C-R.x)*J[0]+n[0]:5>w?(C-R.y)*J[1]+n[1]:(C-R.z)*J[2]+n[2]}else C-=.5;return[w,C]},prepare:function(){var F=this,$=F.data;if(!($ instanceof aq)){var w,N,d,T,j,f=F.gv,D=f.getGL(),U=$._id,Z=F.s("batch"),r=f._batchIndexMap,B=f._batchModelMap,u=f.getBrightness($),A=u!=E&&1!==u;if(F.needValidate(D)){w=$m(r,B,$,Z,f);var h=Z?f.getBatchInfo(Z)||gg:E;if(F.validate(w,h),w&&(!h.ms||!h.ms.length)&&(N=r[U],d=N.size=w.vs.length/3-N.begin,j=w.rs))for(u=A?u:1,T=0;d>T;T++)j.push(u);if(bk($)){var o=f.getWireframeGeometry($);if(o)yq(f,$,o);else{var t=f.getWireframe($);t&&yq(f,$,t)}}F.labelInfo=F.label2Info=F.noteInfo=F.note2Info=F._38o=E,F._24O(em,"getLabel"),F._24O(cd,"getLabel2"),F._26O(qh,"getNote"),F._26O(qk,"getNote2"),F._15O(),F.interactiveInfo=f.isInteractive($)?{}:E,F._iv=!1}}},dispatchBoundingBoxChanged:function(){this._cacheBoundingBox=P},getBoundingBox:function(){var T,s,j,w,Y,m;return function(N){if(this._cacheBoundingBox)return this._cacheBoundingBox;T||(T={vs:Qo,is:kn,uv:Ag},s=new Ab,j=new Ab,w=new Ab,Y=new Ab,m=new Ab);var I=this,x=I.data,X=I.shapeModel;if(!X&&(x instanceof h.Polyline||x instanceof h.Edge)&&I.lineShapeModel&&(X=I.lineShapeModel),X||(X=wq(I)),X||(h.CSGNode&&x instanceof h.CSGNode||h.CSGShape&&x instanceof h.CSGShape?(isCSG=!0,X=[I.left,I.front,I.right,I.back,I.top,I.bottom,I.csg]):x instanceof h.Node&&!(x instanceof h.Shape)?X=T:(I.left||I.front||I.right||I.back||I.top||I.bottom)&&(X=[I.left,I.front,I.right,I.back,I.top,I.bottom])),!X)return P;bs(X)||(X=[X]);var q,u,c,F,H,k,U,_,D,G,p,n,v=["","top_","bottom_"],L=new h.Math.Box3,d=!1;if(I._needRecoverPosition){Y.set.apply(Y,x.p3());var Z=x.s3();m.set(1/(Z[0]||1),1/(Z[1]||1),1/(Z[2]||1))}else Y.set(0,0,0),m.set(1,1,1);var K=[];for(Hf(X,I,K),q=0,u=K.length;u>q;q++)if(D=K[q])for(c=0,F=v.length;F>c;c++)if(G=v[c],U=D[G+"vs"],_=D[G+"is"],U){if(n=G+"boundingBox",p=D[n],!p)for(D[n]=p=new h.Math.Box3,H=0,k=_?_.length:U.length/3;k>H;H+=3)_?(s.fromArray(U,3*_[H]).sub(Y).multiply(m),j.fromArray(U,3*_[H+1]).sub(Y).multiply(m),w.fromArray(U,3*_[H+2]).sub(Y).multiply(m)):(s.fromArray(U,3*H).sub(Y).multiply(m),j.fromArray(U,3*(H+1)).sub(Y).multiply(m),w.fromArray(U,3*(H+2)).sub(Y).multiply(m)),!s.isNaN()&&p.expandByPoint(s),!j.isNaN()&&p.expandByPoint(j),!w.isNaN()&&p.expandByPoint(w);L.expandByBox(p),d=!0}return d?(this._cacheBoundingBox=L,O.freeze(L),O.freeze(L.min),O.freeze(L.max),N||Wo(I.gv,x),L):P}}(),needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Jm},_80o:function(){},dispose:function(){var E=this,P=E._pickId;if(P){var n=E.gv.pickColorMap;n[P]&&delete n[P]}},getBodyColor:function(N){var e=this.data,x=this.gv.getBodyColor(e);return x?x:N?e.getStyle(N):E},contextLost:function(){this._cachedTextures&&this.gv.invalidateCachedTexture(this.data)},getCachedTexture:function(u){var w=this._cachedTextures;return w?w[u||"main"]:null},setCachedTexture:function(E,i){var U=this._cachedTextures;return U||(U=this._cachedTextures={}),U[i||"main"]=E,E},invalidateCachedTexture:function(q){var W=this._cachedTextures;if(W){for(var n in W)q.deleteTexture(W[n]);this._cachedTextures={}}},invalidateCachedGeometry:function(){},_24O:function(d,c){var S=this,x=S.data,B=S.gv,$=S.s,n=B[c](x);if(n!=E){var I=$(d+".scale"),k=$(d+".max"),H=S[d+"Info"]={label:n,textureScale:$(d+".texture.scale"),color:B[c+"Color"](x),font:$(d+".font"),align:$(d+".align"),background:B[c+"Background"](x)},F=H.rect=Tq(H,n);k>0&&k<F.width&&(H.labelWidth=F.width,F.width=k),F.x=F.y=0,F.width*=I,F.height*=I,H.mat=S._16O($(d+".autorotate"),$(d+".position"),F,$(d+".face"),$(d+".t3"),$(d+".r3"),$(d+".rotationMode"));var e=F.width/2,j=F.height/2;H.vs=new Ui([-e,j,0,-e,-j,0,e,-j,0,e,j,0]),F.width/=I,F.height/=I}},_26O:function(l,L){var y=this,r=y.data,f=y.gv,Y=y.s,w=f[L](r);if(w!=E){var M=Y(l+".scale"),s=this[l+"Info"]={note:w,textureScale:Y(l+".texture.scale"),expanded:Y(l+".expanded"),font:Y(l+".font"),color:Y(l+".color"),align:Y(l+".align"),borderWidth:Y(l+".border.width"),borderColor:Y(l+".border.color"),background:f[L+"Background"](r)};if(s.expanded){var e=Y(l+".max"),i=Tq(s,w);i.width+=6,i.height+=2,e>0&&e<i.width&&(s.labelWidth=i.width,i.width=e);var p={x:-i.width/2,y:-8-i.height,width:i.width,height:i.height+8}}else p={x:-6,y:-18,width:12,height:18};s.mat=y._16O(Y(l+".autorotate"),Y(l+".position"),E,Y(l+".face"),Y(l+".t3"),Y(l+".r3"),Y(l+".rotationMode")),s.rect=p,1!==M&&(p=fo(p),p.x*=M,p.height*=M,p.y=-p.height,p.width*=M);var v=p.x,R=p.y,Q=p.width,F=p.height;s.vs=new Ui([v,-R,0,v,-R-F,0,v+Q,-R-F,0,v+Q,-R,0])}},eachShapeModel:function(f,O){function r(R){Lr(R),R.vs&&f(R.vs,R.is,R.ns,R.uv),R.top_vs&&f(R.top_vs,R.top_is,R.top_ns,R.top_uv),R.bottom_vs&&f(R.bottom_vs,R.bottom_is,R.bottom_ns,R.bottom_uv),R.from_vs&&f(R.from_vs,R.from_is,R.from_ns,R.from_uv),R.to_vs&&f(R.to_vs,R.to_is,R.to_ns,R.to_uv)}function v(o){var p,D,P;if(bs(o))for(D=0,P=o.length;P>D;D++)p=o[D],p&&v(p);else Om(o)?v(wq(I,o),I):Hh(o)&&(o.shape3d?v(o.shape3d):r(o))}var I=this,_=I.data,O=O||I.shapeModel||wq(I);O||(O=_ instanceof h.Node&&!(_ instanceof h.Shape)?{vs:Qo,is:kn}:[I.left,I.front,I.right,I.back,I.top,I.bottom]),v(O)},_28O:function(X,Y,v){if(v(this.s(Y+".transparent"))){var i=X.rect,s=X.textureScale,q=i.width*s,L=i.height*s;if(q>=1&&L>=1){var Q=Le(q,L);1!==s&&(Q.translate(i.x,i.y),Q.scale(s,s),Q.translate(-i.x,-i.y)),co(Q,X),Q.restore(),Mi(this,Y,X.mat,X.vs,!0)}}},_29O:function(S,i,C){if(C(this.s(i+".transparent"))){var P=S.rect,y=S.textureScale,E=P.x,k=P.y,D=P.width*y,L=P.height*y;if(D>=1&&L>=1){P.x=P.y=0;var B=Le(D,L);1!==y&&B.scale(y,y),cp(B,S),B.restore(),P.x=E,P.y=k,Mi(this,i,S.mat,S.vs,!1)}}},_99O:function(O,T,d,U,A,h){if(d){var N=this,p=N.gv,V=N.data,Q=p._buffer,_=p._1O,t=d.icons,e=Zq.for(O),q=e.directAttribs();for(var s in t){var f=t[s],X=d.rects[s];if(X&&h(as(f.transparent,V,p))){p._picking&&Ul(O,U,A,N,s);var y=as(f.shape3d,V,p),S=y?[y]:as(f.names,V,p),Z=S?S.length:0,r=as(f.textureScale,V,p)||1,z=as(f.light,V,p);z==E&&(z=y?!0:!1),Yk(O,T,as(f.blend,V,p),z,as(f.opacity,V,p),as(f.reverseFlip,V,p),as(f.reverseColor,V,p),as(f.reverseCull,V,p));for(var b=0;Z>b;b++){var K=S[b],J=X[b];if(qj(N,J.mat),y)cr(p,V,wq(N,y),N);else{var M=fl(K);if(M){var x=J.width*r,W=J.height*r;if(x>=1&&W>=1){var j=Le(x,W);_c(j,M,as(f.stretch,V,p),0,0,x,W,V,p),j.restore(),De(O,Ar,_),tg(O,T,_,as(f.discardSelectable,V,p),Q.uv,Rr),q.aPosition=jh(O,Q.vs,J.vs,E),q.aNormal=Mk(O,Q.ns,nj,E),Vj(O,Q.is,Hk),Dg(O,0,Hk.length),ph(O,T,_)}}}Vh(p)}jf(O,T)}}}}});var lt=function(R,s){cb(lt,this,[R,s])};gd(lt,kt,{_16O:function(P,s,a,x,U,v,y,N,c){var V,w=this.data,q=w.getFinalScale3d();if(w.hasOwnProperty("_anchor")||w.hasOwnProperty("_anchorElevation")){var l=w.getAnchor3d();V=[-(l.x-.5)*q[0],-(l.y-.5)*q[1],-(l.z-.5)*q[2]]}if(w.s("part.boundingBox")){var t=this.getBoundingBox(!0);if(t){var k=t.max.clone().sub(t.min),b=t.max.clone().add(t.min).divideScalar(2);V||(V=[0,0,0]),V[0]+=b.x*q[0],V[1]+=b.y*q[1],V[2]+=b.z*q[2],q[0]*=k.x,q[1]*=k.y,q[2]*=k.z}}var n=dk(s,q,a,x,N,c);return V&&(n[0]+=V[0],n[1]+=V[1],n[2]+=V[2]),Yj(Tc(),n,w.p3(),x,U,v,y,P,w.getFinalRotation3d(),w.getRotationMode())},clear:function(){var Z=this;Z.faceMat=Z.mat=Z.shapeModel=Z.left=Z.right=Z.front=Z.back=Z.top=Z.bottom=Z.csg=E
},needValidate:function(I){if(this._iv)return this._validateFrameId=I._renderInfo.frame,!0;if(this.data._47Q){var W=I._renderInfo.frame;if(this._validateFrameId!==W)return this._validateFrameId=W,!0}return!1},invalidateUnstableWireframe:function(){var W=this.data;if(W._47Q){var R=W.getRenderLayer(),G=this.gv._40Q.get(R);G&&G.ivWireframeBatch(W)}},validate:function(s,Z){var a=this,u=a.gv,C=a.data,W=a.shapeName=a.s(Jb),q=wq(a,W);a._updateAutoRotation(),a._updateFixSize2d(),a._updateOverlapping(),a.dispatchBoundingBoxChanged(),a.invalidateUnstableWireframe();var N=$f(C,u.getMat(C),q?a.s("shape3d.scaleable"):!0);if(C.appendAnchorMatrix3d(N),a.clear(),a.mat=C.mat=N,q||!W)if(a.shapeModel=q,s)if(q)Z.instanced?u.batchInstancedModel(C,q,a,a.getBodyColor(),[N],s):Oi(u,C,q,a,a.getBodyColor(),[N],s);else{var v=Em(N);Z.instanced?u.batchInstancedFace(C,s,Z,N,v):ur(u,C,s,Z,N,v)}else q||(a._cubeUvs=null,a.vf(zi,0),a.vf(es,16),a.vf(Yp,8),a.vf(mc,24),a.vf(Mo,32),a.vf(de,40))},_updateAutoRotation:function(){var y=new bn,C=new jo,G=new Ab,l=new Ab,j=new Ab;return function(){var U=this,d=U.data,V=U.s("autorotate")||U.s("shape3d.autorotate");if(!V)return d._dynamicRotation&&delete d._dynamicRotation,void 0;var N=U.gv;j.copy(U.s("shape3d.autorotate.up")||N._up);var Q;Q="string"==typeof V?[V.indexOf("x")<0?N._eye[0]:N._center[0],V.indexOf("y")<0?N._eye[1]:N._center[1],V.indexOf("z")<0?N._eye[2]:N._center[2]]:N._eye;var a=N._center,P=d.p3();G.copy(P),l.set(Q[0]-a[0],Q[1]-a[1],Q[2]-a[2]).add(G),C.lookAt(l,G,j),y.set(0,0,0,d.getRotationMode(),!0).setFromRotationMatrix(C);var F=d._dynamicRotation;F&&Math.abs(F[0]-y.x)<1e-5&&Math.abs(F[1]-y.y)<1e-5&&Math.abs(F[2]-y.z)<1e-5||(d._dynamicRotation=[y.x,y.y,y.z])}}(),_updateFixSize2d:function(){var $=this,d=$.data,v=$.s("fixSizeOnScreen")||$.s("shape3d.fixSizeOnScreen");if(!v)return d._dynamicScale3d&&delete d._dynamicScale3d,void 0;var V=$.gv,G=$f(d,V.getMat(d)),u=kc([0,0,0],G),Z=V.toViewPosition(u);if(!isNaN(Z.x)&&!isNaN(Z.y)){var F=kc([1,0,0],G),m=V.toViewPosition(F),B=kc([0,1,0],G),A=V.toViewPosition(B),J=m.x-Z.x,w=A.y-Z.y;if(J&&w){var C,g,j=d._dynamicScale3d||[1,1,1],K=fl(d.s("shape3d.image"));if(v[0]>0&&(C=v[0]),v[1]>0&&(g=v[1]),!C||!g){var q=v>0?v:1;C||(C=(_r(K,d)||d.getWidth())*q),g||(g=(wm(K,d)||d.getTall())*q)}var t=Math.abs(J/C),I=Math.abs(w/g);Math.abs(t-1)<.001&&Math.abs(I-1)<.001||(d._dynamicScale3d=[j[0]/t,j[1]/I,j[2]])}}},_updateOverlapping:function(){var v=this,z=v.s("hide.overlapping.group");if(!z)return v._rectOverlapping&&(v._rectOverlapping=P),void 0;var M,x,o,K=v.gv,G=v.data,l=$f(G,K.getMat(G)),r=1/0,t=1/0,O=-1/0,H=-1/0,X=G.getAnchor3d(),w=X.x,Q=X.y,B=X.z;for(M=0;8>M;M++){if(x=kc([(M>>2)-w,(1&M>>1)-Q,(1&M)-B],l),o=K.toViewPosition(x),isNaN(o.x)||isNaN(o.y))return;r=Math.min(r,o.x),O=Math.max(O,o.x),t=Math.min(t,o.y),H=Math.max(H,o.y)}var d={x:r,y:t,w:O-r,h:H-t};v._rectOverlapping=K.overlappingBox.isOverlapping(z,d)},getVectorDynamicSize:function(){var s,O=this,M=O.s("shape3d"),V=O.data;if("billboard"===M||"plane"===M||(s=V._currentCubeElementId)!=E){var Y,I,Q=O.gv,t=$f(V,Q.getMat(V)),r=V.getAnchor3d(),b=.5-r.x,v=.5-r.y,h=.5-r.z,o=Math.min(O.s("vector.dynamic.maxsize"),Q._glCapabilities.maxTextureSize)/Q.getDevicePixelRatio(),f=function(k,s){k[0]+=b,k[1]+=v,k[2]+=h,s[0]+=b,s[1]+=v,s[2]+=h;var C=Q.toViewPosition(kc(k,t)),c=Q.toViewPosition(kc(s,t)),f=C.x-c.x,S=C.y-c.y;return Math.min(o,Math.sqrt(f*f+S*S))};if("billboard"===M)Y=f([-.5,0,0],[.5,0,0]),I=f([0,-.5,0],[0,.5,0]);else if("plane"===M)Y=f([-.5,0,0],[.5,0,0]),I=f([0,0,-.5],[0,0,.5]);else if(V._currentCubeElementId!=E){var d=3*kn[s+1],z=3*kn[s],S=3*kn[s+2];Y=f([Qo[d],Qo[d+1],Qo[d+2]],[Qo[S],Qo[S+1],Qo[S+2]]),I=f([Qo[d],Qo[d+1],Qo[d+2]],[Qo[z],Qo[z+1],Qo[z+2]])}return[Y,I]}},vf:function(v,h){var H=this;if(H.gv.getFaceVisible(H.data,v)){var S=qc(H,v);S.mat&&(H.faceMat=!0);var B=S.uv;if(B){var X=H._cubeUvs;X||(X=H._cubeUvs=new Ui([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var E=0;8>E;E++)X[h+E]=B[E]}return S}},_billboardInView:function(){var C=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],v=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],l=new zg,p=new Ab,z=new jo;return function(i){var s=this;if(!s.mat)return!0;var K=s.gv.getFrustum(),D="billboard"===i?C:v;l.makeEmpty(),z.fromArray(s.mat);for(var S=0,$=D.length;$>S;S+=3)l.expandByPoint(p.fromArray(D,S).applyMatrix4(z));return K.intersectsBox(l)}}(),_80o:function(Z,u,n){var h=this;if(h._rectOverlapping)return!0;var W=h.shapeModel;if(W||!h.shapeName){var s=h.s("shape3d");if(("billboard"===s||"plane"===s)&&!h._billboardInView(s))return!0;var O=h.gv,Y=h.data,$=O._cube,z=Zq.for(Z),q=z.directAttribs();if(xk&&!bp){var o=h.mat;if(o)for(var w=0;w<o.length;w++)h.mat[w]=o[o.length-w-1]}qs(O,h.mat),!Z._picking&&h.s("shape3d.reflector")||h.s("effect.flow")||(W?cr(O,Y,W,h,h.getBodyColor(),n):(q.aPosition=jh(Z,$.vs,E,E),q.aNormal=jh(Z,$.ns,E,E),Zm(Z,$.is),h._18O(Z,u,"left",0,n),h._18O(Z,u,"front",6,n),h._18O(Z,u,"right",12,n),h._18O(Z,u,"back",18,n),h._18O(Z,u,"top",24,n),h._18O(Z,u,"bottom",30,n))),Vh(O),h.faceMat&&(h._18O(Z,u,"left",0,n,!0),h._18O(Z,u,"front",6,n,!0),h._18O(Z,u,"right",12,n,!0),h._18O(Z,u,"back",18,n,!0),h._18O(Z,u,"top",24,n,!0),h._18O(Z,u,"bottom",30,n,!0))}},_18O:function(y,F,_,c,n,w){var $=this[_];if($){if(!n($.transparent))return;if(w&&!$.mat||!w&&$.mat)return;var X=this.data.s("polygonOffset");X&&ue(y,X),w&&qs(this.gv,$.mat);var u=this,v=u.data,q=Zq.for(y),G=q.directUniforms();v._currentCubeElementId=c;var S=u.gv,k=S.getTexture($.texture,v,_),x=$.uv,V=$.uvScale,R=$.uvOffset,Q=$.uvRotation,I=$.uvAnchor,Y=$.discardSelectable;k?x?tg(y,F,k,Y,S._buffer.uv,u._cubeUvs,R,V,Q,I):tg(y,F,k,Y,S._cube.uv,E,R,V,Q,I):tg(y),Yk(y,F,$.blend,$.light,$.opacity,$.reverseFlip,$.reverseColor,$.reverseCull),G.uDiffuse=$.color||N["color.empty"],Dg(y,c,6),jf(y,F),ph(y,F,k),w&&Vh(S),X&&Vf(y),v._currentCubeElementId=null}},contextLost:function(){lt.superClass.contextLost.apply(this,arguments),this.data.s("shape3d.reflector")&&(this._reflectorRenderTarget=null,this._reflectNormal=null)},drawReflector:function(){var w=new Ab,x=new Ab,K=new bn,n=new jo,d=new Ab,W=new Ab,f=new Ab,$=new Ab,e=new jo,F=new jo,D=new Oq,p=new _m,U=new _m,S=function(l,J,G){l[G]=J[0],l[G+1]=J[1],l[G+2]=J[2]},I=function(d,o,n){n=n||0,d[0]=o[n],d[1]=o[n+1],d[2]=o[n+2]},O=function(p,Q){S(p,Q.getEye(),0),S(p,Q.getCenter(),3),S(p,Q.getUp(),6)},V=function(M,l){I(l._eye,M,0),I(l._center,M,3),I(l._up,M,6),l._18Q=E;var x=l._skybox;x&&(x.p3([M[0],M[1],M[2]]),l.getData3dUI(x).iv())};return function(j){var R=this;R._reflectorInfo=null;var B=R.data;if(B._reflecting)return!1;var v=R.gv;if(v._picking)return!1;var S=B instanceof Ap,o=R._reflectorRenderTarget,i=v._canvas.width,M=v._canvas.height;if(o?o.setSize(j,i,M):o=R._reflectorRenderTarget=new ag.RenderTarget(v,j,i,M),S){var g=B.getPointsMatrix3d().getElements(),Y=B.p3();Y[1]+=(1-B.getAnchorElevation())*B.getTall(),w.copy(kc(Y,g))}else w.copy(B.p3());if(x.copy(v.getEye()),n.makeRotationFromEuler(K.set(B.r3(),B.getRotationMode(),!0)),!R._reflectNormal){var L;if(S&&B.getThickness()<0){if(!R.shapeModel||!R.shapeModel.top_vs)return!1;L={vs:R.shapeModel.top_vs,ns:R.shapeModel.top_ns}}else{if(L=wq(R,R.s("shape3d")),!L)return!1;!L.ns&&L.length&&(L=L[0])}if(!L.ns||!L.vs)return!1;R._reflectNormal=[L.ns[0],L.ns[1],L.ns[2]],R._reflectorVbuffer=ff.Buffer.createVertexBuffer(j,new Float32Array(L.vs))}if(d.copy(R._reflectNormal),d.applyMatrix4(n),W.subVectors(w,x),W.dot(d)>0)return!1;W.reflect(d).negate(),W.add(w),f.copy(v.getCenter()).negate().add(w),f.reflect(d).negate(),f.add(w),$.copy(v.getUp()),$.reflect(d);var h=[0,0,0,0,0,0,0,0,0];O(h,v),I(v._eye,W.toArray()),I(v._center,f.toArray()),I(v._up,$.toArray()),v._18Q=E;var J=v._skybox;J&&(J.p3(v._eye),v.getData3dUI(J).iv()),bg(j,o.frame),v.setViewport(j,0,0,o.width,o.height);var k=B.s("shape3d.reflector.background");if(k){var G=j.getParameter(j.COLOR_CLEAR_VALUE);Wf(j,k)}else Wf(j,[0,0,0,1]);Zq.for(j).glState.depth.mask=!0,j.clear(j.COLOR_BUFFER_BIT|j.DEPTH_BUFFER_BIT);var C=B.s("shape3d.reflector.clip"),c=C===P?.003:C,y=Am(v),t=Bm(v);D.setFromNormalAndCoplanarPoint(d,w.add(d.clone().multiplyScalar(c))),D.applyMatrix4(F.fromArray(t)),p.set(D.normal.x,D.normal.y,D.normal.z,D.constant),F.fromArray(y).getInverse(F),U.set(Math.sign(p.x),Math.sign(p.y),1,1).applyMatrix4(F),p.multiplyScalar(2/p.dot(U)),y[2]=p.x-y[3],y[6]=p.y-y[7],y[10]=p.z-y[11],y[14]=p.w-y[15];var l=v._computedProjectMatrix;v._computedProjectMatrix=y,B._reflecting=!0;var m=B.s("shape3d.reflector.shadow"),z={renderAxis:!1,renderEdit:!1,renderGrid:!1};"disabled"===m?(z.createShadowMap=!1,z.renderShadow=!1):"scene"===m?z.createShadowMap=!1:z.useReflectorSelfShadowMap=!0,v.renderScene(z),v._computedProjectMatrix=l,e.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),e.multiply(F.fromArray(v._projectMatrix)),e.multiply(F.fromArray(v._viewMatrix)),k&&Wf(j,G),Pk(j),V(h,v);var Z=B.s("shape3d.reflector.blur");if(Z){var a=v.getPostProcessingModule("Blur");a&&a.drawImpl(j,o,Z,Z>=3,B.s("shape3d.reflector.blur.iterations"))}var r=v.getPostProcessingModule("Glitch");r&&r.enable&&r.onlyReflector&&(o=r._42(j,o));var Q=j._compiledShader.reflector;Q||(Q=j._compiledShader.reflector=new ff.Shader(j,rl.Reflector.vs,rl.Reflector.fs)),Q.bind(),j.activeTexture(j.TEXTURE0),ef(j,o.texture),Q.uniforms.tDiffuse=0,Q.uniforms.color=Ql(B.s("shape3d.reflector.color")||"rgb(128,128,128)"),Q.uniforms.textureMatrix=e.toArray(),Q.uniforms.modelMatrix=S?g:$f(B),Q.uniforms.viewMatrix=Bm(v),Q.uniforms.projectionMatrix=Am(v);var X=R._reflectorVbuffer;X.upload(),Q.attributes.pos.pointer(X);var q=this.s("shape3d.transparent");if(q){var _=Zq.for(j).glState,b=_.depth.mask;_.depth.mask=!1}return j.drawArrays(j.TRIANGLES,0,X.data.length/3),q&&(_.depth.mask=b),B._reflecting=!1,j.useProgram(v._prg),ef(j,E),!0}}()}),rl.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), base.a );","}"].join("\n")};var mt=function(e,k){cb(mt,this,[e,k])};gd(mt,lt,{_80o:function(){}});var nt=function(P,e){cb(nt,this,[P,e])};gd(nt,kt,{_25Q:1,validate:function(H){var G=this,L=G.s;if(L(Jb)!==Rg||L("batch")!=E||!G.info||G.data._needChangeGeometry){var W=G.gv,j=G.data,n=L("edge.width"),z=j._40I,x=j._41I;if(j._needChangeGeometry=G.shapeModel=G.info=G.lineShapeModel=E,z&&x){var o,R,O,X,g,b,m,s,i,$,T=j.isLooped(),S=L(Ig),y=K.getEdgeType(S);if(y){var A=y(j,kr(G,W,j,T,S),W,G._19Q);if(!A.points||A.points.isEmpty())return;b=G.info={},m=A.segments,g=A.points,s=g.size();for(var h=z.getElevation(),D=x.getElevation(),r=0;s>r;r++){var l=g.get(r);l.e==E&&(l.e=h+(D-h)*r/(s-1))}i=Ai(g.get(0)),$=Ai(g.get(s-1));var J=s%2,B=(s-J)/2;b.c1=Ai(g.get(B-1)),b.c2=Ai(g.get(B)),0!==J&&(b.p3=b.c2),b.s1=i,b.s2=Ai(g.get(1)),b.t1=Ai(g.get(s-2)),b.t2=$}else{g=new oc,b=G.info={};var Q=L("edge.offset"),C=L("edge.center"),e=L("edge.source.t3"),N=L("edge.target.t3"),w=Mr(W,j,"source"),M=Mr(W,j,"target");if(!w||!M)return W.invalidateData(j),delete G.info,!1;if(e&&(w[0]+=e[0],w[1]+=e[1],w[2]+=e[2]),N&&(M[0]+=N[0],M[1]+=N[1],M[2]+=N[2]),S===Qr){m=L("edge.segments");var c=b.points=L(rs)||Kd;if(s=c.size()){if(i=Ai(c.get(0)),$=Ai(c.get(s-1)),!C&&Q){var f=Q;O=tf(i,w,!0),Q=I(f,nk(w,i)),w=[w[0]+O[0]*Q,w[1]+O[1]*Q,w[2]+O[2]*Q],O=tf(M,$,!0),Q=I(f,nk($,M)),M=[M[0]-O[0]*Q,M[1]-O[1]*Q,M[2]-O[2]*Q]}if(1===s)b.p3=i;else{var J=s%2,B=(s-J)/2;o=Ai(c.get(B-1)),R=Ai(c.get(B)),0!==J&&(b.p3=R),b.s1=w,b.s2=i,b.t1=$,b.t2=M}}else!C&&Q&&(O=tf(M,w,!0),X=nk(w,M),Q=Er(Q,X),w=[w[0]+O[0]*Q,w[1]+O[1]*Q,w[2]+O[2]*Q],M=[M[0]-O[0]*Q,M[1]-O[1]*Q,M[2]-O[2]*Q]),o=w,R=M;g.add({x:w[0],y:w[2],e:w[1]}),g.addAll(c),g.add({x:M[0],y:M[2],e:M[1]})}else{var v=kr(G,W,j,T,S);if(G._19Q||(v=-v),T){var u=w[0],d=w[1],U=w[2],t=z.getTall()/2+v;o=[u-v,d+t,U],R=[u+v,d+t,U],g.add({x:u-v,y:U,e:d}),g.add({x:u-v,y:U,e:d+t}),g.add({x:u+v,y:U,e:d+t}),g.add({x:u+v,y:U,e:d})}else{O=tf(M,w,!0),X=nk(w,M);var p={x:w[0],y:w[2]},V={x:M[0],y:M[2]},k=Mc(E,p,V,v),q=k.x-p.x,P=k.y-p.y;Q=Er(Q,X),O[0]*=Q,O[1]*=Q,O[2]*=Q,o=[w[0]+O[0]+q,w[1]+O[1],w[2]+O[2]+P],R=[M[0]-O[0]+q,M[1]-O[1],M[2]-O[2]+P],C?(g.add({x:w[0],y:w[2],e:w[1]}),g.add({x:o[0],y:o[2],e:o[1]}),g.add({x:R[0],y:R[2],e:R[1]}),g.add({x:M[0],y:M[2],e:M[1]})):(g.add({x:o[0],y:o[2],e:o[1]}),g.add({x:R[0],y:R[2],e:R[1]}))}}b.c1=o,b.c2=R}b._lastPointsSegments={points:g,segments:m},b.list=L(Jb)===Rg?G.createTubeModel(g,m,n/2,H):G.createLineModel(g,m,n,"edge","edge.dash")}}},invalidateCachedGeometry:function(){this.info=E}});var ot=function(N,e){cb(ot,this,[N,e]),this._needRecoverPosition=!0};gd(ot,lt,{_80o:function(j,S,Q){var C=this,d=C._matWithExtraction||C.mat;if(d&&(!C.s("shape3d.reflector")||j._picking)){var h=C.gv,t=C.shapeModel;qs(h,d),t?cr(h,C.data,t,C,C.getBodyColor(),Q):(In(C,j,S,"left",Q),In(C,j,S,"front",Q),In(C,j,S,"right",Q),In(C,j,S,"back",Q),In(C,j,S,"top",Q),In(C,j,S,"bottom",Q)),Vh(h)}},validate:function(N,v){var I,n,o=this,e=o.s,B=o.data,w=B._thickness/2,f=B.isClosePath(),k=B.getPoints(),a=B.getSegments(),G=e(Vi),p=N&&N.uv;if(o.invalidateUnstableWireframe(),o.clear(),o.dispatchBoundingBoxChanged(),K.extractShapeTranslation||K.extractVerticesTranslation){var _=new Uj.Vector3(B.p3());k=fo(k),k.forEach(function(o){o.x-=_.x,o.y-=_.z}),o._vsTranslation=(new Uj.Matrix4).setPosition(_);var H=B.getShapeElevation;B.getShapeElevation=function(){return-(this.getTall()||0)*(this._anchorElevation-.5)}}else o._vsTranslation=null;if(0>w){o.s("shape3d.reflector")&&(o._reflectNormal=null);try{var t=e("shape3d.image.projection");if(t&&t[4]){var R=B.p3(),C=R[0],g=R[2];t=[C+t[0],t[1]+g,C+t[2],t[3]+g]}n=o.shapeModel=Yl(k,a,e(_g),e(pm),G,e(hp),B.getTall(),B.getShapeElevation(),f,t)}catch(M){n=o.shapeModel={}}e(Bg)?e("shape3d.image")||delete n.uv:(delete n.vs,delete n.ns,delete n.uv),e("shape3d.top.image")||delete n.top_uv,e("shape3d.bottom.image")||delete n.bottom_uv}else if(e(Jb)===Rg)I=_h(k,a,G,f),n=o.shapeModel={vs:[]},e("shape3d.image")&&(n.uv=[],n.sum=e(hp)||Dc(I)||1,n.len=0),e(_g)&&!f&&(n.top_vs=[],e("shape3d.top.image")&&(n.top_uv=[])),e(pm)&&!f&&(n.bottom_vs=[],e("shape3d.bottom.image")&&(n.bottom_uv=[])),o._12O(I,w);else{var i,U,F,W,Q,r,Z,d,D,T;if(I=_h(k,a,G,f),Q=o.vf(Yp,p,!1,v),w&&(r=o.vf(mc,p,!1,v),Z=f?E:o.vf(zi,p,!1,v),d=f?E:o.vf(es,p,!1,v),D=o.vf(Mo,p,!1,v),T=o.vf(de,p,!1,v)),w){for(var P=0,b=I.length;b>P;P++)I[P]=o._tryRemoveBezierPoints(I[P],w);o._12O(I,w)}else Q&&I.forEach(function(d){if(W=d.length,W>0)for(i=d[0],F=1;W>F;F++)U=d[F],o.addV(Q.vs,i,U),i=U});o._20Q(I),N||(Q&&(Q.ns=Gd(Q.vs),Hi(Q,"vs"),Hi(Q,$c)),w&&(r&&(r.ns=Gd(r.vs),Hi(r,"vs"),Hi(r,$c)),Z&&(Z.ns=Gd(Z.vs),Hi(Z,"vs"),Hi(Z,$c)),d&&(d.ns=Gd(d.vs),Hi(d,"vs"),Hi(d,$c)),D&&(D.ns=Gd(D.vs),Hi(D,"vs"),Hi(D,$c)),T&&(T.ns=Gd(T.vs),Hi(T,"vs"),Hi(T,$c))))}var c=o.mat=B.getPointsMatrix3d().getElements();o._vsTranslation?c=o._matWithExtraction=(new Uj.Matrix4).fromArray(c).multiply(o._vsTranslation).toArray():o._matWithExtraction=null,N&&(o.gv.getWireframeGeometry(B)&&(o.wfGeometry=Ch(o,n),o.wfMatrix=c?mf(c):null),ys(o,c,N,n,v),o.clear()),H!=E&&(B.getShapeElevation=H)},_20Q:function(q){var r,D,B,Y,W,l,Z,f,F,b,$,L,N,e=this,o=e.front,c=e.back,V=e.top,i=e.bottom,U=o?o.tuv:E,j=c?c.tuv:E,n=V?V.tuv:E,K=i?i.tuv:E,g=0,J={front:0,back:0,top:0,bottom:0};(U||j||n||K)&&(N=e.s(hp),r=N||Dc(q)||1,$=e.s("all.uv.union"),q.forEach(function(M){if(D=M.length,D>0){for(b in J)L=e.s(b+".uv.union"),(L===!1||L==E&&$===!1)&&(J[b]=0,N||(r=Dc([M])));for(l=M[0],B=1;D>B;B++){Z=M[B],f=nk(l,Z);for(b in J)g=J[b],Y=g/r,J[b]=g+=f,W=g/r,"back"===b&&(F=Y,Y=1-W,W=1-F),e._14O(e[b],Y,W);l=Z}}}))},_14O:function(c,l,j){if(c){var C=c.uv,U=c.tuv;if(U){if(C)var R=C[0]+(C[6]-C[0])*l,$=C[1]+(C[7]-C[1])*l,e=C[2]+(C[4]-C[2])*l,o=C[3]+(C[5]-C[3])*l,f=C[2]+(C[4]-C[2])*j,r=C[3]+(C[5]-C[3])*j,p=C[0]+(C[6]-C[0])*j,V=C[1]+(C[7]-C[1])*j;else R=l,$=0,e=l,o=1,f=j,r=1,p=j,V=0;U.push(e,o,f,r,p,V,p,V,R,$,e,o)}}},_13O:function(i){var S=i.uv,C=i.tuv;C&&(S?C.push(S[2],S[3],S[4],S[5],S[6],S[7],S[6],S[7],S[0],S[1],S[2],S[3]):C.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(o,J){var f=o.length;if(4>f)return o;var X,C,Z,n,q,d,Y=!1,P=function(z){return o[z]},j=function(r){return o[f-1-r]};for(q=0;1>=q;q++)for(d=q?j:P,C=d(0),Z=d(1),X=2;f-1>X;X++)if(n=d(X),!n.remove)if(n.b){var i=Mc(C,Z,n,J);i.adjust?(n.remove=!0,Y=!0):(C=Z,Z=n)}else C=Z,Z=n;if(!Y)return o;var v=[];for(X=0;f>X;X++)o[X].remove||v.push(o[X]);return v},_12O:function(e,M){var l,s,O,c,P,b=this.s("shape3d.point.epsilon"),_=this;e.forEach(function(Z){if(P=Z.length,P>0)for(l={p:Z[0],n:!0},c=1;P>c;c++)s=Z[c],O=P-1>c?Z[c+1]:E,O&&Math.abs(s.x-O.x)<b&&Math.abs(s.y-O.y)<b||_.addPoint(l,s,O,M,Z)})},addPoint:function(d,f,t,i,I){var G,u,j,U,R,x,A,J,a,M=this,q=d.p,n=d.f,N=d.b,m=M.s("shape3d.side")||Lb,P=M.s("shape3d.start.angle"),B=M.s("shape3d.sweep.angle"),e=M.shapeModel,X=M.data.isClosePath();if(d.n&&(d.n=!1,n=X&&I.length>2?Mc(I[I.length-2],q,f,i):Mc(E,q,f,i),N=Nl(q,n),e?e.top_vs&&M._10O(N,n,m,P,B,e.top_vs,e.top_uv):(G=M.left)&&(M.addV(G.vs,N,n),M._13O(G))),u=t?Mc(q,f,t,i):X&&I.length>2?Mc(q,f,I[1],i):Mc(q,f,E,i),j=Nl(f,u),e){var z,D,O=e.vs,k=e.uv,W=e.sum;for(k&&(z=e.len/W,e.len+=nk(q,f),D=e.len/W),x=M._9O(N,n,m,P,B),A=M._9O(j,u,m,P,B),J=0;m>J;J++)a=J+1,Zn(O,x[a]),Zn(O,A[J]),Zn(O,x[J]),Zn(O,A[J]),Zn(O,x[a]),Zn(O,A[a]),k&&(U=J/m,R=a/m,k.push(z,R,D,U,z,U,D,U,z,R,D,R));!t&&e.bottom_vs&&M._10O(j,u,m,P,B,e.bottom_vs,e.bottom_uv,!0)}else!t&&(G=M.right)&&(M.addV(G.vs,u,j),M._13O(G)),(G=M.front)&&M.addV(G.vs,n,u),(G=M.back)&&M.addV(G.vs,j,N),(G=M.top)&&M.addH(G.vs,n,u,j,N,!0),(G=M.bottom)&&M.addH(G.vs,N,j,u,n);d.p=f,d.f=u,d.b=j},_10O:function(p,A,Y,o,G,k,c,O){var H,w,s=this,V=s.data,e=s._9O(p,A,Y,o,G),h=(p.x+A.x)/2,y=(p.y+A.y)/2,F=V.getShapeElevation(),x=0;for(x=0;Y>x;x++)O?(Zn(k,e[x]),Zn(k,e[x+1])):(Zn(k,e[x+1]),Zn(k,e[x])),Zn(k,[h,F,y]),c&&(O?(H=a*(x+1)/Y+o,w=a*x/Y+o):(H=a*x/Y+o,w=a*(x+1)/Y+o),c.push(.5-.5*W(w),.5-.5*l(w),.5-.5*W(H),.5-.5*l(H),.5,.5))},_9O:function(S,h,v,B,F){var x,u,p=this,z=p.data,T=[],C=(S.x+h.x)/2,k=(S.y+h.y)/2,I=z.getTall()/2,L=z.getShapeElevation(),Y=0;for(F==E&&(F=a);v>=Y;Y++)x=F*Y/v+B,u=W(x),T.push([C+(S.x-C)*u,L+I*l(x),k+(S.y-k)*u]);return T},addV:function(m,R,c){var x=R.x,W=R.y,N=c.x,O=c.y,f=this.data,E=f.getShapeElevation(),h=f.getTall()/2;m.push(x,E-h,W,N,E-h,O,N,E+h,O,N,E+h,O,x,E+h,W,x,E-h,W)},addH:function(C,N,R,e,U,i){var h=this.data,V=h.getTall()/2,j=h.getShapeElevation()+(i?V:-V);C.push(N.x,j,N.y,R.x,j,R.y,e.x,j,e.y,e.x,j,e.y,U.x,j,U.y,N.x,j,N.y)},vf:function(Z,K,G,j){var F,U=this,o=U.gv.getFaceVisible(U.data,Z);return(G||o)&&(F=qc(U,Z,j),F.vs=[],F.tuv=o&&(F.texture||K)?[]:E,F.visible=o),F}});var pt=function(S,m){cb(pt,this,[S,m])},qt={},rt=function(w){return/\.(png|jpg|gif|jpeg|bmp|svg)$/i.test(w)};gd(pt,lt,{validate:function(){var D=this,I=D.gv,p=D.data,K=D.s,f=Ql(K("points.color")),J=K("points.size"),$=K("points.uv.offset"),i=K("points.image");!i||rt(i)||jr.test(i)||(qt[i]||(qt[i]=D._createCachedImage(i)),i=qt[i]);var R,A,X=p._modelDirty,Y=K("points.model");if(Y){if(D._lastShapeModel!==Y||!D.shapeModel){var E=wq(D,Y);if(!E)return;var M=[],C={};D.eachShapeModel(function(E){for(var I=0,R=E.length;R>I;I+=3){var q=E[I],N=E[I+1],a=E[I+2],Q=""+q+"_"+N+"_"+a;C[Q]||(C[Q]=!0,M.push(q,N,a))}},E),D._setShapeModelPoints(new Ui(M)),D._lastShapeModel=Y,X=!0}R=D.shapeModel.vs.length,A=R/3}else{var r=p.getPoints();if(A=R=r.length,X||p._pointsDirty||!D.shapeModel){for(var N=[],V=0;A>V;V++){var t=r[V];t&&N.push(t.x,t.e,t.y)}D._setShapeModelPoints(new Ui(N)),p._pointsDirty=!1,D._lastShapeModel=null,X=!0}}if(D.info={mat:$f(p),size:J,diffuse:f,opacity:K("points.opacity"),texture:i,alphaTest:K("points.transparent")?0:K("alphaTest"),uvScale:K("points.uv.scale"),uvOffset:$,discardSelectable:K("points.discard.selectable")},X||p._colorsDirty){var c=!1,d=p.getColors();if(d&&d.length>0)for(var H=[],V=0;A>V;V++)for(var l=d[V],v=l?(c=!0,Ql(l)):f,q=4*V,b=0;4>b;b++)H[q+b]=v[b];D.shapeModel.cs=c?new Ui(H):null,p._colorsDirty=!1}if(X||p._sizesDirty){var j=!1,W=p.getSizes();if(W&&W.length>0)for(var w,F=[],V=0;A>V;V++)w=W[V],w>=0?(F.push(w),j=!0):F.push(J);D.shapeModel.ss=j?new Ui(F):null,p._sizesDirty=!1}if(X||p._offsetsDirty){var L=!1,k=p.getUvoffsets();if(k&&k.length>0)for(var h,B,s,g=[],V=0;A>V;V++)h=2*V,B=k[h],s=k[h+1],B!=P&&s!=P?(g.push(B,s),L=!0):g.push($[0],$[1]);D.shapeModel.os=L?new Ui(g):null,p._offsetsDirty=!1}if(X||D._lastPointNumber!==A){this.dispose();var e=I.pickColorMap,m=D._startPickId=e._pickIdUsed;e._pickIdUsed=m+A;for(var N=[],V=0;A>V;V++){var T=m+V,u=Ws(T);N.push(u[0],u[1],u[2],u[3]),e[T]||(e[T]={data:p,part:V})}D.shapeModel.ps=new Ui(N),D._lastPointNumber=A}p._modelDirty=!1,this.dispatchBoundingBoxChanged()},_setShapeModelPoints:function(k){var v=this,J=v.shapeModel,y=v.shapeModel={vs:k};if(!J)return y;var Z=k.length,h=Math.round(Z/3);return J.cs&&J.cs.length==4*h&&(y.cs=J.cs),J.ss&&J.ss.length==h&&(y.ss=J.ss),J.os&&J.os.length==2*h&&(y.os=J.os),J.ps&&J.ps.length==4*h&&(y.ps=J.ps),y},_createCachedImage:function(X){var l=128,z=ej(),j=z.getContext("2d");Gm(z,l,l,1),Pp(j,{width:l,height:l,comps:[{type:X,background:"white",borderWidth:0,rect:[0,0,l,l]}]},0,0,l,l);var A=h.Math.generateUUID();return xb[A]=z,A},_80o:function(m,N){var P=this,t=P.gv,n=t._picking;if(!n||t.isSelectable(P.data)){var y=P.shapeModel,w=P.info;if(y&&y.vs&&y.vs.length){var v=Zq.for(m);v.useProgram(P._asureProgram(m));var h=v.directUniforms(),u=v.directAttribs();h.modelMatrix=w.mat,h.modelViewMatrix=Cq([],t._viewMatrix,w.mat),h.projectionMatrix=t._projectMatrix,h.viewMatrix=t._viewMatrix,h.scale=t.getHeight()/2,h.size=w.size,h.diffuse=w.diffuse,h.opacity=w.opacity,h.map=t.getTexture(w.texture,P.data),h.alphaTest=w.alphaTest,h.resolution=t.getDevicePixelRatio(),h.discardSelectable=w.discardSelectable,h.uvScale=w.uvScale,u.uvOffset=!n&&y.os?Mk(m,t._buffer.os,y.os,E):w.uvOffset,h.blackout=m._blooming&&!P.data.s("bloom"),u.position=Mk(m,t._buffer.vs,y.vs,E),n?(h.picking=!0,u.pickColor=Mk(m,t._buffer.ps,y.ps,E),h.useColor=!1,u.color=null):(h.picking=!1,u.pickColor=null,y.cs?(h.useColor=!0,u.color=Mk(m,t._buffer.cs,y.cs,E)):(h.useColor=!1,u.color=null)),y.ss?(h.useSizeArray=!0,u.sizeArray=Mk(m,t._buffer.ss,y.ss,E)):(h.useSizeArray=!1,u.sizeArray=null),Mp(m,0,y.vs.length/3,m.POINTS),v.useProgram(N),u.disable(),t.shadowMap.enable&&t.shadowMap.createShadow(),t.flowMap.createFlow()}}},_asureProgram:function(f){return f._pointsShader||(f._pointsShader=this.gv._postProcessing.createShader(f,pt.shaderSrc)),f._pointsShader.program},dispose:function(){pt.superClass.dispose.call(this);var h=this._startPickId,b=this._lastPointNumber;if(h&&b){for(var S=this.gv.pickColorMap,C=0;b>C;C++){var P=h+C;S[P]&&delete S[P]}delete this._startPickId,delete this._lastPointNumber}}}),pt.shaderSrc="!!~v!oj<g*p!s{n/!onpbjuu5j!tnppQewfnm!N.b!u0s!jfym<bd!tv!o)j!g>p+s!nf!{njbTuu5o!jnppQe`fmmhW!j*f!xfNwbjuusdjfyq<ts!fvQotjjg!p)s!ng!jn!bu<5*!!q1s/p2k!f.d!u>j>p!o^N!b4u!s]j^y!<3!!]vyojjsgupbsNno!pnjbuud5f!kwpjsfqx!N)b!u>s!jfyw<ju!dvfoqjtgspfsQnt!jg!mmppbpuc!!tdbm~f!<<o!pbjuuuvsmjpctvfusf!!+w!ffd{4j!tq!p>t!jfu{jjpTou<ojp!Qv`omjhg!ps|n!!fctpmpfm!!~v!tf<Doppmjpusv<mp!tbfusu!s+j!czvbusfs!Bwff{dj5t!!d>p!mfp{sj<Tu!owjbpsQz`jmohh!!w|f!d*5z!bwsDspBmfp{sj<Tft!vb)u!ugsjj!cv<uofp!jwufjdt3p!QvwwnP!g+g!tyfjus<ub!Nwobpsjzujdofhk!pwsfqd!3>!!woPpgjgutjftup<Q`m!hv!oj<goppsjnu!jctpppQmw!nq!j+d!lyjjoshu<bN!xbfujuWsmjfcevpunf!!>w!fodp5j!uqjjtdplQDwpnm!ps<<*!1!/v2o!j-gepfsnns!pggmtpobbus!ut!j){5fd<fw!!v>o!jogppjsunj!tgpmQpwbnu!!5sdfftwp!mv<u*j!poop<ju!jvtopjqg!p)s4nd!fcwp!p>m!!evftnfsTpjg{tfoBbsssub!z4<df!wb!uu<s*jucfvtugfg!Pgwmvp)b3ud!ftwj!{>f!Busfstbgzg<Pw!!c~p!pm<!sjptmQpfds!t>q!fsdpumjpwDfwN!bu|s!j*ys)p!mnpbDuf5t!vn)!!*g!j|!f!tsmffu!vs~o!!n<]s!p3m!p^D]l!d4j!q^!!>>!>s!p.m!p2D/w1!<|!!~*ho!jwlpdjjeq!)n!bgjjo!)*|!^#!!~qs~f!dj<tsjppmop!Difjthvigqg!jgem!p>b!us<pm!p$DehfbgsjGo`fm!hV!TF|`!NfBtQmf!!v~o!jg<psspnm!pwDfwd!5>!!esjpgmgpvDthfb<sG!`vmohj!gp<sens!bgdmtpjbeu!!*p1q/b1d!j>u>z!<b/!svpomjpgDpfstnv!gggmjpeb)u!!gbjm!qi|b!U*fhtouj<ldj!qv)o!jggjp!sn<!ecspbpdmt!jvet!f*DuptmfpUsb<iq!mwbb!s=z!jbo/hs!pwmfpdD5f!twvDgpgmjpes)<!gj!!vogjjgeposfn$!!cp~p!m!<q*jwdvl!j-oqhb<n!!)vEo3jfgspvsuny!fcup!p>m+!!esjptmdpbDsfetTvfgmgfjdeu!bc<muff<tgg!Pvwo!j>g,p!swnv!!cp<pfmm!bcdmTbwdvl!p+v!ue<spp!DvuoojjgppQs`nm!hw!f>d!3w!vv!w3Tddfbwm!f<|!!*wfbmsczbjuodhf!mwffTde3s!bwdPtgjgetaf!u}<}!h$ojjgl!dejfqgaj)o!fgej)!!V*T!FQ`BNNB`QF!T*V!!)veofjogjpgsfne!!tgbjn$q!mf~s!3E<!*n!bzqu<jd$bfqope!j+g!b/wfptjveg!gnjbej!o-){*z!y|/f!tjvgg!g)jcem!b)d5ldpfvwu!*>!!|s!phmmp`DGfstbvhgDgpjmep!s!|>!!fwtfmdf5!)~1!/1<-*!!1z/u1j-d!b1q/p1!-+!!2b//1s*p<m!psDfwu!v-s{oz<y!/~spm!pwDfwd!5)!5edjfgwg!v>t!fsDppmmppDsf<tv!gjggj!e)!aq|j!d*lsjpomhp!D%f%t!v";var st=function(M,A){cb(st,this,[M,A]),this._needRecoverPosition=!0};gd(st,kt,{_25Q:1,validate:function(r){var W=this,e=W.data,j=W.s,G=e.getPoints(),B=G.size();W.dispatchBoundingBoxChanged();var H=e.p3(),Z=W.mat=Tc();sp(Z,H),Qc(Z,e.getFinalRotation3d(),e.getRotationMode());var O=e.getScale3d(),t=e._dynamicScale3d;if(t&&(O[0]*=t[0],O[1]*=t[1],O[2]*=t[2]),vc(Z,O),sp(Z,uf(H)),(j(Jb)!==Rg||j("batch")!=E||!W.shapeModel||e._needChangeGeometry)&&(e._needChangeGeometry=W.shapeModel=W.info=W.lineShapeModel=E,B>1)){var u=W.info={},o=e.getSegments(),i=e.getThickness(),k=Ai(G.get(0)),M=Ai(G.get(B-1)),F=B%2,a=(B-F)/2;if(u.c1=Ai(G.get(a-1)),u.c2=Ai(G.get(a)),0!==F&&(u.p3=u.c2),u.s1=k,u.s2=Ai(G.get(1)),u.t1=Ai(G.get(B-2)),u.t2=M,j(Jb)===Rg){if(K.extractPolylineTranslation||K.extractVerticesTranslation){var H=new Uj.Vector3(e.p3());G=fo(G),G.forEach(function(T){T.x-=H.x,T.e-=H.y,T.y-=H.z}),W._vsTranslation=(new Uj.Matrix4).setPosition(H),W._matWithExtraction=(new Uj.Matrix4).fromArray(Z).multiply(W._vsTranslation).toArray()}else W._vsTranslation=null,W._matWithExtraction=null;u.list=W.createTubeModel(G,o,i/2,r)}else u.list=W.createLineModel(G,o,i,"shape.border","shape.dash")}},invalidateCachedGeometry:function(){this.shapeModel=this.info=this.lineShapeModel=E},_80o:function(U,L,k){var M=this,W=M.shapeModel;if(W){var m=M.mat;(K.extractPolylineTranslation||K.extractVerticesTranslation)&&M._matWithExtraction&&(m=M._matWithExtraction);var y=M.gv;qs(y,m);var c,F=M.s("3d.clip.direction");if(y._uvClipEnabled&&("uv.left"===F||"uv.right"===F)&&(c=M.s("3d.clip.percentage"))<1){var Y=!0,o=!0;Lr(W);var r=W.top_vs,N=W.bottom_vs,a=W.vs,w=Zq.for(U),R=w.directUniforms(),Q=w.directAttribs();"uv.left"==F?(1>c&&(Y=!1),0>=c&&(o=!1)):(1>c&&(o=!1),0>=c&&(Y=!1)),W.top_vs=W.bottom_vs=P,Q.aUv=Mk(U,y._buffer.uv,W.uv,E,2),cr(y,M.data,W,M,M.getBodyColor(),k),Q.aUv=!1,R.uClipDirection=0,W.vs=P,Y&&(W.top_vs=r),o&&(W.bottom_vs=N),cr(y,M.data,W,M,M.getBodyColor(),k),W.vs=a,W.top_vs=r,W.bottom_vs=N}else cr(y,M.data,W,M,M.getBodyColor(),k);Vh(y)}}});var tt=h.graph3d.PostProcessing=function(K){var y,Z,$,H,W=this,e={},u=!1,F=!1;!function(){O.keys(tt).forEach(function(o){e[o]=new tt[o](K)})}(),W.getModule=function($){return $?e[$]:W},W.getModuleList=function(){return O.keys(e)},W.resetModules=function(){for(var J in e){var Y=e[J];Y.enable=!1,Y.resetProperties&&Y.resetProperties()}u=!1},W._serializable=!0,W.handleDataModleChange=function(E,$){E&&(W._serializable&&E.setPostProcessingData(W.serialize()),E.removeSerializeListener(W.onDataModelSerialize,W)),$&&($.addSerializeListener(W.onDataModelSerialize,W),W.deserialize($))},W.onDataModelSerialize=function(f){"serialize"===f.type?W._serializable&&(K.dm()._postProcessingData=W.serialize()):"deserialize"===f.type&&W.deserialize(K.dm())},W.isDeserializeDisabled=function(j){return!W._serializable||j.a("sceneBloom")!==P},W.isSerializable=function(){return W._serializable},W.setSerializable=function(l){W._serializable=l,l||K.dm().setPostProcessingData(P)},W.serialize=function(){var I,C,E,j,R={};for(C in e)if(E=e[C],j=E.serializeProperties){I={},E.enable&&(I.enable=!0);for(var G in j){var X=E[G];X!=j[G]&&(I[G]=X)}O.keys(I).length&&(R[C.toLowerCase()]=I)}return R},W.deserialize=function(M){var A,p,Q,O,f,t={},b={};for(A in e){Q=e[A],O=Q.serializeProperties;var x={},v="scene"+A,T=M.a(v);T!==P&&(x.enable=T);for(var f in O)T=M.a(v+f[0].toUpperCase()+f.slice(1)),T!==P&&T!==O[f]&&(x[f]=T);Cp(x)||(b[A[0].toLowerCase()+A.slice(1)]=x)}if(Cp(b)&&(b=M.getPostProcessingData()),b)for(p in b)if(p&&(A=p[0].toUpperCase()+p.slice(1),Q=e[A])){t[A]=!0,O=b[p];var H=!!O.enable;W.enableModule(A,H),A="scene"+A,M.a(A,H),Q.resetProperties&&Q.resetProperties();for(f in O)if("enable"!==f){var T=O[f];Q[f]=T,M.a(A+f[0].toUpperCase()+f.slice(1),T)}}for(A in e)t[A]||(Q=e[A],Q.enable=!1,Q.resetProperties&&Q.resetProperties())},W.getRenderTarget=function(){return y},W.blitScreen=function(t,c,v,P,X){var n=K.getGL();if(n&&(F||g())){t&&(t.bind(n),K.setViewport(n,0,0,t.width,t.height)),X&&X.clear===!1||n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),v||(v=Z),v.bind(),n.activeTexture(n.TEXTURE0+0),ef(n,c||n._emptyTexture);var p=v.uniforms;p.image=0;var m=1;if(P)for(var i in P){var A=P[i];A instanceof WebGLTexture&&(n.activeTexture(n.TEXTURE0+m),ef(n,A),A=m,m++),p[i]=A}if($.upload(),H.upload(),v.attributes.pos.pointer(H),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),m>1)for(;--m>=0;)n.activeTexture(n.TEXTURE0+m),ef(n,null);else ef(n,null);t&&t.unbind(n)}},W.decodeShader=function(a){var i,r,q,l="",m="";for(q=0;q<a.length;q++)i=a[q],"%"===i?i="'":"a"===i?i='"':"]"===i&&(i="\\"),r=String.fromCharCode(i.charCodeAt(0)-1),q%2?m+=r:l=r+l;return m+l},W.createShader=function(C,h,X){var q,Z;if("string"==typeof h){var f=h.indexOf("^#");q=W.decodeShader(h.substr(0,f)),Z=W.decodeShader(h.substr(f+2))}else q=h.vs,Z=h.fs;if(X){var V=X(q,Z);V&&V.vs&&(q=V.vs),V&&V.fs&&(Z=V.fs)}return new ff.Shader(C,q,Z)},W.enableModule=function(L,h){var G,K,B,b=L.split(",");for(G=0,K=b.length;K>G;G++)B=b[G].trim(),e[B]&&(e[B].enable=h);u=!1;for(B in e)if(e[B].enable){u=!0;break}};var g=function(){if(F)return!1;var U=K.getGL();return U?(y=new ag.RenderTarget(K,U,null,null,{samples:N.renderTextureSamples||1,minFilter:U.LINEAR,magFilter:U.LINEAR,depthFormat:K.isWebGL2()?U.DEPTH_COMPONENT32F:null}),Z=new ff.Shader(U,X.vs,X.fs),$=ff.Buffer.createIndexBuffer(U,new Uint16Array([0,2,1,1,2,3])),H=ff.Buffer.createVertexBuffer(U,new Float32Array([0,0,1,0,0,1,1,1])),F=!0):!1},X=W.blitScreenShaderSrc={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};W.contextLost=function(){F=!1;for(var l in e)e[l].contextLost&&e[l].contextLost()},W.render=function(n,j,C,a){if(u&&(F||g())){y.setSize(n,j,C),y.bind(n);var Y=n.getParameter(n.COLOR_CLEAR_VALUE);Y&&0===Y[0]&&0===Y[1]&&0===Y[2]&&0===Y[3]?Y=null:Wf(n,[0,0,0,0]),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),K.setViewport(n,0,0,j,C),a=a||{};var v=a.renderAxis!==!1,p=a.renderEdit!==!1;a.renderAxis=a.renderEdit=!1,K.renderScene(a),y.unbind(n);for(var U=0,N=K._glCapabilities.maxAttributes;N>U;U++)n.disableVertexAttribArray(U);var R,L=y;for(R in e)L=e[R]._42(n,L)||L;K.setViewport(n,0,0,j,C),Y&&Wf(n,Y);var $=W.getModule("Fxaa");return $&&$.enable?W.blitScreen(null,L.texture,$.getShader(n),{resolution:[1/j,1/C]}):W.blitScreen(null,L.texture),n.useProgram(K._prg),K._renderAxisAndEditHelper(v,p),!0
}}},ut=h.graph3d.PostProcessing.HueSaturation=function(l){function W(){var t=l.getGL();return t?(j=new ag.RenderTarget(l,t),a=l._postProcessing.createShader(t,ut.hueSaturationShader),Q=ff.Buffer.createIndexBuffer(t,new Uint16Array([0,2,1,1,2,3])),k=ff.Buffer.createVertexBuffer(t,new Float32Array([0,0,1,0,0,1,1,1])),A=!0):!1}var Q,k,a,j,e=this,$=!1,A=!1,o=[],v=[],i=[];this.serializeProperties={hue:[0,0,0,0,0,0,0],saturation:[0,0,0,0,0,0,0],lightness:[0,0,0,0,0,0,0]},this.resetProperties=function(){var Y=this.serializeProperties;for(var Q in Y)this[Q]=Y[Q]},this.resetProperties(),O.defineProperties(e,{enable:{get:function(){return $},set:function(y){!!$!=!!y&&($=y,l.iv())}},hue:{get:function(){return o.map(function(c){return X(180*c)})},set:function(g){if(o!==g&&7===g.length){for(var X=0;7>X;X++)o[X]=g[X]/180;l.iv()}}},saturation:{get:function(){return v.map(function(d){return X(100*d)})},set:function(A){if(v!==A&&7===A.length){for(var N=0;7>N;N++)v[N]=A[N]/100;l.iv()}}},lightness:{get:function(){return i.map(function(H){return X(100*H)})},set:function(T){if(i!==T&&7===T.length){for(var C=0;7>C;C++)i[C]=T[C]/100;l.iv()}}}}),e.contextLost=function(){A=!1},e._42=function(w,B){if($&&(A||W())){var K=B.width,D=B.height;if(K&&D){j.setSize(w,K,D),bg(w,j.frame),l.setViewport(w,0,0,j.width,j.height),w.clear(w.COLOR_BUFFER_BIT|w.DEPTH_BUFFER_BIT),a.bind(),w.activeTexture(w.TEXTURE0+0),ef(w,B.texture);var T=a.uniforms;return T.image=0,T.hue=o,T.saturation=v,T.lightness=i,Q.upload(),k.upload(),a.attributes.pos.pointer(k),w.drawElements(w.TRIANGLES,6,w.UNSIGNED_SHORT,0),ef(w,null),Pk(w),j}}}};ut.hueSaturationShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j*txj/psop!mipjdh!i-q*!mgtmip)bcuh<s3!mvtoij)g5pdsfnw!!t>b!nsqpmmfpsD3hEb!sjGn`bmhhf!<<!*w!bs*zfjhoohb!Swtftdf3o!uwiVhwj<m!-!^$1e]ftgtjfoofu!iNhBjYm`!S-B{O/HmFt!i8)t!t$feofugijhojfm!`SqBbOnH!F`-B*MfMh!o1bSo!pvjoujbgspvsunb!tg!m-p^b1u]!oipvjfu]bNsBvYu`bStB!O-HzF/^m<ti!)voopjjgupbssnv!ugbmtp`bqub!nt!bu-v*sfbhuojbpSof]vNiB!Y-`^S1B]OfHvFi^!<-y!/vmotjig)pfsvni!`gqmbpnb!u!)m4jdhfiwu!o>f!tmtt]iN!BY`~S!BO~H!F^<<lbf!sgcm!pb<u^!snfbuqo`vipvdf`)fgvmip]btut!fjoouWibhmjvmf!->!!gfmhpobbuS!titvffoBumimh-j!mg!mp<b^us!fiuvofvSpbdo`hffv*i!]|op!jgumbpsbvuu!bwtb!m>v!ff!h>o!bjSooWpbjmuvbfs!v,u!b)ti!vf<B^msmf!u,o!vipvdf`Sfbvoih]ff*v!i0!!>3!/f1h<obS!fjvgi!!)w|b!m*vffh!o=b!s1!/>1>*!!ssffuuovvspod!`wfbvmiv)f!!g,j!!2/|1!<*,!,fsmftufo!vjpgd!`)fwvbim!v<fF!H?O!B2S/`1Y*B!Ns!f=u!vssfou!owvbpmdv`ff!v.i!!2</11!<>!!sffmutofv!psdf`ufvvsio!!uwobjm)v!fs<pg!!~<!2g!m,p!bfuh!onbbsq!`>t!bfuhvosbbsu!jp<o1)!g>m!pfbhuo!bjso!W*b7m!v>f?-!!fghmopbbsu)!!tgbju!vs~b!uj~p!oB<mlmb-f!sgcm!pb<us!ftubouvvpsdb`ufjvpio!S>b!ofhhfo*b!s|!!|g!m*p6b/u1!!w,b!m*vsff!u>o!vjpodW`bfmvvif)!u+b!p)m2g/!1=!!,i!)t!bgujv!sb|u!j*p,o,Bsmfmu!o,v!ptdb`ufvvsib!u<jFpHoOSBbSo`hYfB*N<!=!!ssffuuvosvop!dd`mfbvniq!)<w1b!m>v!fs-f!u1o/v1p-d!`2f/v1i*!<uo!j~)!!sgpmgp!bu!<nfbhqo`bmSjthtifuooufithtj)mg!m-pfbhuo!bjSooWpbjmuvbfs-v!ugbmtp!b-uf!hmojbhSifuvoif!tutbBpmmmg-!!g<m1p!b>u!!fmhjohbisu!oufotjt!Sb<oehmfp*i!t|fs!igum`pfbvui!!wu!b>p!mmgj!hi<u1o/f7t!t+B!mym/!m,t!im!j>h!iiu!oufbtptmSgb!oh<f*<{z!yj/gs!p)mwp!d=)!m1t/i13*ch!ss!f>u!vmstoi!!j4odWfbwm!vf<!*+w!V)ww!!-,f!h2b/n1j*)<E3!ffsmvtufyf!us!f>u!vsspom!pjdo!W5bdmfvwf!!,|!!)*w)!o+j!b)n2!/e1j!p.w!!joW~b!mv<f**m*!<-t!!~-i!)g4mdpfbwu!!oisvvfu3fssh!c)~g!mp<b1u/!7g!20-!!ig!m>p!biu!!g~3!-!<g1m/p7b!u>!,i!vif!*!||!*!1j/g1!!)=i!vif)!!=g!j1!/1*~!!i<vbfu!m,f>E!d2!/01!<*h!!f.m!tsf)!!j,g!!1)/i5v!f>!!?i!!2/|1!*ft!mifv!f~!!.><!b2u/m1f<Ed!!g0m!p*bsu!!.s!fct)<!,!!j1g/!3)!)>7!/i1!!+|!!i*vyfb*N!d=!!>2>/!1h*)!!gsjf!tf!t>m!fg!2~!!,!<)bgu3m!f.E!dg!20*!!*+c!!7./!1h!)+!!>i!vif!<|!!f*mytbfN!dj!g>!>)!)s3)/!1g!j+!!iv<f***!o=j!N2d/!1,*!y!bsNfdt)!!>.!!g13/<3)!!f0m!tbfu!mjfgE!d)!);4!/*1o!j+N!di!v,f!*y!b=N!d3)/!10*!b!usmfftE!d>!!@g!26!/,1!!)=g!3m!!.>!!gt2!*!+<!o)j)N3d/!1.!!0y!b4N/d1!*>!!.b!uimvffE*d!!+u!b7p/m1g<!!|f!m*tofjN!ds!f?t!!y>b!Ngd2)<!g!js!fuv<s1o/!3s!f0t!<*o!j~Nd!!,w!fydb4N!di)t!m>3!smh!c)w<f*d*4c!!i-thm)*y!b|n!!-wsf)dy4b!ns!h>c!<ybN!dj!gu!b)pimtgm!/z<!*>*>c!!1-/h1)*o!j|n!!-ssh)co!j>n!!w>f!do4j)Nidt!mu/b{p*m<g!!~<!cf/mdt!f>!!|c!!ugbmppmbgu!!g<3h</d!!>j!gh!!)uibtpmm/g{!!=<!s1//d6!*>!!sg!3u!b>p!migt!m/<{1!/+1!!)>2!/m1!!u,b!pimtgm!/z<*1</1!!f>m!ttf!u!bgp3m!g>!!i<t1m//2{.!!,>!!iit!mu/bzp!m.g!!it|m!/*zd!!+4!diftwm)/m{t<i3c!hgsm!p4bduf!wg!2!>~!!3/<1c!h+s!!iotsmv/u{f!s.!!g~3!<<*!*s1h/c4/0s1!/>2!)i!v.f!3ys/hmct)ig!2--3!gg!3--2!gi)tcmh/sy3!f,v!i)!2>/!1c0/4c/h1s*!*<<*!ys/hmct/ih!!->3!gi!v-f23gs)hc";var vt=h.graph3d.PostProcessing.Bloom=function(M){function B(){var y=M.getGL();if(y)for(var I=M._postProcessing,u=0;X>u;u++)W[u]=I.createShader(y,vt._35Q,function(p,N){return{fs:N.replace(/DEFINE_VALUE/g,P[u]).replace("%OVERRIDE_ALPHA_DEFINE%",o?"#define OVERRIDE_ALPHA":"")}})}function V(){var N=M.getWidth(),H=M.getHeight();if(!N||!H)return!1;var Y=M.getGL();if(!Y)return!1;J=[N,H];var o,l=Math.round(J[0]/2),T=Math.round(J[1]/2);for(w=new ag.RenderTarget(M,Y,l,T),h=[],S=[],o=0;X>o;o++)h.push(new ag.RenderTarget(M,Y,l,T)),S.push(new ag.RenderTarget(M,Y,l,T)),l=Math.round(l/2),T=Math.round(T/2);var P=M._postProcessing;return x=P.createShader(Y,vt._34Q),B(),I=P.createShader(Y,vt._36Q,function(s,y){return{fs:y.replace(/NUM_MIPS/g,X)}}),n=P.createShader(Y,vt.finalShader),k=ff.Buffer.createIndexBuffer(Y,new Uint16Array([0,2,1,1,2,3])),i=ff.Buffer.createVertexBuffer(Y,new Float32Array([0,0,1,0,0,1,1,1])),z=!0}var H,c,f,o,t,k,i,p,T=this,y=!1,z=!1;this.serializeProperties={strength:1.5,threshold:.55,radius:.4,overrideAlpha:!0,selective:!1},this.resetProperties=function(){var A=this.serializeProperties;for(var x in A)this[x]=A[x]},O.defineProperties(T,{enable:{get:function(){return y},set:function(l){!!y!=!!l&&(y=l,M.iv())}},strength:{get:function(){return H},set:function(l){H!==l&&(H=l,M.iv())}},threshold:{get:function(){return c},set:function(j){c!==j&&(c=j,M.iv())}},radius:{get:function(){return f},set:function(E){f!==E&&(f=E,M.iv())}},overrideAlpha:{get:function(){return o},set:function(m){!!o!=!!m&&(o=m,z&&B(),M.iv())}},selective:{get:function(){return t},set:function(h){!!t!=!!h&&(t=!!h,M.iv())}}}),this.resetProperties();var w,x,I,n,J=[256,256],h=[],S=[],X=5,P=[3,5,7,9,11],W=[];T.contextLost=function(){z=!1,p=null},T._42=function(R,Y){function v(p,E,j,K){bg(R,E.frame),M.setViewport(R,0,0,E.width,E.height),K?K(R):R.clear(R.COLOR_BUFFER_BIT|R.DEPTH_BUFFER_BIT),l!==p&&p.bind();var v=0;for(var N in j){var F=j[N];F instanceof WebGLTexture&&(R.activeTexture(R.TEXTURE0+v),ef(R,F),F=v,v++),p.uniforms[N]=F}for(l!==p&&(k.upload(),i.upload(),p.attributes.pos.pointer(i),l=p),R.drawElements(R.TRIANGLES,6,R.UNSIGNED_SHORT,0);v--;)R.activeTexture(R.TEXTURE0+v),ef(R,null);Pk(R)}if(y&&(z||V())){var l;if(t){p||(p=new ag.RenderTarget(M,R)),p.setSize(R,Y.width,Y.height),p.bind(R);var D=R.getParameter(R.COLOR_CLEAR_VALUE);D&&0===D[0]&&0===D[1]&&0===D[2]&&1===D[3]?D=null:Wf(R,[0,0,0,1]),R.clear(R.COLOR_BUFFER_BIT|R.DEPTH_BUFFER_BIT),M.setViewport(R,0,0,Y.width,Y.height),R._blooming=!0,M.syncRenderState(),M.renderScene({renderAxis:!1,renderGrid:!1,renderEdit:!1}),R._blooming=!1,D&&Wf(R,D),p.unbind(R)}v(x,w,{smoothWidth:.01,luminosityThreshold:c,tDiffuse:t?p.texture:Y.texture});var s,O=w,b=Math.round(J[0]/2),$=Math.round(J[1]/2);for(s=0;X>s;s++)v(W[s],h[s],{colorTexture:O.texture,direction:[1,0],texSize:[b,$]}),v(W[s],S[s],{colorTexture:h[s].texture,direction:[0,1],texSize:[b,$]}),b=Math.round(b/2),$=Math.round($/2),O=S[s];return v(I,h[0],{blurTexture1:S[0].texture,blurTexture2:S[1].texture,blurTexture3:S[2].texture,blurTexture4:S[3].texture,blurTexture5:S[4].texture,bloomStrength:H,bloomRadius:f,bloomTintColor:[1,1,1]}),v(n,Y,{image:h[0].texture},function(H){Zq.for(H).glState.blend.apply({enabled:!0,equation:H.FUNC_ADD,func:[H.SRC_ALPHA,H.ONE]})}),Zq.for(R).glState.blend.apply({equation:R.FUNC_ADD,func:[R.SRC_ALPHA,R.ONE_MINUS_SRC_ALPHA,R.ONE,R.ONE_MINUS_SRC_ALPHA]}),Y}}};vt._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",vt._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",vt._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",vt.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var wt=h.graph3d.PostProcessing.Dof=function(n){function x(){var Q=n.getGL();return Q?(z=new ag.RenderTarget(n,Q),f=n._postProcessing.createShader(Q,wt._38Q),j=ff.Buffer.createIndexBuffer(Q,new Uint16Array([0,2,1,1,2,3])),y=ff.Buffer.createVertexBuffer(Q,new Float32Array([0,0,1,0,0,1,1,1])),R=!0):!1}function U(Z,V,J,P){d=null;var g=Z.getCanvas(),s=g.width,E=g.height;if(J=J||1024,s>J||E>J){var D=J/Math.max(s,E);s=Math.round(s*D),E=Math.round(E*D),m||(m=ej()),g=K.resizeImage(g,s,E,m)}var S=n.getGL();if(t||(t=S.createTexture()),e=De(S,g,t),Q=V||.01,F=!0,n.iv(),P--){if(d)return;d=K.callLater(function(){U(Z,V,J,P)})}}var z,f,j,y,e,Y,g,k,m,t,d,L=this,V=!1,R=!1,Q=0,F=!1,$=Uj.generateUUID();this.serializeProperties={aperture:.025,maxblur:1,image:null},this.resetProperties=function(){var F=this.serializeProperties;for(var y in F)this[y]=F[y]},O.defineProperties(L,{enable:{get:function(){return V},set:function(c){!!V!=!!c&&(V=c,c||(F=!1),n.iv())}},image:{get:function(){return Y},set:function(s){Y!==s&&(Y=s,F=!1,e&&(n.deleteTexture($),e=null),n.iv())}},maxblur:{get:function(){return g},set:function(r){g!==r&&(g=r,n.iv())}},aperture:{get:function(){return k},set:function(h){k!==h&&(k=h,n.iv())}}}),this.resetProperties(),L.contextLost=function(){R=!1,e&&(n.deleteTexture($),e=null)},L.setImageFromGraphView=function(x,H,b){this.image=null,U(x,H,b,2)},L._42=function(g,_){function l(p,$,K,w){bg(g,$.frame),n.setViewport(g,0,0,$.width,$.height),w?w(g):g.clear(g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT),i!==p&&p.bind();var H=0;for(var a in K){var R=K[a];R instanceof WebGLTexture&&(g.activeTexture(g.TEXTURE0+H),ef(g,R),R=H,H++),p.uniforms[a]=R}for(i!==p&&(j.upload(),y.upload(),p.attributes.pos.pointer(y),i=p),g.drawElements(g.TRIANGLES,6,g.UNSIGNED_SHORT,0);H--;)g.activeTexture(g.TEXTURE0+H),ef(g,null);Pk(g)}if(V&&(R||x())){var i;if(!e){var k=fl(this.image);if(!k||!k.comps&&!k.tagName)return _;h.Default.setImage($,k),e=n.getTexture($)}var T=_.width,H=_.height;if(T&&H)return z.setSize(g,T,H),l(f,z,{tColor:_.texture,tDepth:e,aspect:T/H,aperture:this.aperture,maxblur:this.maxblur,useG2d:F,threshold:Q}),z}}};wt._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vcupypfmu!!v>t,f!Hm3ped<<v*o!j5gspvsmnc!ggpmep!b+u!!*u!iusdfftsisppmdeu<dfvqotjbg!p+s!n*!!g:m3p/b1u.!!n-b:y3c/m1v.s!<)3vdofjwg!p)s!n,!!gzmyp/bwuV!wb!q-fsspumvpsDfu<!)vEo3jfgspvsuny!fgum!p>b,u!!mopfdbs<D*m!j5qs<vmvcogjpgep!s+n!!*g!mupdbfus!sgpbdsuDdmfjqqt<b!v+o!j*g!p1s/n1!!g-m5p/b1u.!!g)p3ddvftw<!)v!o,j!gzpys/nw!Vgwm!p-bsup!mbptDquf!d)uE<3fdspvoutyuf!ug!m>p,b!um!pVdoq<b*d!l5Espvxmoctgdpbem!f+!!>*!!3u6d6f/s!s0p!d3u6d7f/q<t!b0!0+!!1*/!/:23!/.1?!!-g:s3b/d1u.j!p)o3!d)ffwy!d)m!v,e!jzoyh/!w2V*w!d-psoptmup!Dwuf!d)4E!3QfbsdvluGybfduu!p>s,t!!m>p!dwf<d*4!)5!s3v6m7c/g!p+e!!3+6!7*/!!u+d!f3s6s7p/d-u!d3f6q7t/b!!++!!3*6!75//-1!.3!6-71//!1*!<)3ddpfowt!u)!!w,f!dz5y!/VwoVqwb!d-lsGpbmdpuDpus!t)!E>3!fVsovqubydfluE!p>x,o!tmdpbdmf<!*0!!5wsfvdm5c)g!pQeb!d+l!G*b!duudpfssts-p!d2u/d!f*q<tbg!m+p!b*u!!:v3o/q1b.d!l-S:H3C/B1U!p)E3fdqfuwi!))!!d,p!oztyu/!wjVow!!w-fsdp5m!pwD!u*!!)|E3!fssfvuuvysfou!!e>p,u!)m!pwd-!<V*o!q5bsdvlmGcbgdpuep!s+t!!**!<ud~fsgsmppdbuud!fhqftubE!f+q!u*i!)1!/d1p!o-t5u/!1j!o)!3wdffdw3!!)t!d,s!fzfyo/QwpVtwj!u-jsppom!p*D!u|!)\nEs3ffusvvsuoy!fvuo!q>b,d!lmSpHdCB<U*p!E5fsqvumic)g!puef!y+u!v*s!fu3dEf)s!supEdfuqdufiq-t!bt!d+s!f*f!o:Q3p/t1j!u-j:p3o/!1*!!)*3<df~w!g)m!p,b!uz!yq/fwsVtwq!f-dsupjmwpfDEuf!q)uEi3UfpsWvjufyxf[u)!!>d,p!omtpud!j<o*!!g8mspvbmuc!gjpoew!D+m!j*q![u-d!fdspsoptduu!djfoq!tgbm!p+b!u*!!o5f/b1s!--!1d/p1o!t)u3!djfow!!g)m!p,b!uz!yg/bwsV!w*!!-|sp!mspfDuuv!s)oE!3)f!sovfubysf!u+!!>g,b!sm!p*d!0<!*)!!8)s!vgmbcsg!p.e!!o+f!b*s!!u*d!f+s!sjpodwuDdmfjqqt[b!!.+!!g*b!s:!3*/<1.~!-g:m3p/b1u.!!h)f3udWfjwf!x)[!),!!dzpyo/twuV!wj!o-!sgpmmppbDuu!!e)fEq3ufis!v*u!y|fu\n!s>f,u!vmspod!q<f*s!t8qsfvdmucjgwpfeE!f+q!u*i!UupdWfjsfsxp[d)u!deffqqtubi!-+!!o*f!b1s/D1m!j-q5-/!1g.b!s)D3mdjfqw!!*)<!,~!zwyp/jweV!wn!b-jsop)m*p!D|u!w)fEd33f!sevpugycfmuv!s><,!wmfpdd3!<b*t!q8fsdvumdcpgspsef!d+u!!*>!!uwdffds3s)p!d2u/d1f-q!tbbt!q+f!d*u!!:*3</1j!g-!:)3v/t1f.E!f)q3udif*w!!|)!!,g!mzpyb/uw!Vwwj!f-xs[p!m>p!Dhuf!u)WEj3ffxs[v)u!yhffuu!E>f,q!umip)d!w<V*w!!8*s!v*m<cg!pgem!p+b!u*!!gubddfuspssp!d>u!d)f!qgtpbd!v+t!!*,!!5w/j1f.x![-!1*/<1!!)e3pdgfcwm!v)s!!,>!!zwyf/dw3V!w)!!-dsmpbmnpqD)u!!g)bEd3ufpssv!u+y!fbuq!f>s,u!vmspfd-!<.*n!b8yscvmmvcsg-p!en!b+y!c*m!vusd!f*s!s*p<du~dffqmttbf!!+|!*w!f:d35/!1u.f!y-f:m3!/>1!!u)f3ydufvws!f)3!E,)!!zuyE/fwqVuwi!--!swpfmdp3D)uw!V)wE/3yf-s!v2u/y1f!u.!!>w,V!wm/pzd*!<**<!8gsmvpmbcug!pbem!q+i!b*<!ujdgf!s)svptdfuHd3feq*t!b|!+b!m*q!i1b/!1>!!-t1n5p/p1u!i)t3udffqw)!!)u!i,s!fztyi/pwmVew-!!-usipsmfptDiup!m)eE!3,f!s1v/u1y2f-u!!u>f,y!fmmp/db!<**<!8~s!vfmmctgfp!e|!!+b!m*q!iubd!f>s!supfdyufdmf/qbt<b!!~+!!*e!p:g3c/m1v!s-!:>3!/w1f!d)33!d)f!wd!m)b!n,q!)z!yb/mwqViwb!!-+s!pbmqpfDsuu!v)sEf3-f!s.vnubyyfcum!v>s,-!!mnpbdyc<m*v!s:!s*v!m*c<gp~e!w+f!d*3!!uedpfgscsmpvdsu:d!f>q!tebp!g+c!m*v!s8!4+/!11./!:-<62w/f1d!3)!3edpfgwc!m)v!s,8!!z>y!/ewpVgwc!m-vssp!m+p!D1u/!8)<E3wffsdv3u!yefpug!c>m,v!sm5p!d>!<e*p!g:csmvvmsc!g+p!e1!/+5!<*!wufddf5s!sdppdmu!d>f!qwtfbd!5+)!!*1!/612!/*1<.!d-p8m4!/,1>.!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!16/25/!1*!!-+8!4b/t1q!f)d3uddfpws!s)f!d,u!!z*y!/+w!Vewp!g-csmpvmsp!D*u<!)dEp3mf!s,v>u!yuffuy!u>v,s!fm3pEd)!<u*D!p:mspvsm-c!gwpVew!/+y!z*!!,u!d)f!swsfpdd3u)d!f1q/t2b6!-+!!1*/!4884!/*1!!+-!6b2t/q1f.d!u)d3pdsfswf!d)u!!,*!!z+y!/ewpVgwc!m-vssp!m*p<Dud!p)mE!3,f>s!vuufyyfuuv!s>f,3!Em)p!duD<p*m!p:ss-v!mwcVgwp/ey!z+!!,*!!)u!dwffsds3p)d!u1d/f3q:t-b!!1+/!3*:!!8*4!/+1!.b!t-q6f2d/u1d.p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!6+2!/b1t.q!f-d8u4d/p1s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b6t2q/f1d!u-d8p4s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/:yszv!m,c!g)p!ew!f+d!3*)!!u1d/f4s8s-p!d.u1d/f2q6t!b*!!++!!*b!t8q4f/d1u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s3s:p-d!u.d1f/q3t:b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d.f1s/s2p6d-u!d.f1q/t4b8!!+*!!*+!!:b3t/q1f.d!u-d:p3s/s1f.d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfssfv3uEy)f!uu!D>p,m!pmsp-d!w<V*w!/syvzm!c,g!p)e!!w+f!d*3!)u!d1f/s1s-p!d.u1d/f5q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!s,v!m)c!gwpfed!3+)!!*.!1u/d2f6s-s!p1d/u4d8f!q*t!b+!!+b!t*q!f1d/u1d!p-s5s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!yszv!m,c!g)p!ew!f+d!3*)!!u.d1f/s3s:p-d!u1d/f3q:t!b*!!++!!*b!t6q2f/d1u!d-p8s4s/f1d!u)!3*d!f+w!!e)p!g,c!mzvys/!w*V<w!d-psmp!m,p>D!uu!f)yEu3vfs";var xt=h.graph3d.PostProcessing.Blur=function(u){function X(){var c=u.getGL();return c?(H=new ag.RenderTarget(u,c),G=u._postProcessing.createShader(c,xt.hBlurShader),J=u._postProcessing.createShader(c,xt.vBlurShader),f=!0):!1}var G,J,H,q,b,Q,Y,N,l,I=this,h=!1,f=!1;this.serializeProperties={value:0,downSample:!1,iterations:1,layer:"main"},this.resetProperties=function(){var d=this.serializeProperties;for(var O in d)this[O]=d[O]},O.defineProperties(I,{enable:{get:function(){return h},set:function(A){!!h!=!!A&&(h=A,A?u.addRenderLayerListener(y,this):u.removeRenderLayerListener(y,this),u.iv())}},downSample:{get:function(){return Y},set:function(W){Y!==W&&(Y=W,u.iv)}},value:{get:function(){return Q},set:function(w){Q!==w&&(Q=w,u.iv())}},iterations:{get:function(){return N},set:function(b){N!==b&&(N=b,u.iv())}},layer:{get:function(){return l},set:function(p){l!==p&&(l=p,u.iv())}}}),this.resetProperties();var y=function(X){if(h&&X.layer===l&&"post"===X.phase){var m=u.getGL();if(!u._picking&&!u.isReflecting(m)){var y=u._postProcessing.getRenderTarget();y.unbind(m);for(var v=0,Q=u._glCapabilities.maxAttributes;Q>v;v++)m.disableVertexAttribArray(v);I.drawImpl(m,y),y.bind(m),m.useProgram(u._prg)}}};I._42=function(){},I.contextLost=function(){f=!1,q=null},I.drawImpl=function(F,I,m,S,v){if(f||X()){var U,C;if(I?(U=I.width,C=I.height):(U=u._viewport[2],C=u._viewport[3]),U&&C){var c=u._postProcessing;"boolean"!=typeof S&&(S=Y),m==E&&(m=Q),v==E&&(v=N),v=Math.max(1,Math.round(v));var L=Zq.for(F).glState.depth,r=L.enabled;if(L.enabled=!1,S){m/=2;var K=[U,C];U/=2,C/=2,q||(q=new ag.RenderTarget(u,F),b=c.createShader(F,xt.downSampleShader)),q.setSize(F,U,C),c.blitScreen(q,I.texture,b,{texelSize:[1/K[0],1/K[1]]}),I.setSize(F,U,C)}else q&&q.setSize(0,0);H.setSize(F,U,C);for(var o=[],j=0;v>j;j++)o.push(m),m=Math.max(1,Math.floor(m/2));for(var j=0;v>j;j++){var l=o[v-j-1],s=S&&0===j?q.texture:I.texture;c.blitScreen(H,s,G,{value:l/U}),S&&j===v-1&&I.setSize(F,K[0],K[1]),c.blitScreen(I,H.texture,J,{value:l/C})}return L.enabled=r,I}}}};xt.hBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sz3/Ew!Vjwn!b-hffv<mb!ww!b+s!z1j/o5h!!,w!fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!zt/vwnV!w>!!-wffvdm5b)w!!1+/!11!/*4<!,!!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!!.<!655/313!2+/!1w!b+m!v*f!-*!!wzV/ww/Vzw!!*-!f*v!m+b!w1!/+1!612/<3!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!4</214!6+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*f!v+m!b1w/!1+:!219/<2!!,t!vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv!t.!!3</414!7+2!/w1b!m+v!f*-!!*w!Vzw//wzV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!!*.!!z2//w1V!w+!!-wfbvm",xt.vBlurShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<jntvjtp!o>!!isjphmipqD!hgbmspGb`um<h!!vo<j2g6p1s/n1!!t+b!n*q!m*f!sf3vEm!bjwn!b+h!f1</5!!w,b!szz/jwoVhw!!w-fyd/3w!VwwV!w)<3d!fvwo!j-gfphsbnn!jg!m)pEb3uf!swvbumyvffu<!>,!!wnpvjte!!n<b9j2o:)1*/!1|!+!!w*f!d*5!!ftvvmnb!w>!!+w!f1d/54)!!,1!/z1/!w*V<w!-!yt/vwnV!w,!>)!3udffywu!v-sffh3bEn)j!!j)nEb3hffs-v!uwyffdu3!)>!,w!Vnwv/ty!-!<w6V5w3/3z2!/.1!!5+/!1*!!+*!!wfbvmmvbfw!!*+!!*1!/+3!!1,/!1z6/2w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w2/4z6!2./!14!/+1!!*+!!*w!bfmvvmfb!w*!!+*!!1+/!21!/,1!:z2/9w<Vw!!t-vyn/!w,V>w!!u)f3ydufvws!f-3fEh)b!njjn!b)hEf3-f!swvfudy3f)u!!w>V,w!/nyv-t!!wV<w4/4z7!2./!13!/+1!!*+!!*w!bzm/vwfV!w*!!-*y!/+w!V1w/!2)333d5f6w<!-!fthvbnn!j,!>)!Eu3ffysuvvusyff3uE!)>!,j!nnbvhtf!-!<w2f4d632)/!1w!V+w!/*y!-*!!wfVvwm/bzw!!.+!!21/",xt.downSampleShader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd<j1t/j5p!o0!!i*j*h*i1q/!2g!m-p1b/u1<)3!dvfowj!g+p!sfn{!jtTbmnfqymffus!3,E!!wjVnwb!h-ff<hb!nwjb)sEz3jfoshv!uwyffdu3!!w,V!w*<*1!/v2o.j!g-p1s/n1!)w3fddf3w!!u+f!yff{mjTTjm{ffy<fu!!,w!pwjVew!!n-bfjhob)n*j)!E|3f!shvmu`yGfsub!hD,p!m*p*s1!/>1!!)-u1f/y2u.v)s3fd3fEw)!j+n!bfh{fj-T!mwfVywf!u,!!,u!fwyVfwm!T-jf{hfb!n+j!)wEf3df3s)v2u/y1f-u!!1/,1!**";var yt=h.graph3d.PostProcessing.Glitch=function(c){function a(){if(k&&M){y=Date.now(),z=0,r=1e3*q(M[0],M[1]),C=[];for(var D=1,l=k.length;l>D;D+=2)C.push((D>1?C[C.length-1]:0)+r*k[D]/V)}}function T(){c.redraw()}function d(){var $=c.getGL();if(!$)return!1;e=new ag.RenderTarget(c,$),_=c._postProcessing.createShader($,yt.Shader);for(var t=v*v,q=Le(v,v),d=q.getImageData(0,0,v,v),U=d.data,l=0;t>l;l++)U[3*l+0]=P(256),U[3*l+1]=P(256),U[3*l+2]=P(256),U[3*l+3]=P(256);return q.putImageData(d,0,0),x=De($,Ar),N=!0}var e,_,r,y,z,C,x,s,M,k,g=this,X=!1,N=!1,q=Uj.randomFloat,P=Uj.randomInt,V=0,v=64;this.serializeProperties={onlyReflector:!1,period:[2,3],intensity:[3,.3,1,.1,0,.4]},this.resetProperties=function(){var n=this.serializeProperties;for(var f in n)this[f]=n[f]},O.defineProperties(g,{enable:{get:function(){return X},set:function(m){!!X!=!!m&&(X=m,m&&a(),c.iv())}},onlyReflector:{get:function(){return s},set:function(u){!!s!=!!u&&(s=u,c.iv())}},period:{get:function(){return M},set:function(h){M=h,a(),c.iv()}},intensity:{get:function(){return k},set:function(v){v||(v=[1,1]),k=v,V=0;for(var T=1,U=v.length;U>T;T+=2)V+=v[T];a(),c.iv()}}}),this.resetProperties(),g.contextLost=function(){N=!1},g._42=function(o,L){if(X&&(N||d())){var p=!!c.isReflecting(o);if(p===!!s){var S=L.width,P=L.height;if(S&&P){var O=c._postProcessing,m=Zq.for(o).glState.depth,W=m.enabled;m.enabled=!1,e.setSize(o,S,P);var l,F=Date.now();F-y>C[z]&&(z++,z>=C.length&&a()),l=k[2*z];var I={seed:Math.random(),byp:l?0:1,tDisp:x};return l&&(I.angle=q(-Math.PI,Math.PI),I.distortion_x=q(0,1),I.distortion_y=q(0,1),I.amount=Math.random()/30*l,I.seed_x=q(-1,1)*l,I.seed_y=q(-1,1)*l),O.blitScreen(e,L.texture,_,I),m.enabled=W,requestAnimationFrame(T),e}}}}};yt.Shader="!!b~u!us<j*czv/utfp!qw!f.d!31!/q2p!t-<y/!twpbqs)z3jdofhw!!w>f!dw3V!ww!Vw<<*1/!2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+!!hzm/`tQppqt.j!u-j1p/o2!!>.!!w1f/d35!)+q!pyt/^#!!q~s!fd~j!tj<p*ow!Viwj!h-ifqh!bgnmjp)b!uE<3f!svvoujygfpus>ns!pjmopuD!hcbzsqG<`m!hv!oj|g!pfstnm!ft!bn~q!mf<sx3pEo!tj!n,bshpfm<pD!hvbosjGg`pmshn!!>t!bsnpqmmpfDsh3bEs!Gu`Emjht!q<<*3!/v1o+j*g*p/s1n6!+gemfpfbtu!!+b!ntpzv-oeuf<ft!!v+o!jtgyp)s3nd!fgwm)peboub!sb)o5hdmffw<+u!ovvopjngbp+s/n1!1g3m!p>b!ux!ptoftf!e5<df!wv!ojfgtpjspno!!gemepbb0u0!!tf<f*eb`/yb<hd!!v-ocj/gcpds!n-!hg/mbphbdu!!-tsf/fsed`)z5<df!wv!o>j!gsppsmnp!DghmbpsbGu`!mehj!tu<p*suufjtpgog`py!<.!!qv!o-jfghpbsnnj!)gEm3pfbsuv!ueyjftuu!p>s!ucjdp!o5`dzf<w!!v<o*jqg!p-sfnh!bgnmjp)bEu3!fdspvmu`ytf<u!>!!wbbhsdz!j5odhf!ww!fd<3*!uwfVtwg<gp!!,d!pqo!t-uf!hgbmnpjb)uE!3VfosqvbudylfEup!x>o!tsddb!m5fd!f>w!!36<6*/*!f0m!h3o6b7)/o<jt!!d-p*oftmuh!owbf)dt4p!dQ)b3ddlfGwb!d+u!pusotv!p>n!bw!f>d!4u)f!t3g6g7p/!!3+d!f3w6!7/s!f+e!b3i6t7!/u-g!j3i6t7!/C!H+S!!3n6p7s/g-!!f3t6b7c/0!0*!<<!*d/p6o0teuf!fwtf)d+5z!`Veofqfbtd+lmGbbndsuppos>t,!z>/!qV!oq<b*d/l6E0pexfofttd)b+myf`!e0f!fwtf+dm5b)n!sQpbod>l,Gyb/dqu!ps~t!-!~2!/!<**<y`!ogpmjpubsup!uvtojqeb!d,l!SyH/CqB)U!p.E!f/q2u!i>)!!yd/pqo!tu|!!jfot!mwff!d5~!!w!<*y!`|op!jsufsupvustoj!ee>pyu/)q!!w-|!*V/o1q?bzd`leGfbfdtu)pgsjt!!*|<!*!e~fft!+gtm`pmbpud!.szb`ooep)jwufsdp3u!tdjpe*?|y/!qs!f%u%v!sto`!mgpsdb,dzu`)otpjjou)seppuut)jdep=/yy/zq!)-gwjf!d3~)!23~/!:9<:z9`-o8p9j/u3s4p4u*t*j*e!!+>!!5z4/8q6!9/|6!5f6t4m*f<!!~~!<!*wzp`joep!jnubsjpou)t*j!e|!,!!jzg/)qc)z!q.=!2/*2!!|>!!zw/fqd!3!|q*!/>1!?wyV`we<ff!tg)mgpjb!u!|y!t*!e>f!fgtm+ptp`sm)phdm.`yG`sobphjDupsppsuet/jye!?0z!/1q/!6%*%<!t!`gmmppdb,uy!`zotp!j>u!sgpmuptpjse)=hzm/`qG)sgbjh!Dp<p*s*ee/fzf!t0+!e1f/f6t*+<q!!-gqmtpjbEuu!)o!pEs3nfbsmv!u>y!fvuo)qibudqlfSEHpCUB";var zt=h.graph3d.PostProcessing.Fxaa=function(A){var g,B=this,k=!1;O.defineProperties(B,{enable:{get:function(){return k},set:function(t){!!k!=!!t&&(k=t,A.iv())}}}),B.contextLost=function(){g=null},B.getShader=function(L){if(g)return g;var C=A.getPostProcessingModule();return g=C.createShader(L,{vs:C.blitScreenShaderSrc.vs,fs:C.decodeShader(zt.ShaderSourceFs)})},B._42=function(){}};zt.ShaderSourceFs="~!!q<sbf/d*jwtVjwp!o-!fihjbhnijq)!Eg3mfpsbvuu<yf!uv>obj/gsppsmnp!DthbbnsqGm`fmsh3!E!<j*n!bh*f1</1!)v5odjfgwp!sn-!1w/f1d!3!-s1f/t1p!mv-u1j/p1o!<-!4w4b9s1z/j1o!h!-w7f7d23/!1w!Vw-<68/!1$!ef-g*j1o/f1!)G5YdBfBw`!RV-B*M1J/U1Z)`5Qd1f!w2!/1-*!1$/e1f)g5jdoffw!!GY-BoBp`jRuVvBmMpJtUfZs`!Q2-!f2h/b6nj!!$e-ffghjbonfj!!GY-BfBh`bRnVjB!MJ-U*Z1`/Q13)!53d/f1w!!$-ewfVgwj!of)!sGfYeBbBi`TRmVfByMjJQUbZb`yQG4>!s5p/m1pD!h$besfGg`jmohf!!G|Y!B*B)`oRjVbBnM!JeUjZp`wQ!5!~2!3/<1*N!b$nevfmg!j-o{fz!yG/y*bNbtCppqp!m-!ycfpup)mqpU!y$feUfbgbjyoGf)!5GuybbpbmGGmbpbbyuG!!gomspvbuufs!!$e<foghjjoTfi!uGhyobfbmG!m+p!byuj3q!cwvfTdu3ft!g$gePfmgfjyojfq!>G,yzb/bNGtmppqb!u*4o!bwqfTd{4sp!i$!e)fggjj!of<!oGhyjbTbiGumhpobfum5!!+w!fydj5qcv!T$uefftggjgoPfm!fGyyjbqb>T,byu/)Nyt*p!qd!m*bonbqq)Ty{-s!p1i/a1)-g!j2!/1<**I!y$jeqfcgvjto!f-!eGpypbHbuUfftyg!gtPbmnfqymjfqs)3yEbn!>$yejfqgcjvoTfu!fGtygbgbPUmffyyUjpqq!)uub-p!mqG*b!buyfGy!uv<s1f/31E!);u!-u!fqt-g!g1P/m1f*yj!q$!e@f!gojboqfT!eGpypbhb>UefpypPHgugf)tug-g!Pqm-f!ypj-q!!su*b!pumfGybubvysGf!3E<)yuj-q!cqv,T)zpu!j+m!bsv*R-b!b1y/g1!*+!!HGyyjbqbcGvmtp>bIuy!jGqycbvbtM!vunbbp)mGGybbbbyGGm!pb<u65/!1s,h*c*bq*d!S|i!ushfoufvMsoob!qsth.c)b!/+z!<u!t~e)!>GuyfbtbgGgmPpmbfuy5j!qG!yubbbpQmjGybfbmyTGi!be<fGsy)jq!cGvytb!b+G!mGpybjuq3c!vqtp>tH-yj!qGcyvbtb!GumbppbmuG5b!bgyyGb!bD<pQootbpqmTfeQpppthQ!p;t!-Oo!bGqyTbebpUpfhy!!@u!fOyo-pj!uGdyfbsbjUef>yo!bgqyTbebpDppho!tmppmpfC4b7b1yUGf!yF<y*qQCujtbet!O-fOhuPtoef)-oj!nG>yubtbeU!fuyb!pgmyGbbbbDypGo!tp<mQfu4t7e1!U=f!yOFuytqeC>jObotpOjfuhdUfxspj-e!!mGpypbCbbGbmypGb!u3<!iguyhbobfRMvobbmqjtu0z1S/d2q>GqsdbSnifu-ho!fGMyobbbqGtm!pubbup5m!GgbybbybGD!po<tppsmff[SUdMqNGbsnbvnmf!P>qau!-*1!/G1y!b=b!GQmepobFub5n!vgmy)b>bQDopboqtTpempfpShd!qmGpspbCnbfbPyqGu!3-<*!OGuytbeb,GQmuptbeu)5>!iguyhbobfDMpoobtqptm!fu4b7p1mSGdbqbGysGb!nf<Ppqsuf3[-UM!NGbynbvbmG!m>pab!u*!1g/y1b!b=R!vObemojFubznTvvmc)q>jOyo-bq!TGeypbpbhG!mmppbpuC!bgbyybGb!Rv<bzm/jNutzpFqe.hzf/UQitspfqt>iQpumtee-!*!oGbyqbTb{Gsmppibau)!ggjy!bb<Rzv/bOmtjpuqz.Fze/hNftUpiqs>fOtuitpem!e*Nojboq-T{!sGpyibab)Ggmjp!bu<!yg/yNbtbpDqp.oyt/pQmtfpFqe>hQfuTtieb!suqbopfmtGtb-by!GG!yb<byG/mOptbpuq!.gyy/bNbtDppqo>tOpumtfeF!euhbfpUmiGsbfbtyiGp!me~-!!~G!yb~b!Gm<p5bQu`!ZgUyJbMbBDVpRo`tBpBmYfGF!e+h!fzU/iQsOfgtgipp>m,ezN/jQot-pq!!G*yQbfboGpmepab)ug5j!!gy<b5bQD`pZoUtJpMmBfV4R7`1BDBpYoGt!u+E!jys/Q!O*g!g|p>!,Gyy/bQbtGpmqp!b*uQ3f!oqppetaN)<gj!!qp<t*NQ/fyo>pqepat)/!y}<}!!*qOpftoNp/eza>)q>pQtO/fzo<pe!!Gy<b5bQG`mZpUbJuM5B!VsRh`cBzBNY>GG!y+b!bzU/fQyOUgpgqp)>u.fzy/-O!tqppqt!N**O<fo!p$eeaf)ggjjo!f!<m5vQn`bZNU!JsMhBcVzRN`/BzBY!GG!y+b!byG/mQpObgug!pm>v.nyb/TO>tGpyqb!b*MOvfnobp)eGay)bgbjU!fy<Pegfgm)budfTyu-o!fqjpetbNs-h!!G>y?b!b*GQmepobFub3n)v!m1)/t1c-b!>2Q/f1o*p-e!!gy<bebfRmvbbdmTjuuozfSjdeqbGsshb!n>f?/!y*zO*e*o<Fb!nGvymb)btGcmbp>bOuf!ompven!bF<>6G/y1b!b+M!vOnObb)nGvymb.bQUefoyFPbgngv)mu>fQye-o!FqbpntvNm-!!*GQyfbobpGemap)bguj3!)!<26//11-!!+1!/O1O*b-n!vgmy.bObeRovFbbmnjvumz>SOdeqoGFsbbnnvfm/!y*zO*f*o<pe!aG)ygbjb!Gm<p*b*uz!ym/vQntbpOq>!G-yybfbuM)vqnpbU)yGfyUbbbbUyfGy)Pbgngv)Mubfbyy-G!>qQpetoNF-b!nGvymb!b*GQmfpobpue3a))!g1j/!1-<.*2*/z1y*/-O!tgpyqb!b-Ryvfbum)jqupzUSydfqUGbsbbynGf)/bynzv*M*b<by!GG>yObeboGFmbpnbvum!!m*vOnfboXp>eGay)bgbjM!vn|b!)*GQyObfboUpfey)Pggjg!)u<f4yQ-`!ZqUpJtMNB-V!RG`yBbBbYGGm!p+b!uz3/)Q.O2g/g1p->!,1z//1Q*t-p!qg!y*bQbfRovpbemaj)ugzjS!dq<G4sQb`nZfU/JyMzB*V*R<`B!BGYyGb!b+G!myp/bQuO!gngbpy>T,Ny>/nQbtyp)qm!v*nQbfTo-p!emav)ngbjN!*<<*!QGfyobpbeGam)p!b}u}!!n*jOofToNp>enaj)o>)QmOvfnobpTe-!!m<v4nQb`NZ*U<JM!BGVyRb`bBGBmYpGb!u+!!nzb/yQFOTgNg>pn>b.yz)/mOvtnpbqF!-*!OnfboypTeNa*)<gj!!Gy<b4bQG`mZpUbJuM!BnVjRo`FBTBNY>Gn!j+o!)ym/vQnObgFg-p!>n.jyo/TONt*p<q!!*GOyfbobpGemap)bguj!!nb<yeXfOm>bndbTyu)omfvjnebbOs-h!!m>v?n!b*XQ*e<oF!bGnyvbmb)Gtmcpbb>uQ!fnojpoeX!O><nejfom)bmdvTnuboOf-j!embvsnhb!X>*?<!*!OGeyobFbbGnmvpmb)ut!csbb>oOhffoNpbey!>n<b6y/)1n!b+y!XOOO-b!nnvbmy.FQTeNo*F<bn!vGmy>bQbeGomFpbbnuv!ms!b*oQhffoNpjeoa>)ngjjo!)n<j6o/X1O!-+!!nOjOobFnTvNm*.<Oe!oGFybbnbvGmm>pObeuo!Fsbbnovhmf!N*bOyfTodpbemaf)eg>js!bo<h*f*Nzbyy/!Q+t!pgqy!b-byRfvub)mqjpuUzyFfeUhbfbUyiGs)fbtnivpMmbeb<yG!>GQyebobFGbmnpvbmu!!*sQbfoohpfe>as)bgojh!fN<b*y*.zsyb/oOhtfpNqj!o-<yf!uG)yqbpbUGymfpUbbub!ysGb)obhnfvNMbbybDymGb>nOqefoeF>bnnbvym)!g*yObfboRpvebam)jgujz!Fe|h!f*UQiOsffotpiep)mgejN!jo<-3!Qs`bZoUhJfMNBbVyRT`dBbBmYfGe!*+<!z!/GQyObgbgCpp>p,mz!/fQbtspmqz!F*yQjfuo>psebao)hgfj!!=!<s3bQo`hZfUNJbMyBDVmRb`nBqBfYeG<!+!!jyg/)QfObgsgmpz>F,yyj/uQ*tp!qs!f*uQvfsoop!esah)cgzjN!<<!*GQyfbobpGemap)b!u}!}m!v*nObfOoXp>eGay)b>bQMOvfnobp)eG!yb<b3UQf`yZPUgJgM)BuVfRy`-B!BqYpGt!N+-!!zG/yQbObgGgmpp>b.uz3/)O.t2p/q1!-*.O2f/o1p*e-a!)ggyjb!bR<v3bQm`jZuUzJSMdBqVGRs`bBnBfY/Gy!z+*!*y</Q!OGgygbpb>G.myp/bOut!pmqv!n*bOTfFo>pGeyab)bgMjv!nb<)eGfymbbbdUTfuyoPfgjge)busfhy!->!?q!p*tQNe-o!FGbynbvbmG)mtpcbbu>3Q)f!o2p/e1!-!<2e/f1m*b-d!TguyobfbjRevbbsmhj!u>z?S!d*qOGesobFnbfn/vymz)*t*c<b>!OGfyobpbeG!mp<b6u/!1m!v+n!bOOOFb>nGvymb.bQMevonFbb)nGvymb>bQUefoyFPbgngv)mu!f*yQ-f!oqppetaN)-g!jG!yb<b6G/m1p!b+u!3O)O!b2n/v1m-..O2e/o1F*b-n!vgmy>bObeRovFbbmnjvumz!S*dOqfGospbenaf)/gyjz!**<<**!zGyy/bQbtGpmqp!b-uy!fmuv)nqbpTUXy>fGUybbbbyMGv)nbbn)vGMybbbbyUGf>yQPegogF)bunfvym-!!*qQpftoNp-e!aG)ygbjb!Gm<p*b*uz3y)/.O2t/p1q-!!-2y/f1u*)-q!pgUyybfbURbvbbymGj)ubznSvdMqbGbsybGn>fO/eyozF*b*n<vm!!G*yObfboGpmepab)ug!jm!vn|b!O*TQ>OmfvonpbeO),gmjv!nb<T2<Q`!ZGUyJbMbBGVmRp`bBuB!YmGv!n+b!XzF/>QmOvgngbpX>,,mzv/nQbtFp<q!!*GQyfbobpGemap)bguj!!tv<c2qQj`yZSUdJqMSBbVoRh`fB>B2Y/G1!0+s!byo/hQfO<gg!pG>y,byb/GQmtppbqu!!*tQvfcoqpjeyaO)TgXjF!>m<v*nQbfOoTp,emav)n!b}X}F!<*O!fGoypbebaG)m>pQbOuf!ofpeeh!fmIpppsC{b2b>y)G.!3/<12!Q+`!ZmUvJnMbBNV*R,`mBvBnYbGO!T+<!z!/GQyObgbgGpm>p.bzu/!Oftephqf!W*fOsfuo2p>e)a.)3g/j1!!+<!2mQv`nZbUNJ*M,BmVvRn`bBXBFY<G!!+G!yyb/bQGOmgpgbpu>!.myv/nObtOpFqT!F*>OmfvonpbeOaF),gmjv!nb<TeFf<mb!dGTyubobfGjmepbbsuh!!m>v?n!b*OQXeOoFF>bmnvvnmb)OtXc,bm>vQnfboOpFe<!m!pGpyCbbbbGymGp!bu<!effemhbfdITpuso{f3j>e)b.s3h/!1>!?+!!*mOvenobFFb*n,vmmv)ntbcObF>TOFf<op!eG!ymbpbpGCmbpbbyuG!!fe<h6f/W1f!s+u!3O>O)b.n3v/m1>!.+Q!emovFnbbnOv*m,!mv<n6b/O1X!O+F!<OO!bGnyvbmb>G.mOpebouF!bmnvvnmb!OX<T1X/>1m!v=n!bNONXb,nmvvmn>bpTsXf<[U!MGNybbnbvGmm!pmbpup!CmbvbnybGT!XT<FF>ymjvqncbvTtX!,+m!vEnybjTqFc<vt!>GGyybjbqGcmvptb!uu!bfpemhGfbIbpysG{!5><)6b/c1t!)+f!eOhOfbInpvsm{.2N*b!n+v!m3>/N1N*b,nbvcmt!)ufbephmfGIbpbsy{G3!*<<1!/G5y0b1b/G2m!p+b!uu!offejhefbWsfhs>ue5f>m)bbdcTtu)offejhefbWsfhs!uu2b*p!m+G!b3b/y1G*!,b<cTtT)bfnevhmf>WOfOsbun3v*m<!*!OGsyjbbbqGam)pgbju!!f<e*h*fQItppsq{!4->y)f.u3)/q1p!U+y!fmUvbnbbyXG*),bmnvvnMbbObXyTGX><Qe!oGFybbnbvGmm!pubbup!mfGebhbfyWGf!su<4D>y)j.q3c/v1t!!++!!mDvynjbqTc*v,tm>vFnybjTqXcTvFt<!u!bGpymbGbbGbmypGb!u!<f*e*hOftIppqs!{->ybfcut))qfpeUhyffIUpbsb{y4G*),bfnevhMfbIbpysG{>5O<eo!FGbynbvbmG!mupbbpum!GfbebhyfGW!fs<u1>/b4c,t*)DfyejhqfcWvfts+u*41*/,3f.e)h)f>WEfysjuq5c<vt!!GuybbpbmGGmbpbbyuG!!tv<c1qQj`yZOUXJTMXBOVFRT`FB>BmYvGn!b+O!XzT/XQ,Omgvgnpb,OzF/TCFt<pq!>Gzy/bQbtGpmqp!bu<!1mQf`oZhUuJiMTBjVhRo`>BgByYbGb!R+v!bym/jQuOzgSgdpq,Gys/bCntfp/qy><y/!QGtypbqb!Cp<pQmt!piqp!s3{uTbqpbmoG>bfbeyhGf!Ip<s1{Q!`?Z>U!JfMeBhVfRW`fBsBuY<G!!+G!yzb/bQGOmgpgbpu.!zt/vCctqpjqy>Bz>/tOvtcpqqj!yO<T1XQF`!Z+U!J3M/B1V,Rt`vBcBqYjGy!O+X!TyX/OQFOTgFg<p.!yj/gC)tapiqp>sy{/TOqtbpoq*!!m<vOntbpOq>!m3vunbbpXm<Gb!bjygG)!ai<p6s/{1T!q+b!oo*h!jmTvinubhTo>fmmv>n,bzF/<Ct!pjqg!)*iopbsq{TT{qsbpoi*!!)mgfjo!hu<i6T/j1h!o+>!goyhbjbTRivubhmojfumz>S,dyq/GCstbpnqf!/*zo<bq!TG{ysbpbiGam)pgbju!!t<vzc/qfjnybCs>G)qtdvSczqujjymBb!v+R!b)b2y/g1!0;2!31//11*!*@.!m*vonbbqNT<{s!pGiy!b)b>Gzm/pQbOug!ghps!be<jyf/ofunOb>smGvqndbSOz.umjvmnbbvNR<bb!yGgy!b;b!G1m/p1b!u@!!h*sobbeqjTf{osupTi>am)v>nyb/TQ.Omgvgnpb!N<<Q!OGgygbpb!G3mupbbpum!GmbvbnybGO!O><mzv/nNbtOp,qm>vzn/bCNt<pq!!Gy<byb/GNmtppbqu>!ym/vCntbpTqT!>m<vCntbpTq,!m3vunbbpNm<Gb!bGyyGb!bC<p*pfmh!oqbbSjqsdOS>ybjcqtc)vhts!b+e!j*fCoyujOq*c!v?t>)!tbccbt))uhbsTbbebjyfGo>uDTy*j<qc!vGty!bubbGpmmpGbbub!yhGs!be<jofhojuT>inubhyo)fbmc.t>)ohhsjbTeijufhooufOm*!-*!Obscjtb)qh)sgbje!jf<o*u*T",Sn(K,{accordionViewExpandIcon:fh(Rc),accordionViewCollapseIcon:fh(Rc,!0),accordionViewLabelColor:Km,accordionViewLabelFont:Th,accordionViewTitleBackground:Lg,accordionViewSelectBackground:Yc,accordionViewSelectWidth:3,accordionViewSeparatorColor:P,splitViewDividerSize:1,splitViewDividerBackground:Lg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:wc,rect:[2,2,12,12],background:Rc}]},propertyViewLabelColor:Hq,propertyViewLabelSelectColor:Km,propertyViewLabelFont:Th,propertyViewExpandIcon:fh(vr),propertyViewCollapseIcon:fh(vr,!0),propertyViewBackground:Po,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:oi,propertyViewColumnLineColor:oi,propertyViewSelectBackground:Yc,listViewLabelColor:Hq,listViewLabelSelectColor:Km,listViewLabelFont:Th,listViewRowLineVisible:!1,listViewRowLineColor:oi,listViewSelectBackground:Yc,treeViewLabelColor:Hq,treeViewLabelSelectColor:Km,treeViewLabelFont:Th,treeViewExpandIcon:fh(en),treeViewCollapseIcon:fh(en,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:oi,treeViewSelectBackground:Yc,treeViewDoubleClickToToggle:!0,tableViewLabelColor:Hq,tableViewLabelSelectColor:Km,tableViewLabelFont:Th,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:oi,tableViewColumnLineColor:oi,tableViewSelectBackground:Yc,treeTableViewLabelColor:Hq,treeTableViewLabelSelectColor:Km,treeTableViewLabelFont:Th,treeTableViewExpandIcon:fh(en),treeTableViewCollapseIcon:fh(en,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:oi,treeTableViewColumnLineColor:oi,treeTableViewSelectBackground:Yc,tableHeaderLabelColor:Hq,tableHeaderLabelFont:Th,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:tl,tableHeaderBackground:Po,tableHeaderMoveBackground:ml,tableHeaderInsertColor:Yc,tableHeaderSortDescIcon:ad(vr,!0),tableHeaderSortAscIcon:ad(vr),tabViewTabGap:1,tabViewLabelColor:Km,tabViewLabelFont:Th,tabViewTabBackground:Lg,tabViewSelectWidth:3,tabViewSelectBackground:Yc,tabViewMoveBackground:ml,tabViewInsertColor:Yc,toolbarLabelColor:Hq,toolbarLabelSelectColor:Km,toolbarLabelFont:Th,toolbarBackground:Po,toolbarSelectBackground:Yc,toolbarItemGap:8,toolbarSeparatorColor:nq},!0);
var At={translateX:1,sortColumn:1},Bt={sortable:1,sortOrder:1,sortFunc:1},Ct={focusData:1},Dt={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Et={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Ft=function(T,n){n.add(T),T.hasChildren()&&T.eachChild(function(U){Ft(U,n)})},Gt=function(s,r,Y,T,F,c,u,V,o,y,U){var Q,p=Y.getValueType(y),W=Y.getAlign(y);if(Y.getEnumValues(y)){var C=Y.toEnumLabel(r,y),R=Qn||0,g=0,G=c,t=K.getTextSize(T,C).width;return Q=fl(Y.toEnumIcon(r,y)),Q&&(g=c+Qn/2,"center"===W?g+=(V-(R+t))/2:"right"===W&&(g=g+V-(R+t)),yb(s,Q,g,u+o/2,y,U),G=g+Qn/2),C!=E&&(Q?_k(s,C,T,F,G,u,V-(G-c),o):_k(s,C,T,F,c,u,V,o,W)),void 0}return r=Y.formatValue(r),r!=E?p===$h?(cs(s,c,u,V,o,r),void 0):p===Gb||!p&&mh(r)?(Q=fl(r?Oh:im),yb(s,Q,c+V/2,u+o/2,y,U),void 0):(_k(s,r,T,F,c,u,V,o,W),void 0):void 0},Ht=function(s,O){var p=O.view,t=_f(s),v=O.column||O.property;p.getDataModel().beginTransaction(),O.editor=s,s.info=O,p.setCurrentEditor(s),p.getView().insertBefore(t,p._79O),Xb(s,O.editorRect),s.setFocus?s.setFocus():am(s),s.commitValue=function(Q,W){s._17Q&&(s=s._17Q),W||p.setValue(O.data,v,s.getValue?s.getValue():s.value),s.close&&s.close(),gl(t)},v.onEditorCreated&&v.onEditorCreated(O)},It=function(u,y,r,N,m){var o=bb(u,r),w=y.value,I=y.view,e=m.getValueType(y.data);return o.onblur=o.onchange=function(){I.endEditing()},"input"===u?(w=m.formatValue(w),w!=E&&(o.value=w),o.onkeydown=function(w){ol(w)?I.endEditing():xq(w)&&I.endEditing(!0)},(e===ab||e===Qi)&&F(o,zc,K.numberListener)):u===Ef&&N.forEach(function(M){var y=f.createElement("option");y.innerHTML=m.toEnumLabel(M),y.value=M,m.isEnumEqual(w,M)&&(y.selected=!0),Ej(o,y)}),Ht(o,y),o},Jt=h.widget={},Kt=function(o,G,i){gd(M+".widget."+o,G,i)};Sn(wp,{ms_value:function(q){q.getValue=function(I){var z=this.getItemById(I),Q=z.element;return Om(Q)?Q:Q?Q.getValue?Q.getValue():Q.value:z.selected},q.setValue=function(Z,G){var p=this.getItemById(Z);if(p){var T=p.element;T&&!Om(T)?T.setValue?T.setValue(G):T.value=G:mh(G)?(p.selected=G,this.iv()):(p.element=G,this.iv())}},q.v=function(m,N){var a=this;if(2===arguments.length)a.setValue(m,N);else{if(!Hh(m))return a.getValue(m);for(var I in m)a.setValue(I,m[I])}return a}},_46o:function(i){i._icon=E,i._accessType=E,i._valueType=E,i._editable=!1,i._batchEditable=!0,i._align=zi,i._nullable=!0,i._emptiable=!1,i.setParent=ym,i.formatValue=function(u){var B=this,b=B._valueType;return B.getEnumValues()?B.toEnumLabel(u):b===Gb?!!u:u!=E&&b===ab?j(u):u},i.setEnum=function(d,l,k,V,J,r,c){var _=this;d&&!bs(d)&&d.values&&(V=d.editable,k=d.icons,l=d.labels,J=d.strict,r=d.maxHeight,c=d.dropDownWidth,d=d.values),xg(d)&&(d=d._as),xg(l)&&(l=l._as),xg(k)&&(k=k._as),_._enumValues=d,_._enumLabels=l,_._enumIcons=k,_._enumEditable=V,_._enumStrict=J==E?!0:J,_._enumMaxHeight=r,_._enumDropDownWidth=c,d&&d.length&&Kg(d[0])&&(_._valueType=Qi),_.fp("enum",!1,!0)},i.getEnumDropDownWidth=function(){return this._enumDropDownWidth},i.getEnumMaxHeight=function(){return this._enumMaxHeight},i.isEnumEditable=function(){return this._enumEditable},i.getEnumValues=function(){return this._enumValues},i.getEnumLabels=function(){return this._enumLabels},i.getEnumIcons=function(){return this._enumIcons},i.isEnumStrict=function(){return this._enumStrict},i.isEnumEqual=function(J,N){return this._enumStrict?J===N:J==N},i.toEnumLabel=function(r,N){var C=this,W=C.getEnumValues(N),z=C.getEnumLabels(N);if(W&&z)for(var E=0;E<W.length;E++)if(C.isEnumEqual(r,W[E]))return z[E];return r},i.toEnumIcon=function(o,L){var J=this,r=J.getEnumValues(L),m=J.getEnumIcons(L);if(r&&m)for(var F=0;F<r.length;F++)if(J.isEnumEqual(o,r[F]))return m[F];return P}},_45o:function(S){S._87o=function(Q,Y,_,p,B,w){if(Q){var H=this,d=H._90I,A=Xi(1);H._columnLineVisible&&(B-=1),H._rowLineVisible&&(w-=1),0>=B||0>=w||(H._90I||(d=H._90I={}),d[Y]||(d[Y]=new oc),Xb(A,H.tx()+_,H.ty()+p,B,w),Ej(A,Q),H._view.insertBefore(A,H._79O),Q.onParentAdded&&Q.onParentAdded(A),d[Y].add(A))}},S._76o=function(){var f=this,F=f._90I;if(F){for(var p in F)F[p].each(function(h){gl(h)});delete f._90I}},S._77o=function($){var M=this;if(M._90I){var k=M._90I[$];k&&(k.each(function(B){gl(B)}),delete M._90I[$])}}},_47o:function(g){g.getValue=function(P,j){return j.getValue?j.getValue(P,j,this):ri(P,j.getAccessType(),j.getName())},g.setValue=function(n,e,f){if(e.isEmptiable(n)||""!==f||(f=P),e.isNullable(n)||f!=E){var s=this,W=e.getName(n),V=e.getAccessType(n),z=e.getValueType(n);z===ab&&Om(f)?f=sr(f):z===Qi&&Om(f)?f=parseFloat(f):z===Gb&&Om(f)&&(f="true"===f),s._batchEditable&&e._batchEditable&&s.isSelected(n)?s.sm().each(function(j){e.setValue?e.setValue(j,e,f,s):pp(j,V,W,f)}):e.setValue?e.setValue(n,e,f,s):pp(n,V,W,f)}},g.setCurrentEditor=function(N){this.endEditing(),this._currentEditor=N,this.redraw()},g.isEditing=function(p,E){var G=this,A=G._currentEditor;if(!A)return!1;if(E){var m=A.info;return m?(m.column||m.property)===E&&m.data===p:!1}return!0},g.endEditing=function(Z){var A=this,m=A._currentEditor;m&&(delete A._currentEditor,m.commitValue&&m.commitValue(m.info,Z),A.redraw(),A.getDataModel().endTransaction())},g.beginEditing=function(j){this.endEditing();var $=this,l=j.column||j.property;if(l.beginEditing)l.beginEditing(j);else{var X=j.data,u=j.value,H=$.getSelectBackground(X),D=l.getEnumValues(X),Q=l.getSlider(X),y=l.getColorPicker(X);if(Q){var s=Im(Jt.Slider,Q);return s.setValue(u),s.getView().onblur=function(){$.endEditing()},s.isInstant()&&(s.onValueChanged=function(){$.setValue(X,l,s.getValue())}),Ht(s,j),void 0}if(y||l.getValueType(X)===$h){var g=Im(Jt.ColorPicker,y);g.setValue(u);var t=g.onClosed;return g.onClosed=function(){$.endEditing(),t&&t.call(this)},g.isInstant()&&(g.onValueChanged=function(u,y){$.setValue(X,l,y)}),Ht(g,j),g.open(),void 0}if(D){if(Jt.ComboBox){var b=new Jt.ComboBox;b.setValue(u),b.setValues(D),b.setLabels(l.getEnumLabels(X)),b.setIcons(l.getEnumIcons(X)),b.setEditable(l.isEnumEditable(X)),b.setStrict(l.isEnumStrict(X)),b.setMaxHeight(l.getEnumMaxHeight(X)),b.setDropDownWidth(l.getEnumDropDownWidth(X)),b.onClosed=function(){$.endEditing()},Ht(b,j),b.open()}else It(Ef,j,H,D,l);return}var S=l.getValueType(X);if(S===Gb||mh(u))return $.setValue(X,l,!u),void 0;if(l.getItemEditor(X)){var M=Zp(l.getItemEditor(X)),U=new M(X,l,$,j),k=U.getView();return k._17Q=U,U.setValue(u),Pr(k),Ht(k,j),U.editBeginning&&U.editBeginning(),void 0}It("input",j,H,E,l)}}},_44o:function(k){k.init=function(p){var d=this,x=d.th=new Zt(p),Y=d._view=Of(1,d);d.tv=d._tableView=p,Ej(Y,x.getView()),Ej(Y,p.getView()),x.mp(function(K){K.property===Cr&&d.iv()}),d.iv()},k.getTableView=function(){return this.tv},k.getTableHeader=function(){return this.th},k.getDataModel=function(){return this.tv.dm()},k.getColumnModel=function(){return this.tv.getColumnModel()},k.setColumns=function(h){this.tv.setColumns(h)},k.addColumns=function(F){this.tv.addColumns(F)},k.endEditing=function(){this.tv.endEditing()},k.validateImpl=function(){var V=this,$=V.th,d=rf($),L={x:0,y:0,width:V.getWidth(),height:d};Xb($,L),L.y=d,L.height=_(0,V.getHeight()-d),Xb(V.tv,L)}},ms_vs:function(Q){Q._41o=function(){return this._29I.height<this._59I},Q._43o=function(){var O=this;O._41o()&&(O._58I||(Jn(function(){O._94O()},bo),O.iv()),O._58I=new Date)},Q._94O=function(){var z=this;if(z._58I){var K=new Date;K.getTime()-z._58I.getTime()>=bo?(delete z._58I,z.iv()):Jn(function(){z._94O()},bo)}},Q._93I=function(){var Q=this,B=Q._27I;if(Q._58I||!Q._autoHideScrollBar){B||Ej(Q._79O,B=Q._27I=Xi());var G=Q._29I,H=G.height,D=Q._59I,P=Q.getScrollBarSize(),u=G.width-P-2,k=H*(-Q.ty()/D),h=H*(H/D),_=B.style;D>H?(Wl>h&&(k=k+h/2-Wl/2,0>k&&(k=0),k+Wl>H&&(k=H-Wl),h=Wl),_.visibility=Fm,_.background=Q.getScrollBarColor(),_.borderRadius=P/2+yr,Xb(B,u,k,P,h)):_.visibility=gb}else B&&(B.style.visibility=gb)}},ms_hs:function(Z){Z._40o=function(){return this._29I.width<this._91I},Z._42o=function(){var E=this;E._40o()&&(E._95O||(Jn(function(){E._94I()},bo),E.iv()),E._95O=new Date)},Z._94I=function(){var k=this;if(k._95O){var p=new Date;p.getTime()-k._95O.getTime()>=bo?(delete k._95O,k.iv()):Jn(function(){k._94I()},bo)}},Z._92I=function(){var s=this,z=s._28I;if(s._95O||!s._autoHideScrollBar){z||Ej(s._79O,z=s._28I=Xi());var p=s._29I,M=p.width,o=s._91I,X=s.getScrollBarSize(),_=p.height-X-2,u=M*(-s.tx()/o),k=M*(M/o),g=z.style;o>M?(Wl>k&&(u=u+k/2-Wl/2,0>u&&(u=0),u+Wl>M&&(u=M-Wl),k=Wl),g.visibility=Fm,g.background=s.getScrollBarColor(),g.borderRadius=X/2+yr,Xb(z,u,_,k,X)):g.visibility=gb}else z&&(z.style.visibility=gb)}}}),wr(Oh,ti(16,16,[{type:Vd,rect:[1,1,14,14],background:Yc},{type:Pe,rect:[1,1,14,14],width:1,color:ne},{type:Ph,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),wr(im,ti(16,16,{type:Pe,rect:[1,1,14,14],width:1,color:ne})),wr(_q,ti(16,16,[{type:Gl,rect:[2,2,12,12],borderWidth:1,borderColor:ne,background:"#FFF"},{type:Gl,rect:[4,4,8,8],background:Yc}])),wr(Sb,ti(16,16,{type:Gl,rect:[2,2,12,12],borderWidth:1,borderColor:ne})),wp._15Q=function(G){G._29I=Cm,G._59I=0,G._91I=0,G._5o=function(Z){var E=this;E._30I=new oc,E._rows=new oc,E._rowMap={},E._31I=0,E._14I=0,E._view=Of(1,E),E._canvas=ej(E._view),Ej(E._view,E._79O=Xi()),E.dm(Z?Z:new ed)},G.getCheckIcon=function(H){var t=this.sm(),u=t.co(H);return t.sg()?fl(u?_q:Sb):fl(u?Oh:im)},G.checkData=function(O){var l=this.sm(),c=l.co(O);l.sg()&&c||(this._32o=1,c?l.rs(O):l.as(O),delete this._32o)},G.getDataAt=function(v){v.target&&(v=this.lp(v));var e=X(v.y/this._rowHeight),Q=this._rows;return 0>e||e>=Q.size()?E:Q.get(e)},G.onDataDoubleClicked=function(){},G.onDataClicked=function(){},G.adjustTranslateX=function(){return 0},G.adjustTranslateY=function(z){var m=this.getHeight()-this._59I;return m>z&&(z=m),z>0?0:j(z)},G.onPropertyChanged=function(B){var l=this,X=B.property;Dt[X]?l.ivm():Ct[X]||l.redraw(),X===fq?l._42o():X===oq&&l._43o()},G.getLabel=function(C){return C.toLabel()},G.getLabelFont=function(){return this._labelFont},G.getLabelColor=function(C){var t=this;if(t.isCheckMode()){if(t._focusData===C)return t._labelSelectColor}else if(t.isSelected(C))return t._labelSelectColor;return t._labelColor},G.getStartRowIndex=function(){return this._31I},G.getEndRowIndex=function(){return this._14I},G.getRowDatas=function(){return this._rows},G.getRowIndex=function(Y){return this._rowMap[Y._id]},G.getRowSize=function(){return this._rows.size()},G.getViewRect=function(){return fo(this._29I)},G.isVisible=function(G){return this._visibleFunc?this._visibleFunc(G):!0},G.getCurrentSortFunc=function(){return this._sortFunc},G.setDataModel=function(Y){var q=this,w=q._dataModel,K=q._selectionModel;w!==Y&&(w&&(w.umm(q.handleDataModelChange,q),w.umd(q.handleDataPropertyChange,q),w.umh(q.handleHierarchyChange,q),K||w.sm().ums(q.handleSelectionChange,q)),q._dataModel=Y,Y.mm(q.handleDataModelChange,q),Y.md(q.handleDataPropertyChange,q),Y.mh(q.handleHierarchyChange,q),K?K._21I(Y):Y.sm().ms(q.handleSelectionChange,q),q.fp("dataModel",w,Y))},G.validateModel=function(){var I=this;I._rows.clear(),I._rowMap={},I.buildChildren(I._dataModel._roots);var U=I._rows=I._rows.toList(I.isVisible,I),i=0,h=I.getCurrentSortFunc(),Q=U.size();for(h&&U.sort(h);Q>i;i++)I._rowMap[U.get(i)._id]=i},G.buildChildren=function(c){var T=this;c.each(function(R){T._rows.add(R),T.buildChildren(R._children)})},G.handleDataModelChange=function(){this.ivm()},G.handleDataPropertyChange=function(d){"parent"===d.property?this.ivm():this.invalidateData(d.data)},G.handleHierarchyChange=function(){this.ivm()},G.handleSelectionChange=function(H){H.datas.each(this.invalidateData,this),this.onSelectionChanged(H)},G.onSelectionChanged=function(g){var k=this,O=k.sm();!k.isAutoMakeVisible()||1!==O.size()||"set"!==g.kind&&"append"!==g.kind||k._32o||k.makeVisible(O.ld())},G.handleBackgroundClick=function(b){kp(b)&&!this.isCheckMode()&&this.sm().cs()},G.makeVisible=function(X){X&&(this._23I=X,this.iv())},G.scrollToIndex=function(I){var A=this,i=A._29I,L=i.height,a=A._rowHeight,n=a*I;I>=0&&I<A._rows.size()&&L>0&&(n+a>i.y+L?A.ty(-n+L-a):n<i.y&&A.ty(-n))},G.autoScroll=function(S,D){var I=this,j=I._rowHeight,r=j,$=j/4,e=I._29I,m=I.lp(S),W={x:I.tx(),y:I.ty()};return j>0&&e&&(m.x-e.x<r?I.translate($,0):e.x+e.width-m.x<r&&I.translate(-$,0),m.y-e.y<r?I.translate(0,$):e.y+e.height-m.y<r&&I.translate(0,-$)),W.x=I.tx()-W.x,W.y=I.ty()-W.y,D&&(D.x+=W.x,D.y+=W.y),W},G.getTopRowOrderSelection=function(){var X=this.sm().getTopSelection(),u={},t=new oc;return X.each(function(U){u[U._id]=U}),this._rows.each(function(P){u[P._id]&&t.add(P)}),t},G.getRowOrderSelection=function(){var o=new oc;return this._rows.each(function(Q){this.isSelected(Q)&&o.add(Q)},this),o},G.ivm=function(){this.invalidateModel()},G.invalidateModel=function(){var r=this;r._96I||(r._96I=1,r._32I=1,delete r._24I),r.iv()},G.redraw=function(){var b=this;b._32I||(b._32I=1,delete b._24I,b.iv())},G.invalidateData=function(R){var y=this;Sl?y.redraw():y._32I||(y._24I||(y._24I={}),y._24I[R._id]=R,y.iv())},G.getFocusData=function(){return this._focusData},G.setFocusDataById=function(X){this.setFocusData(this.dm().getDataById(X))},G.setFocusData=function(O){var H=this,J=H._focusData;J!==O&&(H._focusData=O,H.fp("focusData",J,O),J&&H.invalidateData(J),O&&(H.invalidateData(O),H.isAutoMakeVisible()&&H.makeVisible(O)))},G.drawRowBackground=function(m,j,$,P,g,w,t){var u=this,S=u.isCheckMode();(j===u._focusData&&S||$&&!S)&&cs(m,P,g,w,t,u.getSelectBackground(j))},G.drawData=function(b,g,B){var X=this,D=X._rowHeight,Y=D*B,H=X._29I,e=H.x,F=H.width;b.save(),b.beginPath(),b.rect(e,Y,F,D),b.clip(),X._87o(X.drawRow(b,g,X.isSelected(g),e,Y,F,D),B,e,Y,F,D),b.restore(),X._rowLineVisible&&cs(b,e,Y+D-1,F,1,X._rowLineColor)},G._12I=function(N){var c=this,t=c._31I,T=c._29I,P=T.x,r=T.y,M=T.width,x=T.height;for(N.beginPath(),N.rect(P,r,M,x),N.clip(),N.clearRect(P,r,M,x),c._76o(),c._93db(N);t<c._14I;t++)c.drawData(N,c._rows.get(t),t);c._92db(N)},G._13I=function(y){for(var w,$=this,f=$._rowHeight,E=$._29I,O=E.x,S=E.width,g=$._31I,x=$._30I;g<$._14I;g++)w=$._rows.get(g),$._24I[w._id]&&x.add({data:w,index:g});x.isEmpty()||(y.beginPath(),x.each(function(I){y.rect(O,I.index*f,S,f)}),y.clip(),x.each(function($){y.clearRect(O,$.index*f,S,f)}),x.each(function(o){$._77o(o.index)}),$._93db(y),x.each(function(U){$.drawData(y,U.data,U.index)}),$._92db(y),x.clear())},G.preValidateModel=function(){this.endEditing&&this.endEditing()},G.validateImpl=function(){var r=this,j=r._canvas,G=r.getWidth(),q=r.getHeight(),p=r._rowHeight,n=r._32I;(G!==j.clientWidth||q!==j.clientHeight)&&(Gm(j,G,q),n=1),r._96I&&(r.preValidateModel(),r.validateModel());var I=r._29I,g={x:-r.tx(),y:-r.ty(),width:G,height:q},t=r._rows.size(),J=Te(j),N=r._23I;n||sl(g,I)||(n=1),r._29I=g,r._59I=t*p,r._31I=X(g.y/p),r._14I=i((g.y+g.height)/p),r._31I<0&&(r._31I=0),r._14I>t&&(r._14I=t),r._99I&&n&&r._99I();var M=r.tx(),H=r.ty();(r._40o()||r._41o())&&(r._59I+=r.getScrollBarSize(),r._99I&&n&&(r._91I+=r.getScrollBarSize())),xk&&!bp&&(J.save(),Rf(J,G/Rg.length,q/Rg.length,1)),Rf(J,M,H,1),n?r._12I(J):r._24I&&r._13I(J),r._93I(),r._92I(),J.restore(),r._32I=r._24I=r._96I=E,N&&(r.scrollToIndex(r.getRowIndex(N)),delete r._23I),r.tx(r.tx()),r.ty(r.ty())},G.canHandleSelectMode=function(){return!0},G.isDraggable=function(){return!0}},wp._48o=function(O){O._rootVisible=!0,O._rootData=E,O._35o=function(){this._expandMap={},this._levelMap={}},O.validateModel=function(){var B=this,e=B._rootData;B._rows.clear(),B._levelMap={},B._rowMap={},B._currentLevel=0,e?B._rootVisible?B.isVisible(e)&&B.buildData(e):B.buildChildren(e):B.buildChildren(),delete B._currentLevel},O.buildData=function(F){var M=this,H=F._id,e=M._rows;M._rowMap[H]=e.size(),e.add(F),M._levelMap[H]=M._currentLevel,M.isExpanded(F)&&(M._currentLevel++,M.buildChildren(F),M._currentLevel--)},O.buildChildren=function(n){var l=this,T=n?n._children:l._dataModel._roots,p=l.getCurrentSortFunc();p&&l.isChildrenSortable(n)?T.toList(l.isVisible,l).sort(p).each(l.buildData,l):T.each(function(K){l.isVisible(K)&&l.buildData(K)})},O.getLevel=function(n){return this._levelMap[n._id]},O.getToggleIcon=function(S){var T=this,s=T._loader,x=T._collapseIcon;return s&&!s.isLoaded(S)?x:S.hasChildren()?T.isExpanded(S)?T._expandIcon:x:E},O.isCheckMode=function(){return this._checkMode!=E},O.isChildrenSortable=function(){return!0},O.handleDataModelChange=function(Q){var x=this;Q.kind===Fk?delete x._expandMap[Q.data._id]:Q.kind===cl&&(x._expandMap={}),x.ivm()},O.toggle=function(R){var F=this;F.isExpanded(R)?F.collapse(R):F.expand(R)},O.isExpanded=function(U){return 1===this._expandMap[U._id]},O.expand=function(k){var i=this,$=i._loader;i.isExpanded(k)||($&&!$.isLoaded(k)&&$.load(k),i._expandMap[k._id]=1,i.ivm(),i.onExpanded(k))},O.onExpanded=function(){},O.collapse=function(u){var b=this;b.isExpanded(u)&&(delete b._expandMap[u._id],b.ivm(),b.onCollapsed(u))},O.onCollapsed=function(){},O.expandAll=function(l){if(l)this.expand(l),l.eachChild(function(l){this.expandAll(l)},this);else{var t=this;t._dataModel.each(function(g){g.hasChildren()&&(t._expandMap[g._id]=1)}),t.ivm()}},O.collapseAll=function(){this._expandMap={},this.ivm()},O.makeVisible=function(O){if(O){var x=this;if(!x._rootData||O.isDescendantOf(x._rootData)){for(var j=O._parent;j;)x.expand(j),j=j._parent;x._23I=O,x.iv()}}},O.checkData=function(g){var C,Y=this,z=Y._checkMode,Q=Y.sm(),b=Q.co(g);if(!Q.sg()||!b){if(Y._32o=1,z===Dj)b?Q.rs(g):Q.as(g);else if(z===Qb)C=new oc(g),C.addAll(g._children);else if("descendant"===z)C=new oc,Ft(g,C);else if("all"===z&&(C=new oc,Ft(g,C),!b))for(var X=g._parent;X;)C.add(X),X=X._parent;C&&(b?Q.rs(C):Q.as(C)),delete Y._32o}},O.drawTree=function(N,v,e,S,f,E,V){var U=this,o=U._indent,p=U._levelMap[v._id],Y=U.getIconWidth(v),r=fl(U.getToggleIcon(v));r?(S+=o*p,yb(N,r,S+o/2,f+V/2,v,U),S+=o):S+=o*(p+1),U._checkMode&&(yb(N,U.getCheckIcon(v),S+o/2,f+V/2,v,U),S+=o),U.drawIcon(N,v,S,f,Y,V),U.drawLabel(N,v,S+Y,f,V)}},wp._14Q=function(H){H.getIcon=function(Y){return Y.getIcon()},H.getIconWidth=function(V){return this.getIcon(V)?this._indent:0},H.drawIcon=function(o,t,R,a,c,p){if(c){var m=this,E=m.getBodyColor(t),O=fl(m.getIcon(t),E);O&&(p-=m.isRowLineVisible()?1:0,_c(o,O,nl,R,a,c,p,t,m,E),di(o,m.getBorderColor(t),R,a,c,p))}},H.drawLabel=function(E,t,f,d,p){var M=this;_k(E,M.getLabel(t),M.getLabelFont(t),M.getLabelColor(t),f,d,0,p)}},wp._50o=function(n){n._98I=function(){var R=this,g=R._39o=new ed;R._60I=new oc,g.mm(R._17o,R),g.md(R._18o,R),g.mh(R._19o,R)},n.setColumns=function(u){this._39o.clear(),this.addColumns(u)},n.addColumns=function(D){var f=this._39o;D.forEach(function(E){if(!(E instanceof Mt)){var R=Zp(E.className);E=Im(R?R:Mt,E)}f.add(E)})},n.onColumnClicked=function(){},n.onCheckColumnClicked=function(){},n._3Q=function(t){for(var Z,B=0,u=this._60I,Q=u.size();Q>B;B++)if(Z=u.get(B),Z.column===t)return Z;return E},n.getColumnAt=function(b){var J=this._4Q(b);return J?J.column:E},n._4Q=function(h){for(var A=this,w=h.target?A.lp(h).x:h.x,z=A._60I,d=0;d<z.size();d++){var y=z.get(d),b=y.startX;if(w>=b&&w<b+y.column.getWidth())return y}return E},n.getToolTip=function(G){var r=this,I=r.getDataAt(G),i=r.getColumnAt(G);return I&&i?i.getToolTip(I,r):E},n.adjustTranslateX=function(G){var Z=this.getWidth()-this._91I;return Z>G&&(G=Z),G>0?0:j(G)},n._99I=function(){var A=this,J=A._29I,G=A._60I;G.clear(),A._91I=0,A._39o._roots.each(function(U){if(U.isVisible()){var k=A._91I+U.getWidth();A._91I<=J.x+J.width&&k>=J.x&&G.add({column:U,startX:A._91I}),A._91I=k}})},n.drawData=function(b,X,H){var y=this,r=y._rowHeight,q=r*H,P=y.isSelected(X),I=y._29I,W=I.x,C=I.width;y.drawRowBackground(b,X,P,W,q,C,r),y._60I.each(function(D){var F=D.column,E=D.startX,t=F.getWidth();t>0&&!y.isEditing(X,F)&&(b.save(),b.beginPath(),b.rect(E,q,t,r),b.clip(),y._87o(y.drawCell(b,X,P,F,E,q,t,r),H,E,q,t,r),y._columnLineVisible&&cs(b,E+t-1,q,1,r,y._columnLineColor),b.restore())}),y._rowLineVisible&&cs(b,W,q+r-1,C,1,y._rowLineColor)},n.drawCell=function(E,P,h,W,x,v,$,z){var O=this;if(W.drawCell)return W.drawCell(E,P,h,W,x,v,$,z,O);var B=O.getValue(P,W);Gt(E,B,W,O.getLabelFont(P,W,B),O.getLabelColor(P,W,B),x,v,$,z,P,O)},n.getColumnModel=function(){return this._39o},n._17o=function(){this.redraw()},n._18o=function(D){var L=this;D.data===L._sortColumn&&Bt[D.property]?L.ivm():(L._42o(),L.redraw())},n._19o=function(){this.redraw()},n.getCurrentSortFunc=function(){var s=this,H=s._sortColumn;if(H&&H.isSortable()){var J=H.getSortFunc(),G=Ri===H.getSortOrder()?1:-1;return J||(J=As),function(r,x){return J.call(s,s.getValue(r,H),s.getValue(x,H),r,x)*G}}return s._sortFunc},n.isCellEditable=function(F,x,o){return x.isEditable()&&this.isEditable()?x.isCellEditable?x.isCellEditable(F,x,o,this):!0:!1},n._37O=function($,O){if(kp(O))for(var Z=this,u=Z.lp(O),_=Z._60I,w=Z._rowHeight,b=Z._29I,t=b.x,A=b.y,g=b.width,J=b.height,P=0;P<_.size();P++){var z=_.get(P),R=z.startX,M=z.column,Q=M.getWidth();if(M!==Z._31o&&M!==Z._4o&&u.x>=R&&u.x<R+Q&&Z.isCellEditable($,M,O)){var L={x:R,y:Z.getRowIndex($)*w,width:Q,height:w},E={x:L.x+Z.tx(),y:L.y+Z.ty(),width:L.width,height:L.height},d=0,y=0;return L.x<t?d=L.x-t:L.x+L.width>t+g&&(d=L.x+L.width-t-g),d&&(Z.tx(Z.tx()-d),E.x-=d),L.y<A?y=L.y-A:L.y+w>A+J&&(y=L.y+w-A-J),y&&(Z.ty(Z.ty()-y),E.y-=y),Z.beginEditing({data:$,column:M,value:Z.getValue($,M),event:O,rect:L,editorRect:E,view:Z}),void 0}}}},Jt.BaseItemEditor=function(J,V,E,N){this._data=J,this._column=V,this._master=E,this._editInfo=N},Kt("BaseItemEditor",O,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Lt=h.Tab=function(){cb(Lt,this)};lq("Tab",Lk,{ms_ac:["view","closable","disabled","visible"],_icon:E,_closable:!1,_disabled:!1,_visible:!0,setParent:ym});var Mt=h.Column=function(){cb(Mt,this)};lq("Column",Lk,{_46o:1,ms_ac:["accessType","valueType",Fm,xp,tn,il,"align",$h,"sortOrder",Uc,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Ri,_sortFunc:E,_sortable:!0,_clickable:!0,setWidth:function(T){16>T&&(T=16);var B=this._width;this._width=T,this.fp(il,B,T)},getToolTip:function(m,k){return this.formatValue(k.getValue(m,this))}});var Nt=h.Property=function(){cb(Nt,this)};lq("Property",Lk,{_46o:1,ms_ac:["accessType","valueType",xp,tn,"categoryName",$h,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:E,getToolTip:function(g,K,Q){var j=this;return K?j.formatValue(Q.getValue(g,j)):Q.getPropertyName(j)}}),Jt.AccordionView=function(){var J=this;J._20o={},J._21o=new oc,J._10o=E,J._9o=E,J._11o=E,J._view=Of(0,J),J.iv()},Kt("AccordionView",O,{ms_v:1,ms_fire:1,ms_ac:[Xh,_e,"titleHeight",Yi,ee,"titleBackground","selectWidth",yd,"orientation","separatorColor"],_expandIcon:K.accordionViewExpandIcon,_collapseIcon:K.accordionViewCollapseIcon,_titleHeight:yh,_labelColor:K.accordionViewLabelColor,_labelFont:K.accordionViewLabelFont,_titleBackground:K.accordionViewTitleBackground,_selectBackground:K.accordionViewSelectBackground,_selectWidth:K.accordionViewSelectWidth,_orientation:"v",_separatorColor:K.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(p,E,A,d){var b=this,L=Xi(),O={content:E,div:L,canvas:ej(L),icon:d};if(b._20o[p])throw p+" already exists";var V=O.downEventFunc=function(i){up(i)},K=O.upEventFunc=function(U){up(U),kp(U)&&(b._10o===p?b.collapse():b.expand(p))};[Qf,zl].forEach(function(q){F(L,q,V)}),[Jk,Fh].forEach(function(j){F(L,j,K)}),L.style.cursor=Wc,Ej(b._view,L),b._20o[p]=O,b._21o.add(p),A&&b.expand(p),b.iv()},remove:function(p){var x=this,T=x._20o[p];if(T){var S=T.div;gl(S),[Qf,zl].forEach(function(s){J(S,s,T.downEventFunc)}),[Jk,Fh].forEach(function(u){J(S,u,T.upEventFunc)}),delete x._20o[p],x._21o.remove(p),x.iv()}},clear:function(){var f=this;f._21o.toArray().forEach(f.remove,f),f._20o={},f._21o.clear(),f.iv()},isExpanded:function(V){return this._10o===V},expand:function(I){var n=this;n._20o[I]&&n._10o!==I&&(n._10o=I,n.onExpanded(I),n.iv())},onExpanded:function(){},collapse:function(){var P=this;P._10o&&(P.onCollapsed(P._10o),delete P._10o,P.iv())},onCollapsed:function(){},initCanvas:function(w,y,m){Gm(w,y,m);var o=Te(w);return Rf(o,0,0,1),o.clearRect(0,0,y,m),o},drawTitle:function(K,s,J,C,v){var F=this,L=fl(v.icon),A=F.isExpanded(s),B=F._titleHeight,e=F._titleBackground,N=F._selectWidth,b=F._separatorColor,P=fl(A?F._expandIcon:F._collapseIcon),y=N+4;cs(K,0,0,J,C,e),A&&N&&cs(K,0,0,N,C,F._selectBackground),(A||F._21o.get(F._21o.size()-1)!==s)&&cs(K,0,C-1,J,1,b?b:sm(e)),L&&(yb(K,L,y+_r(L)/2,B/2),y+=_r(L)+2),_k(K,s,F.getLabelFont(s),F.getLabelColor(s),y,0,0,B),P&&yb(K,P,J-_r(P)/2-4,B/2)},validateImpl:function(){var E=this,g=E._view,h=0,q=0,A=E.getWidth(),f=E.getHeight(),r=E._titleHeight,j=E._21o.size()*r,t=E._11o,K=E._9o;delete E._11o,delete E._9o,E._21o.each(function(N){var i,G,J=E._20o[N],m=J.content,g=E._10o===N;oo(E)?(Xb(J.div,h,0,r,f),i=E.initCanvas(J.canvas,r,f),xc(i,0,f),pl(i,-ss),E.drawTitle(i,N,f,r,J),i.restore(),g?(G=_(0,A-j),m&&(E._11o=m,E._9o=_f(m),Xb(m,h+r,0,G,f)),h+=r+G):h+=r):(Xb(J.div,0,q,A,r),i=E.initCanvas(J.canvas,A,r),E.drawTitle(i,N,A,r,J),i.restore(),g?(G=_(0,f-j),m&&(E._11o=m,E._9o=_f(m),Xb(m,0,q+r,A,G)),q+=r+G):q+=r)});var N=E._9o;t&&t!==E._11o&&t.endEditing&&t.endEditing(),N&&N!==K&&Ej(g,N),K&&K!==N&&gl(K)}}),Jt.SplitView=function(e,v,h,i){var w=this,Q=w._dividerDiv=Xi(),t=w._60O=ej(),Y=w._61O=ej(),g=t.style,b=Y.style;w._view=Of(1,w),Ej(w._view,Q),g.msTouchAction=Yf,g.pointerEvents=Yf,g.cursor=Wc,b.msTouchAction=Yf,b.pointerEvents=Yf,b.cursor=Wc,e&&w.setLeftView(e),v&&w.setRightView(v),h&&w.setOrientation(h),i!=E&&w.setPosition(i),w.setStatus(ts),new Ot(w)},Kt("SplitView",O,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:K.splitViewDividerSize,_dividerBackground:K.splitViewDividerBackground,_dragOpacity:K.splitViewDragOpacity,_toggleIcon:K.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(b,D){var k=this,U=k._position;isNaN(b)||(D||(k._82O=0>b?-1:b>1?1:0),k._position=b,k.fp(Fr,U,b))},getLeftView:function(){return this._leftView},setLeftView:function(c){var D=this,L=D._leftView,t=D._view;if(D._leftView!==c){if(L&&L!==D._rightView){var J=_f(L);J.parentNode===t&&gl(J)}if(D._leftView=c,c){var v=_f(c);v.parentNode!==t&&t.insertBefore(v,D._dividerDiv)}D.fp("leftView",L,c)}},getRightView:function(){return this._rightView},setRightView:function(z){var p=this,f=p._rightView,o=p._view;if(p._rightView!==z){if(f&&f!==p._leftView){var e=_f(f);e.parentNode===o&&gl(e)}if(p._rightView=z,z){var K=_f(z);K.parentNode!==o&&o.insertBefore(K,p._dividerDiv)}p.fp("rightView",f,z)}},validateImpl:function(){var u=this,W=u._draggable,J=u._position,q=u.getWidth(),V=u.getHeight(),T=u._dividerSize,X=u._dividerBackground,R=kd?18:8,Z=u._dividerDiv,L=u._82O,e=u._60O,$=u._61O,s=u._toggleIcon,k=u._status,b=Z.style,p=null,v=kd?20:4,a=s.comps[0];T>=R||0===T?u._coverDiv&&(gl(u._coverDiv),delete u._coverDiv):u._coverDiv||(u._coverDiv=Xi(),Wm&&(u._coverDiv.style.background=Mm),Ej(Z,u._coverDiv)),u._togglable?e.parentNode||(Ej(Z,e),Ej(Z,$)):(gl(e),gl($));var t=u._coverDiv,F=u._leftView,h=u._rightView;if(oo(u)){if(T>q&&(T=q),k===ts)if(1===L)var r=I(J,q),G=_(0,q-T-r);else-1===L?(G=I(-J,q),r=_(0,q-T-G)):(r=j((q-T)*J),G=_(0,q-T-r));else"cl"===k?(r=0,G=_(0,q-T)):"cr"===k&&(G=0,r=_(0,q-T));F&&Xb(F,0,0,r,V),h&&Xb(h,r+T,0,G,V),Xb(Z,r,0,T,V),u._22o=r,t&&(Xb(t,T/2-R/2,0,R,V),t.style.cursor=W?sj:""),Z.style.cursor=W?sj:"";var f=Z.clientHeight/2,P=Z.clientWidth;Gm(e,P,P),Xb(e,0,f-P-v,P,P),p=Te(e),Rf(p,0,0,1),a.rotation=-ss,Pp(p,s,0,0,P,P),p.restore(),Gm($,P,P),Xb($,0,f+v,P,P),p=Te($),Rf(p,0,0,1),a.rotation=ss,Pp(p,s,0,0,P,P),p.restore()}else{if(T>V&&(T=V),k===ts)if(1===L)var l=I(J,V),z=_(0,V-T-l);else-1===L?(z=I(-J,V),l=_(0,V-T-z)):(l=j((V-T)*J),z=_(0,V-T-l));else"cl"===k?(l=0,z=_(0,V-T)):"cr"===k&&(z=0,l=_(0,V-T));F&&Xb(F,0,0,q,l),h&&Xb(h,0,l+T,q,z),Xb(Z,0,l,q,T),u._22o=l,t&&(Xb(t,0,T/2-R/2,q,R),t.style.cursor=W?hd:""),b.cursor=W?hd:"";var A=Z.clientWidth/2,P=Z.clientHeight;Gm(e,P,P),Xb(e,A-P-v,0,P,P),p=Te(e),Rf(p,0,0,1),a.rotation=0,Pp(p,s,0,0,P,P),p.restore(),Gm($,P,P),Xb($,A+v,0,P,P),p=Te($),Rf(p,0,0,1),a.rotation=D,Pp(p,s,0,0,P,P),p.restore()}b.background=X}});var Ot=function(t){this.sv=t,this.addListeners()};gd(Ot,O,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(W){var f=this,e=f.sv,s=e._dividerDiv,E=e._60O,A=e._61O,g=e._status,X=W.target;if(X===E)g===ts?e.setStatus("cl"):"cr"===g&&e.setStatus(ts);else if(X===A)g===ts?e.setStatus("cr"):"cl"===g&&e.setStatus(ts);else if(Wg(W)&&(X===s||X===e._coverDiv)&&(up(W),e.isDraggable())){e.getLeftView(),e.getRightView();var p=f.maskDiv=Xi();if(p.style.left=0,p.style.top=0,p.style.width=e.getWidth()+"px",p.style.height=e.getHeight()+"px",e.getView().appendChild(p),!e.isContinuousLayout()){var u=f.resizeDiv=Xi();u.style.left=s.style.left,u.style.top=s.style.top,u.style.width=s.style.width,u.style.height=s.style.height,u.style.opacity=e.getDragOpacity(),u.style.background=e.getDividerBackground(),Ej(f.getView(),u)}f._lastAbsPosition=e._22o,f._86o=oo(e)?Tk(W).x:Tk(W).y,Mj(f,W)}},handleWindowTouchMove:function(B){Wg(B)&&this.update(B,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(D){var u=this;u.update(D,!0),u.sv.setStatus(ts),u.maskDiv&&gl(u.maskDiv),u.resizeDiv&&gl(u.resizeDiv),u.maskDiv=u.resizeDiv=E},handle_mousedown:function(G){kp(G)&&this.handle_touchstart(G)},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},update:function(I,e){var j=this,G=j.sv,u=oo(G)?G.getWidth():G.getHeight(),m=G._dividerSize,K=j._lastAbsPosition-j._86o;oo(G)?(K+=Tk(I).x,K>u-m&&(K=u-m),0>K&&(K=0),j.resizeDiv&&(j.resizeDiv.style.left=K+yr)):(K+=Tk(I).y,K>u-m&&(K=u-m),0>K&&(K=0),j.resizeDiv&&(j.resizeDiv.style.top=K+yr)),e&&u!==m&&(1===G._82O?G.setPosition(K,1):-1===G._82O?G.setPosition(K-u+m,1):G.setPosition(K/(u-m),1))}}),Jt.TabView=function(){var k=this,A=k._view=Of(1,k),F=k._91O=Xi(1),d=k._tabModel=new ed,t=d.sm(),B=k.invalidate;k._7o=new oc,k._canvas=ej(F),Ej(A,F),Ej(A,k._92O=Xi(1)),t.setSelectionMode(qr),t.ms(k.handleSelectionChange,k),d.mm(B,k),d.mh(B,k),d.md(B,k),k._interactor=new Pt(k),k.iv()},Kt("TabView",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Yi,ee,"tabHPadding","tabBackground","selectWidth",yd,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:Mo,_tabHeight:yh,_tabGap:K.tabViewTabGap,_labelColor:K.tabViewLabelColor,_labelFont:K.tabViewLabelFont,_tabBackground:K.tabViewTabBackground,_selectWidth:K.tabViewSelectWidth,_selectBackground:K.tabViewSelectBackground,_moveBackground:K.tabViewMoveBackground,_insertColor:K.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(M,v,P){var o,T=this._tabModel;return M instanceof Lt?(o=M,v&&o.setView(v)):(o=new Lt,o.setName(M),o.setView(v)),T.add(o),P&&T.sm().ss(o),o},getLabel:function(d){return d.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(M){this._23o=M,this.iv()},get:function(Y){var P=this,T=P._tabModel;if(Kg(Y))return T._roots.get(Y);if(Om(Y)){var n;return T.each(function(Z){Y===P.getLabel(Z)&&(n=Z)}),n}return Y instanceof Lt?Y:E},select:function(o){this._tabModel.sm().ss(this.get(o))},remove:function(j){var C=this;if(j=C.get(j)){var A=C._tabModel,D=A._roots.indexOf(j);C._tabModel.remove(j),C.selectByIndex(--D)}},getCurrentTab:function(){return this._8o},hideTabView:function(w,O){O.parentNode===this._92O&&(sb(O)?(O.style.display=cn,O._tab_=w):gl(O),mb())
},showTabView:function(b,N){sb(N)&&(N.style.display="block",N._tab_=b),N.parentNode!==this._92O&&(Ej(this._92O,N),mb())},_24o:function(){var Z,L=this,F=L._8o,$=L._9o,Q=L._tabModel.sm().ld();Q&&(Z=_f(Q.getView())),Z!==$&&($&&(F.getView()&&F.getView().endEditing&&F.getView().endEditing(),L.hideTabView(F,$)),Z&&L.showTabView(Q,Z)),L._8o=Q,L._9o=Z,F!==Q&&L.onTabChanged(F,Q)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(b,p){this.selectByIndex(--p)},selectByIndex:function(e){var x=this,b=x._tabModel,t=b.size();if(t&&!b.sm().ld()){e==E&&(e=0),e>=t&&(e=t-1),0>e&&(e=0);for(var F=e;F>=0;F--){var n=x.get(F);if(!n.isDisabled())return x.select(n),n}for(F=e+1;t>F;F++)if(n=x.get(F),!n.isDisabled())return x.select(n),n}},getTabWidth:function(F){var S=this.getTabHPadding(),P=4+2*S,z=fl(F.getIcon());z&&(P+=_r(z,F)+4);var h=this.getLabel(F);return h&&(P+=_p(this.getLabelFont(F),h).width+4),F.isClosable()&&(P+=10),P},drawTab:function(y,u,x,Y,c,w,g){var V,X=this,A=X._tabPosition,i=this.getTabHPadding(),W=x+4+i,j=X._selectWidth,m=fl(u.getIcon()),P=u.isDisabled(),v=X.getLabelColor(u),R=X.getLabelFont(u),p=X.getLabel(u),J=X._selectBackground,k=A===zi+"-vertical",a=A===es+"-vertical";(k||a)&&(W=Y+4+i),P&&(y.globalAlpha=vl),cs(y,x,Y,c,w,g),u===X._8o&&j&&(A===Mo?cs(y,x,Y+w-j,c,j,J):A===zi?cs(y,x+c-j,Y,j,w,J):A===es?cs(y,x,Y,j,w,J):k?cs(y,x+c-j,Y,j,w,J):a?cs(y,x,Y,j,w,J):cs(y,x,Y,c,j,J));var F=c/2;if(k&&(xc(y,F,Y+w/2),pl(y,D),xc(y,-F,-Y-w/2)),m){var T=wm(m,u),Z=_r(m,u);if(k||a){var t=x+c/2,O=W+T/2;xc(y,t,O),pl(y,ss),xc(y,-t,-O),yb(y,m,x+c/2,W+T/2,u,X),xc(y,t,O),pl(y,-ss),xc(y,-t,-O),W+=T+4}else yb(y,m,W+Z/2,Y+w/2,u,X),W+=Z+4}return k||a?(xc(y,c/2,W+c/2),pl(y,ss),xc(y,-c/2,-W-c/2),_k(y,p,R,v,x,W,w,c),xc(y,c/2,W+c/2),pl(y,-ss),xc(y,-c/2,-W-c/2)):_k(y,p,R,v,W,Y,c,w),k&&(xc(y,F,Y+w/2),pl(y,-D),xc(y,-F,-Y-w/2)),u.isClosable()&&(V=a?{x:x+c-12,y:Y+w-12,width:12,height:12}:{x:x+c-12,y:Y+2,width:12,height:12},this.drawCloseIcon(u,y,v,V)),P&&(y.globalAlpha=1),V},drawCloseIcon:function(d,g,i,a){var z=a.x,J=a.y;g.strokeStyle=i,g.lineWidth=1,g.beginPath(),g.moveTo(z+2,J+8),g.lineTo(z+8,J+2),g.moveTo(z+8,J+8),g.lineTo(z+2,J+2),g.stroke()},getTabAt:function(T){var W=this._interactor._8Q(T);return W?W.tab:null},validateImpl:function(){var b=this;b._24o();var h,s=b._canvas,P=b._tabPosition,u=b._91O,i=b._92O,o=b._tabModel,H=b.getWidth(),Q=b.getHeight(),x=b._tabHeight,V=b._7o,q=b._tabGap,F=P===Mo,T=P===zi,D=P===es,J=P===zi+"-vertical",p=P===es+"-vertical",E=b._23o,Z=0;if((T||D)&&o._roots.each(function(V){Z=_(b.getTabWidth(V),Z)}),F?(Xb(u,0,0,H,x),h={x:0,y:x,width:H,height:_(0,Q-x)}):T?(Xb(u,0,0,Z,Q),h={x:Z,y:0,width:_(0,H-Z),height:Q}):D?(Xb(u,H-Z,0,Z,Q),h={x:0,y:0,width:_(0,H-Z),height:Q}):J?(Xb(u,0,0,x,Q),h={x:x,y:0,width:_(0,H-x),height:Q}):p?(Xb(u,H-x,0,x,Q),h={x:0,y:0,width:_(0,H-x),height:Q}):(Xb(u,0,Q-x,H,x),h={x:0,y:0,width:H,height:_(0,Q-x)}),Xb(i,h),J||p){b._9o&&(h.x=0,Xb(b._8o.getView(),h)),Gm(s,x,Q);var C=Te(s),A=0;if(Rf(C,0,b.ty(),1),C.clearRect(0,0,x,Q),V.clear(),o._roots.each(function(n){if(n.isVisible()){var Q,I=b.getTabWidth(n);if(!E||E.tab!==n){var m=b.getTabBackground(n);Q=b.drawTab(C,n,0,A,x,I,m)}V.add({_75o:Q,tab:n,startY:A,endY:A+I,height:I}),A+=I+q}}),b._23Q=_(0,A-q),E){var y=E.position;b.drawTab(C,E.tab,0,E.startY,x,E.height,b._moveBackground),cs(C,0,y,x,1,b._insertColor)}if(C.restore(),b._selectionChanged){b._selectionChanged=!1;for(var I=b.ty(),G=0;G<V.size();G++){var c=V.get(G);if(c.tab===b._8o){if(c.endY+I<0){b.ty(-c.startY);break}if(c.startY+I>Q){b.ty(Q-c.endY);break}}}}b.ty(b.ty())}else if(T||D){b._9o&&(h.x=0,Xb(b._8o.getView(),h)),Gm(s,Z,Q);var C=Te(s),A=0;if(Rf(C,0,b.ty(),1),C.clearRect(0,0,Z,Q),V.clear(),o._roots.each(function(O){if(O.isVisible()){var u;if(!E||E.tab!==O){var _=b.getTabBackground(O);u=b.drawTab(C,O,0,A,Z,x,_)}V.add({_75o:u,tab:O,startY:A,endY:A+x,height:x}),A+=x+q}}),b._23Q=_(0,A-q),E){var y=E.position;b.drawTab(C,E.tab,0,E.startY,Z,E.height,b._moveBackground),cs(C,0,y,Z,1,b._insertColor)}if(C.restore(),b._selectionChanged){b._selectionChanged=!1;for(var I=b.ty(),G=0;G<V.size();G++){var c=V.get(G);if(c.tab===b._8o){if(c.endY+I<0){b.ty(-c.startY);break}if(c.startY+I>Q){b.ty(Q-c.endY);break}}}}b.ty(b.ty())}else{b._9o&&(h.y=0,Xb(b._8o.getView(),h)),Gm(s,H,x);var C=Te(s),t=0;if(Rf(C,b.tx(),0,1),C.clearRect(0,0,H,x),V.clear(),o._roots.each(function(I){if(I.isVisible()){var T,_=b.getTabWidth(I);if(!E||E.tab!==I){var g=b.getTabBackground(I);T=b.drawTab(C,I,t,0,_,x,g)}V.add({_75o:T,tab:I,startX:t,endX:t+_,width:_}),t+=_+q}}),b._64I=_(0,t-q),E){var y=E.position;b.drawTab(C,E.tab,E.startX,0,E.width,x,b._moveBackground),Sd(C,b._insertColor,y,0,x)}if(C.restore(),b._selectionChanged){b._selectionChanged=!1;for(var N=b.tx(),G=0;G<V.size();G++){var c=V.get(G);if(c.tab===b._8o){if(c.endX+N<0){b.tx(-c.startX);break}if(c.startX+N>H){b.tx(H-c.endX);break}}}}b.tx(b.tx())}for(var X=[],n=i.children,G=0;G<n.length;G++){var v=n[G],M=v._tab_;M&&!o.contains(M)&&X.push(v)}X.forEach(function(g){i.removeChild(g)})}});var Pt=function(T){this.tv=T,this.addListeners()};gd(Pt,O,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(X){this.handleScroll(X,10*(X.wheelDelta/40))},handle_DOMMouseScroll:function(z){this.handleScroll(z,10*-z.detail)},handleScroll:function(P,n){up(P);var $=this.tv,W=$._tabPosition;!$._40o()||W!==Mo&&W!==de||$.tx(this.tv.tx()+n),!$._41o()||W!==zi&&W!==es&&W!==zi+"-vertical"&&W!==es+"-vertical"||$.ty(this.tv.ty()+n)},_8Q:function(o){var F,O,W=this.tv,b=W._tabPosition,l=W._7o;if(b===Mo||b===de){var h=W.lp(o).x;for(F=0;F<l.size();F++)if(O=l.get(F),O.startX<=h&&h<=O.endX)return O}else if(b===zi||b===es||b===zi+"-vertical"||b===es+"-vertical"){var r=W.lp(o).y;for(F=0;F<l.size();F++)if(O=l.get(F),O.startY<=r&&r<=O.endY)return O}return E},isClickable:function(T){var G=this.tv,D=G._tabPosition,M=this._73o=this._8Q(T);return!G._40o()||D!==Mo&&D!==de?!G._41o()||D!==zi&&D!==es&&D!==zi+"-vertical"&&D!==es+"-vertical"?M&&(!M.tab.isDisabled()||G.isMovable()):!0:!0},handle_mousemove:function(n){var H=this;Yb?H._74o=H._8Q(n):H.getView().style.cursor=H.isClickable(n)?Wc:""},handle_mousedown:function(c){this.handle_mousemove(c),this.handle_touchstart(c)},handle_touchstart:function(F){var K=this,I=K.tv,Y=I._tabPosition;up(F),kp(F)&&K.isClickable(F)&&(Y===Mo||Y===de?(K.x=Tk(F).x,K.lp=I.lp(F),K.tx=I.tx()):(K.y=Tk(F).y,K.lp=I.lp(F),K.ty=I.ty()),Mj(K,F))},handle_mouseup:function(B){this.handle_touchend(B)},handle_touchend:function(u){if(Ym(u)){var M=this._73o;if(!M)return;var x=this.tv,b=x.getTabModel(),i=M.tab;if(!i.isDisabled()&&i.isClosable()){var _=function(){var r=b._roots.indexOf(i);b.remove(i),x.onTabClosed(i,r)};x.onTabClosing(i,_)&&_()}}},handleWindowMouseMove:function(t){this.handleWindowTouchMove(t)},handleWindowTouchMove:function(S){var P,D=this,m=D.tv,s=m._tabPosition,W=D._73o;if(s===Mo||s===de){if(P=Tk(S).x-D.x,!D._25o&&!D.moving&&B(P)>2&&(m._40o()&&!Bj(S)?D._25o=1:W&&m.isMovable()&&(D.moving=1)),D._25o)m.tx(D.tx+P);else if(D.moving){var E=D.lp.x+P,K=m._tabGap/2;m._7o.each(function(T){var A=T.endX,V=E-T.startX<A-E;E>=T.startX&&A>=E&&m._7Q({tab:W.tab,startX:W.startX+P,width:W.width,front:V,insertTab:T.tab,position:V?_(0,T.startX-K):I(m._64I,A+K)})})}}else if(P=Tk(S).y-D.y,!D._25o&&!D.moving&&B(P)>2&&(m._41o()&&!Bj(S)?D._25o=1:W&&m.isMovable()&&(D.moving=1)),D._25o)m.ty(D.ty+P);else if(D.moving){var k=D.lp.y+P,K=m._tabGap/2;m._7o.each(function(r){var u=r.endY,t=k-r.startY<u-k;k>=r.startY&&u>=k&&m._7Q({tab:W.tab,startY:W.startY+P,height:W.height,front:t,insertTab:r.tab,position:t?_(0,r.startY-K):I(m._23Q,u+K)})})}},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(){var I=this,m=I.tv,e=m._tabPosition,v=m.getTabModel(),A=v._roots,M=I._73o;if(I.moving){var T=m._23o;if(T&&T.insertTab!==T.tab){var z=T.tab,p=A.remove(z),x=A.indexOf(T.insertTab);x>=0&&(T.front||x++,x<=A.size()&&(A.add(z,x),v._38I(z,p,x)))}m._7Q(E),delete I.moving}else if(!I._25o&&M){z=M.tab;var G=I._74o;if(!G||G.tab===z)if(!z.isDisabled()&&mg(M._75o,I.lp)){var r=function(){var N=A.indexOf(z);v.remove(z),m.onTabClosed(z,N)};m.onTabClosing(z,r)&&r()}else z.isDisabled()||m._8o===z||v.sm().ss(z)}I._25o=I._73o=I._74o=e===Mo||e===de?I.x=I.lp=I.tx=E:I.y=I.lp=I.ty=E}}),Jt.PropertyView=function(F){var M=this;M._view=Of(1,M),M._canvas=ej(M._view),Ej(M._view,M._79O=Xi()),M._rows=new oc,M._28o=new oc,M._26o={},M._26Q={};var P=M._propertyModel=new ed,G=M.ivm;P.mm(G,M),P.md(G,M),P.mh(G,M),M.dm(F?F:new ed),new Qt(M)},Kt("PropertyView",O,{ms_ac:[Yi,Li,ee,xp,tn,"categorizable",iq,Uc,np,Xh,_e,tm,Dh,jj,"selectRowIndex",yd,"background",bc,Se,gp,gm,Uq],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Cm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Qn,_background:K.propertyViewBackground,_expandIcon:K.propertyViewExpandIcon,_collapseIcon:K.propertyViewCollapseIcon,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoHideScrollBar:Vb,_selectBackground:K.propertyViewSelectBackground,_rowHeight:wg,_rowLineVisible:K.propertyViewRowLineVisible,_rowLineColor:K.propertyViewRowLineColor,_10I:.5,_columnLineVisible:K.propertyViewColumnLineVisible,_columnLineColor:K.propertyViewColumnLineColor,_labelColor:K.propertyViewLabelColor,_labelSelectColor:K.propertyViewLabelSelectColor,_labelFont:K.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(R){0>R&&(R=0),R>1&&(R=1);var O=this,$=O._10I;O._10I=R,O.fp("columnPosition",$,R)},getPropertyName:function(F){return F.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(N,J,Z){return Z===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(R,Y){return Y===this._selectRowIndex?this._labelSelectColor:R.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(x){var F=this.getHeight()-this._59I;return F>x&&(x=F),x>0?0:j(x)},isExpanded:function(T){if(!T)return!0;var P=this._26o[T];return P?P.isExpanded:!(this._26Q[T]===!1)},toggle:function(v){var R=this;R.isExpanded(v)?R.collapse(v):R.expand(v)},expandAll:function(){this.validate();for(var E in this._26o)this.expand(E)},expand:function(q){if(q&&q!==cn){var N=this,e=N._26o[q];e&&!e.isExpanded&&(e.isExpanded=!0,N.onExpanded(q),N.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Z in this._26o)this.collapse(Z)},collapse:function(F){if(F&&F!==cn){var J=this,N=J._26o[F];N&&N.isExpanded&&(N.isExpanded=!1,J.onCollapsed(F),J.ivm())}},onCollapsed:function(){},getCategoryName:function(B){if(!this.isCategorizable())return cn;var f=B.getCategoryName();return f?f:cn},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(M){var r=this,b=r._dataModel;b!==M&&(b&&(b.umd(r.handlePropertyChange,r),r._selectionModel||b.sm().ums(r.handleSelectionChange,r)),r._dataModel=M,M.md(r.handlePropertyChange,r),r._selectionModel?r._selectionModel._21I(M):M.sm().ms(r.handleSelectionChange,r),r.fp(ac,b,M))},isVisible:function(C){return this._visibleFunc?this._visibleFunc(C):!0},onPropertyChanged:function(v){var e=this,G=v.property;Et[G]?e.ivm():e.iv(),G===oq&&e._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:Kd},handlePropertyChange:function(X){this._27o===X.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var q=this;q._96I||(q.setSelectRowIndex(-1),q._96I=1,q.iv())},redraw:function(){this.iv()},validateModel:function(){var H=this,t=H._rows,b=H._28o,Z={},y=new oc,u=H._27o;H.updateCurrentData(),u!==H._27o&&H.endEditing(),t.clear(),b.clear(),H.getRawProperties().each(function(i){if(H.isVisible(i)){y.add(i);var s=H.getCategoryName(i);Z[s]||(b.add(s,s===cn?0:P),Z[s]={isExpanded:H.isExpanded(s),properties:new oc})}}),H._sortFunc&&y.sort(H._sortFunc);for(var Y in H._26o)H._26Q[Y]=H.isExpanded(Y);H._26o=Z,b.each(function(u){u!==cn&&t.add(u);var Q=Z[u];Q.isExpanded&&y.each(function(O){H.getCategoryName(O)===u&&(Q.properties.add(O),t.add({property:O,data:H._27o}))},H)})},validateImpl:function(){var s=this;s._76o(),s._96I&&(s.validateModel(),delete s._96I);var C=s._canvas,O=s.getWidth(),U=s.getHeight(),G=-s.ty(),I=s._rowHeight,e=s._indent,Z=O-e,V=s._rows,g=V.size(),M=s._9I=e+Z*s._10I,S=s._59I=g*I;Gm(C,O,U),s._29I={x:0,y:G,width:O,height:U},s._31I=X(G/I),s._14I=i((G+U)/I),s._31I<0&&(s._31I=0),s._14I>g&&(s._14I=g);var y,Y=Te(C),x=s._background;Rf(Y,0,-G,1),Y.beginPath(),Y.rect(0,G,O,U),Y.clip(),Y.clearRect(0,G,O,U),s._93db(Y),x&&cs(Y,0,0,e,S,x);for(var P=s._31I;P<s._14I;P++){var R=V.get(P),G=I*P;if(Om(R))x&&cs(Y,e,G,Z,I,x),y=fl(s.isExpanded(R)?s._expandIcon:s._collapseIcon),y&&_c(Y,y,nl,0,G,e,I),Y.save(),Y.beginPath(),Y.rect(e,G,Z,I),Y.clip(),s.drawCategoryName(Y,R,P,e,G,Z,I),Y.restore();else{var T=R.property,b=R.data,y=fl(T.getIcon()),D=s._selectRowIndex===P?s.getSelectBackground():E;if(y&&_c(Y,y,nl,0,G,e,I),D&&cs(Y,e,G,Z,I,D),Y.save(),Y.beginPath(),Y.rect(e,G,M-e,I),Y.clip(),s.drawPropertyName(Y,T,P,e,G,M-e,I),Y.restore(),!s.isEditing(b,T)){var _=M+1,F=O-M-1;Y.save(),Y.beginPath(),Y.rect(_,G,F,I),Y.clip(),s._87o(s.drawPropertyValue(Y,T,s.getValue(b,T),P,_,G,F,I,b),P,_,G,F,I),Y.restore()}}s._rowLineVisible&&cs(Y,e,G+I-1,Z,1,s._rowLineColor)}s._columnLineVisible&&(cs(Y,M,0,1,S,s._columnLineColor),cs(Y,O-1,0,1,S)),s._92db(Y),s._93I(),Y.restore(),s.ty(s.ty())},drawCategoryName:function(d,r,Q,R,U,t,b){_k(d,r,this.getCategoryFont(r),this.getCategoryColor(r),R,U,t,b)},drawPropertyName:function(u,A,W,X,N,d,n){return A.drawPropertyName?(A.drawPropertyName(u,A,W,X,N,d,n,this),void 0):(_k(u,this.getPropertyName(A),this.getPropertyFont(A,W),this.getPropertyColor(A,W),X,N,d,n),void 0)},drawPropertyValue:function(d,w,K,J,n,I,W,B,F){return w.drawPropertyValue?w.drawPropertyValue(d,w,K,J,n,I,W,B,F,this):(Gt(d,K,w,this.getLabelFont(w,K,J),this.getLabelColor(w,K,J),n,I,W,B,F,this),void 0)},isPropertyEditable:function(U){return U.isEditable()&&this.isEditable()},setProperties:function($){this._propertyModel.clear(),this.addProperties($)},addProperties:function(e){if(e){var r=this._propertyModel;e.forEach(function(U){if(!(U instanceof Nt)){var F=Zp(U.className);U=Im(F?F:Nt,U)}r.add(U)})}},getRowIndexAt:function(F){var s=this,L=X(s.lp(F).y/s._rowHeight);return L>=0&&L<s._rows.size()?L:-1},getPropertyAt:function(D){var n=this,v=n.getRowIndexAt(D);return v>=0?n._rows.get(v).property:E},getToolTip:function(O){var K=this,u=K.getPropertyAt(O),D=K._27o;return u&&D?u.getToolTip(D,K._9I<K.lp(O).x,K):E}});var Qt=function(F){this.pv=F,this.addListeners()};gd(Qt,O,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(X){this.getView().style.cursor=X},clear:function(){var B=this;B._62O=B.cp=B.ty=B.p=E,B.setCursor(Dj)},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(u){var Y=this,V=Y.pv;up(u),V.setFocus(u)&&(kp(u)?(Y.cp=Tk(u),Y.ty=V.ty(),Y.p=V.getColumnPosition(),Y.handle_touchmove(u)):V.setSelectRowIndex(V.getRowIndexAt(u)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(r){this.handle_touchend(r)},handle_touchend:function(k){var b=this;if(b.cp&&!b._62O){var R=b.pv,H=R.lp(k),g=H.x,T=H.y,Y=R._indent,r=R.getRowIndexAt(k),u=R._9I;if(r>=0){var F=R._rowHeight,N=F*r,f=R._rows.get(r),Q=f.property;if(Om(f))fl(R.isExpanded(f)?R._expandIcon:R._collapseIcon)&&g>=0&&Y>=g&&T>=N&&N+F>=T?R.toggle(f):dh(k)&&R.toggle(f);else if(g>u&&R.isPropertyEditable(Q,k)){var D={x:u+1,y:N,width:R.getWidth()-u-1,height:F},Z={x:D.x+R.tx(),y:D.y+R.ty(),width:D.width,height:D.height},W=0,M=R._29I;D.y<M.y?W=D.y-M.y:D.y+F>M.y+M.height&&(W=D.y+F-M.y-M.height),W&&(R.ty(R.ty()-W),Z.y-=W),R.beginEditing({data:f.data,property:Q,value:R.getValue(f.data,Q),event:k,rect:D,editorRect:Z,view:R})}}R.setSelectRowIndex(r)}b.clear()},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(p){var J=this,i=J.pv,C=J.ty,K=J.cp,D=Tk(p),E=J._62O;if("p"===E)i.setTranslateY(C+D.y-K.y);else if("c"===E){var b=i.getWidth()-i._indent;if(b>16){var u=J.p-(K.x-D.x)/b,O=16/b;O>u&&(u=O),u>1-O&&(u=1-O),i.setColumnPosition(u)}}else"s"===E&&i.setTranslateY(C+(K.y-D.y)*i._59I/i._29I.height)},handle_mousemove:function(y){this.handle_touchmove(y)},handle_touchmove:function(r){if(!Yb&&kp(r)){var L=this,$=L.pv,q=B($.lp(r).x-$._9I)<=(kd?8:3);L.cp?L._62O||(q?(L._62O="c",Mj(L,r)):B(Tk(r).y-L.cp.y)>=2&&(L._62O=L.isV(r)?"s":"p",Mj(L,r))):(q?L.setCursor(sj):L.setCursor(Dj),L.isV(r)&&$._43o())}},isV:function(P){var E=this.pv,D=E._29I;return E._41o()&&D.x+D.width-E.lp(P).x<hj},handle_mousewheel:function(v){this.handleScroll(v,v.wheelDelta/40)},handle_DOMMouseScroll:function(Q){2===Q.axis&&this.handleScroll(Q,-Q.detail)},handleScroll:function(u,h){var i=this.pv;up(u),i.endEditing(),i.translate(0,h*i.getRowHeight())},handle_keydown:function(f){var c=this.pv,r=c._rows.size(),E=c._selectRowIndex+(mp(f)?-1:1);(mp(f)||Wq(f))&&(0>E&&(E=0),E>=r&&(E=r-1),c.setSelectRowIndex(E))}}),Jt.ListView=function(w){this._5o(w),new Rt(this)},Kt("ListView",O,{ms_ac:[Yi,Li,ee,bc,iq,Se,gp,Uc,np,tm,Dh,jj,dj,yd],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Qn,_rowHeight:wg,_rowLineVisible:K.listViewRowLineVisible,_rowLineColor:K.listViewRowLineColor,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoMakeVisible:Kc,_autoHideScrollBar:Vb,_selectBackground:K.listViewSelectBackground,_labelColor:K.listViewLabelColor,_labelSelectColor:K.listViewLabelSelectColor,_labelFont:K.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(S){var v=this,U=v._checkMode;v._checkMode=S,v.fp($p,U,S)},drawRow:function(O,L,V,n,C,m,b){var Z=this,f=0,z=Z._indent,Q=Z.getIconWidth(L);Z.drawRowBackground(O,L,V,n,C,m,b),Z._checkMode&&(yb(O,fl(Z.getCheckIcon(L)),f+z/2,C+b/2,L,Z),f+=z),Z.drawIcon(O,L,f,C,Q,b),Z.drawLabel(O,L,f+Q,C,b)}});var Rt=function(g){this.list=g,this.addListeners()};gd(Rt,O,{ms_listener:1,getView:function(){return this.list._view},clear:function(i){var f=this,I=f.list;i&&"d"===f._62O&&!f.dragCancel&&I.handleDragAndDrop(i,"end"),I.draggingData&&(I.draggingData=null,I.redraw()),f.dragCancel=f._62O=f._isV=f._isH=f.cp=f.tx=f.ty=E},handle_mousedown:function(T){this.handle_touchstart(T)},handle_touchstart:function(O){var S=this,p=S.list;if(up(O),p.setFocus(O)){var w=p.getDataAt(O);S.cp=Tk(O),S.tx=p.tx(),S.ty=p.ty(),kp(O)?w&&p.handleDragAndDrop&&!S.isV(O)&&!S.isH(O)&&p.isDraggable(w)&&(p.draggingData=w,p.redraw(),p.handleDragAndDrop(O,"prepare")):(w?S._33o(O,w):this._cancelDataDoubleSelect(),S.clear(O))}},handleWindowMouseUp:function(m){this.clear(m)},handleWindowTouchEnd:function(g){this.clear(g)},handle_mouseup:function(T){this.handle_touchend(T)},handle_touchend:function(x){var Y=this,Z=Y.list;if(!Y._isV&&!Y._isH&&Y.cp&&!Y._62O){var b=Z.getDataAt(x);b?(Z.isCheckMode()?Y._34o(x,b):Y._33o(x,b),dh(x)?Z.onDataDoubleClicked(b,x):Z.onDataClicked(b,x)):(Y._cancelDataDoubleSelect(),Z.handleBackgroundClick(x))}Y.clear(x)},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(R){var X=this,K=X.list,I=X._62O,c=X.tx,s=X.ty,J=X.cp,C=Tk(R),P=K._29I;"p"===I?K.setTranslate(c+C.x-J.x,s+C.y-J.y):"v"===I?K.ty(s+(J.y-C.y)*K._59I/P.height):"h"===I?K.tx(c+(J.x-C.x)*K._91I/P.width):"d"===I&&(X.dragCancel||K.handleDragAndDrop(R,"between"))},handle_mousemove:function(B){this.handle_touchmove(B)},handle_touchmove:function(B){if(!Yb&&kp(B)){var G=this,p=G.list;if(G._isV=G.isV(B),G._isH=G.isH(B),G.cp){if(!G._62O){if(nk(Tk(B),G.cp)<2)return;G._isV?G._62O="v":G._isH?G._62O="h":p.draggingData&&!this.dragCancel?(G._62O="d",p.handleDragAndDrop(B,"begin")):G._62O="p",G._62O&&"d"!==G._62O&&p.draggingData&&(p.draggingData=null,p.redraw()),Mj(G,B)}}else G._isV&&p._43o(),G._isH&&p._42o()}},isV:function(r){var C=this.list,v=C._29I;return C._41o()&&v.x+v.width-C.lp(r).x<hj},isH:function(d){var S=this.list,r=S._29I;return S._40o()&&r.y+r.height-S.lp(d).y<hj},handle_mousewheel:function(I){this.handleScroll(I,I.wheelDelta/40,I.wheelDelta!==I.wheelDeltaX)},handle_DOMMouseScroll:function(Q){this.handleScroll(Q,-Q.detail,1)},handleScroll:function(O,m,L){var k=this.list;up(O),k.endEditing&&k.endEditing(),L&&k._41o()?k.translate(0,m*k.getRowHeight()):k._40o()&&k.translate(10*m,0)},handle_keydown:function(F){if(!K.isInput(F.target)){var Q,z=this.list,B=z.sm(),s=z._rows,y=s.size();if(Bd(F))z.selectAll();else if(ho(F))z.handleDelete&&z.handleDelete(F);else if(xq(F))"d"!==this._62O||this.dragCancel||(z.handleDragAndDrop(F,"cancel"),this.dragCancel=!0);else if(Vo(F))z.isCheckMode()&&(Q=z.getFocusData(),Q&&z.checkData(Q));else if(mp(F)||Wq(F)){var r=z.isCheckMode();if(Q=r?z.getFocusData():B.ld()){var e=z.getRowIndex(Q);e>=0&&(mp(F)?0!==e&&(Q=s.get(e-1),r?z.setFocusData(Q):B.ss(Q)):e!==y-1&&(Q=s.get(e+1),r?z.setFocusData(Q):B.ss(Q)))}else y>0&&(Q=s.get(0),r?z.setFocusData(Q):B.ss(Q))}}},_34o:function(E,F){var Q=this.list,C=Q.lp(E).x;return C>=0&&C<=Q._indent?(Q.checkData(F),void 0):(Q.setFocusData(F),void 0)},_33o:function(y,L){var W=this.list,c=W.sm(),P=c.ld();if(!W.canHandleSelectMode(y,L))return this._cancelDataDoubleSelect(),void 0;if(Bj(y))W.isSelected(L)?c.rs(L):c.as(L);else if(um(y))if(P)for(var N=W.getRowIndex(P),O=W.getRowIndex(L);N!==O;)N+=O>N?1:-1,c.as(W._rows.get(N));else c.ss(L);else kp(y)?(c.contains(L)?W.handleDataDoubleSelect&&(this._handleDataDoubleSelect(y,L),dh(y)&&this._cancelDataDoubleSelect()):this._cancelDataDoubleSelect(),c.ss(L)):c.contains(L)||c.ss(L)},_handleDataDoubleSelect:function(X,I){this._cancelDataDoubleSelect(),this._doubleSelectTimer=Jn(function(){this.list.handleDataDoubleSelect(X,I),this._doubleSelectTimer=P}.bind(this),K.doubleClickSpeed)},_cancelDataDoubleSelect:function(){this._doubleSelectTimer&&(Lp(this._doubleSelectTimer),this._doubleSelectTimer=P)}}),Jt.TreeView=function(Q){var w=this;w._35o(),w._5o(Q),new St(w)},Kt("TreeView",O,{ms_ac:[Yi,Li,ee,"rootVisible",$p,"rootData",Uc,np,tm,Dh,jj,iq,bc,Se,gp,Xh,_e,dj,yd,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:E,_indent:Qn,_rowHeight:wg,_rowLineVisible:K.treeViewRowLineVisible,_rowLineColor:K.treeViewRowLineColor,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoHideScrollBar:Vb,_expandIcon:K.treeViewExpandIcon,_collapseIcon:K.treeViewCollapseIcon,_autoMakeVisible:Kc,_selectBackground:K.treeViewSelectBackground,_labelColor:K.treeViewLabelColor,_labelSelectColor:K.treeViewLabelSelectColor,_labelFont:K.treeViewLabelFont,_doubleClickToToggle:K.treeViewDoubleClickToToggle,drawRow:function(w,T,i,b,d,N,n){var l=this;l.drawRowBackground(w,T,i,b,d,N,n),l.drawTree(w,T,i,0,d,N,n)},isOnToggleIcon:function(e){var P=this.getDataAt(e);if(P){var J=this.getIndent(),v=this.lp(e).x;if(fl(this.getToggleIcon(P))){var F=J*this.getLevel(P);if(v>=F&&F+J>=v)return!0}}return!1}});var St=function(f){cb(St,this,[f])};gd(St,Rt,{toggle:function(Z,V,W,t){var i=this.list,p=i.lp(Z).x;if(fl(i.getToggleIcon(V))){var l=W*t;if(p>=l&&l+W>=p)return i.toggle(V),!0}return i.isDoubleClickToToggle()&&dh(Z)?(i.toggle(V),!0):!1},_34o:function(p,Q){var C=this.list,E=C.lp(p).x,_=C._levelMap[Q._id],O=C._indent,N=O*(_+1);return E>=N&&N+O>=E?(C.checkData(Q),void 0):(this.toggle(p,Q,O,_)||C.setFocusData(Q),void 0)},_33o:function(o,H){var O=this,V=O.list;if(!O.toggle(o,H,V._indent,V.getLevel(H)))if(um(o)){var j=V.sm();if(j.size()>0){for(var K=V._rows,C=null,B=0,z=K.size();z>B;B++)if(V.isSelected(K.get(B))){C=B;break}for(var i=null,B=K.size()-1;B>=0;B--)if(V.isSelected(K.get(B))){i=B;break}var Q,s,x=V.getRowIndex(H);for(C>x?(Q=x-1,s=C):x>i?(Q=i,s=x):(Q=C,s=i);Q!==s;)Q++,j.as(V._rows.get(Q))}else j.ss(H)}else St.superClass._33o.call(O,o,H)},handle_keydown:function(j){if(oj(j)||Lf(j)){var u=this.list,Y=u._rows,O=u.isCheckMode(),D=u.sm(),e=O?u.getFocusData():D.ld();e?e.hasChildren()&&(oj(j)?u.collapse(e):u.expand(e)):Y.size()>0&&(e=Y.get(0),O?u.setFocusData(e):D.ss(e))}else St.superClass.handle_keydown.call(this,j)}});var Tt=Jt.TableView=function(H){this._98I(),this._5o(H),new Ut(this)};Kt("TableView",O,{ms_ac:[Yi,Li,ee,"sortMode",xp,tn,bc,Se,gp,gm,Uq,"sortColumn",Uc,np,tm,Dh,jj,dj,yd],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:pf,_editable:!0,_batchEditable:!1,_rowHeight:wg,_rowLineVisible:K.tableViewRowLineVisible,_rowLineColor:K.tableViewRowLineColor,_columnLineVisible:K.tableViewColumnLineVisible,_columnLineColor:K.tableViewColumnLineColor,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoHideScrollBar:Vb,_autoMakeVisible:Kc,_selectBackground:K.tableViewSelectBackground,_labelColor:K.tableViewLabelColor,_labelSelectColor:K.tableViewLabelSelectColor,_labelFont:K.tableViewLabelFont,getCheckColumn:function(){var l=this;if(!l._31o){var H=l._31o=new Mt;H.setEditable(!0),H.setWidth(40),H.getValue=l.getCheckColumValue,H.drawCell=l.drawCheckColumnCell}return l._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(s){var l=this,M=l._39o,R=l.getCheckColumn();s!==l.isCheckMode()&&(s?M.add(R,0):M.remove(R),l.fp($p,!s,s))},getCheckColumValue:function(X,z,Z){return Z.isSelected(X)},drawCheckColumnCell:function(y,s,a,i,d,P,r,v,V){yb(y,V.getCheckIcon(s),d+r/2,P+v/2,s,V)}});var Ut=function(Z){cb(Ut,this,[Z])};gd(Ut,Rt,{_34o:function(H,s){var l=this.list,I=l._31o;if(l.isCellEditable(s,I,H)){var x=l._3Q(I),q=l.lp(H).x;if(x&&q>=x.startX&&q<x.startX+I.getWidth())return l.checkData(s),void 0}l._37O(s,H),l.setFocusData(s)},_33o:function($,V){this.list._37O(V,$),Ut.superClass._33o.apply(this,arguments)}});var Vt=Jt.TreeTableView=function(J){var B=this,U=B._4o=new Mt;B._35o(),B._98I(),B._5o(J),U.setDisplayName("Name"),U.setEditable(!0),U.setWidth(180),U.drawCell=Wt,U.getValue=Xt,B._39o.add(U),new Yt(B)},Wt=function(H,j,B,U,d,R,n,h,G){G.drawTree(H,j,B,d,R,n,h)},Xt=function(i,T,Q){return Q.getLabel(i)};Kt("TreeTableView",O,{ms_ac:[Yi,Li,ee,"sortMode",xp,tn,iq,$p,"rootData","rootVisible",Uc,np,"sortColumn",Xh,_e,tm,Dh,jj,dj,gp,bc,Se,gm,Uq,yd,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:pf,_checkMode:E,_editable:!0,_batchEditable:!1,_indent:Qn,_rowHeight:wg,_rowLineVisible:K.treeTableViewRowLineVisible,_rowLineColor:K.treeTableViewRowLineColor,_columnLineVisible:K.treeTableViewColumnLineVisible,_columnLineColor:K.treeTableViewColumnLineColor,_expandIcon:K.treeTableViewExpandIcon,_collapseIcon:K.treeTableViewCollapseIcon,_scrollBarColor:Pg,_scrollBarSize:Lh,_autoHideScrollBar:Vb,_autoMakeVisible:Kc,_selectBackground:K.treeTableViewSelectBackground,_labelColor:K.treeTableViewLabelColor,_labelSelectColor:K.treeTableViewLabelSelectColor,_labelFont:K.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Yt=function(Z){cb(Yt,this,[Z])};gd(Yt,Rt,{_34o:function(q,P){var H=this.list,B=H._4o,z=H._3Q(B),R=H.lp(q).x;if(z){var u=H._indent,c=z.startX+u*H.getLevel(P);if(fl(H.getToggleIcon(P))&&R>=c&&c+u>=R)return H.toggle(P),void 0;if(H.isCellEditable(P,B)&&(c+=u,R>=c&&c+u>=R))return H.checkData(P),void 0}H._37O(P,q),H.setFocusData(P)},_33o:function(Z,p){var r=this.list,v=r.lp(Z).x;if(fl(r.getToggleIcon(p))){var f=r._3Q(r._4o);if(f){var M=r._indent,G=f.startX+M*r.getLevel(p);if(v>=G&&G+M>=v)return r.toggle(p),void 0}}r._37O(p,Z),Yt.superClass._33o.apply(this,arguments)}});var Zt=Jt.TableHeader=function(f){var r=this,E=r._view=Of(1,r),b=r._39o=f.getColumnModel(),Y=r.iv;r.tv=r._tableView=f,r._60I=new oc,r._canvas=ej(E),E.style.background=K.tableHeaderBackground||"",E.style.height=kk+yr,b.mm(Y,r),b.md(Y,r),b.mh(Y,r),f.mp(function(v){At[v.property]&&r.iv()},r),new $t(r),r.iv()};Kt("TableHeader",O,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Yi,ee,iq,"moveBackground","insertColor",gm,Uq,"resizable","movable"],_checkIcon:im,_movable:!0,_resizable:!0,_labelColor:K.tableHeaderLabelColor,_labelFont:K.tableHeaderLabelFont,_columnLineColor:K.tableHeaderColumnLineColor,_columnLineVisible:K.tableHeaderColumnLineVisible,_sortDescIcon:K.tableHeaderSortDescIcon,_sortAscIcon:K.tableHeaderSortAscIcon,_moveBackground:K.tableHeaderMoveBackground,_insertColor:K.tableHeaderInsertColor,_indent:Qn,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(h){return h.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(_){return _.getColor()||this._labelColor},getLabelAlign:function(B){return B._align},onPropertyChanged:function(){this.iv()},_5Q:function(P){this._61I=P,this.iv()},getLogicalPoint:function(s){return Fg(s,this._canvas,this.tv.tx())},validateImpl:function(){var Q=this,v=Q._canvas,$=Q.getWidth(),E=Q.getHeight(),b=Q.tv,O=Q._60I,V=Q._61I,r=-b.tx(),T=0;($!==v.clientWidth||E!==v.clientHeight)&&Gm(v,$,E),O.clear(),Q._39o._roots.each(function(e){if(e.isVisible()){var P=T+e.getWidth();r+$>=T&&P>=r&&O.add({column:e,startX:T}),T=P}});var L=Te(v);if(Rf(L,-r,0,1),L.beginPath(),L.rect(r,0,$,E),L.clip(),L.clearRect(r,0,$,E),O.each(function(R){var i=R.column,J=R.startX,v=i.getWidth();v>0&&(L.save(),L.beginPath(),L.rect(J,0,v,E),L.clip(),V&&V.column===i||Q.drawColumn(L,i,J,0,v,E),Q._columnLineVisible&&cs(L,J+v-1,0,1,E,Q._columnLineColor),L.restore())}),V){var I=V.column,T=V.startX,m=V.position,C=I.getWidth();L.save(),L.beginPath(),L.rect(T,0,C,E),L.clip(),L.fillStyle=Q._moveBackground,L.fill(),Q.drawColumn(L,I,T,0,C,E),L.restore(),Sd(L,Q._insertColor,m,0,E)}L.restore()},_6Q:function(m){var x=this.tv;return x._31o===m&&x.sm().getSelectionMode()===Ho},drawColumn:function(B,g,i,f,F,u){var d=this,K=d.tv,X=fl(g.getIcon()),Z=d.getLabelAlign(g);if(d._6Q(g)){var t=fl(d._checkIcon);yb(B,t,i+F/2,f+u/2,g,d)}else{var p=d.getLabel(g),o=d.getLabelFont(g),w=d.getLabelColor(g),U=_p(o,p).width,l=X?d._indent:0;Z===zi?(X&&_c(B,X,nl,i,f,l,u),_k(B,p,o,w,i+l,f,F,u,zi)):Z===es?(X&&_c(B,X,nl,i+F-U-l,f,l,u),_k(B,p,o,w,i,f,F,u,es)):(X&&_c(B,X,nl,i+(F-U-l)/2,f,l,u),_k(B,p,o,w,i+(F-U+l)/2,f,0,u,zi))}if(g.isSortable()&&K.getSortColumn()===g&&(X=fl(g.getSortOrder()===Ri?d._sortAscIcon:d._sortDescIcon))){var D=_r(X,g)/2+2;yb(B,X,Z===es?i+D:i+F-D,f+u/2,g,K)}}});var $t=function(o){var p=this;p.th=o,p.tv=o._tableView,p.addListeners()};gd($t,O,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(b){this.getView().style.cursor=b},handle_mousemove:function(o){if(!Yb){var I=this;delete I._29o,I.setCursor(Dj);for(var h=I.th,l=h._60I,y=h.lp(o).x,K=l.size()-1;K>=0;K--){var L=l.get(K),r=L.column,M=L.startX+r.getWidth();if(h.isResizable()&&B(M-y)<=(kd?10:3))return I._29o=L,I.setCursor(sj),void 0;y>L.startX&&M>y&&(I._29o=L),(r.isClickable()||r.isSortable()||h.isMovable()||I.tv.getCheckColumn&&r===I.tv.getCheckColumn())&&y>L.startX&&M>y&&I.setCursor(Wc)}}},handle_mousedown:function(M){this.handle_touchstart(M)},handle_touchstart:function(w){var D=this;up(w),D.tv.endEditing(),D.handle_mousemove(w),D._29o&&(D.x=Tk(w).x,D.lx=D.th.lp(w).x,D.w=D._29o.column.getWidth(),Mj(D,w))},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(h){var S=this,J=S.th,s=S.getView().style.cursor,x=S._29o,X=Tk(h).x-S.x;if(S.resizing||S.moving||(s===sj?S.resizing=1:J.isMovable()&&s===Wc&&B(X)>2&&(S.moving=1)),S.resizing)x.column.setWidth(S.w+X);else if(S.moving){var l=S.lx+X;J._60I.each(function(y){var n=y.startX,E=n+y.column.getWidth();if(l>=n&&E>=l){var h={column:x.column,startX:x.startX+X,front:E-l>l-n,insertColumn:y.column};h.position=h.front?n:E,J._5Q(h)
}})}},_16Q:function(M,P){var o=this,S=o.tv,D=o.th,s=D._checkIcon;if(D._6Q(M)){var X=fl(s),y=o.lx,e=M.getWidth(),z=_r(X,M);if(y>=P+e/2-z&&P+e/2+z>=y){D.setCheckIcon(s===Oh?im:Oh);var l=S.sm(),F=S._rows;return s===Oh?l.rs(F):l.ss(F),S.onCheckColumnClicked(M),!0}}return!1},handleWindowMouseUp:function(G){this.handleWindowTouchEnd(G)},handleWindowTouchEnd:function(U){var d=this,t=d.tv,$=d.th,v=d._29o;if(d.moving){var u=$._61I;if(u&&u.insertColumn!==u.column){var Z=u.column,k=t.getColumnModel()._roots,I=k.remove(Z),o=k.indexOf(u.insertColumn);o>=0&&(u.front||o++,o<=k.size()&&(k.add(Z,o),t.getColumnModel()._38I(Z,I,o)))}$._5Q(E),delete d.moving}else if(!d.resizing&&v){Z=v.column;var M=$.lp(U).x,R=v.startX,w=!0;if($.onColumnClicked){var c=$.onColumnClicked(Z,U,R);c===!1&&(w=!1)}if(w&&M>=R&&M<=R+Z.getWidth()&&!d._16Q(Z,R)){if(Z.isSortable()){var W=t.getSortMode(),j=Z.getSortOrder();W===pf?t.getSortColumn()===Z?(j===Pi&&t.setSortColumn(E),Z.setSortOrder(j===Ri?Pi:Ri)):t.setSortColumn(Z):"bistate"===W&&(t.getSortColumn()===Z?Z.setSortOrder(j===Ri?Pi:Ri):t.setSortColumn(Z))}t.onColumnClicked(Z,U,R)}}d._29o=d.resizing=d.x=d.lx=d.w=E}}),Jt.TablePane=function(o){this.init(new Tt(o))},Kt("TablePane",O,{ms_v:1,_44o:1}),Jt.TreeTablePane=function(Q){this.init(new Vt(Q))},Kt("TreeTablePane",O,{ms_v:1,_44o:1}),Jt.Toolbar=function(w){var L=this,V=L._view=Of(1,L),e=V.style;e.background=K.toolbarBackground||"",e.height=yh+yr,L._canvas=ej(V),L._30o=new oc,L._90I=new oc,L.setItems(w||[]),V.handleGroupSelectedChanged=function(I){if(I.isSelected()){var w=I.getGroupId();null!=w&&L._items.forEach(function(F){var p=F.element;p&&p!==I&&p.setSelected&&p.getGroupId&&p.getGroupId()===w&&p.setSelected(!1)})}},new _t(L)},Kt("Toolbar",O,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[vp,Yi,ee,Li,yd,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:K.toolbarLabelColor,_labelSelectColor:K.toolbarLabelSelectColor,_labelFont:K.toolbarLabelFont,_selectBackground:K.toolbarSelectBackground,_itemGap:K.toolbarItemGap,_separatorColor:K.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(D){var C=this.getItemInfoAt(D);return C?C.item.toolTip:E},getLabelColor:function(C){return C&&C.selected&&C.type!==Oh&&C.type!==Td?this._labelSelectColor:this._labelColor},onPropertyChanged:function(C){this.iv(),C.property===vp&&this._items.forEach(function(R){Ff(R)})},redraw:function(){this.iv()},addItem:function(D,_){var Y=this._items;_==E?Y.push(D):Y.splice(_,0,D),this.fp(vp,E,Y)},removeItem:function(H){if(H)for(var f=this._items,m=0;m<f.length;m++)H===f[m]&&(f.splice(m,1),this.fp(vp,E,f))},removeItemById:function(O){if(O!=E)for(var r=this._items,D=0;D<r.length;D++)if(O===r[D].id){var s=r.splice(D,1)[0];return this.fp(vp,E,r),s}},getItemById:function(I){if(I!=E)for(var d=this._items,K=0;K<d.length;K++){var L=d[K];if(I===L.id)return L}},setItemVisible:function(L,N){var _=this.getItemById(L);_&&(_.visible=N)},getItemInfos:function(){return this._30o},getItemInfoAt:function(S){var e=this,_=0,c=e._30o,z=e.lp(S),A=z.x,R=z.y;if(R>=0&&R<=e.getHeight())for(;_<c.size();_++){var X=c.get(_);if(X.startX<=A&&A<=X.endX)return X}return E},drawItem:function(L,B,o,O,y){if(B.visible===!1)return 0;if(tj(B.visible)&&!B.visible())return 0;var K=this,i=B.disabled;i&&(L.globalAlpha=vl);var l=K.drawItemImpl(L,B,o,O,y),U=K._itemGap;return i&&(L.globalAlpha=1),this._currentItem!==B||"separator"===B||B.separator===!0||B.unfocusable||di(L,K._separatorColor,o-U/2,0,l+U,O),l},drawItemImpl:function(P,l,Y,y,g){var B=this,j=B._view,m=B._itemGap,R=y/2,_=l.type,f=l.element,t=l.label;Om(f)&&(t=f,f=E);var x,A=B.getLabelFont(l),I=B.getLabelColor(l),J=l.selected,i=fl(l.icon),v=_r(i,l),S=0,F=v+(t?_p(A,t).width:0);if("separator"===l||l.separator===!0)return Sd(P,B._separatorColor,Y,y/4,R),1;if(f){i&&yb(P,i,Y+v/2,R,l,B),_k(P,t,A,I,Y+v,0,0,y);var K=_f(f);g||B._90I.add(K),K.parentNode!==j&&Ej(j,K),f.iv&&f.iv(),f.validate&&f.validate();var V=K.getBoundingClientRect(),s=V.width,u=K.style;return Pr(K),u.left=B.tx()+Y+F+yr,u.top=(y-V.height)/2+yr,F+s}return _===Td?x=fl(J?_q:Sb):_===Oh&&(x=fl(J?Oh:im)),x?(S=_r(x,l),yb(P,x,Y+S/2,R,l,B),Y+=S,F+=S):J&&cs(P,Y-m/2,0,F+m,y,B.getSelectBackground(l)),i&&yb(P,i,Y+v/2,R,l,B),_k(P,t,A,I,Y+v,0,0,y),F},validateImpl:function(){var L=this,I=L._canvas,y=L.getWidth(),o=L.getHeight(),h=L._30o,$=L._items;Gm(I,y,o);var i=Te(I),J=L._itemGap,k=J/2;Rf(i,L.tx(),0,1),i.clearRect(0,0,y,o);var W=L._90I;L._90I=new oc,h.clear(),$.forEach(function(a){var I=L.drawItem(i,a,k,o);h.add({item:a,startX:k,endX:k+I,width:I}),I&&(k+=I+J)}),W.each(function(U){L._90I.contains(U)||gl(U)});var A=L._64I;L._64I=_(0,k-J/2),i.restore(),L._stickToRight?(L._65O=0,i=Te(I),k=y-L._64I+J/2,Rf(i,0,0,1),i.clearRect(0,0,y,o),h.clear(),$.forEach(function(M){var W=L.drawItem(i,M,k,o,!0);h.add({item:M,startX:k,endX:k+W,width:W}),W&&(k+=W+J)}),i.restore()):L.tx(L.tx()),A!==L._64I&&L.onSumWidthChanged(A,L._64I)},onSumWidthChanged:function(){},handleClick:function(M,A){var B=this,W=M.type,x=M.action,d=M.groupId,g=M.selected;M.disabled||(d!=E?g||(M.selected=!0,this._items.forEach(function(N){N.groupId===d&&M!==N&&(N.selected=!1)}),x&&M.action(M,B,A)):W===Oh||"toggle"===W?(M.selected=!g,x&&M.action(M,B,A)):x&&M.action(M,B,A)),mb(),B.iv()}});var _t=function(Q){this.tb=Q,this.addListeners()};gd(_t,O,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(v){this.handleScroll(v,10*(v.wheelDelta/40))},handle_DOMMouseScroll:function(k){this.handleScroll(k,10*-k.detail)},handleScroll:function(I,J){up(I);var G=this.tb;G.isScrollable()&&!G._stickToRight&&(G.tx(G.tx()+J),tk())},handle_mousemove:function(t){var x=this;Yb||x.setItem(t)},handle_mouseout:function(n){var V=this;n.target===V.getView()?V.tb.setCurrentItem(E):V.handle_mousemove(n)},handle_mousedown:function(g){this.handle_mousemove(g),this.handle_touchstart(g)},handle_touchstart:function($){var q=this,y=q.tb,M=$.target;kp($)&&(M===q.getView()||M===y._canvas)&&(up($),y.setFocus($)&&(this.setItem($,!0),(y.isScrollable()||q.info&&!q.info.item.disabled)&&(q.x=Tk($).x,q.tx=y.tx(),Mj(q,$))))},handleWindowMouseMove:function(f){this.handleWindowTouchMove(f)},handleWindowTouchMove:function(l){var U=this,y=U.tb;if(!y._stickToRight){var o=Tk(l).x-U.x;!U._25o&&B(o)>2&&y.isScrollable()&&(U._25o=1),U._25o&&y.tx(U.tx+o)}},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},handleWindowTouchEnd:function(R){var o=this,W=o.tb,m=o.info,P=o.tb.getItemInfoAt(R);if(!o._25o&&m){var t=m.item;P&&P.item===t&&W.handleClick(t,R)}o._25o=o.x=o.tx=E,o.setItem()},setItem:function(v,n){var Z=this,z=Z.tb,N=Z.info=v?z.getItemInfoAt(v):E,s=N?N.item:E;z.setCurrentItem(s),n&&s&&tj(s.onDown)&&s.onDown(v)}}),Jt.BorderPane=function(){this._view=Of(1,this),this.iv()},Kt("BorderPane",O,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(_,i){this._12o("leftView",_),i!=E&&this.setLeftWidth(i)},getRightView:function(){return this._rightView},setRightView:function(o,B){this._12o("rightView",o),B!=E&&this.setRightWidth(B)},getTopView:function(){return this._topView},setTopView:function(B,e){this._12o("topView",B),e!=E&&this.setTopHeight(e)},getBottomView:function(){return this._bottomView},setBottomView:function(s,j){this._12o("bottomView",s),j!=E&&this.setBottomHeight(j)},getCenterView:function(){return this._centerView},setCenterView:function(p){this._12o("centerView",p)},_12o:function(f,O){var a=this,V="_"+f,I=a._view,h=a[V];h!==O&&(h&&(h.getView?gl(h.getView()):gl(h)),a[V]=O,O&&(O.getView?Ej(I,O.getView(),1):Ej(I,O,1)),a.fp(f,h,O))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var Y=this,I=Y._topView,c=Y._bottomView,u=Y._leftView,J=Y._rightView,j=Y._centerView,A=Y.getWidth(),S=Y.getHeight(),t=0,z=0,s=A,Q=S,g=0,F=0,f=0,o=0;I&&(g=Y._topHeight==E?rf(I):Y._topHeight,z=g),c&&(F=Y._bottomHeight==E?rf(c):Y._bottomHeight,Q=S-F),u&&(f=Y._leftWidth==E?hn(u):Y._leftWidth,t=f),J&&(o=Y._rightWidth==E?hn(J):Y._rightWidth,s=A-o);var q=_(0,s-t),y=_(0,Q-z);I&&Xb(I,0,0,A,g),c&&Xb(c,0,Q,A,F),u&&Xb(u,0,z,f,y),J&&Xb(J,s,z,o,y),j&&Xb(j,t,z,q,y)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
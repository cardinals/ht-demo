!function(S){"use strict";var g="ht",t=S[g],B=Math,Q=B.max,K=B.min,P=B.abs,y=B.atan2,n=(B.cos,B.sin,B.ceil),u=t.Default,o=u.getInternal(),H=t.List,k=o.Mat,v=o.getNodeRect,V=o.intersectionLineRect,j=u.getDistance,L=u.setEdgeType,x="left",c="right",f="top",d="bottom",O="edge.type",W="edge.gap",p="edge.center",I="edge.extend",Z=function(b,V){return v(b,V).width},F=function(L,b){return v(L,b).height},z=function(k,t){return o.getEdgeHostPosition(k,t,"source")},A=function(z,s){return o.getEdgeHostPosition(z,s,"target")},_=function(M,$){var m=M.s(O),k=M.getEdgeGroup();if(k){var C=0;if(k.eachSiblingEdge(function(o){$.isVisible(o)&&o.s(O)==m&&C++}),C>1)return M.s(W)*(C-1)/2}return 0},s=function(g,A){var i=g.s(O),n=g.isLooped();if(!g.getEdgeGroup())return n?g.s(W):0;var V,L=0,c=0,F=0;return g.getEdgeGroup().getSiblings().each(function(j){j.each(function(v){if(v._40I===g._40I&&v.s(O)==i&&A.isVisible(v)){var Y=v.s(W);V?(c+=F/2+Y/2,F=Y):(V=v,F=Y),v===g&&(L=c)}})}),n?c-L+F:L-c/2},D=function(c,R){var V=R.s("edge.corner.radius");return u.toRoundedCorner(c,V)};o.addMethod(t.Style,{"edge.ripple.elevation":-20,"edge.ripple.size":1,"edge.ripple.both":!1,"edge.ripple.straight":!1,"edge.ripple.length":-1,"edge.corner.radius":-1,"edge.ortho":.5,"edge.flex":20,"edge.extend":20},!0),L("boundary",function(Q,R,M,m){m||(R=-R);var G,P=z(M,Q),F=A(M,Q),I=v(M,Q._40I),q=v(M,Q._41I),n=new k(y(F.y-P.y,F.x-P.x)),e=j(P,F),T=P.x,g=P.y;return G=n.tf(0,R),P={x:G.x+T,y:G.y+g},G=n.tf(e,R),F={x:G.x+T,y:G.y+g},G=V(P,F,I),G&&(P={x:G[0],y:G[1]}),G=V(P,F,q),G&&(F={x:G[0],y:G[1]}),{points:new H([P,F])}}),L("ripple",function(_,S,U,m){m||(S=-S);var M=z(U,_),I=A(U,_),D=j(M,I),J=K(_.s("edge.offset"),D/2),h=_.s("edge.ripple.size"),i=_.s("edge.ripple.length"),T=_.s("edge.ripple.both"),R=_.s(p),q=_.s("edge.ripple.elevation"),E=new H,x=_.s("edge.ripple.straight")?null:new H,c=new k(y(I.y-M.y,I.x-M.x));m||(q=-q),D-=2*J,i>0&&(h=n(D/i));var W=D/h;x&&x.add(1);for(var X=0;h>X;X++)x&&x.add(3),0===X?E.add({x:J+W*X,y:R?0:S}):E.add({x:J+W*X,y:S}),E.add({x:J+W*X+W/2,y:q+S}),T&&(q=-q);for(E.add({x:J+D,y:R?0:S}),X=0;X<E.size();X++){var g=c.tf(E.get(X));g.x+=M.x,g.y+=M.y,E.set(X,g)}return{points:E,segments:x}}),L("h.v",function(P,w,T){w=s(P,T);var l=new H,Q=P.s(p),$=z(T,P),r=$.x,b=$.y,N=A(T,P),m=N.x,u=N.y,f=P._40I instanceof t.Edge,C=P._41I instanceof t.Edge,c=0,L=0,V=m-r,X=u-b;return Q||(c=f?0:Z(T,P._40I)/2,L=C?0:F(T,P._41I)/2),V>=0&&0>=X?(l.add({x:r+c,y:b+w}),l.add({x:m+w,y:b+w}),l.add({x:m+w,y:u+L})):0>=V&&X>=0?(l.add({x:r-c,y:b+w}),l.add({x:m+w,y:b+w}),l.add({x:m+w,y:u-L})):V>=0&&X>=0?(l.add({x:r+c,y:b+w}),l.add({x:m-w,y:b+w}),l.add({x:m-w,y:u-L})):(l.add({x:r-c,y:b+w}),l.add({x:m-w,y:b+w}),l.add({x:m-w,y:u+L})),D(l,P)}),L("v.h",function(o,w,M){w=s(o,M);var d=new H,L=o.s(p),q=z(M,o),P=q.x,C=q.y,h=A(M,o),X=h.x,v=h.y,m=o._40I instanceof t.Edge,Y=o._41I instanceof t.Edge,i=0,O=0,S=X-P,k=v-C;return L||(i=Y?0:Z(M,o._41I)/2,O=m?0:F(M,o._40I)/2),S>=0&&0>=k?(d.add({x:P+w,y:C-O}),d.add({x:P+w,y:v+w}),d.add({x:X-i,y:v+w})):0>=S&&k>=0?(d.add({x:P+w,y:C+O}),d.add({x:P+w,y:v+w}),d.add({x:X+i,y:v+w})):S>=0&&k>=0?(d.add({x:P-w,y:C+O}),d.add({x:P-w,y:v+w}),d.add({x:X-i,y:v+w})):(d.add({x:P-w,y:C-O}),d.add({x:P-w,y:v+w}),d.add({x:X+i,y:v+w})),D(d,o)}),L("ortho",function(E,o,v){var j=new H,Q=E.s(p),B=E.s("edge.ortho"),W=E._40I,y=E._41I,I=z(v,E),c=I.x,C=I.y,R=A(v,E),m=R.x,s=R.y,$=m-c,u=s-C,b=W instanceof t.Edge,J=y instanceof t.Edge,X=Q||b?0:Z(v,W)/2,G=Q||b?0:F(v,W)/2,x=Q||J?0:Z(v,y)/2,Y=Q||J?0:F(v,y)/2,K=($-(X+x)*($>0?1:-1))*B,e=(u-(G+Y)*(u>0?1:-1))*B;return P($)<P(u)?$>=0&&0>=u?(j.add({x:c+o,y:C-G}),j.add({x:c+o,y:C+e+o-G}),j.add({x:m+o,y:C+e+o-G}),j.add({x:m+o,y:s+Y})):0>=$&&u>=0?(j.add({x:c+o,y:C+G}),j.add({x:c+o,y:C+e+o+G}),j.add({x:m+o,y:C+e+o+G}),j.add({x:m+o,y:s-Y})):$>=0&&u>=0?(j.add({x:c+o,y:C+G}),j.add({x:c+o,y:C+e-o+G}),j.add({x:m+o,y:C+e-o+G}),j.add({x:m+o,y:s-Y})):(j.add({x:c+o,y:C-G}),j.add({x:c+o,y:C+e-o-G}),j.add({x:m+o,y:C+e-o-G}),j.add({x:m+o,y:s+Y})):$>=0&&0>=u?(j.add({x:c+X,y:C+o}),j.add({x:c+K+o+X,y:C+o}),j.add({x:c+K+o+X,y:s+o}),j.add({x:m-x,y:s+o})):0>=$&&u>=0?(j.add({x:c-X,y:C+o}),j.add({x:c+K+o-X,y:C+o}),j.add({x:c+K+o-X,y:s+o}),j.add({x:m+x,y:s+o})):$>=0&&u>=0?(j.add({x:c+X,y:C+o}),j.add({x:c+K-o+X,y:C+o}),j.add({x:c+K-o+X,y:s+o}),j.add({x:m-x,y:s+o})):(j.add({x:c-X,y:C+o}),j.add({x:c+K-o-X,y:C+o}),j.add({x:c+K-o-X,y:s+o}),j.add({x:m+x,y:s+o})),D(j,E)}),L("flex",function(c,x,r){var O=new H,f=c.s("edge.flex")+_(c,r),N=c.s(p),b=c._40I,h=c._41I,v=z(r,c),d=v.x,K=v.y,$=A(r,c),M=$.x,T=$.y,k=b instanceof t.Edge,n=h instanceof t.Edge,B=M-d,G=T-K,U=N||k?0:Z(r,b)/2,e=N||k?0:F(r,b)/2,m=N||n?0:Z(r,h)/2,C=N||n?0:F(r,h)/2,u=B>0?f:-f,X=G>0?f:-f;return P(B)<P(G)?B>=0&&0>=G?(O.add({x:d+x,y:K-e}),O.add({x:d+x,y:K+X+x-e}),O.add({x:M+x,y:T-X+x+C}),O.add({x:M+x,y:T+C})):0>=B&&G>=0?(O.add({x:d+x,y:K+e}),O.add({x:d+x,y:K+X+x+e}),O.add({x:M+x,y:T-X+x-C}),O.add({x:M+x,y:T-C})):B>=0&&G>=0?(O.add({x:d+x,y:K+e}),O.add({x:d+x,y:K+X-x+e}),O.add({x:M+x,y:T-X-x-C}),O.add({x:M+x,y:T-C})):(O.add({x:d+x,y:K-e}),O.add({x:d+x,y:K+X-x-e}),O.add({x:M+x,y:T-X-x+C}),O.add({x:M+x,y:T+C})):B>=0&&0>=G?(O.add({x:d+U,y:K+x}),O.add({x:d+u+x+U,y:K+x}),O.add({x:M-u+x-m,y:T+x}),O.add({x:M-m,y:T+x})):0>=B&&G>=0?(O.add({x:d-U,y:K+x}),O.add({x:d+u+x-U,y:K+x}),O.add({x:M-u+x+m,y:T+x}),O.add({x:M+m,y:T+x})):B>=0&&G>=0?(O.add({x:d+U,y:K+x}),O.add({x:d+u-x+U,y:K+x}),O.add({x:M-u-x-m,y:T+x}),O.add({x:M-m,y:T+x})):(O.add({x:d-U,y:K+x}),O.add({x:d+u-x-U,y:K+x}),O.add({x:M-u-x+m,y:T+x}),O.add({x:M+m,y:T+x})),D(O,c)}),L("extend.east",function(a,K,Y){var r=new H,S=a.s(I)+_(a,Y),c=a.s(p),M=z(Y,a),R=a._40I instanceof t.Edge,u=a._41I instanceof t.Edge,O=M.x+(c||R?0:Z(Y,a._40I)/2),k=M.y,s=A(Y,a),o=s.x+(c||u?0:Z(Y,a._41I)/2),$=s.y,q=Q(O,o)+S;return k>$?(r.add({x:O,y:k+K}),r.add({x:q+K,y:k+K}),r.add({x:q+K,y:$-K}),r.add({x:o,y:$-K})):(r.add({x:O,y:k-K}),r.add({x:q+K,y:k-K}),r.add({x:q+K,y:$+K}),r.add({x:o,y:$+K})),D(r,a)}),L("extend.west",function(x,E,S){var s=new H,j=x.s(I)+_(x,S),B=x.s(p),C=x._40I instanceof t.Edge,q=x._41I instanceof t.Edge,a=z(S,x),c=a.x-(B||C?0:Z(S,x._40I)/2),W=a.y,l=A(S,x),i=l.x-(B||q?0:Z(S,x._41I)/2),w=l.y,f=K(c,i)-j;return W>w?(s.add({x:c,y:W+E}),s.add({x:f-E,y:W+E}),s.add({x:f-E,y:w-E}),s.add({x:i,y:w-E})):(s.add({x:c,y:W-E}),s.add({x:f-E,y:W-E}),s.add({x:f-E,y:w+E}),s.add({x:i,y:w+E})),D(s,x)}),L("extend.north",function(k,J,n){var l=new H,Y=k.s(I)+_(k,n),X=k.s(p),q=k._40I instanceof t.Edge,C=k._41I instanceof t.Edge,M=z(n,k),P=M.x,m=M.y-(X||q?0:F(n,k._40I)/2),f=A(n,k),S=f.x,v=f.y-(X||C?0:F(n,k._41I)/2),r=K(m,v)-Y;return P>S?(l.add({y:m,x:P+J}),l.add({y:r-J,x:P+J}),l.add({y:r-J,x:S-J}),l.add({y:v,x:S-J})):(l.add({y:m,x:P-J}),l.add({y:r-J,x:P-J}),l.add({y:r-J,x:S+J}),l.add({y:v,x:S+J})),D(l,k)}),L("extend.south",function(a,X,v){var N=new H,B=a.s(I)+_(a,v),x=a.s(p),C=a._40I instanceof t.Edge,K=a._41I instanceof t.Edge,g=z(v,a),q=g.x,W=g.y+(x||C?0:F(v,a._40I)/2),$=A(v,a),V=$.x,f=$.y+(x||K?0:F(v,a._41I)/2),T=Q(W,f)+B;return q>V?(N.add({y:W,x:q+X}),N.add({y:T+X,x:q+X}),N.add({y:T+X,x:V-X}),N.add({y:f,x:V-X})):(N.add({y:W,x:q-X}),N.add({y:T+X,x:q-X}),N.add({y:T+X,x:V+X}),N.add({y:f,x:V+X})),D(N,a)});var m=function(i,D,M,y,Y){if(y.sort(function(t,$){var J=t.getSourceAgent()===D?t.getTargetAgent():t.getSourceAgent(),L=$.getSourceAgent()===D?$.getTargetAgent():$.getSourceAgent(),n=J.p(),B=L.p();if(M===x||M===c){if(n.y>B.y)return 1;if(n.y<B.y)return-1}else{if(n.x>B.x)return 1;if(n.x<B.x)return-1}return u.sortFunc(t.getId(),$.getId())}),Y){for(var f,h,T,S=i.getSourceAgent(),$=i.getTargetAgent(),w=0;w<y.size();w++){var X=y.get(w);X.getSourceAgent()===S&&X.getTargetAgent()===$||X.getTargetAgent()===S&&X.getSourceAgent()===$?(h||(h=new H),h.add(X,0)):h?(T||(T=new H),T.add(X)):(f||(f=new H),f.add(X))}y.clear(),f&&y.addAll(f),h&&y.addAll(h),T&&y.addAll(T)}var p=y.indexOf(i),I=y.size(),N=i.s(W);return{side:M,index:p,size:I,offset:-N*(I-1)/2+N*p}},G=function(C,S,K,X,i){var j=S.s(O);return m(S,K,X,K.getAgentEdges().toList(function(y){return C.isVisible(y)&&y.s(O)===j}),i)},R=function(k,n){var i=k.getSourceAgent()===n?k.getTargetAgent():k.getSourceAgent(),G=n.p(),z=i.p(),l=z.x-G.x,F=z.y-G.y;return l>0&&P(F)<=l?c:0>l&&P(F)<=-l?x:F>0&&P(l)<=F?d:f},X=function(b,q,a){var s=q.s(O),h=R(q,a);return m(q,a,h,a.getAgentEdges().toList(function(x){return b.isVisible(x)&&x.s(O)===s&&R(x,a)===h}))},Y=function(B,z){var r=B.getSourceAgent()===z,y=r?B.getTargetAgent():B.getSourceAgent(),F=z.p(),k=y.p();return r?F.y>k.y?f:d:F.x<k.x?c:x},E=function(p,K,H){var h=K.s(O),L=Y(K,H);return m(K,H,L,H.getAgentEdges().toList(function(v){return p.isVisible(v)&&v.s(O)===h&&Y(v,H)===L}),L===c||L===d)},b=function(V,e){var I=V.getSourceAgent()===e,F=I?V.getTargetAgent():V.getSourceAgent(),M=e.p(),K=F.p();return I?M.x<K.x?c:x:M.y>K.y?f:d},l=function(g,j,H){var L=j.s(O),G=b(j,H);return m(j,H,G,H.getAgentEdges().toList(function(X){return g.isVisible(X)&&X.s(O)===L&&b(X,H)===G}),G===c||G===d)},q=function(G,C,l){var S=G.getSourceAgent(),e=G.getTargetAgent(),$=S.getId()>e.getId(),L=$?e:S,P=$?S:e,X=L.p(),M=P.p(),T=l(C,G,L),A=l(C,G,P),g=G.s(p),O=g?0:Z(C,L)/2,E=g?0:Z(C,P)/2,q=g?0:F(C,L)/2,i=g?0:F(C,P)/2,N=T.offset,B=A.offset,j=T.side,J=A.side,V=new H;return j===f?(V.add({x:X.x+N,y:X.y-q}),V.add({x:X.x+N,y:M.y+B}),J===x?V.add({x:M.x-E,y:M.y+B}):V.add({x:M.x+E,y:M.y+B})):j===d?(V.add({x:X.x+N,y:X.y+q}),V.add({x:X.x+N,y:M.y+B}),J===x?V.add({x:M.x-E,y:M.y+B}):V.add({x:M.x+E,y:M.y+B})):j===x?(V.add({x:X.x-O,y:X.y+N}),V.add({x:M.x+B,y:X.y+N}),J===d?V.add({x:M.x+B,y:M.y+i}):V.add({x:M.x+B,y:M.y-i})):j===c&&(V.add({x:X.x+O,y:X.y+N}),V.add({x:M.x+B,y:X.y+N}),J===d?V.add({x:M.x+B,y:M.y+i}):V.add({x:M.x+B,y:M.y-i})),$&&V.reverse(),D(V,G)};L("ortho2",function(M,V,z){var G,Y,t=M.s(p),Q=M.s("edge.ortho"),S=M.getSourceAgent(),L=M.getTargetAgent(),q=S.getId()>L.getId(),m=q?L:S,E=q?S:L,$=m.p(),N=E.p(),r=X(z,M,m),i=X(z,M,E),A=t?0:Z(z,m)/2,P=t?0:F(z,m)/2,g=t?0:Z(z,E)/2,b=t?0:F(z,E)/2,y=new H,I=r.offset,h=i.offset,a=r.side;return a===c?(G=N.y>$.y?-I:I,Y=$.x+A+(N.x-g-$.x-A)*Q,y.add({x:$.x+A,y:$.y+I}),y.add({x:Y+G,y:$.y+I}),y.add({x:Y+G,y:N.y+h}),y.add({x:N.x-g,y:N.y+h})):a===x?(G=N.y>$.y?-I:I,Y=$.x-A-($.x-A-N.x-g)*Q,y.add({x:$.x-A,y:$.y+I}),y.add({x:Y-G,y:$.y+I}),y.add({x:Y-G,y:N.y+h}),y.add({x:N.x+g,y:N.y+h})):a===d?(G=N.x>$.x?-I:I,Y=$.y+P+(N.y-b-$.y-P)*Q,y.add({x:$.x+I,y:$.y+P}),y.add({x:$.x+I,y:Y+G}),y.add({x:N.x+h,y:Y+G}),y.add({x:N.x+h,y:N.y-b})):a===f&&(G=N.x>$.x?-I:I,Y=$.y-P-($.y-P-N.y-b)*Q,y.add({x:$.x+I,y:$.y-P}),y.add({x:$.x+I,y:Y-G}),y.add({x:N.x+h,y:Y-G}),y.add({x:N.x+h,y:N.y+b})),q&&y.reverse(),D(y,M)},!0),L("flex2",function(V,S,b){var K,A=V.getSourceAgent(),G=V.getTargetAgent(),u=A.getId()>G.getId(),v=u?G:A,q=u?A:G,I=v.p(),L=q.p(),T=X(b,V,v),t=X(b,V,q),$=V.s(p),N=V.s("edge.flex")+(T.size-1)/2*V.s(W),J=$?0:Z(b,v)/2,U=$?0:F(b,v)/2,g=$?0:Z(b,q)/2,n=$?0:F(b,q)/2,i=new H,k=T.offset,e=t.offset,C=T.side;return C===c?(K=L.y>I.y?-k:k,i.add({x:I.x+J,y:I.y+k}),i.add({x:I.x+J+N+K,y:I.y+k}),i.add({x:L.x-g-N+K,y:L.y+e}),i.add({x:L.x-g,y:L.y+e})):C===x?(K=L.y>I.y?-k:k,i.add({x:I.x-J,y:I.y+k}),i.add({x:I.x-J-N-K,y:I.y+k}),i.add({x:L.x+g+N-K,y:L.y+e}),i.add({x:L.x+g,y:L.y+e})):C===d?(K=L.x>I.x?-k:k,i.add({x:I.x+k,y:I.y+U}),i.add({x:I.x+k,y:I.y+U+N+K}),i.add({x:L.x+e,y:L.y-n-N+K}),i.add({x:L.x+e,y:L.y-n})):C===f&&(K=L.x>I.x?-k:k,i.add({x:I.x+k,y:I.y-U}),i.add({x:I.x+k,y:I.y-U-N-K}),i.add({x:L.x+e,y:L.y+n+N-K}),i.add({x:L.x+e,y:L.y+n})),u&&i.reverse(),D(i,V)},!0),L("extend.north2",function(B,Q,g){var Z=B.getSourceAgent(),$=B.getTargetAgent(),q=Z.getId()>$.getId(),i=q?$:Z,R=q?Z:$,r=i.p(),X=R.p(),u=G(g,B,i,f),v=G(g,B,R,f,!0),l=B.s(p),M=l?0:F(g,i)/2,o=l?0:F(g,R)/2,y=u.offset,Y=v.offset,L=B.s(I)+(u.size-1)/2*B.s(W),c=K(r.y-M,X.y-o)-L+(r.x<X.x?y:-y),V=new H;return V.add({x:r.x+y,y:r.y-M}),V.add({x:r.x+y,y:c}),V.add({x:X.x+Y,y:c}),V.add({x:X.x+Y,y:X.y-o}),q&&V.reverse(),D(V,B)},!0),L("extend.south2",function(m,A,q){var t=m.getSourceAgent(),X=m.getTargetAgent(),a=t.getId()>X.getId(),J=a?X:t,M=a?t:X,k=J.p(),U=M.p(),i=G(q,m,J,d),y=G(q,m,M,d,!0),B=m.s(p),S=B?0:F(q,J)/2,E=B?0:F(q,M)/2,K=i.offset,O=y.offset,_=m.s(I)+(i.size-1)/2*m.s(W),r=Q(k.y+S,U.y+E)+_+(k.x>U.x?K:-K),x=new H;return x.add({x:k.x+K,y:k.y+S}),x.add({x:k.x+K,y:r}),x.add({x:U.x+O,y:r}),x.add({x:U.x+O,y:U.y+E}),a&&x.reverse(),D(x,m)},!0),L("extend.west2",function(C,b,U){var J=C.getSourceAgent(),z=C.getTargetAgent(),u=J.getId()>z.getId(),M=u?z:J,s=u?J:z,A=M.p(),k=s.p(),B=G(U,C,M,f),l=G(U,C,s,f,!0),m=C.s(p),r=m?0:Z(U,M)/2,X=m?0:Z(U,s)/2,x=B.offset,R=l.offset,Y=C.s(I)+(B.size-1)/2*C.s(W),S=K(A.x-r,k.x-X)-Y+(A.y<k.y?x:-x),T=new H;return T.add({x:A.x-r,y:A.y+x}),T.add({x:S,y:A.y+x}),T.add({x:S,y:k.y+R}),T.add({x:k.x-X,y:k.y+R}),u&&T.reverse(),D(T,C)},!0),L("extend.east2",function(k,P,q){var X=k.getSourceAgent(),z=k.getTargetAgent(),J=X.getId()>z.getId(),m=J?z:X,d=J?X:z,l=m.p(),y=d.p(),K=G(q,k,m,f),A=G(q,k,d,f,!0),R=k.s(p),U=R?0:Z(q,m)/2,N=R?0:Z(q,d)/2,L=K.offset,M=A.offset,F=k.s(I)+(K.size-1)/2*k.s(W),$=Q(l.x+U,y.x+N)+F+(l.y>y.y?L:-L),a=new H;return a.add({x:l.x+U,y:l.y+L}),a.add({x:$,y:l.y+L}),a.add({x:$,y:y.y+M}),a.add({x:y.x+N,y:y.y+M}),J&&a.reverse(),D(a,k)},!0),L("v.h2",function(F,O,I){return q(F,I,E)},!0),L("h.v2",function(z,o,E){return q(z,E,l)},!0)}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
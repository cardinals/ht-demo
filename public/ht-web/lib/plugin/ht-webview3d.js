!function(e){"use strict";function F(f){var F,U,s,k,J,R,e,I=[],X=0;F=x.createDiv(!0);var V=f.getView();V.insertBefore(F,f.getCanvas()),U=T.Default.createDiv(),U.style.WebkitTransformStyle="preserve-3d",U.style.MozTransformStyle="preserve-3d",U.style.transformStyle="preserve-3d",F.appendChild(U),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(w){var M=w.style;$.addEventListener(V,w.event,function(){f.isDragProtectForWebView()&&(F.style.pointerEvents=M)})}),this.updateWebView=function(){if(f.getWidth()&&f.getHeight()){var E=f.getCanvas(),o=1*E.style.width.slice(0,-2),p=1*E.style.height.slice(0,-2);(I[0]!==o||I[1]!==p)&&(I[0]=o,I[1]=p,F.style.width=o+"px",F.style.height=p+"px",U.style.width=o+"px",U.style.height=p+"px");var y=f._projectMatrix[5]*I[1]/2;y!==s&&(s=y,F.style.WebkitPerspective=s+"px",F.style.MozPerspective=s+"px",F.style.perspective=s+"px"),R="translateZ("+s+"px)"+q(f._viewMatrix);var m=R+"translate("+I[0]/2+"px,"+I[1]/2+"px)";k===m||J||(U.style.WebkitTransform=m,U.style.MozTransform=m,U.style.transform=m,k=m),X++,e=!1,f.dm().each(function(D){D.isWebView&&A(D)});for(var v,V=U.children,t=[],P=0,G=V.length;G>P;P++)v=V[P],v._isHtWebView&&v._renderCookie!==X&&t.push(v);t.length&&t.forEach(function(C){U.removeChild(C)})}};var j=new Array(16),A=function(o){var F=o.getAttach();if(F){var E=f.isVisible(o);if(E&&F.parentNode!==U?U.appendChild(F):!E&&F.parentNode&&x.removeHTML(F),E){F._renderCookie=X,e=!0;var p=o.getFinalScale3d(),d=o._prefrenceSize;d&&d[0]?d[1]||(d[1]=d[0]/p[0]*p[1]):d=[p[0],p[1]],F.style.width=d[0]+"px",F.style.height=d[1]+"px";var P=1/d[0],Z=1/d[1],C=1,O=o.mat;j[0]=O[0]*P,j[1]=O[1]*P,j[2]=O[2]*P,j[3]=O[3]*P,j[4]=O[4]*Z,j[5]=O[5]*Z,j[6]=O[6]*Z,j[7]=O[7]*Z,j[8]=O[8]*C,j[9]=O[9]*C,j[10]=O[10]*C,j[11]=O[11]*C,j[12]=O[12],j[13]=O[13],j[14]=O[14],j[15]=O[15];var T=L(j,J?"translate("+I[0]/2+"px,"+I[1]/2+"px)"+R:""),D=F.$a2;D!==T&&(F.$a2=T,F.style.WebkitTransform=T,F.style.MozTransform=T,F.style.transform=T)}}}}function o(V){return Math.abs(V)<1e-10?0:V}function q(b){var T=b;return"matrix3d("+o(T[0])+","+o(-T[1])+","+o(T[2])+","+o(T[3])+","+o(T[4])+","+o(-T[5])+","+o(T[6])+","+o(T[7])+","+o(T[8])+","+o(-T[9])+","+o(T[10])+","+o(T[11])+","+o(T[12])+","+o(-T[13])+","+o(T[14])+","+o(T[15])+")"}function L(c,M){var B=c,f="matrix3d("+o(B[0])+","+o(B[1])+","+o(B[2])+","+o(B[3])+","+o(-B[4])+","+o(-B[5])+","+o(-B[6])+","+o(-B[7])+","+o(B[8])+","+o(B[9])+","+o(B[10])+","+o(B[11])+","+o(B[12])+","+o(B[13])+","+o(B[14])+","+o(B[15])+")";return"translate(-50%,-50%)"+(M||"")+f}var V="ht",T=e[V],x=T.Default,$=x.getInternal(),Q=$.superCall,_=T.graph3d.Graph3dView,K=_.prototype.validateImpl;_.prototype.validateImpl=function(){K.call(this);var i=this._webViewRenderer;i||(i=this._webViewRenderer=new F(this)),i.updateWebView()},_.prototype.isDragProtectForWebView=function(){return this._dragProtectForWebView},_.prototype.setDragProtectForWebView=function(X){this._dragProtectForWebView=X};var P=T.WebView3d=function(){var o=this;Q(P,o),o.s({shape3d:"billboard","shape3d.reverse.flip":!0})},v=[1,1,1,1],n=[0,0,0,0];x.def(V+"."+"WebView3d",T.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(J,g,F){if(!J)return this.detachDOM();if("string"==typeof J){var j=document.createElement("iframe");j.src=J,J=j}var e=J.style;e.position="absolute",e.border=0,e.outline=0,e.padding=0,e.margin=0,J._isHtWebView=!0,this.setAttach(J),this._prefrenceSize=[g,F],this.s("shape3d.blend",n)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(R){this.a("defaultBgColor",R),this.getAttach()||this.s("shape3d.blend",R)},getBgColor:function(){return this.a("defaultBgColor")||v}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);
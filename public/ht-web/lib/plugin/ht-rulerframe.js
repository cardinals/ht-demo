!function(q,F){"use strict";var Y="position",K="absolute",B="relative",m="px",T="left",e="right",J="top",u="bottom",V="display",r="none",G="block",v=ht.Default,k=v.getInternal(),p=Math.floor,$=Math.ceil,a=Math.PI,W=null,H=q.parseInt,f=function(z){return z.getContext("2d")},x=function(){return document},_=function(i){return x().createElement(i)},l=function(){return _("canvas")},A=function(E,L,p){E.style.setProperty(L,p,W)},h=function(j,i,Z){v.def(ht.widget[j],i,Z)},U=function(t,w){t.appendChild(w)},I=function(X,O){X.removeChild(O)},k=v.getInternal(),i=k.addEventListener,S=k.removeEventListener;ht.widget.RulerFrame=function(t){var X=this,d=X._view=k.createView(null,X),p=X.$1k=l(),C=X.$2k=l(),r=X.$3k=l(),s=X.$4k=l();X._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},X._topRulerConfig={visible:!0},X._rightRulerConfig={visible:!1},X._bottomRulerConfig={visible:!1},X._leftRulerConfig={visible:!0},U(d,p),U(d,r),U(d,C),U(d,s),A(d,Y,B),A(d,"box-sizing","border-box"),A(d,"-moz-box-sizing","border-box"),A(p,Y,K),A(C,Y,K),A(r,Y,K),A(s,Y,K),X.$14k=function(){X.$13k=1,X.iv()},X.$15k=function(G){if(X._topRulerConfig.guideVisible||X._rightRulerConfig.guideVisible||X._bottomRulerConfig.guideVisible||X._leftRulerConfig.guideVisible||X._defaultRulerConfig.guideVisible||(X._topRulerConfig.guideTipVisible||X._rightRulerConfig.guideTipVisible||X._bottomRulerConfig.guideTipVisible||X._leftRulerConfig.guideTipVisible||X._defaultRulerConfig.guideTipVisible)&&X._component){var K=d.getBoundingClientRect();X.$16k={x:G.clientX-K.left,y:G.clientY-K.top},X.$5k()}},X.setComponent(t)},h("RulerFrame",F,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(H){var R=this,T=R._component,k=R.getView();if(k){if(R._component=H,R.fp("component",T,H),T){var N=R.getComponentView(T);I(k,N),S(k,"mousemove",R.$15k),R.removeComponentPropertyChangeListener(T,R.$14k)}if(H){var Z=R.getComponentView(H);U(k,Z),A(Z,Y,K),i(k,"mousemove",R.$15k),R.addComponentPropertyChangeListener(H,R.$14k)}}},addComponentPropertyChangeListener:function(L,R){L&&L.mp&&L.mp(R)},removeComponentPropertyChangeListener:function(W,s){W&&W.ump&&W.ump(s)},getComponentHZoom:function($){return $&&$.getZoom?$.getZoom():1},getComponentVZoom:function(X){return X&&X.getZoom?X.getZoom():1},getComponentViewRect:function(M){return M&&M.getViewRect?M.getViewRect():void 0},getComponentView:function(i){return i&&i.getView?i.getView():i},invalidateComponent:function(h){h&&h.iv&&h.iv()},validateComponent:function(R){R&&R.validate&&R.validate()},$7k:function(O,J,j,b,e,H,s,I,x,Z,K,F){if(J.visible){var E=this._defaultRulerConfig,B="borderStyle",l="borderColor",X="borderWidth",L="background",q=J[B]||E[B],t=J[l]||E[l],C=J[X]||E[X],z=J.size!=W?J.size:E.size,U=J[L]||E[L],m=z+C,T=this.$6k(C,q,t,O,j,e,m,s,I,x,Z,K,F);A(O,e,"0px"),H?k.setCanvas(O,b-T,z):k.setCanvas(O,z,b-T),A(O,"background",U),A(O,V,G)}else A(O,V,r),A(this.getComponentView(this._component),e,"0px")},$6k:function(G,u,p,E,g,L,U,h,V,x,K,W,c){var j=0;return A(E,g,G+"px "+u+" "+p),A(this.getComponentView(this._component),L,U+m),h?(A(E,V,x+m),j+=x):A(E,V,"0px"),K?(A(E,W,c+m),j+=c):A(E,W,"0px"),j},validateImpl:function(){var D=this,k=D._component,E=D.$1k,l=D.$2k,g=D.$3k,t=D.$4k,H=D._view,p=D._defaultRulerConfig,y=D._topRulerConfig,Q=D._rightRulerConfig,r=D._bottomRulerConfig,d=D._leftRulerConfig,B=p.size;if(H&&k){var L=y.size!=W?y.size:B,P=Q.size!=W?Q.size:B,A=r.size!=W?r.size:B,U=d.size!=W?d.size:B;D.$7k(E,y,"border-bottom",H.offsetWidth,J,!0,d.visible,T,U,Q.visible,e,P),D.$7k(l,Q,"border-left",H.offsetHeight,e,!1,y.visible,J,L,r.visible,u,A),D.$7k(g,r,"border-top",H.offsetWidth,u,!0,d.visible,T,U,Q.visible,e,P),D.$7k(t,d,"border-right",H.offsetHeight,T,!1,y.visible,J,L,r.visible,u,A),D.$13k?delete D.$13k:D.invalidateComponent(k),D.validateComponent(k),D.$5k()}},$5k:function(){function e(Z,j,E,G,l,e){if(j.visible){var M=f(Z),w=j[k]||N,z=j[_]!=W?j[_]:P,g=j[d]||L,u=j[q]||h,H=j.size!=W?j.size:S,yk=j[J]||s,Xd=j[T]||F,wf=j[t]||Y,vb=j[x]!=W?j[x]:c,Uc=j[C]!=W?j[C]:V,Kk=j[p]!=W?j[p]:K,ci=j[a]!=W?j[a]:y,Zb=j[R]!=W?j[R]:X,bj=j[r]!=W?j[r]:Q,eh=j[m]||Zg,sp=j[i]||jq;z&&(w=b[e]=b.$8k(b[e]||w,j[o]||I,j[U]||D,G?A:v,Xd)),E.call(b,M,O,$,B,n,H,G?A:v,w,g,u,l,yk,wf);var $p=b.$16k;(vb||Uc)&&$p&&(G?b.$9k(M,$p.x,H,eh,sp,vb,Uc,Kk,ci,Zb,bj):b.$10k(M,$p.y,H,eh,sp,vb,Uc,Kk,ci,Zb,bj,l))}}var b=this,j=b.$1k,M=b.$2k,z=b.$3k,G=b.$4k,u=b._topRulerConfig,l=b._rightRulerConfig,H=b._bottomRulerConfig,g=b._leftRulerConfig,E=b._defaultRulerConfig,Z=b._component,w=b.getComponentViewRect(Z),A=b.getComponentHZoom(Z),v=b.getComponentVZoom(Z),O=w.x*A,B=O+w.width*A,$=w.y*v,n=$+w.height*v,S=b._defaultRulerConfig.size,k="defaultMajorTickSpacing",o="maxPhysicalMajorTickSpacing",U="minPhysicalMajorTickSpacing",_="tickSpacingAdaptable",d="majorTickTextFont",q="majorTickTextColor",J="majorTickColor",t="minorTickColor",x="guideVisible",C="guideTipVisible",p="guideTipBorderColor",a="guideTipTextColor",R="guideTipTextFont",r="guideTipBackground",m="guideColor",i="guideWidth",T="minMajorTickSpacing",N=E[k],I=E[o],D=E[U],P=E[_],L=E[d],h=E[q],s=E[J],F=E[T],Y=E[t],c=E[x],V=E[C],K=E[p],y=E[a],X=E[R],Q=E[r],Zg=E[m],jq=E[i];b._view&&Z&&(e(j,u,b.$11k,!0,!1,"_currentTopMajorTickSpacing"),e(M,l,b.$12k,!1,!0,"_currentRightMajorTickSpacing"),e(z,H,b.$11k,!0,!0,"_currentBottomMajorTickSpacing"),e(G,g,b.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(f,e,q,A,s){return q>f*A?f=p(e/A/s)*s:f*A>e&&(f=$(q/A/s)*s),f},getHTipText:function(j){var v=this,D=v._component,T=0,Y=v._view.getBoundingClientRect();return D.lp?T=H(D.lp({x:j.x+Y.left,y:j.y}).x):T-=H(this.getComponentView(D).style.left)||0,T},$9k:function(t,B,c,Q,P,v,m,C,U,A,h){var X=this,g=X._component;t.save(),k.translateAndScale(t,0,0,1);var o=B-(H(this.getComponentView(g).style.left)||0),Y=0;if(B=X.getHTipText(X.$16k),v&&(t.beginPath(),t.fillStyle=Q,t.rect(o,Y,P,c),t.fill()),m){t.beginPath(),t.textAlign="center",t.textBaseline="middle",t.font=A;var O=t.measureText(B).width+6;t.fillStyle=h,t.rect(o-O/2,Y,O,c),t.fill(),t.strokeStyle=C,t.stroke(),t.beginPath(),t.fillStyle=U,t.fillText(B,o,Y+c/2)}t.restore()},getVTipText:function(Q){var g=this,q=g._component,h=0,z=g._view.getBoundingClientRect();return q.lp?h=H(q.lp({x:Q.x,y:Q.y+z.top}).y):h-=H(this.getComponentView(q).style.top)||0,h},formatScaleText:function(U){return Math.round(U)},$10k:function(j,I,t,w,Y,p,E,B,l,L,V,Q){var n=this,X=n._component;j.save(),k.translateAndScale(j,0,0,1);var s=t/2,v=I-(H(this.getComponentView(X).style.top)||0);if(I=n.getVTipText(n.$16k),p&&(j.beginPath(),j.fillStyle=w,j.rect(s-t/2,v,t,Y),j.fill()),E){j.translate(s,v),j.rotate((Q?90:-90)*a/180),j.translate(-s,-v),j.beginPath(),j.textAlign="center",j.textBaseline="middle",j.font=L;var U=j.measureText(I).width+6;j.fillStyle=V,j.rect(s-U/2,v-t/2,U,t),j.fill(),j.strokeStyle=B,j.stroke(),j.fillStyle=l,j.fillText(I,s,v)}j.restore()},$11k:function(E,$,I,q,o,g,B,A,Y,f,m,w,D){E.save(),I=0;var t=$,L=q,d=(t+L)/2;$=0,q=L-t,k.translateAndScale(E,0,0,1);var i=0,Q=0,z=H(g/2),P=g-z,V=m?0:z,R=A*B,a=R/10;$-=R,q+=R,E.clearRect($,0,q-$,g),E.beginPath(),E.fillStyle=D;var x=p(d/a)*a-t;for(i=x;q>i;i+=a)E.rect(i,I+V,1,P);for(i=x;i>$;i-=a)E.rect(i,I+V,1,P);for(E.fill(),V=m?0:1,E.beginPath(),E.fillStyle=w,x=p(d/R)*R-t,i=x;q>i;i+=R)E.rect(i,I+V,1,g-1);for(i=x;i>$;i-=R)E.rect(i,I+V,1,g-1);E.fill();var h=H(/\d+px/.exec(Y)[0]),s=(h||10)/2;E.textBaseline="middle",V=m?g-s-2:s+2,E.beginPath(),E.fillStyle=f,E.font=Y;var Z=p(d/R)*R/B;for(i=x,Q=Z;q>i;i+=R,Q+=A){var O=this.getHScaleText?this.getHScaleText(i):Q;E.fillText(this.formatScaleText(O),i+2,I+V)}for(i=x,Q=Z;i>$;i-=R,Q-=A){var O=this.getHScaleText?this.getHScaleText(i):Q;E.fillText(this.formatScaleText(O),i+2,I+V)}E.restore()},$12k:function(c,b,_,G,E,X,Y,l,B,r,I,z,L){function o(h,X,d,K,x,a){x=Q.getVScaleText?Q.getVScaleText(d):x,x=Q.formatScaleText(x),c.translate(h+X,d),c.rotate(-K),c.translate(-h-X,-d),c.fillText(x,h+X+(a?2:1),d),c.translate(h+X,d),c.rotate(K),c.translate(-h-X,-d)}c.save(),b=0;var F=_,D=E,K=(F+D)/2;_=0,E=D-F,k.translateAndScale(c,0,0,1);var C=0,Q=this,h=0,y=H(X/2),M=X-y,O=I?0:y,s=l*Y,P=s/10;_-=s,E+=s,c.clearRect(b,0,X,E-_),c.beginPath(),c.fillStyle=L;var n=p(K/P)*P-F;for(C=n;E>C;C+=P)c.rect(b+O,C,M,1);for(C=n;C>_;C-=P)c.rect(b+O,C,M,1);for(c.fill(),O=I?0:1,c.beginPath(),c.fillStyle=z,n=p(K/s)*s-F,C=n;E>C;C+=s)c.rect(b+O,C,X-1,1);for(C=n;C>_;C-=s)c.rect(b+O,C,X-1,1);c.fill();var W=H(/\d+px/.exec(B)[0]),e=(W||10)/2,U=90*a/180;c.textBaseline="middle",O=I?X-e:e+2,U=I?-U:U,c.beginPath(),c.fillStyle=r,c.font=B;var q=p(K/s)*s/Y;for(C=n,h=q;E>C;C+=s,h+=l)o(b,O,C,U,h,I);for(C=n,h=q;C>_;C-=s,h-=l)o(b,O,C,U,h,I);c.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var C=this,q=C._component,B=C._view;q&&C.removeComponentPropertyChangeListener(q,C.$14k),B&&(S(B,"mousemove",C.$15k),I(B.parentNode,B),C._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);